var mod;mod=angular.module("infinite-scroll",[]),mod.value("THROTTLE_MILLISECONDS",null),mod.directive("infiniteScroll",["$rootScope","$window","$interval","THROTTLE_MILLISECONDS",function(a,b,c,d){return{scope:{infiniteScroll:"&",infiniteScrollContainer:"=",infiniteScrollDistance:"=",infiniteScrollDisabled:"=",infiniteScrollUseDocumentBottom:"="},link:function(e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return x=angular.element(b),t=null,u=null,i=null,j=null,q=!0,w=!1,p=function(a){return a=a[0]||a,isNaN(a.offsetHeight)?a.document.documentElement.clientHeight:a.offsetHeight},r=function(a){return a[0].getBoundingClientRect&&!a.css("none")?a[0].getBoundingClientRect().top+s(a):void 0},s=function(a){return a=a[0]||a,isNaN(window.pageYOffset)?a.document.documentElement.scrollTop:a.ownerDocument.defaultView.pageYOffset},o=function(){var b,c,d,g,h;return j===x?(b=p(j)+s(j[0].document.documentElement),d=r(f)+p(f)):(b=p(j),c=0,void 0!==r(j)&&(c=r(j)),d=r(f)-c+p(f)),w&&(d=p((f[0].ownerDocument||f[0].document).documentElement)),g=d-b,h=g<=p(j)*t+1,h?(i=!0,u?e.$$phase||a.$$phase?e.infiniteScroll():e.$apply(e.infiniteScroll):void 0):i=!1},v=function(a,b){var d,e,f;return f=null,e=0,d=function(){var b;return e=(new Date).getTime(),c.cancel(f),f=null,a.call(),b=null},function(){var g,h;return g=(new Date).getTime(),h=b-(g-e),0>=h?(clearTimeout(f),c.cancel(f),f=null,e=g,a.call()):f?void 0:f=c(d,h,1)}},null!=d&&(o=v(o,d)),e.$on("$destroy",function(){return j.unbind("scroll",o)}),m=function(a){return t=parseFloat(a)||0},e.$watch("infiniteScrollDistance",m),m(e.infiniteScrollDistance),l=function(a){return u=!a,u&&i?(i=!1,o()):void 0},e.$watch("infiniteScrollDisabled",l),l(e.infiniteScrollDisabled),n=function(a){return w=a},e.$watch("infiniteScrollUseDocumentBottom",n),n(e.infiniteScrollUseDocumentBottom),h=function(a){return null!=j&&j.unbind("scroll",o),j=a,null!=a?j.bind("scroll",o):void 0},h(x),k=function(a){if(null!=a&&0!==a.length){if(a instanceof HTMLElement?a=angular.element(a):"function"==typeof a.append?a=angular.element(a[a.length-1]):"string"==typeof a&&(a=angular.element(document.querySelector(a))),null!=a)return h(a);throw new Exception("invalid infinite-scroll-container attribute.")}},e.$watch("infiniteScrollContainer",k),k(e.infiniteScrollContainer||[]),null!=g.infiniteScrollParent&&h(angular.element(f.parent())),null!=g.infiniteScrollImmediateCheck&&(q=e.$eval(g.infiniteScrollImmediateCheck)),c(function(){return q?o():void 0},0,1)}}}]);!function(){"use strict";var e=angular.module("pasvaz.bindonce",[]);e.directive("bindonce",function(){var e=function(e){if(e&&0!==e.length){var t=angular.lowercase(""+e);e=!("f"===t||"0"===t||"false"===t||"no"===t||"n"===t||"[]"===t)}else e=!1;return e},t=parseInt((/msie (\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10);isNaN(t)&&(t=parseInt((/trident\/.*; rv:(\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10));var r={restrict:"AM",controller:["$scope","$element","$attrs","$interpolate",function(r,a,i,n){var c=function(t,r,a){var i="show"===r?"":"none",n="hide"===r?"":"none";t.css("display",e(a)?i:n)},o=function(e,t){if(angular.isObject(t)&&!angular.isArray(t)){var r=[];angular.forEach(t,function(e,t){e&&r.push(t)}),t=r}t&&e.addClass(angular.isArray(t)?t.join(" "):t)},s=function(e,t){e.transclude(t,function(t){var r=e.element.parent(),a=e.element&&e.element[e.element.length-1],i=r&&r[0]||a&&a.parentNode,n=a&&a.nextSibling||null;angular.forEach(t,function(e){i.insertBefore(e,n)})})},l={watcherRemover:void 0,binders:[],group:i.boName,element:a,ran:!1,addBinder:function(e){this.binders.push(e),this.ran&&this.runBinders()},setupWatcher:function(e){var t=this;this.watcherRemover=r.$watch(e,function(e){void 0!==e&&(t.removeWatcher(),t.checkBindonce(e))},!0)},checkBindonce:function(e){var t=this,r=e.$promise?e.$promise.then:e.then;"function"==typeof r?r(function(){t.runBinders()}):t.runBinders()},removeWatcher:function(){void 0!==this.watcherRemover&&(this.watcherRemover(),this.watcherRemover=void 0)},runBinders:function(){for(;this.binders.length>0;){var r=this.binders.shift();if(!this.group||this.group==r.group){var a=r.scope.$eval(r.interpolate?n(r.value):r.value);switch(r.attr){case"boIf":e(a)&&s(r,r.scope.$new());break;case"boSwitch":var i,l=r.controller[0];(i=l.cases["!"+a]||l.cases["?"])&&(r.scope.$eval(r.attrs.change),angular.forEach(i,function(e){s(e,r.scope.$new())}));break;case"boSwitchWhen":var u=r.controller[0];u.cases["!"+r.attrs.boSwitchWhen]=u.cases["!"+r.attrs.boSwitchWhen]||[],u.cases["!"+r.attrs.boSwitchWhen].push({transclude:r.transclude,element:r.element});break;case"boSwitchDefault":var u=r.controller[0];u.cases["?"]=u.cases["?"]||[],u.cases["?"].push({transclude:r.transclude,element:r.element});break;case"hide":case"show":c(r.element,r.attr,a);break;case"class":o(r.element,a);break;case"text":r.element.text(a);break;case"html":r.element.html(a);break;case"style":r.element.css(a);break;case"disabled":r.element.prop("disabled",a);break;case"src":r.element.attr(r.attr,a),t&&r.element.prop("src",a);break;case"attr":angular.forEach(r.attrs,function(e,t){var a,i;t.match(/^boAttr./)&&r.attrs[t]&&(a=t.replace(/^boAttr/,"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=r.scope.$eval(r.attrs[t]),r.element.attr(a,i))});break;case"href":case"alt":case"title":case"id":case"value":r.element.attr(r.attr,a)}}}this.ran=!0}};angular.extend(this,l)}],link:function(e,t,r,a){var i=r.bindonce&&e.$eval(r.bindonce);void 0!==i?a.checkBindonce(i):(a.setupWatcher(r.bindonce),t.bind("$destroy",a.removeWatcher))}};return r}),angular.forEach([{directiveName:"boShow",attribute:"show"},{directiveName:"boHide",attribute:"hide"},{directiveName:"boClass",attribute:"class"},{directiveName:"boText",attribute:"text"},{directiveName:"boBind",attribute:"text"},{directiveName:"boHtml",attribute:"html"},{directiveName:"boSrcI",attribute:"src",interpolate:!0},{directiveName:"boSrc",attribute:"src"},{directiveName:"boHrefI",attribute:"href",interpolate:!0},{directiveName:"boHref",attribute:"href"},{directiveName:"boAlt",attribute:"alt"},{directiveName:"boTitle",attribute:"title"},{directiveName:"boId",attribute:"id"},{directiveName:"boStyle",attribute:"style"},{directiveName:"boDisabled",attribute:"disabled"},{directiveName:"boValue",attribute:"value"},{directiveName:"boAttr",attribute:"attr"},{directiveName:"boIf",transclude:"element",terminal:!0,priority:1e3},{directiveName:"boSwitch",require:"boSwitch",controller:function(){this.cases={}}},{directiveName:"boSwitchWhen",transclude:"element",priority:800,require:"^boSwitch"},{directiveName:"boSwitchDefault",transclude:"element",priority:800,require:"^boSwitch"}],function(t){var r=200;return e.directive(t.directiveName,function(){var e={priority:t.priority||r,transclude:t.transclude||!1,terminal:t.terminal||!1,require:["^bindonce"].concat(t.require||[]),controller:t.controller,compile:function(e,r,a){return function(e,r,i,n){var c=n[0],o=i.boParent;if(o&&c.group!==o){var s=c.element.parent();c=void 0;for(var l;9!==s[0].nodeType&&s.length;){if((l=s.data("$bindonceController"))&&l.group===o){c=l;break}s=s.parent()}if(!c)throw new Error("No bindonce controller: "+o)}c.addBinder({element:r,attr:t.attribute||t.directiveName,attrs:i,value:i[t.directiveName],interpolate:t.interpolate,group:o,transclude:a,controller:n.slice(1),scope:e})}}};return e})})}();(function($,window,document,undefined){var $window=$(window);$.fn.lazyload=function(options){var elements=this;var $container;var settings={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:false,appear:null,load:null,throttle:500,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function throttle(fn,threshhold,scope){threshhold||(threshhold=settings.throttle);var last,deferTimer;return function(){var context=scope||this;var now=+new Date;if(last&&now<last+threshhold){clearTimeout(deferTimer);deferTimer=setTimeout(function(){last=now;fn.apply(context,arguments)},threshhold)}else{last=now;fn.apply(context,arguments)}}}function update(){if(elements.length<=0)return;var counter=0;for(var i=0;i<elements.length;i++){var $this=$(elements[i]);if(settings.skip_invisible&&!$this.is(":visible")){return}if($.abovethetop(elements[i],settings)){}else if(!$.belowthefold(elements[i],settings)){$this.trigger("appear");counter=0;elements.splice(i,1);i--}else{if(++counter>settings.failure_limit){return false}}}}if(options){if(undefined!==options.failurelimit){options.failure_limit=options.failurelimit;delete options.failurelimit}if(undefined!==options.effectspeed){options.effect_speed=options.effectspeed;delete options.effectspeed}$.extend(settings,options)}$container=settings.container===undefined||settings.container===window?$window:$(settings.container);if(0===settings.event.indexOf("scroll")){$container.bind(settings.event,throttle(update))}this.each(function(){var self=this;var $self=$(self);self.loaded=false;if($self.attr("src")===undefined||$self.attr("src")===false){if($self.is("img")){$self.attr("src",settings.placeholder)}}$self.one("appear",function(){if(!this.loaded){if(settings.appear){var elements_left=elements.length;settings.appear.call(self,elements_left,settings)}$("<img />").bind("load",function(){var original=$self.attr("data-"+settings.data_attribute);$self.hide();if($self.is("img")){$self.attr("src",original)}else{$self.css("background-image","url('"+original+"')")}$self[settings.effect](settings.effect_speed);self.loaded=true;var temp=$.grep(elements,function(element){return!element.loaded});elements=$(temp);if(settings.load){var elements_left=elements.length;settings.load.call(self,elements_left,settings)}}).attr("src",$self.attr("data-"+settings.data_attribute))}});if(0!==settings.event.indexOf("scroll")){$self.bind(settings.event,function(){if(!self.loaded){$self.trigger("appear")}})}});$window.bind("resize",throttle(update));if(/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)){$window.bind("pageshow",function(event){if(event.originalEvent&&event.originalEvent.persisted){elements.each(function(){$(this).trigger("appear")})}})}$(document).ready(function(){update()});return this};$.belowthefold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=(window.innerHeight?window.innerHeight:$window.height())+$window.scrollTop()}else{fold=$(settings.container).offset().top+$(settings.container).height()}return fold<=$(element).offset().top-settings.threshold};$.rightoffold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.width()+$window.scrollLeft()}else{fold=$(settings.container).offset().left+$(settings.container).width()}return fold<=$(element).offset().left-settings.threshold};$.abovethetop=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollTop()}else{fold=$(settings.container).offset().top}return fold>=$(element).offset().top+settings.threshold+$(element).height()};$.leftofbegin=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollLeft()}else{fold=$(settings.container).offset().left}return fold>=$(element).offset().left+settings.threshold+$(element).width()};$.inviewport=function(element,settings){return!$.rightoffold(element,settings)&&!$.leftofbegin(element,settings)&&!$.belowthefold(element,settings)&&!$.abovethetop(element,settings)};$.extend($.expr[":"],{"below-the-fold":function(a){return $.belowthefold(a,{threshold:0})},"above-the-top":function(a){return!$.belowthefold(a,{threshold:0})},"right-of-screen":function(a){return $.rightoffold(a,{threshold:0})},"left-of-screen":function(a){return!$.rightoffold(a,{threshold:0})},"in-viewport":function(a){return $.inviewport(a,{threshold:0})},"above-the-fold":function(a){return!$.belowthefold(a,{threshold:0})},"right-of-fold":function(a){return $.rightoffold(a,{threshold:0})},"left-of-fold":function(a){return!$.rightoffold(a,{threshold:0})}})})(jQuery,window,document);"use strict";angular.module("ngLocale",[],["$provide",function($provide){var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};function getDecimals(n){n=n+"";var i=n.indexOf(".");return i==-1?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;if(undefined===v){v=Math.min(getDecimals(n),3)}var base=Math.pow(10,v);var f=(n*base|0)%base;return{v:v,f:f}}$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["vorm.","nachm."],DAY:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ERANAMES:["v. Chr.","n. Chr."],ERAS:["v. Chr.","n. Chr."],FIRSTDAYOFWEEK:0,MONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],SHORTDAY:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],SHORTMONTH:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],WEEKENDRANGE:[5,6],fullDate:"EEEE, d. MMMM y",longDate:"d. MMMM y",medium:"dd.MM.y HH:mm:ss",mediumDate:"dd.MM.y",mediumTime:"HH:mm:ss",short:"dd.MM.yy HH:mm",shortDate:"dd.MM.yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"de-de",pluralCat:function(n,opt_precision){var i=n|0;var vf=getVF(n,opt_precision);if(i==1&&vf.v==0){return PLURAL_CATEGORY.ONE}return PLURAL_CATEGORY.OTHER}})}]);(function(window,angular,undefined){"use strict";var $resourceMinErr=angular.$$minErr("$resource");var MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/;function isValidDottedPath(path){return path!=null&&path!==""&&path!=="hasOwnProperty"&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path)){throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path)}var keys=path.split(".");for(var i=0,ii=keys.length;i<ii&&angular.isDefined(obj);i++){var key=keys[i];obj=obj!==null?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{};angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src){if(src.hasOwnProperty(key)&&!(key.charAt(0)==="$"&&key.charAt(1)==="$")){dst[key]=src[key]}}return dst}angular.module("ngResource",["ng"]).provider("$resource",function(){var PROTOCOL_AND_DOMAIN_REGEX=/^https?:\/\/[^\/]*/;var provider=this;this.defaults={stripTrailingSlashes:true,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:true},remove:{method:"DELETE"},delete:{method:"DELETE"}}};this.$get=["$http","$q",function($http,$q){var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;function encodeUriSegment(val){return encodeUriQuery(val,true).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template;this.defaults=extend({},provider.defaults,defaults);this.urlParams={}}Route.prototype={setUrlParams:function(config,params,actionUrl){var self=this,url=actionUrl||self.template,val,encodedVal,protocolAndDomain="";var urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if(param==="hasOwnProperty"){throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.")}if(!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)){urlParams[param]=true}});url=url.replace(/\\:/g,":");url=url.replace(PROTOCOL_AND_DOMAIN_REGEX,function(match){protocolAndDomain=match;return""});params=params||{};forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam];if(angular.isDefined(val)&&val!==null){encodedVal=encodeUriSegment(val);url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})}else{url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){if(tail.charAt(0)=="/"){return tail}else{return leadingSlashes+tail}})}});if(self.defaults.stripTrailingSlashes){url=url.replace(/\/+$/,"")||"/"}url=url.replace(/\/\.(?=\w+($|\?))/,".");config.url=protocolAndDomain+url.replace(/\/\\\./,"/.");forEach(params,function(value,key){if(!self.urlParams[key]){config.params=config.params||{};config.params[key]=value}})}};function resourceFactory(url,paramDefaults,actions,options){var route=new Route(url,options);actions=extend({},provider.defaults.actions,actions);function extractParams(data,actionParams){var ids={};actionParams=extend({},paramDefaults,actionParams);forEach(actionParams,function(value,key){if(isFunction(value)){value=value()}ids[key]=value&&value.charAt&&value.charAt(0)=="@"?lookupDottedPath(data,value.substr(1)):value});return ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}Resource.prototype.toJSON=function(){var data=extend({},this);delete data.$promise;delete data.$resolved;return data};forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var params={},data,success,error;switch(arguments.length){case 4:error=a4;success=a3;case 3:case 2:if(isFunction(a2)){if(isFunction(a1)){success=a1;error=a2;break}success=a2;error=a3}else{params=a1;data=a2;success=a3;break}case 1:if(isFunction(a1))success=a1;else if(hasBody)data=a1;else params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource;var value=isInstanceCall?data:action.isArray?[]:new Resource(data);var httpConfig={};var responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor;var responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){if(key!="params"&&key!="isArray"&&key!="interceptor"){httpConfig[key]=copy(value)}});if(hasBody)httpConfig.data=data;route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray){throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to "+"contain an {1} but got an {2} (Request: {3} {4})",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object",httpConfig.method,httpConfig.url)}if(action.isArray){value.length=0;forEach(data,function(item){if(typeof item==="object"){value.push(new Resource(item))}else{value.push(item)}})}else{shallowClearAndCopy(data,value);value.$promise=promise}}value.$resolved=true;response.resource=value;return response},function(response){value.$resolved=true;(error||noop)(response);return $q.reject(response)});promise=promise.then(function(response){var value=responseInterceptor(response);(success||noop)(value,response.headers);return value},responseErrorInterceptor);if(!isInstanceCall){value.$promise=promise;value.$resolved=false;return value}return promise};Resource.prototype["$"+name]=function(params,success,error){if(isFunction(params)){error=success;success=params;params={}}var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}});Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)};return Resource}return resourceFactory}]})})(window,window.angular);(function(window,angular,undefined){"use strict";var ngRouteModule=angular.module("ngRoute",["ng"]).provider("$route",$RouteProvider),$routeMinErr=angular.$$minErr("ngRoute");function $RouteProvider(){function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}var routes={};this.when=function(path,route){var routeCopy=angular.copy(route);if(angular.isUndefined(routeCopy.reloadOnSearch)){routeCopy.reloadOnSearch=true}if(angular.isUndefined(routeCopy.caseInsensitiveMatch)){routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch}routes[path]=angular.extend(routeCopy,path&&pathRegExp(path,routeCopy));if(path){var redirectPath=path[path.length-1]=="/"?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({redirectTo:path},pathRegExp(redirectPath,routeCopy))}return this};this.caseInsensitiveMatch=false;function pathRegExp(path,opts){var insensitive=opts.caseInsensitiveMatch,ret={originalPath:path,regexp:path},keys=ret.keys=[];path=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(_,slash,key,option){var optional=option==="?"?option:null;var star=option==="*"?option:null;keys.push({name:key,optional:!!optional});slash=slash||"";return""+(optional?"":slash)+"(?:"+(optional?slash:"")+(star&&"(.+?)"||"([^/]+)")+(optional||"")+")"+(optional||"")}).replace(/([\/$\*])/g,"\\$1");ret.regexp=new RegExp("^"+path+"$",insensitive?"i":"");return ret}this.otherwise=function(params){if(typeof params==="string"){params={redirectTo:params}}this.when(null,params);return this};this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce){var forceReload=false,preparedRoute,preparedRouteIsUpdateOnly,$route={routes:routes,reload:function(){forceReload=true;$rootScope.$evalAsync(function(){prepareRoute();commitRoute()})},updateParams:function(newParams){if(this.current&&this.current.$$route){newParams=angular.extend({},this.current.params,newParams);$location.path(interpolate(this.current.$$route.originalPath,newParams));$location.search(newParams)}else{throw $routeMinErr("norout","Tried updating route when with no current route")}}};$rootScope.$on("$locationChangeStart",prepareRoute);$rootScope.$on("$locationChangeSuccess",commitRoute);return $route;function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1];var val=m[i];if(key&&val){params[key.name]=val}}return params}function prepareRoute($locationEvent){var lastRoute=$route.current;preparedRoute=parseRoute();preparedRouteIsUpdateOnly=preparedRoute&&lastRoute&&preparedRoute.$$route===lastRoute.$$route&&angular.equals(preparedRoute.pathParams,lastRoute.pathParams)&&!preparedRoute.reloadOnSearch&&!forceReload;if(!preparedRouteIsUpdateOnly&&(lastRoute||preparedRoute)){if($rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented){if($locationEvent){$locationEvent.preventDefault()}}}}function commitRoute(){var lastRoute=$route.current;var nextRoute=preparedRoute;if(preparedRouteIsUpdateOnly){lastRoute.params=nextRoute.params;angular.copy(lastRoute.params,$routeParams);$rootScope.$broadcast("$routeUpdate",lastRoute)}else if(nextRoute||lastRoute){forceReload=false;$route.current=nextRoute;if(nextRoute){if(nextRoute.redirectTo){if(angular.isString(nextRoute.redirectTo)){$location.path(interpolate(nextRoute.redirectTo,nextRoute.params)).search(nextRoute.params).replace()}else{$location.url(nextRoute.redirectTo(nextRoute.pathParams,$location.path(),$location.search())).replace()}}}$q.when(nextRoute).then(function(){if(nextRoute){var locals=angular.extend({},nextRoute.resolve),template,templateUrl;angular.forEach(locals,function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)});if(angular.isDefined(template=nextRoute.template)){if(angular.isFunction(template)){template=template(nextRoute.params)}}else if(angular.isDefined(templateUrl=nextRoute.templateUrl)){if(angular.isFunction(templateUrl)){templateUrl=templateUrl(nextRoute.params)}if(angular.isDefined(templateUrl)){nextRoute.loadedTemplateUrl=$sce.valueOf(templateUrl);template=$templateRequest(templateUrl)}}if(angular.isDefined(template)){locals["$template"]=template}return $q.all(locals)}}).then(function(locals){if(nextRoute==$route.current){if(nextRoute){nextRoute.locals=locals;angular.copy(nextRoute.params,$routeParams)}$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute)}},function(error){if(nextRoute==$route.current){$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)}})}}function parseRoute(){var params,match;angular.forEach(routes,function(route,path){if(!match&&(params=switchRouteMatcher($location.path(),route))){match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params});match.$$route=route}});return match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function interpolate(string,params){var result=[];angular.forEach((string||"").split(":"),function(segment,i){if(i===0){result.push(segment)}else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/);var key=segmentMatch[1];result.push(params[key]);result.push(segmentMatch[2]||"");delete params[key]}});return result.join("")}}]}ngRouteModule.provider("$routeParams",$RouteParamsProvider);function $RouteParamsProvider(){this.$get=function(){return{}}}ngRouteModule.directive("ngView",ngViewFactory);ngRouteModule.directive("ngView",ngViewFillContentFactory);ngViewFactory.$inject=["$route","$anchorScroll","$animate"];function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:true,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update);update();function cleanupLastView(){if(previousLeaveAnimation){$animate.cancel(previousLeaveAnimation);previousLeaveAnimation=null}if(currentScope){currentScope.$destroy();currentScope=null}if(currentElement){previousLeaveAnimation=$animate.leave(currentElement);previousLeaveAnimation.then(function(){previousLeaveAnimation=null});currentElement=null}}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new();var current=$route.current;var clone=$transclude(newScope,function(clone){$animate.enter(clone,null,currentElement||$element).then(function onNgViewEnter(){if(angular.isDefined(autoScrollExp)&&(!autoScrollExp||scope.$eval(autoScrollExp))){$anchorScroll()}});cleanupLastView()});currentElement=clone;currentScope=current.scope=newScope;currentScope.$emit("$viewContentLoaded");currentScope.$eval(onloadExp)}else{cleanupLastView()}}}}}ngViewFillContentFactory.$inject=["$compile","$controller","$route"];function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);if(current.controllerAs){scope[current.controllerAs]=controller}$element.data("$ngControllerController",controller);$element.children().data("$ngControllerController",controller)}link(scope)}}}})(window,window.angular);(function(window,angular,undefined){"use strict";var $sanitizeMinErr=angular.$$minErr("$sanitize");function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))}));return buf.join("")}}]}function sanitizeText(chars){var buf=[];var writer=htmlSanitizeWriter(buf,angular.noop);writer.chars(chars);return buf.join("")}var START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g;var voidElements=makeMap("area,br,col,hr,img,wbr");var optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements);var blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,"+"aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,"+"h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul"));var inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,"+"bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,"+"samp,small,span,strike,strong,sub,sup,time,tt,u,var"));var svgElements=makeMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,"+"hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,"+"radialGradient,rect,stop,svg,switch,text,title,tspan,use");var specialElements=makeMap("script,style");var validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements);var uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href");var htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,"+"color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,"+"ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,"+"scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,"+"valign,value,vspace,width");var svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,"+"baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,"+"cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,"+"font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,"+"height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,"+"marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,"+"max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,"+"path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,"+"requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,"+"stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,"+"stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,"+"stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,"+"underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,"+"width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,"+"xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",true);var validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs);function makeMap(str,lowercaseKeys){var obj={},items=str.split(","),i;for(i=0;i<items.length;i++){obj[lowercaseKeys?angular.lowercase(items[i]):items[i]]=true}return obj}function htmlParser(html,handler){if(typeof html!=="string"){if(html===null||typeof html==="undefined"){html=""}else{html=""+html;
}}var index,chars,match,stack=[],last=html,text;stack.last=function(){return stack[stack.length-1]};while(html){text="";chars=true;if(!stack.last()||!specialElements[stack.last()]){if(html.indexOf("<!--")===0){index=html.indexOf("--",4);if(index>=0&&html.lastIndexOf("-->",index)===index){if(handler.comment)handler.comment(html.substring(4,index));html=html.substring(index+3);chars=false}}else if(DOCTYPE_REGEXP.test(html)){match=html.match(DOCTYPE_REGEXP);if(match){html=html.replace(match[0],"");chars=false}}else if(BEGING_END_TAGE_REGEXP.test(html)){match=html.match(END_TAG_REGEXP);if(match){html=html.substring(match[0].length);match[0].replace(END_TAG_REGEXP,parseEndTag);chars=false}}else if(BEGIN_TAG_REGEXP.test(html)){match=html.match(START_TAG_REGEXP);if(match){if(match[4]){html=html.substring(match[0].length);match[0].replace(START_TAG_REGEXP,parseStartTag)}chars=false}else{text+="<";html=html.substring(1)}}if(chars){index=html.indexOf("<");text+=index<0?html:html.substring(0,index);html=index<0?"":html.substring(index);if(handler.chars)handler.chars(decodeEntities(text))}}else{html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1");if(handler.chars)handler.chars(decodeEntities(text));return""});parseEndTag("",stack.last())}if(html==last){throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block "+"of html: {0}",html)}last=html}parseEndTag();function parseStartTag(tag,tagName,rest,unary){tagName=angular.lowercase(tagName);if(blockElements[tagName]){while(stack.last()&&inlineElements[stack.last()]){parseEndTag("",stack.last())}}if(optionalEndTagElements[tagName]&&stack.last()==tagName){parseEndTag("",tagName)}unary=voidElements[tagName]||!!unary;if(!unary){stack.push(tagName)}var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)});if(handler.start)handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var pos=0,i;tagName=angular.lowercase(tagName);if(tagName){for(pos=stack.length-1;pos>=0;pos--){if(stack[pos]==tagName)break}}if(pos>=0){for(i=stack.length-1;i>=pos;i--)if(handler.end)handler.end(stack[i]);stack.length=pos}}}var hiddenPre=document.createElement("pre");function decodeEntities(value){if(!value){return""}hiddenPre.innerHTML=value.replace(/</g,"&lt;");return hiddenPre.textContent}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0);var low=value.charCodeAt(1);return"&#"+((hi-55296)*1024+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=false;var out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag);if(!ignore&&specialElements[tag]){ignore=tag}if(!ignore&&validElements[tag]===true){out("<");out(tag);angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key);var isImage=tag==="img"&&lkey==="src"||lkey==="background";if(validAttrs[lkey]===true&&(uriAttrs[lkey]!==true||uriValidator(value,isImage))){out(" ");out(key);out('="');out(encodeEntities(value));out('"')}});out(unary?"/>":">")}},end:function(tag){tag=angular.lowercase(tag);if(!ignore&&validElements[tag]===true){out("</");out(tag);out(">")}if(tag==ignore){ignore=false}},chars:function(chars){if(!ignore){out(encodeEntities(chars))}}}}angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider);angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i;return function(text,target){if(!text)return text;var match;var raw=text;var html=[];var url;var i;while(match=raw.match(LINKY_URL_REGEXP)){url=match[0];if(!match[2]&&!match[4]){url=(match[3]?"http://":"mailto:")+url}i=match.index;addText(raw.substr(0,i));addLink(url,match[0].replace(MAILTO_REGEXP,""));raw=raw.substring(i+match[0].length)}addText(raw);return $sanitize(html.join(""));function addText(text){if(!text){return}html.push(sanitizeText(text))}function addLink(url,text){html.push("<a ");if(angular.isDefined(target)){html.push('target="',target,'" ')}html.push('href="',url.replace(/"/g,"&quot;"),'">');addText(text);html.push("</a>")}}}])})(window,window.angular);(function(window,angular,undefined){"use strict";var noop=angular.noop;var extend=angular.extend;var jqLite=angular.element;var forEach=angular.forEach;var isArray=angular.isArray;var isString=angular.isString;var isObject=angular.isObject;var isUndefined=angular.isUndefined;var isDefined=angular.isDefined;var isFunction=angular.isFunction;var isElement=angular.isElement;var ELEMENT_NODE=1;var COMMENT_NODE=8;var ADD_CLASS_SUFFIX="-add";var REMOVE_CLASS_SUFFIX="-remove";var EVENT_CLASS_PREFIX="ng-";var ACTIVE_CLASS_SUFFIX="-active";var NG_ANIMATE_CLASSNAME="ng-animate";var NG_ANIMATE_CHILDREN_DATA="$$ngAnimateChildren";var CSS_PREFIX="",TRANSITION_PROP,TRANSITIONEND_EVENT,ANIMATION_PROP,ANIMATIONEND_EVENT;if(isUndefined(window.ontransitionend)&&isDefined(window.onwebkittransitionend)){CSS_PREFIX="-webkit-";TRANSITION_PROP="WebkitTransition";TRANSITIONEND_EVENT="webkitTransitionEnd transitionend"}else{TRANSITION_PROP="transition";TRANSITIONEND_EVENT="transitionend"}if(isUndefined(window.onanimationend)&&isDefined(window.onwebkitanimationend)){CSS_PREFIX="-webkit-";ANIMATION_PROP="WebkitAnimation";ANIMATIONEND_EVENT="webkitAnimationEnd animationend"}else{ANIMATION_PROP="animation";ANIMATIONEND_EVENT="animationend"}var DURATION_KEY="Duration";var PROPERTY_KEY="Property";var DELAY_KEY="Delay";var TIMING_KEY="TimingFunction";var ANIMATION_ITERATION_COUNT_KEY="IterationCount";var ANIMATION_PLAYSTATE_KEY="PlayState";var SAFE_FAST_FORWARD_DURATION_VALUE=9999;var ANIMATION_DELAY_PROP=ANIMATION_PROP+DELAY_KEY;var ANIMATION_DURATION_PROP=ANIMATION_PROP+DURATION_KEY;var TRANSITION_DELAY_PROP=TRANSITION_PROP+DELAY_KEY;var TRANSITION_DURATION_PROP=TRANSITION_PROP+DURATION_KEY;var isPromiseLike=function(p){return p&&p.then?true:false};function assertArg(arg,name,reason){if(!arg){throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required")}return arg}function mergeClasses(a,b){if(!a&&!b)return"";if(!a)return b;if(!b)return a;if(isArray(a))a=a.join(" ");if(isArray(b))b=b.join(" ");return a+" "+b}function packageStyles(options){var styles={};if(options&&(options.to||options.from)){styles.to=options.to;styles.from=options.from}return styles}function pendClasses(classes,fix,isPrefix){var className="";classes=isArray(classes)?classes:classes&&isString(classes)&&classes.length?classes.split(/\s+/):[];forEach(classes,function(klass,i){if(klass&&klass.length>0){className+=i>0?" ":"";className+=isPrefix?fix+klass:klass+fix}});return className}function removeFromArray(arr,val){var index=arr.indexOf(val);if(val>=0){arr.splice(index,1)}}function stripCommentsFromElement(element){if(element instanceof jqLite){switch(element.length){case 0:return[];break;case 1:if(element[0].nodeType===ELEMENT_NODE){return element}break;default:return jqLite(extractElementNode(element));break}}if(element.nodeType===ELEMENT_NODE){return jqLite(element)}}function extractElementNode(element){if(!element[0])return element;for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType==ELEMENT_NODE){return elm}}}function $$addClass($$jqLite,element,className){forEach(element,function(elm){$$jqLite.addClass(elm,className)})}function $$removeClass($$jqLite,element,className){forEach(element,function(elm){$$jqLite.removeClass(elm,className)})}function applyAnimationClassesFactory($$jqLite){return function(element,options){if(options.addClass){$$addClass($$jqLite,element,options.addClass);options.addClass=null}if(options.removeClass){$$removeClass($$jqLite,element,options.removeClass);options.removeClass=null}}}function prepareAnimationOptions(options){options=options||{};if(!options.$$prepared){var domOperation=options.domOperation||noop;options.domOperation=function(){options.$$domOperationFired=true;domOperation();domOperation=noop};options.$$prepared=true}return options}function applyAnimationStyles(element,options){applyAnimationFromStyles(element,options);applyAnimationToStyles(element,options)}function applyAnimationFromStyles(element,options){if(options.from){element.css(options.from);options.from=null}}function applyAnimationToStyles(element,options){if(options.to){element.css(options.to);options.to=null}}function mergeAnimationOptions(element,target,newOptions){var toAdd=(target.addClass||"")+" "+(newOptions.addClass||"");var toRemove=(target.removeClass||"")+" "+(newOptions.removeClass||"");var classes=resolveElementClasses(element.attr("class"),toAdd,toRemove);if(newOptions.preparationClasses){target.preparationClasses=concatWithSpace(newOptions.preparationClasses,target.preparationClasses);delete newOptions.preparationClasses}var realDomOperation=target.domOperation!==noop?target.domOperation:null;extend(target,newOptions);if(realDomOperation){target.domOperation=realDomOperation}if(classes.addClass){target.addClass=classes.addClass}else{target.addClass=null}if(classes.removeClass){target.removeClass=classes.removeClass}else{target.removeClass=null}return target}function resolveElementClasses(existing,toAdd,toRemove){var ADD_CLASS=1;var REMOVE_CLASS=-1;var flags={};existing=splitClassesToLookup(existing);toAdd=splitClassesToLookup(toAdd);forEach(toAdd,function(value,key){flags[key]=ADD_CLASS});toRemove=splitClassesToLookup(toRemove);forEach(toRemove,function(value,key){flags[key]=flags[key]===ADD_CLASS?null:REMOVE_CLASS});var classes={addClass:"",removeClass:""};forEach(flags,function(val,klass){var prop,allow;if(val===ADD_CLASS){prop="addClass";allow=!existing[klass]}else if(val===REMOVE_CLASS){prop="removeClass";allow=existing[klass]}if(allow){if(classes[prop].length){classes[prop]+=" "}classes[prop]+=klass}});function splitClassesToLookup(classes){if(isString(classes)){classes=classes.split(" ")}var obj={};forEach(classes,function(klass){if(klass.length){obj[klass]=true}});return obj}return classes}function getDomNode(element){return element instanceof angular.element?element[0]:element}function applyGeneratedPreparationClasses(element,event,options){var classes="";if(event){classes=pendClasses(event,EVENT_CLASS_PREFIX,true)}if(options.addClass){classes=concatWithSpace(classes,pendClasses(options.addClass,ADD_CLASS_SUFFIX))}if(options.removeClass){classes=concatWithSpace(classes,pendClasses(options.removeClass,REMOVE_CLASS_SUFFIX))}if(classes.length){options.preparationClasses=classes;element.addClass(classes)}}function clearGeneratedClasses(element,options){if(options.preparationClasses){element.removeClass(options.preparationClasses);options.preparationClasses=null}if(options.activeClasses){element.removeClass(options.activeClasses);options.activeClasses=null}}function blockTransitions(node,duration){var value=duration?"-"+duration+"s":"";applyInlineStyle(node,[TRANSITION_DELAY_PROP,value]);return[TRANSITION_DELAY_PROP,value]}function blockKeyframeAnimations(node,applyBlock){var value=applyBlock?"paused":"";var key=ANIMATION_PROP+ANIMATION_PLAYSTATE_KEY;applyInlineStyle(node,[key,value]);return[key,value]}function applyInlineStyle(node,styleTuple){var prop=styleTuple[0];var value=styleTuple[1];node.style[prop]=value}function concatWithSpace(a,b){if(!a)return b;if(!b)return a;return a+" "+b}var $$rAFSchedulerFactory=["$$rAF",function($$rAF){var queue,cancelFn;function scheduler(tasks){queue=queue.concat(tasks);nextTick()}queue=scheduler.queue=[];scheduler.waitUntilQuiet=function(fn){if(cancelFn)cancelFn();cancelFn=$$rAF(function(){cancelFn=null;fn();nextTick()})};return scheduler;function nextTick(){if(!queue.length)return;var items=queue.shift();for(var i=0;i<items.length;i++){items[i]()}if(!cancelFn){$$rAF(function(){if(!cancelFn)nextTick()})}}}];var $$AnimateChildrenDirective=[function(){return function(scope,element,attrs){var val=attrs.ngAnimateChildren;if(angular.isString(val)&&val.length===0){element.data(NG_ANIMATE_CHILDREN_DATA,true)}else{attrs.$observe("ngAnimateChildren",function(value){value=value==="on"||value==="true";element.data(NG_ANIMATE_CHILDREN_DATA,value)})}}}];var ANIMATE_TIMER_KEY="$$animateCss";var ONE_SECOND=1e3;var BASE_TEN=10;var ELAPSED_TIME_MAX_DECIMAL_PLACES=3;var CLOSING_TIME_BUFFER=1.5;var DETECT_CSS_PROPERTIES={transitionDuration:TRANSITION_DURATION_PROP,transitionDelay:TRANSITION_DELAY_PROP,transitionProperty:TRANSITION_PROP+PROPERTY_KEY,animationDuration:ANIMATION_DURATION_PROP,animationDelay:ANIMATION_DELAY_PROP,animationIterationCount:ANIMATION_PROP+ANIMATION_ITERATION_COUNT_KEY};var DETECT_STAGGER_CSS_PROPERTIES={transitionDuration:TRANSITION_DURATION_PROP,transitionDelay:TRANSITION_DELAY_PROP,animationDuration:ANIMATION_DURATION_PROP,animationDelay:ANIMATION_DELAY_PROP};function getCssKeyframeDurationStyle(duration){return[ANIMATION_DURATION_PROP,duration+"s"]}function getCssDelayStyle(delay,isKeyframeAnimation){var prop=isKeyframeAnimation?ANIMATION_DELAY_PROP:TRANSITION_DELAY_PROP;return[prop,delay+"s"]}function computeCssStyles($window,element,properties){var styles=Object.create(null);var detectedStyles=$window.getComputedStyle(element)||{};forEach(properties,function(formalStyleName,actualStyleName){var val=detectedStyles[formalStyleName];if(val){var c=val.charAt(0);if(c==="-"||c==="+"||c>=0){val=parseMaxTime(val)}if(val===0){val=null}styles[actualStyleName]=val}});return styles}function parseMaxTime(str){var maxValue=0;var values=str.split(/\s*,\s*/);forEach(values,function(value){if(value.charAt(value.length-1)=="s"){value=value.substring(0,value.length-1)}value=parseFloat(value)||0;maxValue=maxValue?Math.max(value,maxValue):value});return maxValue}function truthyTimingValue(val){return val===0||val!=null}function getCssTransitionDurationStyle(duration,applyOnlyDuration){var style=TRANSITION_PROP;var value=duration+"s";if(applyOnlyDuration){style+=DURATION_KEY}else{value+=" linear all"}return[style,value]}function createLocalCacheLookup(){var cache=Object.create(null);return{flush:function(){cache=Object.create(null)},count:function(key){var entry=cache[key];return entry?entry.total:0},get:function(key){var entry=cache[key];return entry&&entry.value},put:function(key,value){if(!cache[key]){cache[key]={total:1,value:value}}else{cache[key].total++}}}}function registerRestorableStyles(backup,node,properties){forEach(properties,function(prop){backup[prop]=isDefined(backup[prop])?backup[prop]:node.style.getPropertyValue(prop)})}var $AnimateCssProvider=["$animateProvider",function($animateProvider){var gcsLookup=createLocalCacheLookup();var gcsStaggerLookup=createLocalCacheLookup();this.$get=["$window","$$jqLite","$$AnimateRunner","$timeout","$$forceReflow","$sniffer","$$rAFScheduler","$animate",function($window,$$jqLite,$$AnimateRunner,$timeout,$$forceReflow,$sniffer,$$rAFScheduler,$animate){var applyAnimationClasses=applyAnimationClassesFactory($$jqLite);var parentCounter=0;function gcsHashFn(node,extraClasses){var KEY="$$ngAnimateParentKey";var parentNode=node.parentNode;var parentID=parentNode[KEY]||(parentNode[KEY]=++parentCounter);return parentID+"-"+node.getAttribute("class")+"-"+extraClasses}function computeCachedCssStyles(node,className,cacheKey,properties){var timings=gcsLookup.get(cacheKey);if(!timings){timings=computeCssStyles($window,node,properties);if(timings.animationIterationCount==="infinite"){timings.animationIterationCount=1}}gcsLookup.put(cacheKey,timings);return timings}function computeCachedCssStaggerStyles(node,className,cacheKey,properties){var stagger;if(gcsLookup.count(cacheKey)>0){stagger=gcsStaggerLookup.get(cacheKey);if(!stagger){var staggerClassName=pendClasses(className,"-stagger");$$jqLite.addClass(node,staggerClassName);stagger=computeCssStyles($window,node,properties);stagger.animationDuration=Math.max(stagger.animationDuration,0);stagger.transitionDuration=Math.max(stagger.transitionDuration,0);$$jqLite.removeClass(node,staggerClassName);gcsStaggerLookup.put(cacheKey,stagger)}}return stagger||{}}var cancelLastRAFRequest;var rafWaitQueue=[];function waitUntilQuiet(callback){rafWaitQueue.push(callback);$$rAFScheduler.waitUntilQuiet(function(){gcsLookup.flush();gcsStaggerLookup.flush();var pageWidth=$$forceReflow();for(var i=0;i<rafWaitQueue.length;i++){rafWaitQueue[i](pageWidth)}rafWaitQueue.length=0})}function computeTimings(node,className,cacheKey){var timings=computeCachedCssStyles(node,className,cacheKey,DETECT_CSS_PROPERTIES);var aD=timings.animationDelay;var tD=timings.transitionDelay;timings.maxDelay=aD&&tD?Math.max(aD,tD):aD||tD;timings.maxDuration=Math.max(timings.animationDuration*timings.animationIterationCount,timings.transitionDuration);return timings}return function init(element,options){var restoreStyles={};var node=getDomNode(element);if(!node||!node.parentNode||!$animate.enabled()){return closeAndReturnNoopAnimator()}options=prepareAnimationOptions(options);var temporaryStyles=[];var classes=element.attr("class");var styles=packageStyles(options);var animationClosed;var animationPaused;var animationCompleted;var runner;var runnerHost;var maxDelay;var maxDelayTime;var maxDuration;var maxDurationTime;if(options.duration===0||!$sniffer.animations&&!$sniffer.transitions){return closeAndReturnNoopAnimator()}var method=options.event&&isArray(options.event)?options.event.join(" "):options.event;var isStructural=method&&options.structural;var structuralClassName="";var addRemoveClassName="";if(isStructural){structuralClassName=pendClasses(method,EVENT_CLASS_PREFIX,true)}else if(method){structuralClassName=method}if(options.addClass){addRemoveClassName+=pendClasses(options.addClass,ADD_CLASS_SUFFIX)}if(options.removeClass){if(addRemoveClassName.length){addRemoveClassName+=" "}addRemoveClassName+=pendClasses(options.removeClass,REMOVE_CLASS_SUFFIX)}if(options.applyClassesEarly&&addRemoveClassName.length){applyAnimationClasses(element,options)}var preparationClasses=[structuralClassName,addRemoveClassName].join(" ").trim();var fullClassName=classes+" "+preparationClasses;var activeClasses=pendClasses(preparationClasses,ACTIVE_CLASS_SUFFIX);var hasToStyles=styles.to&&Object.keys(styles.to).length>0;var containsKeyframeAnimation=(options.keyframeStyle||"").length>0;if(!containsKeyframeAnimation&&!hasToStyles&&!preparationClasses){return closeAndReturnNoopAnimator()}var cacheKey,stagger;if(options.stagger>0){var staggerVal=parseFloat(options.stagger);stagger={transitionDelay:staggerVal,animationDelay:staggerVal,transitionDuration:0,animationDuration:0}}else{cacheKey=gcsHashFn(node,fullClassName);stagger=computeCachedCssStaggerStyles(node,preparationClasses,cacheKey,DETECT_STAGGER_CSS_PROPERTIES)}if(!options.$$skipPreparationClasses){$$jqLite.addClass(element,preparationClasses)}var applyOnlyDuration;if(options.transitionStyle){var transitionStyle=[TRANSITION_PROP,options.transitionStyle];applyInlineStyle(node,transitionStyle);temporaryStyles.push(transitionStyle)}if(options.duration>=0){applyOnlyDuration=node.style[TRANSITION_PROP].length>0;var durationStyle=getCssTransitionDurationStyle(options.duration,applyOnlyDuration);applyInlineStyle(node,durationStyle);temporaryStyles.push(durationStyle)}if(options.keyframeStyle){var keyframeStyle=[ANIMATION_PROP,options.keyframeStyle];applyInlineStyle(node,keyframeStyle);temporaryStyles.push(keyframeStyle)}var itemIndex=stagger?options.staggerIndex>=0?options.staggerIndex:gcsLookup.count(cacheKey):0;var isFirst=itemIndex===0;if(isFirst&&!options.skipBlocking){blockTransitions(node,SAFE_FAST_FORWARD_DURATION_VALUE)}var timings=computeTimings(node,fullClassName,cacheKey);var relativeDelay=timings.maxDelay;maxDelay=Math.max(relativeDelay,0);maxDuration=timings.maxDuration;var flags={};flags.hasTransitions=timings.transitionDuration>0;flags.hasAnimations=timings.animationDuration>0;flags.hasTransitionAll=flags.hasTransitions&&timings.transitionProperty=="all";flags.applyTransitionDuration=hasToStyles&&(flags.hasTransitions&&!flags.hasTransitionAll||flags.hasAnimations&&!flags.hasTransitions);flags.applyAnimationDuration=options.duration&&flags.hasAnimations;flags.applyTransitionDelay=truthyTimingValue(options.delay)&&(flags.applyTransitionDuration||flags.hasTransitions);flags.applyAnimationDelay=truthyTimingValue(options.delay)&&flags.hasAnimations;flags.recalculateTimingStyles=addRemoveClassName.length>0;if(flags.applyTransitionDuration||flags.applyAnimationDuration){maxDuration=options.duration?parseFloat(options.duration):maxDuration;if(flags.applyTransitionDuration){flags.hasTransitions=true;timings.transitionDuration=maxDuration;applyOnlyDuration=node.style[TRANSITION_PROP+PROPERTY_KEY].length>0;temporaryStyles.push(getCssTransitionDurationStyle(maxDuration,applyOnlyDuration))}if(flags.applyAnimationDuration){flags.hasAnimations=true;timings.animationDuration=maxDuration;temporaryStyles.push(getCssKeyframeDurationStyle(maxDuration))}}if(maxDuration===0&&!flags.recalculateTimingStyles){return closeAndReturnNoopAnimator()}if(options.delay!=null){var delayStyle=parseFloat(options.delay);if(flags.applyTransitionDelay){temporaryStyles.push(getCssDelayStyle(delayStyle))}if(flags.applyAnimationDelay){temporaryStyles.push(getCssDelayStyle(delayStyle,true))}}if(options.duration==null&&timings.transitionDuration>0){flags.recalculateTimingStyles=flags.recalculateTimingStyles||isFirst}maxDelayTime=maxDelay*ONE_SECOND;maxDurationTime=maxDuration*ONE_SECOND;if(!options.skipBlocking){flags.blockTransition=timings.transitionDuration>0;flags.blockKeyframeAnimation=timings.animationDuration>0&&stagger.animationDelay>0&&stagger.animationDuration===0}if(options.from){if(options.cleanupStyles){registerRestorableStyles(restoreStyles,node,Object.keys(options.from))}applyAnimationFromStyles(element,options)}if(flags.blockTransition||flags.blockKeyframeAnimation){applyBlocking(maxDuration)}else if(!options.skipBlocking){blockTransitions(node,false)}return{$$willAnimate:true,end:endFn,start:function(){if(animationClosed)return;runnerHost={end:endFn,cancel:cancelFn,resume:null,pause:null};runner=new $$AnimateRunner(runnerHost);waitUntilQuiet(start);return runner}};function endFn(){close()}function cancelFn(){close(true)}function close(rejected){if(animationClosed||animationCompleted&&animationPaused)return;animationClosed=true;animationPaused=false;if(!options.$$skipPreparationClasses){$$jqLite.removeClass(element,preparationClasses)}$$jqLite.removeClass(element,activeClasses);blockKeyframeAnimations(node,false);blockTransitions(node,false);forEach(temporaryStyles,function(entry){node.style[entry[0]]=""});applyAnimationClasses(element,options);applyAnimationStyles(element,options);if(Object.keys(restoreStyles).length){forEach(restoreStyles,function(value,prop){value?node.style.setProperty(prop,value):node.style.removeProperty(prop)})}if(options.onDone){options.onDone()}if(runner){runner.complete(!rejected)}}function applyBlocking(duration){if(flags.blockTransition){blockTransitions(node,duration)}if(flags.blockKeyframeAnimation){blockKeyframeAnimations(node,!!duration)}}function closeAndReturnNoopAnimator(){runner=new $$AnimateRunner({end:endFn,cancel:cancelFn});waitUntilQuiet(noop);close();return{$$willAnimate:false,start:function(){return runner},end:endFn}}function start(){if(animationClosed)return;if(!node.parentNode){close();return}var startTime,events=[];var playPause=function(playAnimation){if(!animationCompleted){animationPaused=!playAnimation;if(timings.animationDuration){var value=blockKeyframeAnimations(node,animationPaused);animationPaused?temporaryStyles.push(value):removeFromArray(temporaryStyles,value)}}else if(animationPaused&&playAnimation){animationPaused=false;close()}};var maxStagger=itemIndex>0&&(timings.transitionDuration&&stagger.transitionDuration===0||timings.animationDuration&&stagger.animationDuration===0)&&Math.max(stagger.animationDelay,stagger.transitionDelay);if(maxStagger){$timeout(triggerAnimationStart,Math.floor(maxStagger*itemIndex*ONE_SECOND),false)}else{triggerAnimationStart()}runnerHost.resume=function(){playPause(true)};runnerHost.pause=function(){playPause(false)};function triggerAnimationStart(){if(animationClosed)return;applyBlocking(false);forEach(temporaryStyles,function(entry){var key=entry[0];var value=entry[1];node.style[key]=value});applyAnimationClasses(element,options);$$jqLite.addClass(element,activeClasses);if(flags.recalculateTimingStyles){fullClassName=node.className+" "+preparationClasses;cacheKey=gcsHashFn(node,fullClassName);timings=computeTimings(node,fullClassName,cacheKey);relativeDelay=timings.maxDelay;maxDelay=Math.max(relativeDelay,0);maxDuration=timings.maxDuration;if(maxDuration===0){close();return}flags.hasTransitions=timings.transitionDuration>0;flags.hasAnimations=timings.animationDuration>0}if(flags.applyAnimationDelay){relativeDelay=typeof options.delay!=="boolean"&&truthyTimingValue(options.delay)?parseFloat(options.delay):relativeDelay;maxDelay=Math.max(relativeDelay,0);timings.animationDelay=relativeDelay;delayStyle=getCssDelayStyle(relativeDelay,true);temporaryStyles.push(delayStyle);node.style[delayStyle[0]]=delayStyle[1]}maxDelayTime=maxDelay*ONE_SECOND;maxDurationTime=maxDuration*ONE_SECOND;if(options.easing){var easeProp,easeVal=options.easing;if(flags.hasTransitions){easeProp=TRANSITION_PROP+TIMING_KEY;temporaryStyles.push([easeProp,easeVal]);node.style[easeProp]=easeVal}if(flags.hasAnimations){easeProp=ANIMATION_PROP+TIMING_KEY;temporaryStyles.push([easeProp,easeVal]);node.style[easeProp]=easeVal}}if(timings.transitionDuration){events.push(TRANSITIONEND_EVENT)}if(timings.animationDuration){events.push(ANIMATIONEND_EVENT)}startTime=Date.now();var timerTime=maxDelayTime+CLOSING_TIME_BUFFER*maxDurationTime;var endTime=startTime+timerTime;var animationsData=element.data(ANIMATE_TIMER_KEY)||[];var setupFallbackTimer=true;if(animationsData.length){var currentTimerData=animationsData[0];setupFallbackTimer=endTime>currentTimerData.expectedEndTime;if(setupFallbackTimer){$timeout.cancel(currentTimerData.timer)}else{animationsData.push(close)}}if(setupFallbackTimer){var timer=$timeout(onAnimationExpired,timerTime,false);animationsData[0]={timer:timer,expectedEndTime:endTime};animationsData.push(close);element.data(ANIMATE_TIMER_KEY,animationsData)}element.on(events.join(" "),onAnimationProgress);if(options.to){if(options.cleanupStyles){registerRestorableStyles(restoreStyles,node,Object.keys(options.to))}applyAnimationToStyles(element,options)}}function onAnimationExpired(){var animationsData=element.data(ANIMATE_TIMER_KEY);if(animationsData){for(var i=1;i<animationsData.length;i++){animationsData[i]()}element.removeData(ANIMATE_TIMER_KEY)}}function onAnimationProgress(event){event.stopPropagation();var ev=event.originalEvent||event;var timeStamp=ev.$manualTimeStamp||ev.timeStamp||Date.now();var elapsedTime=parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));if(Math.max(timeStamp-startTime,0)>=maxDelayTime&&elapsedTime>=maxDuration){animationCompleted=true;close()}}}}}]}];var $$AnimateCssDriverProvider=["$$animationProvider",function($$animationProvider){$$animationProvider.drivers.push("$$animateCssDriver");var NG_ANIMATE_SHIM_CLASS_NAME="ng-animate-shim";var NG_ANIMATE_ANCHOR_CLASS_NAME="ng-anchor";var NG_OUT_ANCHOR_CLASS_NAME="ng-anchor-out";var NG_IN_ANCHOR_CLASS_NAME="ng-anchor-in";function isDocumentFragment(node){return node.parentNode&&node.parentNode.nodeType===11}this.$get=["$animateCss","$rootScope","$$AnimateRunner","$rootElement","$sniffer","$$jqLite","$document",function($animateCss,$rootScope,$$AnimateRunner,$rootElement,$sniffer,$$jqLite,$document){if(!$sniffer.animations&&!$sniffer.transitions)return noop;var bodyNode=$document[0].body;var rootNode=getDomNode($rootElement);var rootBodyElement=jqLite(isDocumentFragment(rootNode)||bodyNode.contains(rootNode)?rootNode:bodyNode);var applyAnimationClasses=applyAnimationClassesFactory($$jqLite);return function initDriverFn(animationDetails){return animationDetails.from&&animationDetails.to?prepareFromToAnchorAnimation(animationDetails.from,animationDetails.to,animationDetails.classes,animationDetails.anchors):prepareRegularAnimation(animationDetails)};function filterCssClasses(classes){return classes.replace(/\bng-\S+\b/g,"")}function getUniqueValues(a,b){if(isString(a))a=a.split(" ");if(isString(b))b=b.split(" ");return a.filter(function(val){return b.indexOf(val)===-1}).join(" ")}function prepareAnchoredAnimation(classes,outAnchor,inAnchor){var clone=jqLite(getDomNode(outAnchor).cloneNode(true));var startingClasses=filterCssClasses(getClassVal(clone));outAnchor.addClass(NG_ANIMATE_SHIM_CLASS_NAME);inAnchor.addClass(NG_ANIMATE_SHIM_CLASS_NAME);clone.addClass(NG_ANIMATE_ANCHOR_CLASS_NAME);rootBodyElement.append(clone);var animatorIn,animatorOut=prepareOutAnimation();if(!animatorOut){animatorIn=prepareInAnimation();if(!animatorIn){return end()}}var startingAnimator=animatorOut||animatorIn;return{start:function(){var runner;var currentAnimation=startingAnimator.start();currentAnimation.done(function(){currentAnimation=null;if(!animatorIn){animatorIn=prepareInAnimation();if(animatorIn){currentAnimation=animatorIn.start();currentAnimation.done(function(){currentAnimation=null;end();runner.complete()});return currentAnimation}}end();runner.complete()});runner=new $$AnimateRunner({end:endFn,cancel:endFn});return runner;function endFn(){if(currentAnimation){currentAnimation.end()}}}};function calculateAnchorStyles(anchor){var styles={};var coords=getDomNode(anchor).getBoundingClientRect();forEach(["width","height","top","left"],function(key){var value=coords[key];switch(key){case"top":value+=bodyNode.scrollTop;break;case"left":value+=bodyNode.scrollLeft;break}styles[key]=Math.floor(value)+"px"});return styles}function prepareOutAnimation(){var animator=$animateCss(clone,{addClass:NG_OUT_ANCHOR_CLASS_NAME,delay:true,from:calculateAnchorStyles(outAnchor)});return animator.$$willAnimate?animator:null}function getClassVal(element){return element.attr("class")||""}function prepareInAnimation(){var endingClasses=filterCssClasses(getClassVal(inAnchor));var toAdd=getUniqueValues(endingClasses,startingClasses);var toRemove=getUniqueValues(startingClasses,endingClasses);var animator=$animateCss(clone,{to:calculateAnchorStyles(inAnchor),addClass:NG_IN_ANCHOR_CLASS_NAME+" "+toAdd,removeClass:NG_OUT_ANCHOR_CLASS_NAME+" "+toRemove,delay:true});return animator.$$willAnimate?animator:null}function end(){clone.remove();outAnchor.removeClass(NG_ANIMATE_SHIM_CLASS_NAME);inAnchor.removeClass(NG_ANIMATE_SHIM_CLASS_NAME)}}function prepareFromToAnchorAnimation(from,to,classes,anchors){var fromAnimation=prepareRegularAnimation(from,noop);var toAnimation=prepareRegularAnimation(to,noop);var anchorAnimations=[];forEach(anchors,function(anchor){var outElement=anchor["out"];var inElement=anchor["in"];var animator=prepareAnchoredAnimation(classes,outElement,inElement);if(animator){anchorAnimations.push(animator)}});if(!fromAnimation&&!toAnimation&&anchorAnimations.length===0)return;return{start:function(){var animationRunners=[];if(fromAnimation){animationRunners.push(fromAnimation.start())}if(toAnimation){animationRunners.push(toAnimation.start())}forEach(anchorAnimations,function(animation){animationRunners.push(animation.start())});var runner=new $$AnimateRunner({end:endFn,cancel:endFn});$$AnimateRunner.all(animationRunners,function(status){runner.complete(status)});return runner;function endFn(){forEach(animationRunners,function(runner){runner.end()})}}}}function prepareRegularAnimation(animationDetails){var element=animationDetails.element;var options=animationDetails.options||{};
if(animationDetails.structural){options.event=animationDetails.event;options.structural=true;options.applyClassesEarly=true;if(animationDetails.event==="leave"){options.onDone=options.domOperation}}if(options.preparationClasses){options.event=concatWithSpace(options.event,options.preparationClasses)}var animator=$animateCss(element,options);return animator.$$willAnimate?animator:null}}]}];var $$AnimateJsProvider=["$animateProvider",function($animateProvider){this.$get=["$injector","$$AnimateRunner","$$jqLite",function($injector,$$AnimateRunner,$$jqLite){var applyAnimationClasses=applyAnimationClassesFactory($$jqLite);return function(element,event,classes,options){if(arguments.length===3&&isObject(classes)){options=classes;classes=null}options=prepareAnimationOptions(options);if(!classes){classes=element.attr("class")||"";if(options.addClass){classes+=" "+options.addClass}if(options.removeClass){classes+=" "+options.removeClass}}var classesToAdd=options.addClass;var classesToRemove=options.removeClass;var animations=lookupAnimations(classes);var before,after;if(animations.length){var afterFn,beforeFn;if(event=="leave"){beforeFn="leave";afterFn="afterLeave"}else{beforeFn="before"+event.charAt(0).toUpperCase()+event.substr(1);afterFn=event}if(event!=="enter"&&event!=="move"){before=packageAnimations(element,event,options,animations,beforeFn)}after=packageAnimations(element,event,options,animations,afterFn)}if(!before&&!after)return;function applyOptions(){options.domOperation();applyAnimationClasses(element,options)}return{start:function(){var closeActiveAnimations;var chain=[];if(before){chain.push(function(fn){closeActiveAnimations=before(fn)})}if(chain.length){chain.push(function(fn){applyOptions();fn(true)})}else{applyOptions()}if(after){chain.push(function(fn){closeActiveAnimations=after(fn)})}var animationClosed=false;var runner=new $$AnimateRunner({end:function(){endAnimations()},cancel:function(){endAnimations(true)}});$$AnimateRunner.chain(chain,onComplete);return runner;function onComplete(success){animationClosed=true;applyOptions();applyAnimationStyles(element,options);runner.complete(success)}function endAnimations(cancelled){if(!animationClosed){(closeActiveAnimations||noop)(cancelled);onComplete(cancelled)}}}};function executeAnimationFn(fn,element,event,options,onDone){var args;switch(event){case"animate":args=[element,options.from,options.to,onDone];break;case"setClass":args=[element,classesToAdd,classesToRemove,onDone];break;case"addClass":args=[element,classesToAdd,onDone];break;case"removeClass":args=[element,classesToRemove,onDone];break;default:args=[element,onDone];break}args.push(options);var value=fn.apply(fn,args);if(value){if(isFunction(value.start)){value=value.start()}if(value instanceof $$AnimateRunner){value.done(onDone)}else if(isFunction(value)){return value}}return noop}function groupEventedAnimations(element,event,options,animations,fnName){var operations=[];forEach(animations,function(ani){var animation=ani[fnName];if(!animation)return;operations.push(function(){var runner;var endProgressCb;var resolved=false;var onAnimationComplete=function(rejected){if(!resolved){resolved=true;(endProgressCb||noop)(rejected);runner.complete(!rejected)}};runner=new $$AnimateRunner({end:function(){onAnimationComplete()},cancel:function(){onAnimationComplete(true)}});endProgressCb=executeAnimationFn(animation,element,event,options,function(result){var cancelled=result===false;onAnimationComplete(cancelled)});return runner})});return operations}function packageAnimations(element,event,options,animations,fnName){var operations=groupEventedAnimations(element,event,options,animations,fnName);if(operations.length===0){var a,b;if(fnName==="beforeSetClass"){a=groupEventedAnimations(element,"removeClass",options,animations,"beforeRemoveClass");b=groupEventedAnimations(element,"addClass",options,animations,"beforeAddClass")}else if(fnName==="setClass"){a=groupEventedAnimations(element,"removeClass",options,animations,"removeClass");b=groupEventedAnimations(element,"addClass",options,animations,"addClass")}if(a){operations=operations.concat(a)}if(b){operations=operations.concat(b)}}if(operations.length===0)return;return function startAnimation(callback){var runners=[];if(operations.length){forEach(operations,function(animateFn){runners.push(animateFn())})}runners.length?$$AnimateRunner.all(runners,callback):callback();return function endFn(reject){forEach(runners,function(runner){reject?runner.cancel():runner.end()})}}}};function lookupAnimations(classes){classes=isArray(classes)?classes:classes.split(" ");var matches=[],flagMap={};for(var i=0;i<classes.length;i++){var klass=classes[i],animationFactory=$animateProvider.$$registeredAnimations[klass];if(animationFactory&&!flagMap[klass]){matches.push($injector.get(animationFactory));flagMap[klass]=true}}return matches}}]}];var $$AnimateJsDriverProvider=["$$animationProvider",function($$animationProvider){$$animationProvider.drivers.push("$$animateJsDriver");this.$get=["$$animateJs","$$AnimateRunner",function($$animateJs,$$AnimateRunner){return function initDriverFn(animationDetails){if(animationDetails.from&&animationDetails.to){var fromAnimation=prepareAnimation(animationDetails.from);var toAnimation=prepareAnimation(animationDetails.to);if(!fromAnimation&&!toAnimation)return;return{start:function(){var animationRunners=[];if(fromAnimation){animationRunners.push(fromAnimation.start())}if(toAnimation){animationRunners.push(toAnimation.start())}$$AnimateRunner.all(animationRunners,done);var runner=new $$AnimateRunner({end:endFnFactory(),cancel:endFnFactory()});return runner;function endFnFactory(){return function(){forEach(animationRunners,function(runner){runner.end()})}}function done(status){runner.complete(status)}}}}else{return prepareAnimation(animationDetails)}};function prepareAnimation(animationDetails){var element=animationDetails.element;var event=animationDetails.event;var options=animationDetails.options;var classes=animationDetails.classes;return $$animateJs(element,event,classes,options)}}]}];var NG_ANIMATE_ATTR_NAME="data-ng-animate";var NG_ANIMATE_PIN_DATA="$ngAnimatePin";var $$AnimateQueueProvider=["$animateProvider",function($animateProvider){var PRE_DIGEST_STATE=1;var RUNNING_STATE=2;var rules=this.rules={skip:[],cancel:[],join:[]};function isAllowed(ruleType,element,currentAnimation,previousAnimation){return rules[ruleType].some(function(fn){return fn(element,currentAnimation,previousAnimation)})}function hasAnimationClasses(options,and){options=options||{};var a=(options.addClass||"").length>0;var b=(options.removeClass||"").length>0;return and?a&&b:a||b}rules.join.push(function(element,newAnimation,currentAnimation){return!newAnimation.structural&&hasAnimationClasses(newAnimation.options)});rules.skip.push(function(element,newAnimation,currentAnimation){return!newAnimation.structural&&!hasAnimationClasses(newAnimation.options)});rules.skip.push(function(element,newAnimation,currentAnimation){return currentAnimation.event=="leave"&&newAnimation.structural});rules.skip.push(function(element,newAnimation,currentAnimation){return currentAnimation.structural&&currentAnimation.state===RUNNING_STATE&&!newAnimation.structural});rules.cancel.push(function(element,newAnimation,currentAnimation){return currentAnimation.structural&&newAnimation.structural});rules.cancel.push(function(element,newAnimation,currentAnimation){return currentAnimation.state===RUNNING_STATE&&newAnimation.structural});rules.cancel.push(function(element,newAnimation,currentAnimation){var nO=newAnimation.options;var cO=currentAnimation.options;return nO.addClass&&nO.addClass===cO.removeClass||nO.removeClass&&nO.removeClass===cO.addClass});this.$get=["$$rAF","$rootScope","$rootElement","$document","$$HashMap","$$animation","$$AnimateRunner","$templateRequest","$$jqLite","$$forceReflow",function($$rAF,$rootScope,$rootElement,$document,$$HashMap,$$animation,$$AnimateRunner,$templateRequest,$$jqLite,$$forceReflow){var activeAnimationsLookup=new $$HashMap;var disabledElementsLookup=new $$HashMap;var animationsEnabled=null;function postDigestTaskFactory(){var postDigestCalled=false;return function(fn){if(postDigestCalled){fn()}else{$rootScope.$$postDigest(function(){postDigestCalled=true;fn()})}}}var deregisterWatch=$rootScope.$watch(function(){return $templateRequest.totalPendingRequests===0},function(isEmpty){if(!isEmpty)return;deregisterWatch();$rootScope.$$postDigest(function(){$rootScope.$$postDigest(function(){if(animationsEnabled===null){animationsEnabled=true}})})});var callbackRegistry={};var classNameFilter=$animateProvider.classNameFilter();var isAnimatableClassName=!classNameFilter?function(){return true}:function(className){return classNameFilter.test(className)};var applyAnimationClasses=applyAnimationClassesFactory($$jqLite);function normalizeAnimationOptions(element,options){return mergeAnimationOptions(element,options,{})}function findCallbacks(element,event){var targetNode=getDomNode(element);var matches=[];var entries=callbackRegistry[event];if(entries){forEach(entries,function(entry){if(entry.node.contains(targetNode)){matches.push(entry.callback)}})}return matches}return{on:function(event,container,callback){var node=extractElementNode(container);callbackRegistry[event]=callbackRegistry[event]||[];callbackRegistry[event].push({node:node,callback:callback})},off:function(event,container,callback){var entries=callbackRegistry[event];if(!entries)return;callbackRegistry[event]=arguments.length===1?null:filterFromRegistry(entries,container,callback);function filterFromRegistry(list,matchContainer,matchCallback){var containerNode=extractElementNode(matchContainer);return list.filter(function(entry){var isMatch=entry.node===containerNode&&(!matchCallback||entry.callback===matchCallback);return!isMatch})}},pin:function(element,parentElement){assertArg(isElement(element),"element","not an element");assertArg(isElement(parentElement),"parentElement","not an element");element.data(NG_ANIMATE_PIN_DATA,parentElement)},push:function(element,event,options,domOperation){options=options||{};options.domOperation=domOperation;return queueAnimation(element,event,options)},enabled:function(element,bool){var argCount=arguments.length;if(argCount===0){bool=!!animationsEnabled}else{var hasElement=isElement(element);if(!hasElement){bool=animationsEnabled=!!element}else{var node=getDomNode(element);var recordExists=disabledElementsLookup.get(node);if(argCount===1){bool=!recordExists}else{bool=!!bool;if(!bool){disabledElementsLookup.put(node,true)}else if(recordExists){disabledElementsLookup.remove(node)}}}}return bool}};function queueAnimation(element,event,options){var node,parent;element=stripCommentsFromElement(element);if(element){node=getDomNode(element);parent=element.parent()}options=prepareAnimationOptions(options);var runner=new $$AnimateRunner;var runInNextPostDigestOrNow=postDigestTaskFactory();if(isArray(options.addClass)){options.addClass=options.addClass.join(" ")}if(options.addClass&&!isString(options.addClass)){options.addClass=null}if(isArray(options.removeClass)){options.removeClass=options.removeClass.join(" ")}if(options.removeClass&&!isString(options.removeClass)){options.removeClass=null}if(options.from&&!isObject(options.from)){options.from=null}if(options.to&&!isObject(options.to)){options.to=null}if(!node){close();return runner}var className=[node.className,options.addClass,options.removeClass].join(" ");if(!isAnimatableClassName(className)){close();return runner}var isStructural=["enter","move","leave"].indexOf(event)>=0;var skipAnimations=!animationsEnabled||disabledElementsLookup.get(node);var existingAnimation=!skipAnimations&&activeAnimationsLookup.get(node)||{};var hasExistingAnimation=!!existingAnimation.state;if(!skipAnimations&&(!hasExistingAnimation||existingAnimation.state!=PRE_DIGEST_STATE)){skipAnimations=!areAnimationsAllowed(element,parent,event)}if(skipAnimations){close();return runner}if(isStructural){closeChildAnimations(element)}var newAnimation={structural:isStructural,element:element,event:event,close:close,options:options,runner:runner};if(hasExistingAnimation){var skipAnimationFlag=isAllowed("skip",element,newAnimation,existingAnimation);if(skipAnimationFlag){if(existingAnimation.state===RUNNING_STATE){close();return runner}else{mergeAnimationOptions(element,existingAnimation.options,options);return existingAnimation.runner}}var cancelAnimationFlag=isAllowed("cancel",element,newAnimation,existingAnimation);if(cancelAnimationFlag){if(existingAnimation.state===RUNNING_STATE){existingAnimation.runner.end()}else if(existingAnimation.structural){existingAnimation.close()}else{mergeAnimationOptions(element,existingAnimation.options,newAnimation.options);return existingAnimation.runner}}else{var joinAnimationFlag=isAllowed("join",element,newAnimation,existingAnimation);if(joinAnimationFlag){if(existingAnimation.state===RUNNING_STATE){normalizeAnimationOptions(element,options)}else{applyGeneratedPreparationClasses(element,isStructural?event:null,options);event=newAnimation.event=existingAnimation.event;options=mergeAnimationOptions(element,existingAnimation.options,newAnimation.options);return existingAnimation.runner}}}}else{normalizeAnimationOptions(element,options)}var isValidAnimation=newAnimation.structural;if(!isValidAnimation){isValidAnimation=newAnimation.event==="animate"&&Object.keys(newAnimation.options.to||{}).length>0||hasAnimationClasses(newAnimation.options)}if(!isValidAnimation){close();clearElementAnimationState(element);return runner}var counter=(existingAnimation.counter||0)+1;newAnimation.counter=counter;markElementAnimationState(element,PRE_DIGEST_STATE,newAnimation);$rootScope.$$postDigest(function(){var animationDetails=activeAnimationsLookup.get(node);var animationCancelled=!animationDetails;animationDetails=animationDetails||{};var parentElement=element.parent()||[];var isValidAnimation=parentElement.length>0&&(animationDetails.event==="animate"||animationDetails.structural||hasAnimationClasses(animationDetails.options));if(animationCancelled||animationDetails.counter!==counter||!isValidAnimation){if(animationCancelled){applyAnimationClasses(element,options);applyAnimationStyles(element,options)}if(animationCancelled||isStructural&&animationDetails.event!==event){options.domOperation();runner.end()}if(!isValidAnimation){clearElementAnimationState(element)}return}event=!animationDetails.structural&&hasAnimationClasses(animationDetails.options,true)?"setClass":animationDetails.event;markElementAnimationState(element,RUNNING_STATE);var realRunner=$$animation(element,event,animationDetails.options);realRunner.done(function(status){close(!status);var animationDetails=activeAnimationsLookup.get(node);if(animationDetails&&animationDetails.counter===counter){clearElementAnimationState(getDomNode(element))}notifyProgress(runner,event,"close",{})});runner.setHost(realRunner);notifyProgress(runner,event,"start",{})});return runner;function notifyProgress(runner,event,phase,data){runInNextPostDigestOrNow(function(){var callbacks=findCallbacks(element,event);if(callbacks.length){$$rAF(function(){forEach(callbacks,function(callback){callback(element,phase,data)})})}});runner.progress(event,phase,data)}function close(reject){clearGeneratedClasses(element,options);applyAnimationClasses(element,options);applyAnimationStyles(element,options);options.domOperation();runner.complete(!reject)}}function closeChildAnimations(element){var node=getDomNode(element);var children=node.querySelectorAll("["+NG_ANIMATE_ATTR_NAME+"]");forEach(children,function(child){var state=parseInt(child.getAttribute(NG_ANIMATE_ATTR_NAME));var animationDetails=activeAnimationsLookup.get(child);switch(state){case RUNNING_STATE:animationDetails.runner.end();case PRE_DIGEST_STATE:if(animationDetails){activeAnimationsLookup.remove(child)}break}})}function clearElementAnimationState(element){var node=getDomNode(element);node.removeAttribute(NG_ANIMATE_ATTR_NAME);activeAnimationsLookup.remove(node)}function isMatchingElement(nodeOrElmA,nodeOrElmB){return getDomNode(nodeOrElmA)===getDomNode(nodeOrElmB)}function areAnimationsAllowed(element,parentElement,event){var bodyElement=jqLite($document[0].body);var bodyElementDetected=isMatchingElement(element,bodyElement)||element[0].nodeName==="HTML";var rootElementDetected=isMatchingElement(element,$rootElement);var parentAnimationDetected=false;var animateChildren;var parentHost=element.data(NG_ANIMATE_PIN_DATA);if(parentHost){parentElement=parentHost}while(parentElement&&parentElement.length){if(!rootElementDetected){rootElementDetected=isMatchingElement(parentElement,$rootElement)}var parentNode=parentElement[0];if(parentNode.nodeType!==ELEMENT_NODE){break}var details=activeAnimationsLookup.get(parentNode)||{};if(!parentAnimationDetected){parentAnimationDetected=details.structural||disabledElementsLookup.get(parentNode)}if(isUndefined(animateChildren)||animateChildren===true){var value=parentElement.data(NG_ANIMATE_CHILDREN_DATA);if(isDefined(value)){animateChildren=value}}if(parentAnimationDetected&&animateChildren===false)break;if(!rootElementDetected){rootElementDetected=isMatchingElement(parentElement,$rootElement);if(!rootElementDetected){parentHost=parentElement.data(NG_ANIMATE_PIN_DATA);if(parentHost){parentElement=parentHost}}}if(!bodyElementDetected){bodyElementDetected=isMatchingElement(parentElement,bodyElement)}parentElement=parentElement.parent()}var allowAnimation=!parentAnimationDetected||animateChildren;return allowAnimation&&rootElementDetected&&bodyElementDetected}function markElementAnimationState(element,state,details){details=details||{};details.state=state;var node=getDomNode(element);node.setAttribute(NG_ANIMATE_ATTR_NAME,state);var oldValue=activeAnimationsLookup.get(node);var newValue=oldValue?extend(oldValue,details):details;activeAnimationsLookup.put(node,newValue)}}]}];var $$AnimateAsyncRunFactory=["$$rAF",function($$rAF){var waitQueue=[];function waitForTick(fn){waitQueue.push(fn);if(waitQueue.length>1)return;$$rAF(function(){for(var i=0;i<waitQueue.length;i++){waitQueue[i]()}waitQueue=[]})}return function(){var passed=false;waitForTick(function(){passed=true});return function(callback){passed?callback():waitForTick(callback)}}}];var $$AnimateRunnerFactory=["$q","$sniffer","$$animateAsyncRun",function($q,$sniffer,$$animateAsyncRun){var INITIAL_STATE=0;var DONE_PENDING_STATE=1;var DONE_COMPLETE_STATE=2;AnimateRunner.chain=function(chain,callback){var index=0;next();function next(){if(index===chain.length){callback(true);return}chain[index](function(response){if(response===false){callback(false);return}index++;next()})}};AnimateRunner.all=function(runners,callback){var count=0;var status=true;forEach(runners,function(runner){runner.done(onProgress)});function onProgress(response){status=status&&response;if(++count===runners.length){callback(status)}}};function AnimateRunner(host){this.setHost(host);this._doneCallbacks=[];this._runInAnimationFrame=$$animateAsyncRun();this._state=0}AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){if(this._state===DONE_COMPLETE_STATE){fn()}else{this._doneCallbacks.push(fn)}},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){status===false?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},catch:function(handler){return this.getPromise()["catch"](handler)},finally:function(handler){return this.getPromise()["finally"](handler)},pause:function(){if(this.host.pause){this.host.pause()}},resume:function(){if(this.host.resume){this.host.resume()}},end:function(){if(this.host.end){this.host.end()}this._resolve(true)},cancel:function(){if(this.host.cancel){this.host.cancel()}this._resolve(false)},complete:function(response){var self=this;if(self._state===INITIAL_STATE){self._state=DONE_PENDING_STATE;self._runInAnimationFrame(function(){self._resolve(response)})}},_resolve:function(response){if(this._state!==DONE_COMPLETE_STATE){forEach(this._doneCallbacks,function(fn){fn(response)});this._doneCallbacks.length=0;this._state=DONE_COMPLETE_STATE}}};return AnimateRunner}];var $$AnimationProvider=["$animateProvider",function($animateProvider){var NG_ANIMATE_REF_ATTR="ng-animate-ref";var drivers=this.drivers=[];var RUNNER_STORAGE_KEY="$$animationRunner";function setRunner(element,runner){element.data(RUNNER_STORAGE_KEY,runner)}function removeRunner(element){element.removeData(RUNNER_STORAGE_KEY)}function getRunner(element){return element.data(RUNNER_STORAGE_KEY)}this.$get=["$$jqLite","$rootScope","$injector","$$AnimateRunner","$$HashMap","$$rAFScheduler",function($$jqLite,$rootScope,$injector,$$AnimateRunner,$$HashMap,$$rAFScheduler){var animationQueue=[];var applyAnimationClasses=applyAnimationClassesFactory($$jqLite);function sortAnimations(animations){var tree={children:[]};var i,lookup=new $$HashMap;for(i=0;i<animations.length;i++){var animation=animations[i];lookup.put(animation.domNode,animations[i]={domNode:animation.domNode,fn:animation.fn,children:[]})}for(i=0;i<animations.length;i++){processNode(animations[i])}return flatten(tree);function processNode(entry){if(entry.processed)return entry;entry.processed=true;var elementNode=entry.domNode;var parentNode=elementNode.parentNode;lookup.put(elementNode,entry);var parentEntry;while(parentNode){parentEntry=lookup.get(parentNode);if(parentEntry){if(!parentEntry.processed){parentEntry=processNode(parentEntry)}break}parentNode=parentNode.parentNode}(parentEntry||tree).children.push(entry);return entry}function flatten(tree){var result=[];var queue=[];var i;for(i=0;i<tree.children.length;i++){queue.push(tree.children[i])}var remainingLevelEntries=queue.length;var nextLevelEntries=0;var row=[];for(i=0;i<queue.length;i++){var entry=queue[i];if(remainingLevelEntries<=0){remainingLevelEntries=nextLevelEntries;nextLevelEntries=0;result.push(row);row=[]}row.push(entry.fn);entry.children.forEach(function(childEntry){nextLevelEntries++;queue.push(childEntry)});remainingLevelEntries--}if(row.length){result.push(row)}return result}}return function(element,event,options){options=prepareAnimationOptions(options);var isStructural=["enter","move","leave"].indexOf(event)>=0;var runner=new $$AnimateRunner({end:function(){close()},cancel:function(){close(true)}});if(!drivers.length){close();return runner}setRunner(element,runner);var classes=mergeClasses(element.attr("class"),mergeClasses(options.addClass,options.removeClass));var tempClasses=options.tempClasses;if(tempClasses){classes+=" "+tempClasses;options.tempClasses=null}animationQueue.push({element:element,classes:classes,event:event,structural:isStructural,options:options,beforeStart:beforeStart,close:close});element.on("$destroy",handleDestroyedElement);if(animationQueue.length>1)return runner;$rootScope.$$postDigest(function(){var animations=[];forEach(animationQueue,function(entry){if(getRunner(entry.element)){animations.push(entry)}else{entry.close()}});animationQueue.length=0;var groupedAnimations=groupAnimations(animations);var toBeSortedAnimations=[];forEach(groupedAnimations,function(animationEntry){toBeSortedAnimations.push({domNode:getDomNode(animationEntry.from?animationEntry.from.element:animationEntry.element),fn:function triggerAnimationStart(){animationEntry.beforeStart();var startAnimationFn,closeFn=animationEntry.close;var targetElement=animationEntry.anchors?animationEntry.from.element||animationEntry.to.element:animationEntry.element;if(getRunner(targetElement)){var operation=invokeFirstDriver(animationEntry);if(operation){startAnimationFn=operation.start}}if(!startAnimationFn){closeFn()}else{var animationRunner=startAnimationFn();animationRunner.done(function(status){closeFn(!status)});updateAnimationRunners(animationEntry,animationRunner)}}})});$$rAFScheduler(sortAnimations(toBeSortedAnimations))});return runner;function getAnchorNodes(node){var SELECTOR="["+NG_ANIMATE_REF_ATTR+"]";var items=node.hasAttribute(NG_ANIMATE_REF_ATTR)?[node]:node.querySelectorAll(SELECTOR);var anchors=[];forEach(items,function(node){var attr=node.getAttribute(NG_ANIMATE_REF_ATTR);if(attr&&attr.length){anchors.push(node)}});return anchors}function groupAnimations(animations){var preparedAnimations=[];var refLookup={};forEach(animations,function(animation,index){var element=animation.element;var node=getDomNode(element);var event=animation.event;var enterOrMove=["enter","move"].indexOf(event)>=0;var anchorNodes=animation.structural?getAnchorNodes(node):[];if(anchorNodes.length){var direction=enterOrMove?"to":"from";forEach(anchorNodes,function(anchor){var key=anchor.getAttribute(NG_ANIMATE_REF_ATTR);refLookup[key]=refLookup[key]||{};refLookup[key][direction]={animationID:index,element:jqLite(anchor)}})}else{preparedAnimations.push(animation)}});var usedIndicesLookup={};var anchorGroups={};forEach(refLookup,function(operations,key){var from=operations.from;var to=operations.to;if(!from||!to){var index=from?from.animationID:to.animationID;var indexKey=index.toString();if(!usedIndicesLookup[indexKey]){usedIndicesLookup[indexKey]=true;preparedAnimations.push(animations[index])}return}var fromAnimation=animations[from.animationID];var toAnimation=animations[to.animationID];var lookupKey=from.animationID.toString();if(!anchorGroups[lookupKey]){var group=anchorGroups[lookupKey]={structural:true,beforeStart:function(){fromAnimation.beforeStart();toAnimation.beforeStart()},close:function(){fromAnimation.close();toAnimation.close()},classes:cssClassesIntersection(fromAnimation.classes,toAnimation.classes),from:fromAnimation,to:toAnimation,anchors:[]};if(group.classes.length){preparedAnimations.push(group)}else{preparedAnimations.push(fromAnimation);preparedAnimations.push(toAnimation)}}anchorGroups[lookupKey].anchors.push({out:from.element,in:to.element})});return preparedAnimations}function cssClassesIntersection(a,b){a=a.split(" ");b=b.split(" ");var matches=[];for(var i=0;i<a.length;i++){var aa=a[i];if(aa.substring(0,3)==="ng-")continue;for(var j=0;j<b.length;j++){if(aa===b[j]){matches.push(aa);break}}}return matches.join(" ")}function invokeFirstDriver(animationDetails){for(var i=drivers.length-1;i>=0;i--){var driverName=drivers[i];if(!$injector.has(driverName))continue;var factory=$injector.get(driverName);var driver=factory(animationDetails);if(driver){return driver}}}function beforeStart(){element.addClass(NG_ANIMATE_CLASSNAME);if(tempClasses){$$jqLite.addClass(element,tempClasses)}}function updateAnimationRunners(animation,newRunner){if(animation.from&&animation.to){update(animation.from.element);update(animation.to.element)}else{update(animation.element)}function update(element){getRunner(element).setHost(newRunner)}}function handleDestroyedElement(){var runner=getRunner(element);if(runner&&(event!=="leave"||!options.$$domOperationFired)){runner.end()}}function close(rejected){element.off("$destroy",handleDestroyedElement);removeRunner(element);applyAnimationClasses(element,options);applyAnimationStyles(element,options);options.domOperation();if(tempClasses){$$jqLite.removeClass(element,tempClasses)}element.removeClass(NG_ANIMATE_CLASSNAME);runner.complete(!rejected)}}}]}];angular.module("ngAnimate",[]).directive("ngAnimateChildren",$$AnimateChildrenDirective).factory("$$rAFScheduler",$$rAFSchedulerFactory).factory("$$AnimateRunner",$$AnimateRunnerFactory).factory("$$animateAsyncRun",$$AnimateAsyncRunFactory).provider("$$animateQueue",$$AnimateQueueProvider).provider("$$animation",$$AnimationProvider).provider("$animateCss",$AnimateCssProvider).provider("$$animateCssDriver",$$AnimateCssDriverProvider).provider("$$animateJs",$$AnimateJsProvider).provider("$$animateJsDriver",$$AnimateJsDriverProvider)})(window,window.angular);angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.tooltip","ui.bootstrap.position","ui.bootstrap.bindHtml"]);angular.module("ui.bootstrap.tpls",["template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html"]);angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){var defaultOptions={placement:"top",animation:true,popupDelay:0};var triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"};var globalOptions={};this.options=function(value){angular.extend(globalOptions,value)};this.setTriggers=function setTriggers(triggers){angular.extend(triggerMap,triggers)};function snake_case(name){var regexp=/[A-Z]/g;var separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function($window,$compile,$timeout,$document,$position,$interpolate){return function $tooltip(type,prefix,defaultTriggerShow){var options=angular.extend({},defaultOptions,globalOptions);function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow;var hide=triggerMap[show]||show;return{show:show,hide:hide}}var directiveName=snake_case(type);var startSym=$interpolate.startSymbol();var endSym=$interpolate.endSymbol();var template="<div "+directiveName+"-popup "+'title="'+startSym+"title"+endSym+'" '+'content="'+startSym+"content"+endSym+'" '+'placement="'+startSym+"placement"+endSym+'" '+'animation="animation" '+'is-open="isOpen"'+">"+"</div>";return{restrict:"EA",compile:function(tElem,tAttrs){var tooltipLinker=$compile(template);return function link(scope,element,attrs){var tooltip;var tooltipLinkedScope;var transitionTimeout;var popupTimeout;var appendToBody=angular.isDefined(options.appendToBody)?options.appendToBody:false;var triggers=getTriggers(undefined);var hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]);var ttScope=scope.$new(true);var positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,ttScope.placement,appendToBody);ttPosition.top+="px";ttPosition.left+="px";tooltip.css(ttPosition)};ttScope.isOpen=false;function toggleTooltipBind(){if(!ttScope.isOpen){showTooltipBind()}else{hideTooltipBind()}}function showTooltipBind(){if(hasEnableExp&&!scope.$eval(attrs[prefix+"Enable"])){return}prepareTooltip();if(ttScope.popupDelay){if(!popupTimeout){popupTimeout=$timeout(show,ttScope.popupDelay,false);popupTimeout.then(function(reposition){reposition()})}}else{show()()}}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){popupTimeout=null;if(transitionTimeout){$timeout.cancel(transitionTimeout);transitionTimeout=null}if(!ttScope.content){return angular.noop}createTooltip();tooltip.css({top:0,left:0,display:"block"});if(appendToBody){$document.find(".tooltip").remove();$document.find("body").append(tooltip)}else{element.after(tooltip)}positionTooltip();ttScope.isOpen=true;ttScope.$digest();return positionTooltip}function hide(){ttScope.isOpen=false;$timeout.cancel(popupTimeout);popupTimeout=null;if(ttScope.animation){if(!transitionTimeout){transitionTimeout=$timeout(removeTooltip,500)}}else{removeTooltip()}}function createTooltip(){if(tooltip){removeTooltip()}tooltipLinkedScope=ttScope.$new();tooltip=tooltipLinker(tooltipLinkedScope,angular.noop)}function removeTooltip(){transitionTimeout=null;if(tooltip){tooltip.remove();tooltip=null}if(tooltipLinkedScope){tooltipLinkedScope.$destroy();tooltipLinkedScope=null}}function prepareTooltip(){prepPlacement();prepPopupDelay()}attrs.$observe(type,function(val){ttScope.content=val;if(!val&&ttScope.isOpen){hide()}});attrs.$observe(prefix+"Title",function(val){ttScope.title=val});function prepPlacement(){var val=attrs[prefix+"Placement"];ttScope.placement=angular.isDefined(val)?val:options.placement}function prepPopupDelay(){var val=attrs[prefix+"PopupDelay"];var delay=parseInt(val,10);ttScope.popupDelay=!isNaN(delay)?delay:options.popupDelay}var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind);
element.unbind(triggers.hide,hideTooltipBind)};function prepTriggers(){var val=attrs[prefix+"Trigger"];unregisterTriggers();triggers=getTriggers(val);if(triggers.show===triggers.hide){element.bind(triggers.show,toggleTooltipBind)}else{element.bind(triggers.show,showTooltipBind);element.bind(triggers.hide,hideTooltipBind)}}prepTriggers();var animation=scope.$eval(attrs[prefix+"Animation"]);ttScope.animation=angular.isDefined(animation)?!!animation:options.animation;var appendToBodyVal=scope.$eval(attrs[prefix+"AppendToBody"]);appendToBody=angular.isDefined(appendToBodyVal)?appendToBodyVal:appendToBody;if(appendToBody){scope.$on("$locationChangeSuccess",function closeTooltipOnLocationChangeSuccess(){if(ttScope.isOpen){hide()}})}scope.$on("$destroy",function onDestroyTooltip(){$timeout.cancel(transitionTimeout);$timeout.cancel(popupTimeout);unregisterTriggers();removeTooltip();ttScope=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:true,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:true,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]);angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){if(el.currentStyle){return el.currentStyle[cssprop]}else if($window.getComputedStyle){return $window.getComputedStyle(el)[cssprop]}return el.style[cssprop]}function isStaticPositioned(element){return(getStyle(element,"position")||"static")==="static"}var parentOffsetEl=function(element){var docDomEl=$document[0];var offsetParent=element.offsetParent||docDomEl;while(offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent)){offsetParent=offsetParent.offsetParent}return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element);var offsetParentBCR={top:0,left:0};var offsetParentEl=parentOffsetEl(element[0]);if(offsetParentEl!=$document[0]){offsetParentBCR=this.offset(angular.element(offsetParentEl));offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop;offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft}var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var positionStrParts=positionStr.split("-");var pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";var hostElPos,targetElWidth,targetElHeight,targetElPos;hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl);targetElWidth=targetEl.prop("offsetWidth");targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}};var shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()};break}return targetElPos}}}]);angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe);scope.$watch(attr.bindHtmlUnsafe,function bindHtmlUnsafeWatchAction(value){element.html(value||"")})}});angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n'+'  <div class="tooltip-arrow"></div>\n'+'  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n'+"</div>\n"+"")}]);angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n'+'  <div class="tooltip-arrow"></div>\n'+'  <div class="tooltip-inner" ng-bind="content"></div>\n'+"</div>\n"+"")}]);(function($){"use strict";function AJAXProxy(config){var defaults={dataURL:null,successHandler:null,dataType:"json",errorHandler:null};var options=$.extend(defaults,config);function _getData(){if(!options.dataURL){throw new Error("AJAXProxy: no dataURL configured")}if("function"!==typeof options.successHandler){throw new Error("AJAXProxy: no successHandler configured")}var ajaxOptions={dataType:options.dataType,success:options.successHandler};if("function"===typeof options.errorHandler){ajaxOptions.error=options.errorHandler}$.ajax(options.dataURL,ajaxOptions)}_getData()}$.fn.sport1AJAXProxy=function(config){return new AJAXProxy(config)}})(jQuery);jQuery.fn.sport1Disqus=function(spec){"use strict";if(!this.length){return this}spec=jQuery.extend({click:jQuery.noop,height:Math.max(1024,window.innerHeight*1.5),more:"More",tries:10,unobtrusive:true},spec||{});var that=this,tries=0,discoveryHeight=500;function init(){var frame=jQuery("#dsq-1"),frameHeight=frame.height(),button,height;if(!window.DISQUS||!frame.length||!frameHeight){if(tries<spec.tries){tries+=1;setTimeout(init,1e3)}return}height=spec.height;that.height(height).css("overflow","hidden");if(spec.unobtrusive&&height+discoveryHeight>=frameHeight){that.removeAttr("style");return}button=jQuery("<a>",{id:"s1-disqus-more",class:"active",html:spec.more});that.after(button);button.click(function(){frameHeight=frame.height()+10;height+=spec.height;if(spec.unobtrusive){if(height+discoveryHeight>=frameHeight){height="auto";button.remove()}}else{if(height>=frameHeight){height=frameHeight;button.removeClass("active")}else{button.addClass("active")}}that.height(height);spec.click()})}init();return that};(function($){"use strict";var name="sport1-news-feed";function NewsFeed(el,config){var self=this;var $el=$(el);var defaults={emptyClass:"s1-news-feed-empty",feedList:".s1-news-feed-content"};var options=$.extend(defaults,config);var $feedList=$(options.feedList,$el);function _init(){$el.data(name,self)}this.destroy=function(){$el.removeData(name)};this.displayFeedAtURL=function(url){$.fn.sport1AJAXProxy({dataURL:url,dataType:"html",errorHandler:function(){$feedList.html('<li class="'+options.emptyClass+'">Im Augenblick sind leider keine Daten verfügbar</li>')},successHandler:function(data){$feedList.html(data)}})};_init()}$.fn.sport1NewsFeed=function(config){var el=this.data(name);if(el){return el}this.each(function(){el=new NewsFeed($(this),config)});return config?el:this}})(jQuery);(function($,angular){"use strict";var modules=[];var throttle=false;var threshold=400;var bootstrapWhenVisibleDelayed;var bootstrapWhenVisible=function(){if(!throttle){throttle=true;var y=$(window).scrollTop()+$(window).height()+threshold;for(var i=0;i<modules.length;){var currentModule=modules[i];if(currentModule.y===0){console.warn("currentModule has height of 0",currentModule)}if(y>currentModule.y){if(currentModule.hasOwnProperty("callback")&&typeof currentModule.callback==="function"){currentModule.callback.apply()}else if(!angular.element(currentModule.element).scope()){angular.bootstrap(currentModule.element,$(currentModule.element).attr("ng-module").split(","))}modules.splice(i,1)}else{i++}}if(modules.length){setTimeout(function(){throttle=false},250)}else{$(document).off("scroll touchmove",bootstrapWhenVisible);$(document).off("touchend",bootstrapWhenVisibleDelayed);if(Array.isArray(Sport1Tools.lazyLoadingAjaxWidgets)){Sport1Tools.lazyLoadingAjaxWidgets=[];Sport1Tools.lazyLoadingAjaxWidgetsElements=[]}}}};bootstrapWhenVisibleDelayed=function(){setTimeout(bootstrapWhenVisible,500)};$(document).ready(function(){var viewportY=$(window).scrollTop();function top(element){if(!element||"function"!==typeof element.getBoundingClientRect){return 0}return viewportY+element.getBoundingClientRect().top||top(element.parentNode)}modules=$("[ng-module]").map(function(index,element){return{element:element,y:top(element)}});if(Array.isArray(Sport1Tools.lazyLoadingAjaxWidgets)){modules=modules.add(Sport1Tools.lazyLoadingAjaxWidgets)}bootstrapWhenVisible();$(document).on("scroll touchmove",bootstrapWhenVisible).on("touchend",bootstrapWhenVisibleDelayed)})})(jQuery,angular);(function(document,$){"use strict";var name="sport1-popup-button";function PopupButton(el,config){var self=this;var $el=$(el);var defaults={dynamic:false,dynamicPropagation:false,titleSelector:".s1-popup-button-title",scrollViewSelector:".s1-scroll-view",menuSelector:".s1-popup-button-menu",menuItemSelector:"a",menuItemActiveClass:"active",menuOpenClass:"s1-open",changedEvent:"sport1PopupButtonChanged"};var options=$.extend(defaults,config);var $title=$(options.titleSelector,$el);var $scrollView=$(options.scrollViewSelector,$el);var $menu=$(options.menuSelector,$scrollView);var $active=$("."+options.menuItemActiveClass,$menu);var _toggleMenu;var _toggleMenuClickHandler;var _keyUpHandler;_toggleMenu=function(){$el.toggleClass(options.menuOpenClass);setTimeout(function(){if($el.hasClass(options.menuOpenClass)){$title.off("click",_toggleMenuClickHandler);$(document).on("click touchend",_toggleMenuClickHandler);$(document).on("keyup",_keyUpHandler)}else{$title.on("click",_toggleMenuClickHandler);$(document).off("click touchend",_toggleMenuClickHandler);$(document).off("keyup",_keyUpHandler)}},250)};_toggleMenuClickHandler=function(evt){if(!$.contains($menu.get(0),evt.target)){_toggleMenu();if(options.dynamic){return false}evt.preventDefault()}};_keyUpHandler=function(evt){var keyCode=evt.keyCode;switch(keyCode){case 27:var e=jQuery.Event("click touchend");_toggleMenuClickHandler(e);break}};function _menuItemClickHandler(evt,noMenu){var $this=$(evt.target);if($active&&$active.get(0)!==$this.get(0)){var txt=$this.text();$active.removeClass(options.menuItemActiveClass);$this.addClass(options.menuItemActiveClass);$active=$this;$title.text(txt);$.event.trigger({type:options.changedEvent,instance:self})}if(!noMenu){_toggleMenu()}if(!options.dynamicPropagation){return false}}function _init(){$el.data(name,self);$title.on("click",_toggleMenuClickHandler);if(options.dynamic){$menu.on("click",options.menuItemSelector,_menuItemClickHandler);$menu.on("selectDefault",options.menuItemSelector,_menuItemClickHandler)}}this.destroy=function(){$el.removeData(name);$title.off("click",_toggleMenuClickHandler);if(options.dynamic){$menu.off("click",options.menuItemSelector,_menuItemClickHandler);$menu.off("selectDefault",options.menuItemSelector,_menuItemClickHandler)}};_init()}$.fn.sport1PopupButton=function(config){var el=this.data(name);if(el){return el}this.each(function(){el=new PopupButton($(this),config)});return config?el:this}})(document,jQuery);(function(){"use strict";function getImgUrlWithoutFilter(src){var x=src.split("/");x.splice(3,4);return x}function trackResizeImg(src,category,action){var label=getImgUrlWithoutFilter(src).join("/");if(window.ga){window.ga("send","event",category,action,label)}if(window.ivwPI){window.ivwPI()}}$("#s1-article-img-bigger").click(function(){var img=$(".s1-article-figure-image").children("img");var src=img.attr("src");src=src.replace("article_main","article_main_enlarged");img.attr("src",src);trackResizeImg(src,"ResizeArtikelBild","maximize");$(".s1-aside").animate({"margin-top":"612px"},200);$("#s1-article-img-bigger").animate({width:"0",height:"0"},200);setTimeout(function(){img.animate({width:"1000px",height:"562px"},200,function(){$("#s1-article-img-smaller").animate({width:"25px",height:"25px"},200)})},100)});$("#s1-article-img-smaller").click(function(){var img=$(".s1-article-figure-image").children("img");var src=img.attr("src");src=src.replace("article_main_enlarged","article_main");img.attr("src",src);trackResizeImg(src,"ResizeArtikelBild","minimize");img.animate({width:"660px",height:"371px"},200,function(){$("#s1-article-img-bigger").animate({width:"25px",height:"25px"},200)});$("#s1-article-img-smaller").animate({width:"0",height:"0"},200);setTimeout(function(){$(".s1-aside").animate({"margin-top":"0"},200)},100)});$(document).on("click",".s1-article-img-half-bigger",function(){var thisImage=$(this);var smallId=thisImage.context.id.replace("bigger","smaller");var parentElem=thisImage.parent();var img=parentElem.find("img");var src=img.attr("src");src=src.replace("half_size","full_size");img.attr("src",src);trackResizeImg(src,"ResizeHalfSize","maximize");thisImage.animate({width:"0",height:"0"},300);img.animate({width:"660px",height:"100%"},300,function(){$("#"+smallId).animate({width:"25px",height:"25px"},200)});parentElem.removeClass("s1-single-column");parentElem.animate({width:"660px"},200)});$(document).on("click",".s1-article-img-half-smaller",function(){var thisImage=$(this);var bigId=thisImage.context.id.replace("smaller","bigger");var parentElem=thisImage.parent();var img=parentElem.find("img");var src=img.attr("src");src=src.replace("full_size","half_size");img.attr("src",src);trackResizeImg(src,"ResizeHalfSize","minimize");img.animate({width:"320px",height:"179px"},300,function(){$("#"+bigId).animate({width:"25px",height:"25px"},200);parentElem.addClass("s1-single-column")});thisImage.animate({width:"0",height:"0"},200)})})();(function($){"use strict";var name="sport1-tab-bar";function TabBar(el,config){var self=this;var $el=$(el);var defaults={tabItemSelector:"a",activeClass:"active",dataId:"query",changedEvent:"sport1TabBarChanged",autoHide:false};var options=$.extend(defaults,config);var $links=$();var $active=$();function _selectTab(el){if($active[0]!==el[0]){$active.removeClass(options.activeClass);$active=el;$active.addClass(options.activeClass)}}function _autoHide(){if(options.autoHide){if(2>$links.length){$el.hide()}else{$el.show()}}}function _handleClick(evt){var target=$(evt.target);if(target.get(0).nodeName.toLowerCase()===options.tabItemSelector){var query=target.data(options.dataId);_selectTab(target);$.event.trigger({type:options.changedEvent,query:query})}return false}function _init(){$el.data(name,self);$links=$el.find(options.tabItemSelector);$active=$el.find("."+options.activeClass);$el.on("click",_handleClick);_autoHide()}this.destroy=function(){$el.removeData(name);$el.off("click",_handleClick);$links=$();$active=$()};this.selectTabAtIndex=function(index){_selectTab($($links[index]))};this.addTabs=function(tabs){if(0<tabs.length){$el.append(tabs);$links=$el.find(options.tabItemSelector);_autoHide()}};this.tabCount=function(){return $links.length};_init()}$.fn.sport1TabBar=function(config){var el=this.data(name);if(el){return el}this.each(function(){el=new TabBar($(this),config)});return config?el:this}})(jQuery);jQuery.fn.sport1ToTop=function(spec){"use strict";var w=jQuery(window),visible=false,a,modifier=spec.modifier||function(f){return f};function hide(){if(!visible){return}a.fadeOut();visible=false}function show(){if(visible){return}a.fadeIn();visible=true}function showWhenScrolled(){if(w.scrollTop()>window.innerHeight/2){show()}else{hide()}}a=jQuery("<img>",{src:spec.src,class:spec["class"]}).click(function(){hide();if(spec.click){spec.click()}window.location.href=location.href}).appendTo(this);w.scroll(modifier(showWhenScrolled));return this};$(document).ready(function(){"use strict";if(typeof Storage!=="undefined"){var guid=null;if(!localStorage.getItem("s1-guid")){guid=Sport1Tools.createUUID();localStorage.setItem("s1-guid",guid)}var recommenderIndex=parseInt(localStorage.getItem("s1-recommender-index"),10);if(!recommenderIndex){var index=Math.floor(Math.random()*100)+1;localStorage.setItem("s1-recommender-index",index)}var userPercentage=parseInt(localStorage.getItem("s1-recommender-percentage"),10);if(!userPercentage||userPercentage<parseInt(localStorage.getItem("s1-recommender-index"),10)){$(".s1-dashboard:contains('Ihr SPORT1 Dashboard')").hide()}}});(function($){"use strict";var name="sport1-scroll-view";function ScrollView(el,config){var self=this;var $el=$(el);var defaults={scrollContentClass:".s1-scroll-content",scrollAreaClass:".s1-scroll-area",scrollTrackClass:".s1-scroll-track",scrollBarClass:".s1-scroll-bar",disabledClassName:"s1-disabled"};var options=$.extend(defaults,config);var $scrollContent=$(options.scrollContentClass,$el);var $scrollArea=$(options.scrollAreaClass,$el);var $scrollTrack;var $scrollBar;var $videoActive;var _trackMouseDownScrollTop=0;var _trackMouseDownY=0;function _barScaleFactor(){var contentHeight=$scrollContent.outerHeight();var areaHeight=$scrollArea.outerHeight();if(0<areaHeight){return contentHeight/areaHeight}return 0}function _scrollContent(evt){var scrollTop=_trackMouseDownScrollTop;var deltaY=evt.pageY-_trackMouseDownY;var factor=_barScaleFactor();if(0<factor){$scrollContent.scrollTop(scrollTop+Math.floor(deltaY/factor))}}function _animatedScrollPlaylist(){if(1===$videoActive.length){var $listScrollStep=$videoActive.outerHeight()*10;var $videoActivePosTop=$videoActive.position().top;if($videoActivePosTop>$listScrollStep){$scrollContent.scrollTop($videoActivePosTop-$listScrollStep)}$scrollContent.animate({scrollTop:$videoActivePosTop+"px"},2e3,"swing")}}function _scrollHandler(){var deltaY=$scrollContent.scrollTop();var factor=_barScaleFactor();if(0<factor){$scrollBar.css({top:Math.floor(deltaY*factor),height:Math.floor($scrollTrack.height()*factor-parseInt($scrollBar.css("marginTop"),10))})}if(0<factor&&factor<1){if($scrollBar.hasClass(options.disabledClassName)){$scrollTrack.removeClass(options.disabledClassName);$scrollBar.removeClass(options.disabledClassName)}}else{if(!$scrollBar.hasClass(options.disabledClassName)){$scrollTrack.addClass(options.disabledClassName);$scrollBar.addClass(options.disabledClassName)}}$scrollContent.find("img.s1-lazy-img").lazyload({skip_invisible:true})}function _mouseMoveHandler(evt){_scrollContent(evt);return false}function _mouseUpHandler(evt){$(document).off("mousemove",_mouseMoveHandler);$(document).off("mouseup",_mouseUpHandler);$scrollTrack.removeClass("s1-clicked");_scrollContent(evt);_trackMouseDownScrollTop=0;_trackMouseDownY=0;return false}function _mouseDownHandler(evt){_trackMouseDownScrollTop=$scrollContent.scrollTop();_trackMouseDownY=evt.pageY;$(document).on("mousemove",_mouseMoveHandler);$(document).on("mouseup",_mouseUpHandler);$scrollTrack.addClass("s1-clicked")}function _init(){$el.data(name,self);$scrollTrack=$(options.scrollTrackClass,$el);if(0===$scrollTrack.length){$scrollTrack=$('<div class="s1-scroll-track"><div class="s1-scroll-bar"></div></div>');$el.append($scrollTrack)}$scrollBar=$(options.scrollBarClass,$el);if(0===$scrollBar.length){$scrollBar=$('<div class="s1-scroll-bar"></div>');$scrollTrack.append($scrollBar)}$scrollContent.on("scroll",_scrollHandler);$scrollTrack.on("mousedown",_mouseDownHandler);$videoActive=$scrollContent.find(".s1-video-active");setTimeout(function(){_scrollHandler()},600);_animatedScrollPlaylist()}this.destroy=function(){$el.removeData(name);$scrollArea.off("scroll",_scrollHandler);$scrollTrack.off("mousedown",_mouseDownHandler)};_init()}$.fn.sport1ScrollView=function(config){var el=this.data(name);if(el){return el}this.each(function(){el=new ScrollView($(this),config)});return config?el:this}})(jQuery);window.appTemplates=angular.module("sport1.templates",[]);window.appControllers=angular.module("sport1.controllers",[]);window.appDirectives=angular.module("sport1.directives",["sport1.templates","infinite-scroll","ui.bootstrap","pasvaz.bindonce"]).config(["$tooltipProvider",function($tooltipProvider){"use strict";$tooltipProvider.setTriggers({mouseenter:"mouseleaveTooltip",click:"click",focus:"blur"})}]);window.appFilters=angular.module("sport1.filters",[]);window.appServices=angular.module("sport1.services",[]);angular.module("popupAudioPlayer",["ngRoute","ngResource","ngSanitize","sport1.controllers","sport1.directives","sport1.filters","sport1.services","uiSlider","sport1.templates"]).config(["$interpolateProvider","$routeProvider",function($interpolateProvider,$routeProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]");$routeProvider.when("/",{templateUrl:"common/angularjs/apps/audio-player/templates/onair.html"}).when("/:tabId",{templateUrl:"common/angularjs/apps/audio-player/templates/onair.html"}).otherwise({redirectTo:"/"})}]);(function(){"use strict";var AudioPlayerController,dependencies;dependencies=["$controller","$rootScope","$scope","$route","$location","$q","$filter","$timeout","$interval","sportDataService","graphicService","lineupService","fmMatchHighlightsService","fmPopUpPlayerAdService"];AudioPlayerController=function($controller,$rootScope,$scope,$route,$location,$q,$filter,$timeout,$interval,sportDataService,graphicService,lineupService,highlightsService,fmPopUpPlayerAdService){AudioPlayerController=function(){var apCtrl,coInterval,competionIds,ctrl,epgInterval;apCtrl={};ctrl={};epgInterval=null;coInterval=null;competionIds=null;ctrl.UPDATE_ACTIVE_ELEMENT="audioplayer-update-playlist-element";ctrl.VALID_SPORTS_FOR_SCORERS=[sportDataService.SPORT_ID.SOCCER,sportDataService.SPORT_ID.ICEHOCKEY];function AudioPlayerController(){$controller("BaseController",{$rootScope:$rootScope});$scope.competition={};$scope.selectedMatch={};$scope.liveFMMatchs=[];apCtrl=this;apCtrl.fmHighlightsData=null;apCtrl.app={init:false,playlist:{loading:false},lineup:{loading:false},stats:{loading:false},highlights:{loading:false}};ctrl.tabs={onair:{title:"On Air",id:0,path:"onair",templateUrl:"common/angularjs/apps/audio-player/templates/onair.html",headerCssClass:"",enabled:true,visible:true},aufstellung:{title:"Aufstellung",id:10,path:"aufstellung",templateUrl:"common/angularjs/apps/audio-player/templates/lineup.html",headerCssClass:"",enabled:false,visible:true},tabelle:{title:"Tabelle",id:20,path:"tabelle",templateUrl:"common/angularjs/apps/audio-player/templates/standings.html",headerCssClass:"",enabled:false,visible:true},telegramm:{title:"Telegramm",id:30,path:"telegramm",templateUrl:"common/angularjs/apps/audio-player/templates/telegram.html",headerCssClass:"",enabled:false,visible:true},statistik:{title:"Statistik",id:40,path:"statistik",templateUrl:"common/angularjs/apps/audio-player/templates/statistics.html",headerCssClass:"",enabled:false,visible:true},highlights:{title:"Highlights",id:40,path:"highlights",templateUrl:"common/angularjs/apps/audio-player/templates/highlights.html",headerCssClass:"",enabled:false,visible:false}};apCtrl.tabs=[];ctrl.setTabVisible(ctrl.tabs.onair.path,true);ctrl.setTabVisible(ctrl.tabs.aufstellung.path,true);ctrl.setTabVisible(ctrl.tabs.tabelle.path,true);ctrl.setTabVisible(ctrl.tabs.telegramm.path,true);ctrl.setTabVisible(ctrl.tabs.statistik.path,true);ctrl.setTabVisible(ctrl.tabs.highlights.path,false);ctrl.models={team:{lineup:[],bench:[],coach:[],statistics:{},scorers:[]}};ctrl.initWatchers()}ctrl.initWatchers=function(){$scope.$on("$routeChangeSuccess",function(event,current){var newTabId,ref,ref1,ref2;newTabId=(ref=current.params.tabId)!=null?ref:apCtrl.tabs[0].path;if(newTabId!=null&&newTabId!==((ref1=apCtrl.currentTab)!=null?ref1.path:void 0)){apCtrl.currentTab=(ref2=ctrl.tabs[newTabId])!=null?ref2:apCtrl.tabs[0];apCtrl.templateUrl=apCtrl.currentTab.templateUrl}});return $scope.$watch("apCtrl.currentTab",function(newValue,oldValue){var params;if(oldValue!=null&&newValue!==oldValue){if(newValue.id<oldValue.id){apCtrl.animationClass="s1-animation-slide-ltr"}else{apCtrl.animationClass="s1-animation-slide-rtl"}params=angular.copy($route.current.params);params.tabId=newValue.path;ctrl.updateLocationPath(params);apCtrl.templateUrl=apCtrl.currentTab.templateUrl;if(oldValue!=null){return fmPopUpPlayerAdService.reloadAd($scope.activeSportData.coId,$scope.activeSportData.sportId)}}})};AudioPlayerController.prototype.selectSiElement=function(siElement){var coId;if(siElement!=null){coId=siElement.coId;if(apCtrl.currentTab.id!==0&&apCtrl.currentTab.id!==20||coId==null){apCtrl.currentTab=ctrl.tabs.onair}if(coId!=null){sportDataService.getCompetition(coId).then(function(competition){return sportDataService.getStanding(coId,competition.current_round_id,competition.current_matchday).then(function(st){var hasValidStanding,tableData;hasValidStanding=st.standing.length>0;if(hasValidStanding){tableData={};tableData.coId=competition.id;tableData.roundId=competition.current_round_id;tableData.match={};tableData.match.matchday=competition.current_matchday;tableData.match.group_matchday="0";tableData.linkTarget="_blank";tableData.toPortal="http://www.sport1.de";return $scope.$broadcast("audioplayer-update-standing",tableData)}else{apCtrl.currentTab=ctrl.tabs.onair;return ctrl.setTabActive("tabelle",false)}})})}ctrl.setTabActive("aufstellung",false);ctrl.setTabActive("telegramm",false);ctrl.setTabActive("statistik",false);ctrl.setTabActive("highlights",false);ctrl.setTabActive("tabelle",coId!=null);$scope.selectedMatch=siElement;$scope.selectedMatch.isSiElement=true;$scope.selectedMatchId=siElement.id;if(siElement.isLive){return $scope.updateLiveCompetionData(siElement)}}};AudioPlayerController.prototype.selectLiveGame=function(data,sendIVW){if(data==null){return}if(sendIVW===true){window.ivwPI()}if(data.type==="epg"){apCtrl.selectSiElement(data);return}if(data.sportId==="1"){return apCtrl.updateMatch(data)}else if(data.sportId==="42"){apCtrl.currentTab=ctrl.tabs.onair;$scope.selectedMatch=data;$scope.selectedMatchId=data.id}};AudioPlayerController.prototype.updateMatch=function(data){var $promises,coId;apCtrl.teams={home:angular.copy(data.match.home),away:angular.copy(data.match.away)};coId=data.coId;$promises={};$promises["co"+coId]=sportDataService.getCompetition(coId);$promises["st"+coId]=sportDataService.getStanding(coId,data.roundId,data.match.matchday);ctrl.setTabActive("telegramm",true);$q.all($promises).then(function(promise){var competition,hasValidStanding,standingData,tableData;competition=promise["co"+coId];standingData=promise["st"+coId];hasValidStanding=standingData.standing!=null&&standingData.standing.length;ctrl.setTabActive("tabelle",hasValidStanding);if(hasValidStanding){tableData=angular.copy(data);tableData.linkTarget="_blank";tableData.toPortal="http://www.sport1.de";$scope.$broadcast("audioplayer-update-standing",tableData)}$scope.competition=competition;apCtrl.app.stats.loading=true;ctrl.setTeamStatistics(data.match.id);ctrl.refreshTeamPlayers(data.match.id);ctrl.checkIfActiveTabIsEnabled();sportDataService.setTeamLogo(apCtrl.teams.home);return sportDataService.setTeamLogo(apCtrl.teams.away)});$scope.selectedMatch=data;$scope.selectedMatchId=data.id};ctrl.setTeamStatistics=function(matchId){var isMatchFinished,ref;if(Number($scope.competition.sport.id)!==sportDataService.SPORT_ID.SOCCER){ctrl.setTabVisible("aufstellung",false);apCtrl.app.lineup.loading=false;ctrl.setTabVisible("statistik",false);apCtrl.app.stats.loading=false;return false}else{ctrl.setTabVisible("aufstellung",true);ctrl.setTabVisible("statistik",true);isMatchFinished=((ref=$scope.selectedMatch)!=null?ref.finished:void 0)!=null&&$scope.selectedMatch.finished==="yes"?true:false;return sportDataService.getCompleteMatchTeamStats($scope.competition.id,$scope.competition.sport.id,matchId,isMatchFinished).then(function(statistics){var hasValidStats;hasValidStats=statistics.length!==0;ctrl.setTabVisible("statistik",hasValidStats);ctrl.setTabActive("statistik",hasValidStats);apCtrl.app.stats.loading=false})}};ctrl.refreshTeamPlayers=function(matchId){apCtrl.app.lineup.loading=true;return ctrl.setTeamPlayers(matchId)};ctrl.setTeamPlayers=function(matchId){var promises;promises={};promises.events=sportDataService.getMatchEvents(matchId);promises.tacticals=sportDataService.getMatchTactical(matchId);$q.all(promises).then(function(response){var containerSize,event,events,hasValidLineup,i,j,len,len1,person,player,playerSize,ref,ref1,tactical,tacticals,team,updates;events=response.events;updates=[];tacticals=response.tacticals;apCtrl.teams.home.lineup=[];apCtrl.teams.home.bench=[];apCtrl.teams.home.coach=[];apCtrl.teams.away.lineup=[];apCtrl.teams.away.bench=[];apCtrl.teams.away.coach=[];for(i=0,len=events.length;i<len;i++){event=events[i];team=+((ref=event.team)!=null?ref.id:void 0)===+apCtrl.teams.home.id?apCtrl.teams.home:apCtrl.teams.away;if(+event.minute===0){switch(event.action){case"playing":person=event.person;person.img=graphicService.getPersonImgUrl(person.id,"s");sportDataService.setPersonDetails(person,$scope.competition);switch(event.kind){case"lineup":team.lineup.push(person);break;case"bench":team.bench.push(person)}break;case"coaching":team.coach.push(event.person)}}else{updates.push(event)}}hasValidLineup=apCtrl.teams.away.bench.length!==0&&apCtrl.teams.home.bench.length!==0;ctrl.setTabActive("aufstellung",hasValidLineup);ctrl.checkIfActiveTabIsEnabled();if(updates.length){ctrl.updatePlayers(updates)}for(j=0,len1=tacticals.length;j<len1;j++){tactical=tacticals[j];player=ctrl.getPlayer(tactical.person.id,tactical.team.id);lineupService.setPlayerCoords(player,tactical);if((player!=null?(ref1=player.coords)!=null?ref1.x:void 0:void 0)==null||player.coords.y==null){player={coords:{x:0,y:0}};console.warn("player: "+tactical.person.name+" with person id: "+tactical.person.id+" has no coords -> replace with default coords")}}if(!tacticals.length){ctrl.setTabActive("aufstellung",false)}if(apCtrl.currentTab.path==="aufstellung"&&!apCtrl.currentTab.enabled){apCtrl.currentTab=ctrl.tabs.onair}containerSize={width:358,height:315};playerSize={width:70,height:40};lineupService.calculatePlayerPositions(apCtrl.teams.home.lineup,true,containerSize,playerSize);lineupService.calculatePlayerPositions(apCtrl.teams.away.lineup,false,containerSize,playerSize);apCtrl.app.lineup.loading=false})};ctrl.getPlayer=function(playerId,teamId){var item,player,searchIn;if(+teamId===+apCtrl.teams.home.id){searchIn=apCtrl.teams.home.lineup.concat(apCtrl.teams.home.bench)}else{searchIn=apCtrl.teams.away.lineup.concat(apCtrl.teams.away.bench)}player=function(){var i,len,results;results=[];for(i=0,len=searchIn.length;i<len;i++){item=searchIn[i];if(+item.id===+playerId){results.push(item)}}return results}();if(player.length&&!player[0]._link.match("http://www.sport1.de")){player[0]._link="http://www.sport1.de"+player[0]._link}if(player.length){return player[0]}else{return false}};ctrl.updatePlayers=function(events){var addEventToList,event,eventType,i,isEventAlreadyInList,len,ownGoal,player,ref,ref1,ref2,ref3,ref4,results,team;isEventAlreadyInList=function(event,list){return list.filter(function(data){return data.id===event.id}).length>0};addEventToList=function(event,list,eventType){return list.push({id:event.id,minute:event.minute,type:eventType})};results=[];for(i=0,len=events.length;i<len;i++){
event=events[i];if(!~~event.minute||event.team_id!=null||event.person_id!=null){continue}if(event.person!=null){player=ctrl.getPlayer(event.person.id,event.team.id);player.events=(ref=player.events)!=null?ref:[]}eventType=null;switch(event.action){case"goal":ownGoal=event.kind==="own-goal";if(+event.team.id===+apCtrl.teams.home.id){team=ownGoal?apCtrl.teams.away:apCtrl.teams.home}else{team=ownGoal?apCtrl.teams.home:apCtrl.teams.away}if(ref1=Number($scope.competition.sport.id),window.indexOf.call(ctrl.VALID_SPORTS_FOR_SCORERS,ref1)>=0){if((ref2=team.scorers)!=null){ref2.push({minute:+event.minute,name:((ref3=event.person)!=null?ref3.surname:void 0)+" "+(ownGoal?" (ET)":""),display:event.minute+"' "+((ref4=event.person)!=null?ref4.surname:void 0)+" "+(ownGoal?" (ET)":"")})}}eventType=event.kind==="own-goal"?event.kind:event.action;break;case"playing":eventType=event.kind;break;case"card":eventType="card-"+event.kind}if(eventType!=null&&(player!=null?player.events:void 0)!=null&&!isEventAlreadyInList(event,player.events)){results.push(addEventToList(event,player.events,eventType))}else{results.push(void 0)}}return results};ctrl.checkForMatchHighlights=function(match){return highlightsService.getMatchHighlights(match).then(function(highlight){ctrl.setTabActive("highlights",true);apCtrl.fmHighlightsData=highlight;apCtrl.app.highlights.loading=false},function(){ctrl.setTabActive("highlights",false);ctrl.checkIfActiveTabIsEnabled();apCtrl.app.highlights.loading=false})};ctrl.checkIfActiveTabIsEnabled=function(){if(apCtrl.currentTab!=null&&!apCtrl.currentTab.enabled){apCtrl.currentTab=ctrl.tabs.onair}};ctrl.setTabVisible=function(tabPath,status){var ref,tab;if(status){if(ref=ctrl.tabs[tabPath],window.indexOf.call(apCtrl.tabs,ref)<0){apCtrl.tabs.push(ctrl.tabs[tabPath])}}else{apCtrl.tabs=function(){var i,len,ref1,results;ref1=apCtrl.tabs;results=[];for(i=0,len=ref1.length;i<len;i++){tab=ref1[i];if(tab.path!==tabPath){results.push(tab)}}return results}();ctrl.setTabActive(tabPath,status)}return apCtrl.tabs.sort(function(a,b){return a.id-b.id})};ctrl.setTabActive=function(tabName,status){var tab;tab=function(){var i,len,ref,results;ref=apCtrl.tabs;results=[];for(i=0,len=ref.length;i<len;i++){tab=ref[i];if(tab.path===tabName){results.push(tab)}}return results}();if(tab.length){tab[0].enabled=status}};ctrl.updateLocationPath=function(params){var path;path="";if(params.tabId!=null){path=path+"/"+params.tabId}return $location.path(path)};return AudioPlayerController}();return new AudioPlayerController};AudioPlayerController.$inject=dependencies;return angular.module("sport1.controllers").controller("AudioPlayerController",AudioPlayerController)})();angular.module("gameplanApp",["ngResource","ngRoute","sport1.controllers","sport1.directives","sport1.filters","sport1.services"]).config(["$interpolateProvider","$routeProvider",function($interpolateProvider,$routeProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]");$routeProvider.when("",{}).when("/saison/:seasonId",{}).when("/saison/:seasonId/spieltag/:matchdayId",{}).when("/saison/:seasonId/runde/:roundId",{}).when("/saison/:seasonId/runde/:roundId/spieltag/:matchdayId",{}).when("/saison/:seasonId/runde/:roundId/gruppe/:groupId",{}).otherwise({redirectTo:"/"})}]);appControllers.controller("GameplanAppCtrl",["$controller","$rootScope","$scope","$location","$route","$filter","$element","sportDataService","$window","$q","$routeParams","FlashService","gaService",function($controller,$rootScope,$scope,$location,$route,$filter,$element,SportData,$window,$q,$routeParams,Flash,gaService){"use strict";$controller("BaseController",{$rootScope:$rootScope});var ctrl=this;gaService.initTracking();$scope.seasons=[];$scope.currentSeason=undefined;$scope.matchdays=[];$scope.currentMatchday=undefined;$scope.rounds=[];$scope.currentRound=undefined;$scope.groups=[];$scope.currentGroup=undefined;$scope.competition={};$scope.gameplan={options:{},data:{},loading:true};$scope.popups=[];ctrl.popups={season:{id:"season",label:"Saison",menuItems:"seasons",menuItemLabel:"name",menuItemPrefix:Sport1Tools.isMobileSite()?"Saison":"",selected:"currentSeason",titleId:"s1-popup-button-title-table-season"},round:{id:"round",label:"Spielmodus",menuItems:"rounds",menuItemLabel:"label",menuItemPostfix:"",selected:"currentRound",titleId:"s1-popup-button-title-table-matchday"},matchday:{id:"matchday",label:"Spieltag",menuItems:"matchdays",menuItemLabel:"name",selected:"currentMatchday",titleId:"s1-popup-button-title-table-matchday"},group:{id:"group",label:"Gruppe",menuItems:"groups",menuItemLabel:"name",selected:"currentGroup",titleId:"s1-popup-button-title-table-matchday"}};ctrl.matches=[];$scope.initVars=function(competitionId){$scope.competition.id=competitionId;$scope.competition.$promise=SportData.getCompetition(competitionId)};ctrl.initCompetition=function(competitionId){SportData.getCompetition($scope.competition.id).then(function(competition){$scope.competition=angular.extend($scope.competition,competition);$scope.gameplan.options={competition:$scope.competition,contentType:"gameplan",layout:"default"};ctrl.setPopups(competition._type);ctrl._setSeasons(competitionId);$element.addClass("s1-gameplan").addClass("s1-sport-"+competition._sport).addClass("s1-content-"+$scope.gameplan.options.contentType).addClass("s1-competition-"+competition._type).addClass("s1-competition-id-"+competition.id).addClass("s1-layout-"+$scope.gameplan.options.layout);return ctrl._setSeasons($scope.competitionId)})};ctrl.setPopups=function(competitionType){switch(competitionType){case SportData._COMPETITION_TYPE.TOURNAMENT:if(!~$scope.popups.indexOf(ctrl.popups.season)){$scope.popups.push(ctrl.popups.season)}if(!~$scope.popups.indexOf(ctrl.popups.round)){$scope.popups.push(ctrl.popups.round)}break;case SportData._COMPETITION_TYPE.LEAGUE:if(!~$scope.popups.indexOf(ctrl.popups.season)){$scope.popups.push(ctrl.popups.season)}if(!~$scope.popups.indexOf(ctrl.popups.matchday)){$scope.popups.push(ctrl.popups.matchday)}break;case SportData._COMPETITION_TYPE.DIVISION:if(!~$scope.popups.indexOf(ctrl.popups.season)){$scope.popups.push(ctrl.popups.season)}break}};ctrl._setSeasons=function(competitionId){if(!angular.isDefined(competitionId)){competitionId=$scope.competition.id}$scope.gameplan.loading=true;$scope.seasons.loading=true;$scope.rounds.loading=true;$scope.matchdays.loading=true;$scope.groups.loading=true;return SportData.getSeasonsByCompetition(competitionId).then(function(seasons){seasons=[].concat(seasons);var sortedSeasons=seasons.reverse();var currentSeason;if(angular.isDefined($route.current.params.seasonId)){currentSeason=$filter("keyValueFilter")(sortedSeasons,{id:$route.current.params.seasonId})}else{currentSeason=$filter("keyValueFilter")(sortedSeasons,{id:$scope.competition.current_season_id})}if(currentSeason.length){currentSeason=currentSeason[0]}else{currentSeason=sortedSeasons[0]}$scope.currentSeason=currentSeason;$scope.seasons=sortedSeasons;return ctrl.setRounds($scope.currentSeason.id)})};ctrl.setRounds=function(seasonId,resetRounds){$scope.gameplan.loading=true;if(!angular.isDefined(seasonId)){return $scope.competition.$promise.then(function(competition){return ctrl.setRounds(competition.current_season_id,resetRounds)})}return SportData.getRoundsBySeason(seasonId).then(function(season){var newRoundId;var newMatchdayId;if(angular.isDefined(season.round)&&season.round.length){newRoundId=parseInt(season.current_round_id,10)?season.current_round_id:season.round[0].id;newMatchdayId=season.current_group_matchday}else{$scope.gameplan.loading=false;return Flash.error("gac_err_1","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getRoundsBySeason` in ctrl.setRounds")}if(!resetRounds){newRoundId=$route.current.params.roundId||newRoundId}while($scope.rounds.length){$scope.rounds.pop()}angular.forEach(season.round,function(round){var mainRound=$filter("keyValueFilter")($scope.rounds,{round_order:round.round_order});if(!mainRound.length){if(angular.isDefined(round.table_mode)&&~round.name.toUpperCase().indexOf("GRUPPE")){round.label="Gruppenphase"}else{round.label=round.name}round._roundIds=[round.id];round.current_group_matchday=newMatchdayId;$scope.rounds.push(round)}else{mainRound[0]._roundIds.push(round.id)}});var groupStages=$filter("keyValueFilter")($scope.rounds,function(round){return angular.isDefined(round.table_mode)&&~round.name.toUpperCase().indexOf("GRUPPE")});if(groupStages.length>1){for(var i=0;i<groupStages.length;i++){groupStages[i].label=String(i+1)+". "+groupStages[i].label}}var currentRound=$filter("keyValueFilter")($scope.rounds,function(round){return~round._roundIds.indexOf(newRoundId)});if(currentRound.length){$scope.currentRound=currentRound[0]}else{$scope.currentRound=$scope.rounds[0]}$scope.rounds.loading=false;return ctrl.setMatchdays(seasonId,newRoundId,resetRounds)})};ctrl.setMatchdays=function(seasonId,roundId,resetMatchday){$scope.gameplan.loading=true;if(!angular.isDefined(seasonId)){return $scope.competition.$promise.then(function(competition){return ctrl.setMatchdays(competition.current_season_id,roundId,resetMatchday)})}$scope.matchdays.loading=true;$scope.groups.loading=true;SportData.getRound(roundId).then(function(round){$scope.displayLinkToStandings=~~round.round_mode.id===SportData.ROUND_MODE.LEAGUE;switch(parseInt(round.round_mode.id,10)){case SportData.ROUND_MODE.LEAGUE:ctrl.setMatchdaysForLeague(seasonId,roundId,resetMatchday);break;case SportData.ROUND_MODE.KO:case SportData.ROUND_MODE.DOUBLE_KO:ctrl.setMatchdaysForKo(seasonId,roundId,resetMatchday);break;case SportData.ROUND_MODE.PLAYOFF:ctrl.setMatchdaysForPlayoff(seasonId,roundId,resetMatchday);break}})};ctrl.setMatchdaysForLeague=function(seasonId,roundId,resetMatchday){return SportData.getRoundsBySeason(seasonId).then(function(season){var firstGroup=$filter("keyValueFilter")(season.round,function(round){return+round.id===+roundId})[0];var groups=$filter("keyValueFilter")(season.round,{round_order:firstGroup.round_order});if(!groups.length){$scope.gameplan.loading=false;return Flash.error("gac_err_2","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getRoundsBySeason` in ctrl.setMatchdaysForLeague")}while($scope.matchdays.length){$scope.matchdays.pop()}var newMatchdayId;if(groups.length>1){newMatchdayId=ctrl.setMatchdaysForLeagueAsGroups(groups,resetMatchday)}else if(groups[0].name==="Platzierungsrunde"){newMatchdayId=ctrl.setMatchdaysForLeagueAsGroups(groups,resetMatchday,true)}else{newMatchdayId=ctrl.setMatchdaysForLeagueAsSingle(groups,resetMatchday)}return ctrl.setGameplan(seasonId,roundId,newMatchdayId)})};ctrl.setMatchdaysForLeagueAsSingle=function(groups,resetMatchday){if(!groups.length){$scope.gameplan.loading=false;return Flash.error("gac_err_3","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid Call of method ctrl.setMatchdaysForLeagueAsSingle","no groups available")}var round=groups[0];$scope.currentGroup=round;ctrl.popups.matchday.label=round.name;angular.forEach($scope.popups,function(popup){if(popup.id==="matchday"){popup.label=round.name}});var newMatchdayId=resetMatchday?round.current_matchday:$route.current.params.matchdayId||round.current_matchday;if(!angular.isDefined(round.matchdays_extended)){round.matchdays_extended=[]}angular.forEach(round.matchdays_extended,function(item){var matchdayName=item.name;if(round.name==="Spielwoche"){matchdayName=item.matchday+". Woche ("+item.start_date.substr(0,6)+" - "+item.end_date.substr(0,6)+")"}$scope.matchdays.push({matchday:item.matchday,name:matchdayName});if(parseInt(item.matchday,10)===parseInt(newMatchdayId,10)){$scope.currentMatchday={matchday:item.matchday,name:matchdayName}}});$scope.matchdays.loading=false;$scope.popups=$scope.popups.filter(function(item){return item.id!=="round"&&item.id!=="group"});if(!~$scope.popups.indexOf(ctrl.popups.matchday)){$scope.popups.push(ctrl.popups.matchday)}return newMatchdayId};ctrl.setMatchdaysForLeagueAsGroups=function(groups,resetMatchday,hideMatchdays){$scope.gameplan.data={groups:groups};$scope.groups=groups;var groupId=$route.current.params.groupId;if(groupId){$scope.currentGroup=$filter("keyValueFilter")($scope.groups,{id:groupId})}if(angular.isDefined($scope.currentGroup)&&$scope.currentGroup.length){$scope.currentGroup=$scope.currentGroup[0]}else{$scope.currentGroup=groups[0]}if(!hideMatchdays){if(!~$scope.popups.indexOf(ctrl.popups.group)){$scope.popups.push(ctrl.popups.group)}}else{$scope.popups=$filter("keyValueFilter")($scope.popups,function(element){return!~["matchday","group"].indexOf(element.id)})}var roundMatchdays=$scope.currentRound.group_matchdays_extended||$scope.currentRound.matchdays_extended;var currentRoundMatchday=$scope.currentRound.current_group_matchday||$scope.currentRound.current_matchday;var newMatchdayId=0;if(angular.isDefined(roundMatchdays)){newMatchdayId=parseInt(currentRoundMatchday,10)||parseInt(roundMatchdays.length,10)}if(!resetMatchday){newMatchdayId=$route.current.params.matchdayId||newMatchdayId}$scope.groups.loading=false;return newMatchdayId};ctrl.setMatchdaysForKo=function(seasonId,roundId){while($scope.groups.length){$scope.groups.pop()}$scope.currentGroup=undefined;var groupPopupInd=$scope.popups.indexOf(ctrl.popups.group);if(groupPopupInd>=0){$scope.popups.splice(groupPopupInd,1)}while($scope.matchdays.length){$scope.matchdays.pop()}$scope.currentMatchday={};$scope.popups=$filter("keyValueFilter")($scope.popups,function(element){return element.id!=="matchday"});if($filter("keyValueFilter")($scope.popups,{id:"round"}).length===0){$scope.popups.push(ctrl.popups.round)}$scope.groups.loading=false;return ctrl.setGameplan(seasonId,roundId,-1)};ctrl.setMatchdaysForPlayoff=function(seasonId,roundId,resetMatchday){return ctrl.setMatchdaysForKo(seasonId,roundId,resetMatchday)};ctrl.setGameplan=function(seasonId,roundId,matchdayId,abortMission){$scope.gameplan.loading=true;$scope.gameplan.data={};if(angular.isDefined(seasonId)&&angular.isDefined(matchdayId)){var $promise;SportData.getRound(roundId).then(function(round){switch(parseInt(round.round_mode.id,10)){case SportData.ROUND_MODE.LEAGUE:$promise=ctrl.setGameplanForLeague(seasonId,roundId,matchdayId);break;case SportData.ROUND_MODE.KO:case SportData.ROUND_MODE.DOUBLE_KO:$promise=ctrl.setGameplanForKo(seasonId,roundId,matchdayId);break;case SportData.ROUND_MODE.PLAYOFF:$promise=ctrl.setGameplanForPlayoff(seasonId,roundId,matchdayId);break}if($promise){$promise.then(function(){ctrl.setGroupTimes();ctrl.setTeamLogos();ctrl.setTeamScore();ctrl.setTickerLinks();Flash.clear({id:"gac_err_"});$scope.gameplan.loading=false})}})}else if(!abortMission){if(angular.isDefined(seasonId)){return SportData.getSeason(seasonId).then(function(season){var _seasonId=season.id;var _roundId=season.current_round_id;return SportData.getRound(_roundId).then(function(round){var _matchdayId=+round.current_matchday||-1;return ctrl.setGameplan(_seasonId,_roundId,_matchdayId,true)})})}else{return $scope.competition.$promise.then(function(competition){var _seasonId=angular.isDefined(seasonId)?seasonId:competition.current_season_id;var _roundId=angular.isDefined(roundId)?roundId:competition.current_round_id;var _matchdayId=angular.isDefined(matchdayId)?matchdayId:competition.current_matchday;return ctrl.setGameplan(_seasonId,_roundId,_matchdayId,true)})}}};ctrl.setGameplanForLeague=function(seasonId,roundId,matchdayId){var deferred=$q.defer();SportData.getRoundsBySeason(seasonId).then(function(season){var groups=$filter("keyValueFilter")(season.round,function(round){return parseInt(round.round_mode.id,10)===SportData.ROUND_MODE.LEAGUE});if(!groups.length){$scope.gameplan.loading=false;deferred.reject();return Flash.error("gac_err_4","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getRoundsBySeason` in ctrl.setGameplanForLeague")}var $promise;if(groups.length>1){$promise=ctrl.setGameplanForLeagueAsGroups(seasonId,roundId,matchdayId)}else{$promise=ctrl.setGameplanForLeagueAsSingle(seasonId,roundId,matchdayId)}$promise.then(function(){deferred.resolve()})});return deferred.promise};ctrl.setGameplanForLeagueAsSingle=function(seasonId,roundId,matchdayId){var deferred=$q.defer();$scope.gameplan.options.layout="default";$element.removeClass("s1-layout-playoffs").addClass("s1-layout-default");SportData.getSystemDate().then(function(now){SportData.getGameplanByMatchday($scope.competition.id,seasonId,matchdayId).then(function(data){if(angular.isDefined(data.round)){var matches;if(angular.isDefined(roundId)){matches=$filter("keyValueFilter")(data.round,{id:roundId})}else{matches=data.round}if(matches.length){matches=matches[0].match}else{$scope.gameplan.loading=false;deferred.reject();return Flash.error("gac_err_5","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getGameplanByMatchday` in ctrl.setGameplanForLeague")}ctrl.setLiveStatusForMatches(matches,now);$scope.gameplan.data.content=$filter("groupMatchesByStartTime")(matches);angular.forEach($scope.gameplan.data.content,function(dateGroup){var liveMatches=$filter("keyValueFilter")(dateGroup.matches,{isLive:true});dateGroup.isLive=liveMatches.length>0});deferred.resolve()}else{$scope.gameplan.loading=false;deferred.reject();return Flash.error("gac_err_6","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getGameplanByMatchday` in ctrl.setGameplanForLeague")}})});return deferred.promise};ctrl.setGameplanForLeagueAsGroups=function(seasonId){var deferred=$q.defer();SportData.getSystemDate().then(function(now){SportData.getGameplanByRound($scope.competition.id,seasonId,$scope.currentGroup.id).then(function(group){if(angular.isDefined(group)){var matches=group.match;ctrl.setLiveStatusForMatches(matches,now);angular.forEach(group.content,function(dateGroup){var liveMatches=$filter("keyValueFilter")(dateGroup.matches,{isLive:true});dateGroup.isLive=liveMatches.length>0});$scope.gameplan.data.content=$filter("groupMatchesByStartTime")([].concat(matches));deferred.resolve()}else{$scope.gameplan.loading=false;deferred.reject();return Flash.error("gac_err_8","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getGameplanByMatchday` in ctrl.setGameplanForTournament")}})});return deferred.promise};ctrl.setGameplanForKo=function(seasonId,roundId){var deferred=$q.defer();$scope.gameplan.options.layout="default";$element.removeClass("s1-layout-playoffs").addClass("s1-layout-default");SportData.getSystemDate().then(function(now){SportData.getGameplanByRound($scope.competition.id,seasonId,roundId).then(function(round){var matches=round.match;ctrl.setLiveStatusForMatches(matches,now);$scope.gameplan.data={content:$filter("groupMatchesByStartTime")([].concat(matches))};angular.forEach($scope.gameplan.data.content,function(dateGroup){var liveMatches=$filter("keyValueFilter")(dateGroup.matches,{isLive:true});dateGroup.isLive=liveMatches.length>0});deferred.resolve()})});return deferred.promise};ctrl.setGameplanForPlayoff=function(seasonId,roundId){var deferred=$q.defer();$scope.gameplan.options.layout="playoffs";$element.removeClass("s1-layout-default").addClass("s1-layout-playoffs");SportData.getSystemDate().then(function(now){SportData.getGameplanByRound($scope.competition.id,seasonId,roundId).then(function(round){var matches=round.match;ctrl.setLiveStatusForMatches(matches,now);var playoffGroups=$filter("groupPlayoffsByTeams")(matches);$scope.gameplan.data.groups=[];for(var i=0;i<playoffGroups.length;i++){var group=playoffGroups[i];group.content=$filter("groupMatchesByStartTime")(group.matches);$scope.gameplan.data.groups.push(group);deferred.resolve()}})});return deferred.promise};ctrl.setLiveStatusForMatches=function(matches,now){for(var i=0;i<matches.length;i++){var match=matches[i];var isoDate=Sport1Tools.getDate(match.match_date,match.match_time);if(isNaN(isoDate.getTime())){match._isoDate=null;match._hasStarted=false;match.isLive=false}else{match._isoDate=isoDate;match._hasStarted=now>=isoDate;match.isLive=match._hasStarted&&match.finished==="no"}}};ctrl._buildLocationPath=function(params){return $scope.competition.$promise.then(function(){var path="";if(params.seasonId){path+="/saison/"+params.seasonId}if(params.roundId){path+="/runde/"+params.roundId}if(params.groupId){path+="/gruppe/"+params.groupId}if(params.matchdayId){path+="/spieltag/"+params.matchdayId}return path})};ctrl._updateLocationPath=function(params){ctrl._buildLocationPath(params).then(function(path){$location.path(path)})};ctrl.setGroupTimes=function(){angular.forEach($scope.gameplan.data.content,function(matchGroup){matchGroup._startTime=Sport1Tools.getDateFromGermanDateTime(matchGroup.date,matchGroup.time)});angular.forEach($scope.gameplan.data.groups,function(roundGroup){angular.forEach(roundGroup.content,function(matchGroup){matchGroup._startTime=Sport1Tools.getDateFromGermanDateTime(matchGroup.date,matchGroup.time)})})};ctrl.setTeamLogos=function(){angular.forEach($scope.gameplan.data.content,function(matchGroup){if(!matchGroup.matches.length){return false}angular.forEach(matchGroup.matches,function(match){if(angular.isDefined(match.home)){SportData.setTeamLogo(match.home,"60x60")}if(angular.isDefined(match.away)){SportData.setTeamLogo(match.away,"60x60")}})});angular.forEach($scope.gameplan.data.groups,function(group){if(angular.isDefined(group.home)){SportData.setTeamLogo(group.home,"100x100")}if(angular.isDefined(group.away)){SportData.setTeamLogo(group.away,"100x100")}})};ctrl.setTeamScore=function(){angular.forEach($scope.gameplan.data.content,function(matchGroup){if(!matchGroup.matches.length){return false}angular.forEach(matchGroup.matches,function(match){var resultHomeFinal=$filter("keyValueFilter")(match.match_result,{match_result_at:"0",place:"home"});var resultAwayFinal=$filter("keyValueFilter")(match.match_result,{match_result_at:"0",place:"away"});if(resultHomeFinal.length&&resultAwayFinal.length){match._result=resultHomeFinal[0].match_result+" : "+resultAwayFinal[0].match_result}})})};ctrl.setTickerLinks=function(){angular.forEach($scope.gameplan.data.content,function(matchGroup){if(!matchGroup.matches.length){return false}angular.forEach(matchGroup.matches,function(match){SportData.setLinkForMatch(match,$scope.competition,$scope.competition.sport.id)})});if(angular.isDefined($scope.gameplan.data.groups)){angular.forEach($scope.gameplan.data.groups,function(matchGroup){angular.forEach(matchGroup.content,function(groupContent){if(!groupContent.matches.length){return false}angular.forEach(groupContent.matches,function(match){SportData.setLinkForMatch(match,$scope.competition,$scope.competition.sport.id)})})})}};$scope.$watch("currentSeason",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){ctrl._updateLocationPath({seasonId:newValue.id})}});$scope.$watch("currentRound",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){ctrl._updateLocationPath({seasonId:angular.isDefined($scope.currentSeason)?$scope.currentSeason.id:undefined,roundId:angular.isDefined(newValue)?newValue.id:undefined,groupId:undefined})}});$scope.$watch("currentMatchday",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){ctrl._updateLocationPath({seasonId:angular.isDefined($scope.currentSeason)?$scope.currentSeason.id:undefined,roundId:angular.isDefined($scope.currentRound)?$scope.currentRound.id:undefined,matchdayId:newValue.matchday})}});$scope.$watch("currentGroup",function(newVal,oldVal){if(angular.isDefined(oldVal)&&newVal!==oldVal){ctrl._updateLocationPath({seasonId:angular.isDefined($scope.currentSeason)?$scope.currentSeason.id:undefined,roundId:angular.isDefined($scope.currentRound)?$scope.currentRound.id:undefined,groupId:angular.isDefined(newVal)?newVal.id:undefined})}});$scope.$on("$routeChangeSuccess",function(event,current,prev){if(!prev){ctrl.initCompetition()}else{if(angular.isDefined(current.params.matchdayId)){ctrl.setGameplan(current.params.seasonId,current.params.roundId,current.params.matchdayId)}else if(angular.isDefined(current.params.roundId)){ctrl.setMatchdays(current.params.seasonId,current.params.roundId,true)}else if(angular.isDefined(current.params.seasonId)){ctrl.setRounds(current.params.seasonId,true)}else{ctrl.initCompetition()}}})}]);angular.module("genericWidgetApp",["sport1.templates","ngTouch","ngResource","ngSanitize","ngAnimate","sport1.controllers","sport1.directives","sport1.filters","sport1.services"]).config(["$interpolateProvider",function($interpolateProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]")}]).run(["gaService",function(gaService){"use strict";gaService.initTracking()}]);appControllers.controller("LiveTeaserAppCtrl",["$controller","$rootScope","$scope","$filter","sportDataService","graphicService",function($controller,$rootScope,$scope,$filter,SportData,graphicService){"use strict";$controller("BaseController",{$rootScope:$rootScope});$scope.competitionId=-1;$scope.today=null;$scope.details=null;$scope.otherMatches=null;$scope.enabled=false;$scope.competition={};$scope.links={};var ctrl=this;var isFmPopUpHandlerSet=false;var fmPopUpHandlerFC=1e3*60*60*24;$scope.getOtherMatches=function(){return $scope.otherMatches};ctrl._getLiveCompetitions=function(competitionId){SportData.getCompetition(competitionId).then(function(competition){SportData.getRound(competition.current_round_id).then(function(round){var $gameplanPromise;switch(competition._type){case SportData._COMPETITION_TYPE.LEAGUE:$gameplanPromise=SportData.getGameplanByMatchday(competition.id,competition.current_season,competition.current_matchday);break;case SportData._COMPETITION_TYPE.TOURNAMENT:if(parseInt(round.round_mode.id,10)===SportData.ROUND_MODE.LEAGUE){$gameplanPromise=SportData.getGameplanByGroupMatchday(competition.id,round.season.id,round.season.current_group_matchday)}else{$gameplanPromise=SportData.getGameplanByRound(competition.id,round.season.id,round.id)}break}if(angular.isDefined($gameplanPromise)){$gameplanPromise.then(function(gameplan){ctrl.setMatches(gameplan,competition,round)})}})})};ctrl.setMatches=function(gameplan,competition,round){SportData.getSystemDate().then(function(now){var matches=$filter("getMatchesForLiveTeaser")(gameplan,now,$scope.matchesMeta);var matchesToDisplay=[];$scope.audioExists=false;angular.forEach(matches,function(match){SportData.getMatchStatus(match).then(function(){match._isFinished=match.finished==="yes";match.isLive=match._isLive});SportData.setTeamLogo(match.home,"50x50");SportData.setTeamLogo(match.away,"50x50");SportData.setLinkForMatch(match,competition,competition.sport.id);if(match._fmLink){$scope.audioExists=true}if(!window.s1IsMobileDomain&&!isFmPopUpHandlerSet&&match._fmLink){isFmPopUpHandlerSet=true;jQuery(document).bind("click",function f(){var lastPopup=parseInt(localStorage.s1FmLastPopup,10),now=(new Date).getTime(),popup;if(lastPopup&&now-lastPopup<fmPopUpHandlerFC){return}popup=Sport1Tools.openFmPopup({href:"//www.sport1.fm/fm-popup-audio-player"});localStorage.s1FmLastPopup=now;if(popup){jQuery(document).unbind("click",f)}})}matchesToDisplay.push(match)});matchesToDisplay=$filter("orderBy")(matchesToDisplay,function(match){var date=Sport1Tools.getDate(match.match_date,match.match_time);if(angular.isDate(date)){return date.getTime()}return 0});if(matchesToDisplay.length>0){$scope.enabled=true;$scope.details=competition;$scope.details._title=round.name;$scope.details.logo=graphicService.getCompetitionIconUrl(competition.id,"50");$scope.displayTable=matchesToDisplay.length!==2}else{$scope.error=true}$scope.otherMatches=matchesToDisplay})};$scope.openLink=function(event,url){event.preventDefault();window.open(url)};$scope.initVars=function(config){var competitionId=config.competitionId;$scope.links.conferenceTicker="/live-ticker/"+competitionId;$scope.links.standing="/tabelle/"+competitionId;$scope.links.gameplan="/spielplan/"+competitionId;$scope.matchesMeta=config.matchesMeta;SportData.getCompleteGameplan(competitionId,config.sportId).then(function(gameplan){if(gameplan instanceof Array&&gameplan.length){gameplan=gameplan[0];$scope.competition=angular.extend($scope.competition,gameplan.competition);ctrl.setMatches(gameplan,gameplan.competition,gameplan.round[0])}else{$scope.error=true}},function(){$scope.error=true})}}]);appControllers.controller("LiveTeaserSmallAppCtrl",["$controller","$rootScope","$scope","sportDataService","graphicService",function($controller,$rootScope,$scope,sportDataService,graphicService){"use strict";$controller("BaseController",{$rootScope:$rootScope});var now,timePadding=15*60*1e3;$scope.sport="";$scope.competitionId=-1;$scope.liveEvents=null;$scope.firstEvent=null;$scope.isOpen=false;$scope.enabled=false;function transformer(competition){return function transform(match,comp){if(!competition&&comp){competition=comp}if(comp.sport_id&&competition){competition=comp}if(!comp&&competition.gender==="female"){competition.name+=" (Frauen)"}var matchName="",homeName,awayName,matchStart;if(!match.isLive){if(match.finished==="yes"){if(!match.current_period_start||now-Sport1Tools.getDateTime(match.current_period_start)>timePadding){return}}else{matchStart=Sport1Tools.getDate(match.match_date,match.match_time);if(now<matchStart&&matchStart-now>timePadding){return}}}if(match.home){homeName=Sport1Tools.isMobileSite()&&match.home.shortname||match.home.name;awayName=Sport1Tools.isMobileSite()&&match.away.shortname||match.away.name;matchName=homeName+" : "+awayName}else{matchName=match.venue.name}var ev={id:match.id,channel:competition.name,icon:graphicService.getCompetitionIconUrl(competition.id,"50",competition.sport_id,competition.gender),matchName:matchName,startTime:match.match_time,gender:competition.gender,live_status:match.live_status,home:match.home,away:match.away};sportDataService.setLinkForMatch(ev,competition,competition.sport_id);return ev}}function sort(a,b){if(a.startTime==="unknown"){return 1}else if(b.startTime==="unkown"){return-1}var time1=parseFloat(a.startTime.replace(":",".").replace(/[^\d.-]/g,""));var time2=parseFloat(b.startTime.replace(":",".").replace(/[^\d.-]/g,""));return time1-time2}function start(events){if(events.length>0){$scope.enabled=true;events.sort(sort);$scope.firstEvent=events[0]}$scope.liveEvents=events.slice(0,10);$scope.$broadcast("start-text-rotation")}$scope.toggle=function($event){$scope.isOpen=!$scope.isOpen;$event.preventDefault()};$scope.doAutoRotation=function(){return!$scope.isOpen};$scope.getLiveEvents=function(methodName,param){sportDataService[methodName](param).then(function(response){var items=[];response.forEach(function(competition){var season=competition.season,transform=transformer(competition);if(angular.isArray(season)&&season.length>0){season=season[0]}season.round.forEach(function(round){if(!round.match){return}items=items.concat(round.match.map(transform).filter(angular.identity))})});start(items)})};function _prepareGet(){if(-1===$scope.sport&&-1===$scope.competitionId){$scope.getLiveEvents("getCurrentLiveEvents",null)}else if($scope.sport!==-1&&-1===$scope.competitionId){$scope.getLiveEvents("getLiveEventsInSport",$scope.sport)}else if(-1!==$scope.competitionId){$scope.getLiveEvents("getLiveEventsInLeague",$scope.competitionId)}}function loadMatches(matchesMeta,fallback){if(!matchesMeta||!matchesMeta.length){return fallback()}var transform=transformer();var map={};matchesMeta.forEach(function(m){map[m.matchId]=m});sportDataService.getMatches(matchesMeta.map(function(m){return m.matchId})).then(function(matches){if(!matches.length){return fallback()}start(matches.map(function(match){return transform(match,{id:map[match.id].competitionId,sport_id:map[match.id].sportId,name:map[match.id].competitionName,gender:map[match.id].competitionGender})}).filter(angular.identity))},fallback)}$scope.initVars=function(config){$scope.sport=config.sport;$scope.competitionId=config.competitionId;
sportDataService.getSystemDate().then(function(time){now=time;loadMatches(config.matchesMeta,_prepareGet)})}}]);angular.module("liveTickerApp",["ngResource","ngRoute","ngSanitize","ngAnimate","sport1.controllers","sport1.directives","sport1.filters","sport1.services","sport1.templates"]).config(["$interpolateProvider","$routeProvider",function($interpolateProvider,$routeProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]");$routeProvider.when("/",{templateUrl:"common/angularjs/apps/live-ticker/templates/ticker.html"}).when("/:matchId/:tabId",{templateUrl:"common/angularjs/apps/live-ticker/templates/ticker.html"}).when("/:tabId",{templateUrl:"common/angularjs/apps/live-ticker/templates/ticker.html"}).otherwise({redirectTo:"/"})}]);(function(){"use strict";var LiveTickerAppCtrl,dependencies;dependencies=["$controller","$rootScope","$scope","$element","$route","$location","$q","$filter","$timeout","$sce","sportDataService","tickerService","liveTickerTimerService","graphicService","FlashService","lineupService"];LiveTickerAppCtrl=function($controller,$rootScope,$scope,$element,$route,$location,$q,$filter,$timeout,$sce,SportData,TickerService,TimerService,GraphicService,Flash,lineupService){LiveTickerAppCtrl=function(){var ctrl,vm;$controller("BaseController",{$rootScope:$rootScope});vm={};ctrl={};ctrl.VALID_SPORTS_FOR_SCORERS=[SportData.SPORT_ID.SOCCER,SportData.SPORT_ID.ICEHOCKEY];ctrl.initWatchers=function(){$scope.$on("$routeChangeSuccess",function(event,current){var newMatchId,newTabId,ref,ref1,ref2,ref3;newMatchId=+((ref=current.params.matchId)!=null?ref:ctrl.initialMatchId);newTabId=(ref1=current.params.tabId)!=null?ref1:(ref2=vm.tabs[0])!=null?ref2.path:void 0;if(newMatchId!==vm.matchId){ctrl.changeMatch(vm.competitionId,newMatchId)}if(newTabId!=null&&vm.currentTab!=null&&newTabId!==vm.currentTab.path){vm.currentTab=(ref3=ctrl.tabs[newTabId])!=null?ref3:vm.tabs[0];vm.templateUrl=vm.currentTab.templateUrl}});return $scope.$watch("vm.currentTab",function(newValue,oldValue){var firstId,lastId,params,ref;if(Number(newValue!=null?newValue.id:void 0)===ctrl.tabs.telegramm.id){vm.telegram=true}if(Number(newValue!=null?newValue.id:void 0)===ctrl.tabs.spielverlauf.id){vm.telegram=false}if(newValue!==oldValue){if(oldValue!=null){if(newValue.id<oldValue.id){vm.animationClass="s1-animation-slide-ltr"}else{vm.animationClass="s1-animation-slide-rtl"}if(Sport1Tools.isMobileSite()){firstId=vm.tabs[0].id;lastId=vm.tabs[vm.tabs.length-1].id;if(newValue.id===firstId&&oldValue.id===lastId){vm.animationClass="s1-animation-slide-rtl"}else if(newValue.id===lastId&&oldValue.id===firstId){vm.animationClass="s1-animation-slide-ltr"}}}params=angular.copy($route.current.params);params.matchId=(ref=params.matchId)!=null?ref:vm.matchId;params.tabId=newValue.path;ctrl.updateLocationPath(params);vm.templateUrl=vm.currentTab.templateUrl;if(Number(newValue.id)===30){return ctrl.loadLineup()}}})};function LiveTickerAppCtrl(){vm=this;vm.app={init:false,ticker:{loading:true},lineup:{loading:false},stats:{loading:true}};vm.busy=false;ctrl.tabs={spielverlauf:{title:"Spielverlauf",id:0,path:"spielverlauf",templateUrl:"common/angularjs/apps/live-ticker/templates/ticker.html",headerCssClass:"",enabled:true,visible:true},telegramm:{title:"Telegramm",id:5,path:"telegramm",templateUrl:"common/angularjs/apps/live-ticker/templates/ticker.html",headerCssClass:"",enabled:true,visible:true},tabelle:{title:"Tabelle",id:10,path:"tabelle",templateUrl:"common/angularjs/apps/live-ticker/templates/standings.html",headerCssClass:"",enabled:true,visible:false},spielplan:{title:"Spielplan",id:20,path:"spielplan",templateUrl:"common/angularjs/apps/live-ticker/templates/gameplan.html",headerCssClass:"",enabled:true,visible:false},aufstellung:{title:"Aufstellung",id:30,path:"aufstellung",templateUrl:(Sport1Tools.isMobileSite()?"mobile":"desktop")+"/angularjs/apps/live-ticker/templates/lineup.html",headerCssClass:"s1-live-ticker-header-setup",enabled:false,visible:false},statistik:{title:"Statistik",id:40,path:"statistik",templateUrl:(Sport1Tools.isMobileSite()?"mobile":"desktop")+"/angularjs/apps/live-ticker/templates/statistics.html",headerCssClass:"s1-live-ticker-header-statistics",enabled:false,visible:false}};ctrl.models={team:{lineup:[],bench:[],coach:[],statistics:{},scorers:[],scorersPso:[]}};vm.tabs=[];ctrl.tickerData=[];vm.tickerData=[];vm.animationClass="s1-animation-fade";ctrl.initWatchers()}LiveTickerAppCtrl.prototype.initVars=function(config){var ref;$.extend(vm,config);if(typeof vm.embedCode==="string"){vm.embedCode=$sce.trustAsHtml(vm.embedCode)}if(Sport1Tools.isMobileSite()){ctrl.setTabVisible("spielplan",true)}vm.gtmTrack("view",(ref=vm.presenting)!=null?ref.trackingCode:void 0);vm.manualRefreshDisabled=true;ctrl.initialMatchId=vm.matchId;ctrl.isTeamLiveticker=location.pathname.search("team")!==-1;return SportData.getCompetition(vm.competitionId).then(function(competition){var ref1;vm.competition=competition;if(ref1=+competition.sport.id,window.indexOf.call(SportData.VALID_SPORTS_FOR_MATCH_LINKS,ref1)>=0){vm.conferenceTickerUrl="/live-ticker/"+vm.competitionId}$element.addClass("s1-live-ticker");$element.addClass("s1-"+vm.competition._sport+"-live-ticker");$element.addClass("s1-"+vm.competition._type+"-live-ticker");TimerService.registerCallback(ctrl._timerCallback);vm.canRefresh=TimerService.canRefresh;return vm.refresh()})};LiveTickerAppCtrl.prototype.gtmTrack=function(action,label){var ref;if(!label||!action){return}if((ref=window.dataLayer)!=null){ref.push({event:"ga_event",eventCategory:"Ad",eventAction:action,eventLabel:label})}};LiveTickerAppCtrl.prototype.refresh=function($event){if($event!=null){$event.preventDefault()}if(vm.app.init&&(vm.app.ticker.loading||vm.app.lineup.loading||vm.app.stats.loading)){return false}$scope.$broadcast("live-ticker-refresh");vm.app.lineup.loading=false;vm.app.stats.loading=true;vm.app.init=true;TimerService.stopTimer();TimerService.resetTime(true);if(vm.matchId!=null){return ctrl.changeMatch(vm.competition.id,vm.matchId)}};ctrl.loadLineup=function(){if(vm.hasOwnProperty("teams")&&vm.teams!==null){lineupService.calculatePlayerPositions(vm.teams.home.lineup,true);lineupService.calculatePlayerPositions(vm.teams.away.lineup,false);vm.app.lineup.loading=false}};ctrl.changeMatch=function(competitionId,matchId){var $promises;vm.competitionId=competitionId;vm.matchId=matchId;vm.teams={home:angular.copy(ctrl.models.team),away:angular.copy(ctrl.models.team)};$promises={};$promises.match=SportData.getMatch(vm.matchId);$promises.liveticker=SportData.getMatchTicker(vm.competitionId,vm.matchId);return $q.all($promises).then(ctrl.setMatch)};ctrl.setMatch=function(data){var hasLivetickerData;vm.matchData=data.match;hasLivetickerData=!!data.liveticker.length;if(!hasLivetickerData){vm.displayConfTickerLink=false;SportData.getMatchEvents(vm.matchId).then(function(events){var hasTelegramEvents;hasTelegramEvents=events.filter(function(event){return event.action!=="coaching"});ctrl.addTab(ctrl.tabs.telegramm);if(hasTelegramEvents.length){vm.currentTab=ctrl.tabs.telegramm}else{ctrl.addTab(ctrl.tabs.spielverlauf);vm.currentTab=ctrl.tabs.spielverlauf}})}else{ctrl.addTab(ctrl.tabs.spielverlauf);ctrl.addTab(ctrl.tabs.telegramm);var tabId=$route.current.params.tabId;vm.currentTab=ctrl.tabs[tabId]||ctrl.tabs.spielverlauf;vm.displayConfTickerLink=true}SportData.getMatchStatus(vm.matchData);angular.extend(vm.teams.home,vm.matchData.home);SportData.setTeamDetails(vm.teams.home,vm.competition);TickerService.setHomeTeam(vm.teams.home);angular.extend(vm.teams.away,vm.matchData.away);SportData.setTeamDetails(vm.teams.away,vm.competition);TickerService.setAwayTeam(vm.teams.away);vm.matchStart=new Date(vm.matchData._isoDate);vm.manualRefreshDisabled=true;return SportData.getRound(vm.matchData.round_id).then(function(round){var currentGroups,ref;vm.displayStandings=~~round.round_mode.id===SportData.ROUND_MODE.LEAGUE;if(Sport1Tools.isMobileSite()){ctrl.setTabVisible("tabelle",vm.displayStandings)}if(Number(round.round_mode.id)===SportData.ROUND_MODE.LEAGUE&&Number(round.current_matchday)===0){currentGroups=[];SportData.getRoundBySeason(round.season.id).then(function(season){var r,ref,ref1;currentGroups=function(){var i,len,ref,results;ref=season.round;results=[];for(i=0,len=ref.length;i<len;i++){r=ref[i];if(Number(r.round_order)===Number(round.round_order)){results.push(r)}}return results}();if(ref=Number(vm.competition.sport.id),window.indexOf.call(SportData.VALID_SPORTS_FOR_CONFERENCE_LINKS,ref)>=0){vm.displayAsideLinks=(ref1=vm.competition.current_round_id,window.indexOf.call(currentGroups,ref1)>=0)&&+season.current_group_matchday===vm.matchData.group_matchday}})}else{if(ref=Number(vm.competition.sport.id),window.indexOf.call(SportData.VALID_SPORTS_FOR_CONFERENCE_LINKS,ref)>=0){vm.displayAsideLinks=+vm.competition.current_round_id===+round.id&&+vm.competition.current_matchday===+vm.matchData.matchday}if(vm.competition._type===SportData._COMPETITION_TYPE.LEAGUE){vm.matchData._matchdayText=(vm.matchData.matchday||vm.matchData.group_matchday)+". "+round.name}else{vm.matchData._matchdayText=round.name}}ctrl.setTeamStatistics(vm.matchId);ctrl.setTeamPlayers(vm.matchId);$scope.$broadcast("reloadLiveTicker",vm.competitionId,vm.matchId);return TimerService.startTimer()})};ctrl._timerCallback=function(ms){return $scope.$evalAsync(function(){var diff;diff=(vm.matchStart.getTime()-(new Date).getTime())/1e3/60;if(diff>30||vm.matchData.finished==="yes"){vm.manualRefreshDisabled=true}else{vm.manualRefreshDisabled=false;vm.timeSinceUpdate=ms}})};ctrl.addTab=function(tab){vm.tabs.push(tab);return vm.tabs.sort(function(a,b){return a.id-b.id})};ctrl.setTabVisible=function(tabPath,status){var ref,tab;if(status){if(ref=ctrl.tabs[tabPath],window.indexOf.call(vm.tabs,ref)<0){ctrl.addTab(ctrl.tabs[tabPath])}}else{vm.tabs=function(){var i,len,ref1,results;ref1=vm.tabs;results=[];for(i=0,len=ref1.length;i<len;i++){tab=ref1[i];if(tab.path!==tabPath){results.push(tab)}}return results}()}ctrl.setTabActive(tabPath,status);return vm.tabs.sort(function(a,b){return a.id-b.id})};ctrl.setTabActive=function(tabName,status){var tab;tab=function(){var i,len,ref,results;ref=vm.tabs;results=[];for(i=0,len=ref.length;i<len;i++){tab=ref[i];if(tab.path===tabName){results.push(tab)}}return results}();if(tab.length){tab[0].enabled=status}};ctrl.setTeamStatistics=function(matchId){var isMatchFinished,ref;if(Number(vm.competition.sport.id)!==SportData.SPORT_ID.SOCCER){ctrl.setTabVisible("aufstellung",false);vm.app.lineup.loading=false;ctrl.setTabVisible("statistik",false);vm.app.stats.loading=false;return false}else{ctrl.setTabVisible("aufstellung",true);ctrl.setTabVisible("statistik",true);isMatchFinished=((ref=vm.matchData)!=null?ref.finished:void 0)!=null&&vm.matchData.finished==="yes"?true:false;return SportData.getCompleteMatchTeamStats(vm.competition.id,vm.competition.sport.id,matchId,isMatchFinished).then(function(statistics){var hasValidStats;hasValidStats=statistics.length!==0;ctrl.setTabVisible("statistik",hasValidStats);vm.app.stats.loading=false})}};ctrl.getPlayer=function(playerId,teamId){var item,player,searchIn;if(+teamId===+vm.teams.home.id){searchIn=vm.teams.home.lineup.concat(vm.teams.home.bench)}else{searchIn=vm.teams.away.lineup.concat(vm.teams.away.bench)}player=function(){var i,len,results;results=[];for(i=0,len=searchIn.length;i<len;i++){item=searchIn[i];if(+item.id===+playerId){results.push(item)}}return results}();if(player.length){return player[0]}else{return false}};ctrl.setTeamPlayers=function(matchId){var promises;promises={};promises.events=SportData.getMatchEvents(matchId);promises.tacticals=SportData.getMatchTactical(matchId);$q.all(promises).then(function(response){var event,events,i,j,len,len1,person,player,ref,ref1,tactical,tacticals,team,updates;events=response.events;updates=[];tacticals=response.tacticals;for(i=0,len=events.length;i<len;i++){event=events[i];team=+((ref=event.team)!=null?ref.id:void 0)===+vm.teams.home.id?vm.teams.home:vm.teams.away;if(+event.minute===0){switch(event.action){case"playing":person=event.person;person.img=GraphicService.getPersonImgUrl(person.id,"s");SportData.setPersonDetails(person,vm.competition);switch(event.kind){case"lineup":team.lineup.push(person);break;case"bench":team.bench.push(person)}break;case"coaching":team.coach.push(event.person)}}else{updates.push(event)}}ctrl.setTabVisible("aufstellung",vm.teams.away.bench.length!==0&&vm.teams.home.bench.length!==0);if(updates.length){ctrl.updatePlayers(updates)}for(j=0,len1=tacticals.length;j<len1;j++){tactical=tacticals[j];if(!tactical.person){continue}player=ctrl.getPlayer(tactical.person.id,tactical.team.id);lineupService.setPlayerCoords(player,tactical);if((player!=null?(ref1=player.coords)!=null?ref1.x:void 0:void 0)==null||player.coords.y==null){player={coords:{x:0,y:0}};console.warn("player: "+tactical.person.name+" with person id: "+tactical.person.id+" has no coords -> replace with default coords")}}if(!tacticals.length){ctrl.setTabVisible("aufstellung",false)}if(Number(vm.currentTab.id)===30){return ctrl.loadLineup()}})};ctrl.updatePlayers=function(events){var classes,display,event,i,len,ownGoal,player,ref,ref1,ref10,ref11,ref12,ref2,ref3,ref4,ref5,ref6,ref7,ref8,ref9,results,team;results=[];for(i=0,len=events.length;i<len;i++){event=events[i];if(!~~event.minute||event.team_id!=null||event.person_id!=null){continue}if(event.person!=null){player=ctrl.getPlayer(event.person.id,event.team.id);player.events=(ref=player.events)!=null?ref:[]}switch(event.action){case"goal":ownGoal=event.kind==="own-goal";if(+event.team.id===+vm.teams.home.id){team=ownGoal?vm.teams.away:vm.teams.home}else{team=ownGoal?vm.teams.home:vm.teams.away}if(ref1=Number(vm.competition.sport.id),window.indexOf.call(ctrl.VALID_SPORTS_FOR_SCORERS,ref1)>=0){if((ref2=team.scorers)!=null){ref2.push({minute:+event.minute,name:((ref3=event.person)!=null?ref3.surname:void 0)+" "+(ownGoal?" (ET)":""),display:event.minute+"' "+((ref4=event.person)!=null?ref4.surname:void 0)+" "+(ownGoal?" (ET)":"")})}}results.push(player!=null?(ref5=player.events)!=null?ref5.push({minute:event.minute,type:event.kind==="own-goal"?event.kind:event.action}):void 0:void 0);break;case"playing":results.push(player!=null?(ref6=player.events)!=null?ref6.push({minute:event.minute,type:event.kind}):void 0:void 0);break;case"card":results.push(player!=null?(ref7=player.events)!=null?ref7.push({minute:event.minute,type:"card-"+event.kind}):void 0:void 0);break;case"pso":classes=["s1-pso-"+(event.kind==="goal"?"scored":"missed")];classes.push("s1-sport-"+SportData.getSportSlug(vm.competition.sport.name));if(Number(event.team.id)===Number(vm.teams.home.id)){team=vm.teams.home;classes.push("s1-pull-right");display=((ref8=event.person)!=null?ref8.surname:void 0)+' <i class="'+classes.join(" ")+'"></i>'}else{team=vm.teams.away;classes.push("s1-pull-left");display='<i class="'+classes.join(" ")+'"></i> '+((ref9=event.person)!=null?ref9.surname:void 0)}if(ref10=Number(vm.competition.sport.id),window.indexOf.call(ctrl.VALID_SPORTS_FOR_SCORERS,ref10)>=0){results.push((ref11=team.scorersPso)!=null?ref11.push({id:Number(event.id),minute:Number(event.minute),name:(ref12=event.person)!=null?ref12.surname:void 0,display:display}):void 0)}else{results.push(void 0)}break;default:results.push(void 0)}}return results};ctrl.updateLocationPath=function(params){var path;path="";if(!ctrl.isTeamLiveticker&&params.matchId!=null){path=path+"/"+params.matchId}if(params.tabId!=null){path=path+"/"+params.tabId}return $location.path(path)};return LiveTickerAppCtrl}();return new LiveTickerAppCtrl};LiveTickerAppCtrl.$inject=dependencies;return angular.module("sport1.controllers").controller("LiveTickerAppCtrl",LiveTickerAppCtrl)})();angular.module("motorsLiveTickerApp",["ngResource","ngRoute","sport1.controllers","sport1.directives","sport1.filters","sport1.services","sport1.templates"]).config(["$interpolateProvider","$routeProvider",function($interpolateProvider,$routeProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]");$routeProvider.when("/",{templateUrl:"common/angularjs/apps/motors-live-ticker.html"}).when("/:raceId/:tabId",{templateUrl:"common/angularjs/apps/motors-live-ticker.html"}).otherwise({redirectTo:"/"})}]);angular.module("motorsportsStandingsApp",["ngResource","ngRoute","sport1.controllers","sport1.directives","sport1.filters","sport1.services","sport1.templates"]).config(["$interpolateProvider",function($interpolateProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]")}]);angular.module("programManagerApp",["ngResource","ngRoute","sport1.controllers","sport1.filters","sport1.services","sport1.directives"]).config(["$interpolateProvider",function($interpolateProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]")}]);appControllers.controller("ProgramManagerMainController",["$controller","$rootScope","$scope","epgDataService","$interval","$timeout",function($controller,$rootScope,$scope,epgDataService,$interval,$timeout){"use strict";$controller("BaseController",{$rootScope:$rootScope});var MAX_DAYS=$scope.MAX_DAYS=6;var SCROLL_ELEMENT="#s1-program-manager-content .s1-scroll-view>div:first";var POP_UP_LINK="/fm-popup-audio-player";$scope.range=function(max){var input=[];for(var i=0;i<=max;i+=1){input.push(i)}return input};var today=new Date;$scope.program=null;$scope.startDate=null;$scope.actualDate=null;$scope.loading=true;$scope.activeItem=null;$scope.init=function(){$scope.startDate=$scope.actualDate=today;$scope.changeDay(today);$scope.endDate=$scope.addDays(MAX_DAYS);var promise=$interval(function(){if($scope.program&&$scope.program.content){$scope.checkActiveFlag(Date.now(),$scope.program.content)}},6e4);$scope.$on("$destroy",function(){$interval.cancel(promise)})};$scope.returnToBeginningWeek=function(){if($scope.isActualWeek()===false){$scope.changeWeek(true)}else if($scope.actualDate.getDate()!==today.getDate()){$scope.changeDay(today)}};$scope.isActualWeek=function(){return today.getDate()===$scope.startDate.getDate()};$scope.changeDay=function(date){if($scope.actualDate!==date&&window.ivwPI){window.ivwPI()}$scope.actualDate=date;$scope.getProgram($scope.actualDate)};$scope.changeWeek=function(back){var offset=MAX_DAYS+1,days=back?-offset:offset,date=$scope.addDays(days);$scope.changeDay(date);$scope.startDate=date;$scope.endDate=$scope.addDays(MAX_DAYS)};$scope.addDays=function(days){days=parseInt(days);if(isNaN(days)){throw"Argument is NaN"}var calcDate=new Date($scope.startDate);calcDate.setDate($scope.startDate.getDate()+days);return calcDate};$scope.checkActiveFlag=function(now,content){content.forEach(function(item){var startingTime=Sport1Tools.getDateTime(item.startzeit,"T").getTime();if(now>=startingTime){$scope.activeItem=item}})};var _scrollToActiveElement=function(){if($scope.activeItem){var position=$("#program-"+$scope.activeItem.id).position(),top=Sport1Tools.isMobileSite()?position.top-200:position.top;$(SCROLL_ELEMENT).animate({scrollTop:top},1500,"swing")}};$scope.getProgram=function(date){$scope.program=$scope.activeItem=null;$scope.loading=true;epgDataService.setBaseUrl("api");epgDataService.getFM(date).then(function(data){data.content=data.content.map(function(item){item.image=item.image.replace("http://assets.sport1.de","http://assets.sport1.de/imagix/filter2/jpeg/_set=dyn_size,width=190,height=120,focus=50x50/");return item});$scope.program=data;$scope.checkActiveFlag(Date.now(),$scope.program.content);$timeout(_scrollToActiveElement,500)}).finally(function(){$scope.loading=false})};$scope.changeWeekClick=function(){$scope.changeWeek(!$scope.isActualWeek())};$scope.selectDayClick=function(daysOffset){$scope.changeDay($scope.addDays(daysOffset))};$scope.selectClick=function(item){if(item===$scope.activeItem){Sport1Tools.deeplinking.openFmPopup({href:POP_UP_LINK})}};$scope.init()}]);appControllers.controller("ProgramManagerMobileController",["$controller","$rootScope","$scope","$filter",function($controller,$rootScope,$scope,$filter){"use strict";$controller("BaseController",{$rootScope:$rootScope});var generateDays=function(){return $scope.range($scope.MAX_DAYS).map(function(dayOffset,$index){var date=$scope.addDays(dayOffset),label=$index===0&&$scope.isActualWeek()?"Heute":$filter("date")(date,"EEEE");return{label:label,date:date,offset:dayOffset}})};$scope.activeWeek={label:$filter("date")($scope.startDate,"dd.MM")+"-"+$filter("date")($scope.endDate,"dd.MM")};$scope.weeks=[$scope.activeWeek,{label:$filter("date")($scope.addDays(7),"dd.MM")+"-"+$filter("date")($scope.addDays(13),"dd.MM")}];$scope.days=generateDays();$scope.activeDay=$scope.days[0];$scope.changeWeekClick=function(){$scope.$parent.changeWeekClick();$scope.days=generateDays();$scope.activeDay=$scope.days[0]};$scope.selectDayClick=function(item){$scope.$parent.selectDayClick(item.offset)}}]);angular.module("searchApp",["ngResource","ngRoute","sport1.controllers","sport1.directives","sport1.filters","sport1.services","sport1.templates"]).config(["$interpolateProvider",function($interpolateProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]")}]);appControllers.controller("SearchController",["$controller","$rootScope","$scope","$http","$sce","$timeout",function($controller,$rootScope,$scope,$http,$sce,$timeout){"use strict";$controller("BaseController",{$rootScope:$rootScope});var maxSearchElements=10,startPageItems=6,isFirst=true,oldSearchValue="",curDataSize,currentSearchUrl,i,k,timeoutId,scopeSearchElements=$("#s1-search-result-content"),maxPageSize=99,fallbackSearchPicture="http://assets.sport1.de/imagix/filter2/jpeg/_set=dyn_size,width=180,height=111,focus=50x54/var/sport1/storage/images/medien/bilder/kommunikation/node_145433/2141819-1-ger-DE/Sport1-generisch.jpg",searchPageUrl,domainName=location.host.indexOf("local")!==-1?"http://video.sport1.de":"",collection=function(){if(location.hostname.indexOf("video")>-1){return"mediacenter"}if(/\bfm\b/.test(location.hostname)){return"radio"}return"default_collection"}(),config={waitMilliseconds:300,searchBoxStandardText:"Suche",suggestUrl:domainName+"/suggest?q=<searchWord>&max="+maxSearchElements+"&format=rich&client=sport1&site="+collection,searchUrl:domainName+"/search?q=<searchWord>&client=sport1&site="+collection+"&proxystylesheet=xml2json&rc=1&filter=0&getfields=gsa_thumbnail.gsa_page_type.gsa_publish_date"};function setItem_StartAndNumber(){var retString="";if($scope.currentSearchPage===0){retString+="&start="+0;retString+="&num="+startPageItems}else{retString+="&start="+(($scope.currentSearchPage-1)*maxSearchElements+startPageItems);retString+="&num="+maxSearchElements}return retString}function buildSuggestContent(data){for(i=0,k=data.results.length;i<k;++i){data.results[i].display=$sce.trustAsHtml(data.results[i].name.substring(0,data.query.length)+"<b>"+data.results[i].name.substring(data.query.length)+"</b>");data.results[i].highLight=false}curDataSize=data.results.length-1;return data.results}function buildSearchContent(data){var tmpData={result:[],value:"content"},i,k,dataLength=data.results.length,searchValue="http://",isMobileView=location.hostname.indexOf("m.")>-1,maxResultOnPage=$scope.currentSearchPage===0?startPageItems:maxSearchElements;$scope.itemStart=$scope.currentSearchPage>0?($scope.currentSearchPage-1)*maxSearchElements+startPageItems+1:1;$scope.itemEnd=$scope.currentSearchPage>0?$scope.currentSearchPage*maxSearchElements+startPageItems:maxResultOnPage;for(i=0,k=dataLength;i<k&&i<maxResultOnPage;++i){tmpData.result[i]={};tmpData.result[i].title=$sce.trustAsHtml(data.results[i].title);tmpData.result[i].url=data.results[i].url;tmpData.result[i].snippet=$sce.trustAsHtml(data.results[i].snippet);tmpData.result[i].pic=data.results[i].gsa_thumbnail!==undefined?data.results[i].gsa_thumbnail:fallbackSearchPicture;tmpData.result[i].type=data.results[i].gsa_page_type;tmpData.result[i].date=data.results[i].gsa_publish_date;tmpData.result[i].isVideo=data.results[i].url.indexOf("video.sport1.de")>-1;if(isMobileView){tmpData.result[i].url=tmpData.result[i].url.replace("www.sport1.de","m.sport1.de");tmpData.result[i].url=tmpData.result[i].url.replace("video.sport1.de","m.video.sport1.de")}if(tmpData.result[i].pic!==""){if(tmpData.result[i].pic.substring(0,searchValue.length)!==searchValue){tmpData.result[i].pic="//www.sport1.de"+tmpData.result[i].pic}}}return tmpData}function calcPageCount(items){var saveValue=0,pageCount=0;while(saveValue<items){pageCount++;saveValue+=saveValue===0?startPageItems:maxSearchElements}return pageCount}function buildSearchPageCaller(itemCount){$scope.maxPageCount=calcPageCount(itemCount);var mod,currentPage=$scope.currentSearchPage+1,returnValue=[];if(maxPageSize<$scope.maxPageCount){$scope.maxPageCount=maxPageSize}returnValue[returnValue.length]={pageNumber:1,active:1===currentPage,isNumber:true};for(i=-2,k=3;i<k;++i){mod=i;if(currentPage<4){mod=i+4-currentPage}if(currentPage>$scope.maxPageCount-4){mod=i-3+$scope.maxPageCount-currentPage}if(i===-2&&currentPage+mod>2||i===2&&currentPage+mod<$scope.maxPageCount-1){returnValue[returnValue.length]={pageNumber:null,active:false,isNumber:false}}else if(currentPage+mod>1&&currentPage+mod<$scope.maxPageCount){returnValue[returnValue.length]={pageNumber:currentPage+mod,active:currentPage+mod===currentPage,isNumber:true}}}if($scope.maxPageCount>1){returnValue[returnValue.length]={pageNumber:$scope.maxPageCount,active:$scope.maxPageCount===currentPage,isNumber:true}}return returnValue}function makeAjaxCalls(searchWord,type){var tmpUrl=type==="suggest"?config.suggestUrl:config.searchUrl+setItem_StartAndNumber();currentSearchUrl=tmpUrl.replace("<searchWord>",searchWord.replace(/(\w)\s{1,}(\w)/g,"$1+$2"));if(type==="search"){currentSearchUrl+=$scope.sortMode==="date"?"&sort=date:D:S:d1":"&sort=date:D:L:d1"}oldSearchValue=searchWord;$http.get(currentSearchUrl).success(function(data,status,headers,config){if(type==="suggest"){$scope.suggestResults=buildSuggestContent(data);if($scope.currentHighlight!==-1&&data.results.length===0){$scope.currentHighlight=-1}}else{if(data.count>0){$scope.searchCount=data.count;$scope.searchResults=buildSearchContent(data);$scope.pageResults=buildSearchPageCaller(data.count)}else{$scope.searchResults={result:[],value:$scope.searchInputBox!==""&&$scope.searchInputBox!==config.searchBoxStandardText?"search":"empty"};$scope.pageResults=[];$scope.maxPageCount=0;$scope.searchCount=false}}}).error(function(){console.log("Error: Ajax has not worked: "+currentSearchUrl)})}$scope.showSubSearchElements=false;$scope.hasSearchBoxFocus=false;$scope.searchCount=false;$scope.sortMode="rev";$scope.itemStart=0;$scope.itemEnd=0;$scope.currentHighlight=-1;$scope.currentSearchPage=0;$scope.searchInputBox="";$scope.searchResults={result:[],value:$scope.searchInputBox!==""&&$scope.searchInputBox!==config.searchBoxStandardText?"search":"empty"};$scope.pageResults=[];$scope.suggestResults=[];$scope.maxPageCount=0;$scope.isOpenSearchBar=false;$scope.isOpenSuggestionBox=false;$scope.$watch("sortMode",function(){if($scope.searchResults.result.length){makeAjaxCalls(oldSearchValue,"search")}});function resetHighlight(data){for(i=0,k=$scope.suggestResults.length;i<k;++i){$scope.suggestResults[i].highLight=false}if(data!==undefined){$scope.currentHighlight=data}}function isSearchSide(){return scopeSearchElements.length>0}function checkAndCallSearch(searchWord){location.href=searchPageUrl.replace(/#.*/,"")+"#"+searchWord;if(isSearchSide()){location.reload()}}function isAllowedSearchWord(searchWord){return searchWord!==""&&searchWord!==config.searchBoxStandardText}var callAjaxWithTimeOut=Sport1Tools.debounce(function(searchWord,searchType){if(isFirst===false){window.dataLayer.push({event:"virtPagePath",virtPath:"/suche#"+searchWord})}else{isFirst=false}makeAjaxCalls(searchWord,searchType)},config.waitMilliseconds);$scope.searchSuggestion=function(event){var keyCode=event.keyCode;if($scope.isOpenSuggestionBox&&(keyCode===13||keyCode===40||keyCode===38)||!$scope.isOpenSuggestionBox&&keyCode===13){if(keyCode===13){if($scope.currentHighlight!==-1){checkAndCallSearch($scope.suggestResults[$scope.currentHighlight].name)}else{if($scope.searchInputBox!==""){checkAndCallSearch($scope.searchInputBox)}}}else{if($scope.currentHighlight!==-1){resetHighlight()}if(keyCode===40){$scope.currentHighlight++;if($scope.currentHighlight>curDataSize){$scope.currentHighlight=0}}else{if($scope.currentHighlight===-1){$scope.currentHighlight=curDataSize+1}$scope.currentHighlight--;if($scope.currentHighlight<0){$scope.currentHighlight=curDataSize}}$scope.suggestResults[$scope.currentHighlight].highLight=true}}else{if(isAllowedSearchWord(event.target.value)){callAjaxWithTimeOut(event.target.value,"suggest")}}};$scope.callHighlightSearchWord=function(){checkAndCallSearch($scope.suggestResults[$scope.currentHighlight].name)};$scope.callInputSearchWord=function(){if(isAllowedSearchWord($scope.searchInputBox)){checkAndCallSearch($scope.searchInputBox)}};$scope.directCallSearch=function(){$scope.currentSearchPage=0;callAjaxWithTimeOut($scope.searchInputBox,"search")};$scope.setHighlightIndex=function(currentIndex){$scope.currentHighlight=currentIndex};$scope.resetHighlight=resetHighlight;$scope.cleanResultsList=function cleanResultsList(){$scope.clearInputBox();timeoutId=$timeout(function(){$scope.suggestResults=[];$scope.currentHighlight=-1;oldSearchValue=""},200)};$scope.suggestFocus=function(event){var searchWord=event.target.value.trim();$scope.hasSearchBoxFocus=true;$timeout.cancel(timeoutId);if(isAllowedSearchWord(searchWord)){callAjaxWithTimeOut(searchWord,"suggest")}};$scope.callSearchResultSide=function(pageNumber,searchWord){$scope.currentSearchPage=pageNumber;callAjaxWithTimeOut(searchWord,"search")};$scope.clearInputBox=function(){$scope.hasSearchBoxFocus=false;$scope.searchInputBox=""};$scope.initVars=function(config){var isSearchResultPage=config.isSearchResultPage;searchPageUrl=config.searchPage;if(isSearchResultPage){$(".mainSearch").focus().select()}if(scopeSearchElements.length){if(location.hash!==""&&($scope.searchInputBox===""||$scope.searchInputBox===config.searchBoxStandardText)){$scope.searchInputBox=decodeURIComponent(location.hash.substring(1));if(isSearchResultPage){callAjaxWithTimeOut($scope.searchInputBox,"search")}}}};$scope.showSearchElements=function(){$scope.showSubSearchElements=!$scope.showSubSearchElements}}]);angular.module("soccerTournamentApp",["ngResource","ngRoute","sport1.controllers","sport1.directives","sport1.filters","sport1.services","sport1.templates"]).config(["$interpolateProvider","$routeProvider",function($interpolateProvider,$routeProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]");$routeProvider.when("/",{}).otherwise({redirectTo:"/"})}]);angular.module("standingsApp",["ngResource","ngRoute","sport1.controllers","sport1.directives","sport1.filters","sport1.services","sport1.templates"]).config(["$interpolateProvider","$routeProvider",function($interpolateProvider,$routeProvider){"use strict";$interpolateProvider.startSymbol("[[");$interpolateProvider.endSymbol("]]");$routeProvider.when("/",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/ansicht/:tabId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/ansicht/:tabId/saison/:seasonId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/ansicht/:tabId/saison/:seasonId/spieltag/:matchdayId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/saison/:seasonId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/saison/:seasonId/spieltag/:matchdayId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/saison/:seasonId/gruppe/:groupId",{
templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/saison/:seasonId/ansicht/:usGroupSlug/spieltag/:matchdayId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/saison/:seasonId/runde/:roundId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).when("/saison/:seasonId/runde/:roundId/gruppe/:groupId",{templateUrl:"common/angularjs/apps/standings/templates/standings.html"}).otherwise({redirectTo:"/"})}]);appControllers.controller("StandingsAppCtrl",["$controller","$rootScope","$scope","$location","$route","$filter","sportDataService","$element","$window","FlashService",function($controller,$rootScope,$scope,$location,$route,$filter,SportData,$element,$window,Flash){"use strict";$controller("BaseController",{$rootScope:$rootScope});var ctrl=this;$scope.seasons=[];$scope.currentSeason=undefined;$scope.matchdays=[];$scope.currentMatchday=undefined;$scope.rounds=[];$scope.currentRound=undefined;$scope.groups=[];$scope.currentGroup=undefined;$scope.usGroups=[{id:0,name:"Division",slug:"division"},{id:1,name:"Conference",slug:"conference"}];$scope.currentUsGroup=$scope.usGroups[0];$scope.tabs=[{title:"Gesamt",id:0,path:SportData.STANDINGS_TYPE.DEFAULT,templateUrl:"common/angularjs/apps/standings/templates/standings.html",visible:true,enabled:true},{title:"Heim- / Auswärts",id:1,path:SportData.STANDINGS_TYPE.HOME_AWAY,templateUrl:"common/angularjs/apps/standings/templates/standingsHA.html",visible:true,enabled:true}];$scope.currentTab=$scope.tabs[0];$scope.competition={};$scope.linkText="zum Spielplan";ctrl.live={};$scope.standings={options:{},data:{standard:{},home:{},away:{},firstHalf:{},secondHalf:{}},loading:true};$scope.popups=[];ctrl.popups={season:{label:"Saison",menuItems:"seasons",menuItemLabel:"name",selected:"currentSeason",titleId:"s1-popup-button-title-table-season"},matchday:{label:"Spieltag",menuItems:"matchdays",menuItemLabel:"name",selected:"currentMatchday",titleId:"s1-popup-button-title-table-matchday"},round:{id:"round",label:"Spielmodus",menuItems:"rounds",menuItemLabel:"label",menuItemPostfix:"",selected:"currentRound",titleId:"s1-popup-button-title-table-matchday"},group:{id:"group",label:"Gruppe",menuItems:"groups",menuItemLabel:"name",menuItemPostfix:"",selected:"currentGroup",titleId:"s1-popup-button-title-table-group"},usGroups:{id:"us-groups",label:"Anzeige nach",menuItems:"usGroups",menuItemLabel:"name",selected:"currentUsGroup",titleId:"s1-popup-button-title-table-us-groups"}};$scope.templateUrl=null;$scope.initVars=function(config){var competitionId=config.competitionId,linkText=config.linkText;$scope.competition.id=competitionId;$scope.today=config.today;if(linkText&&typeof linkText==="string"){$scope.linkText=linkText}ctrl.live.$promise=SportData.getMatchesByDateForCompetition($scope.today,competitionId);$scope.competition.$promise=SportData.getCompetition(competitionId)};ctrl.initCompetition=function(){ctrl.live.$promise.then(ctrl.handleLiveEvents);$scope.competition.$promise.then(function(competition){$scope.competition=angular.extend($scope.competition,competition);$scope.standings.options={competition:$scope.competition,contentType:"standings",layout:"default"};ctrl._setPopups(competition._type);ctrl._setTabs(competition._type);ctrl._setSeasons();$element.addClass("s1-standings").addClass("s1-sport-"+competition._sport).addClass("s1-content-"+$scope.standings.options.contentType).addClass("s1-competition-"+competition._type).addClass("s1-layout-"+$scope.standings.options.layout);return $scope.competition})};ctrl.handleLiveEvents=function(competition){ctrl.live.teams=[];if(competition.length){competition=competition[0]}else{return false}angular.forEach(competition.season,function(season){angular.forEach(season.round,function(round){angular.forEach(round.match,function(match){var home=angular.extend({},match.home,{match:match});var away=angular.extend({},match.away,{match:match});ctrl.live.teams.push(home,away)})})})};ctrl._setPopups=function(competitionType){switch(competitionType){case SportData._COMPETITION_TYPE.TOURNAMENT:if(!~$scope.popups.indexOf(ctrl.popups.season)){$scope.popups.push(ctrl.popups.season)}break;case SportData._COMPETITION_TYPE.LEAGUE:if(!~$scope.popups.indexOf(ctrl.popups.season)){$scope.popups.push(ctrl.popups.season)}if(!~$scope.popups.indexOf(ctrl.popups.matchday)){$scope.popups.push(ctrl.popups.matchday)}break;case SportData._COMPETITION_TYPE.DIVISION:if(!~$scope.popups.indexOf(ctrl.popups.season)){$scope.popups.push(ctrl.popups.season)}if(!~$scope.popups.indexOf(ctrl.popups.usGroups)){$scope.popups.push(ctrl.popups.usGroups)}break}};ctrl._setTabs=function(competitionType){switch(competitionType){case SportData._COMPETITION_TYPE.TOURNAMENT:$scope.tabs=[];break;case SportData._COMPETITION_TYPE.DIVISION:$scope.tabs=[];break}};ctrl._setSeasons=function(){$scope.standings.loading=true;$scope.seasons.loading=true;$scope.rounds.loading=true;$scope.matchdays.loading=true;$scope.competition.$promise.then(function(competition){SportData.getSeasonsByCompetition(competition.id).then(function(seasons){seasons=[].concat(seasons);seasons=$filter("keyValueFilter")(seasons,{has_tables:"yes"});var sortedSeasons=seasons.reverse();var currentSeason;if(angular.isDefined($route.current.params.roundId)){currentSeason=$filter("keyValueFilter")(sortedSeasons,{current_round_id:$route.current.params.roundId})}else if(angular.isDefined($route.current.params.seasonId)){currentSeason=$filter("keyValueFilter")(sortedSeasons,{id:$route.current.params.seasonId})}else{currentSeason=$filter("keyValueFilter")(sortedSeasons,{id:$scope.competition.current_season_id})}if(currentSeason.length){currentSeason=currentSeason[0]}else{currentSeason=sortedSeasons[0]}$scope.currentSeason=currentSeason;$scope.seasons=sortedSeasons;$scope.seasons.loading=false;if(typeof currentSeason!=="undefined"){ctrl.setRounds($scope.currentSeason.id)}else{$scope.standings.loading=false}return $scope.seasons})})};ctrl.setRounds=function(seasonId,resetRounds){$scope.standings.loading=true;if(!angular.isDefined(seasonId)){return $scope.competition.$promise.then(function(competition){return ctrl.setRounds(competition.current_season_id,resetRounds)})}return SportData.getRoundsBySeason(seasonId).then(function(season){var newRoundId;var newMatchdayId;var validRounds=$filter("keyValueFilter")(season.round,function(round){return+round.round_mode.id===SportData.ROUND_MODE.LEAGUE});if(angular.isDefined(season.round)&&season.round.length){newRoundId=validRounds.filter(function(round){return+round.id===+season.current_round_id}).length?season.current_round_id:validRounds[0].id;newMatchdayId=season.current_group_matchday}else{$scope.standings.loading=false;return Flash.error("sac_err_1","Daten stehen zur Zeit leider nicht zur Verfügung.","Invalid API Data for `getRoundsBySeason` in ctrl.setRounds")}if(!resetRounds){newRoundId=$route.current.params.roundId||newRoundId}while($scope.rounds.length){$scope.rounds.pop()}angular.forEach(season.round,function(round){var mainRound=$filter("keyValueFilter")($scope.rounds,{round_order:round.round_order});if(!mainRound.length){if(angular.isDefined(round.table_mode)){round.label="Gruppenphase";round._roundIds=[round.id];round.current_group_matchday=newMatchdayId;$scope.rounds.push(round)}}else{mainRound[0]._roundIds.push(round.id)}});var groupStages=$filter("keyValueFilter")($scope.rounds,function(round){return angular.isDefined(round.table_mode)});if(groupStages.length>1){for(var i=0;i<groupStages.length;i++){groupStages[i].label=String(i+1)+". "+groupStages[i].label}}var currentRound=$filter("keyValueFilter")($scope.rounds,function(round){return~round._roundIds.indexOf(newRoundId)});if(currentRound.length){$scope.currentRound=currentRound[0]}else{$scope.currentRound=$scope.rounds[0]}$scope.rounds.loading=false;return ctrl.setMatchdays(seasonId,newRoundId,resetRounds)})};ctrl.setMatchdays=function(seasonId,roundId,resetMatchday){$scope.standings.loading=true;if(!angular.isDefined(seasonId)){$scope.competition.$promise.then(function(competition){return ctrl.setMatchdays(competition.current_season_id,competition.current_round_id,resetMatchday)})}$scope.matchdays.loading=true;switch($scope.competition._type){case SportData._COMPETITION_TYPE.TOURNAMENT:ctrl.setMatchdaysForTournament(seasonId,roundId,resetMatchday);break;case SportData._COMPETITION_TYPE.LEAGUE:ctrl.setMatchdaysForLeague(seasonId,roundId,resetMatchday);break;default:ctrl.setMatchdaysForLeague(seasonId,roundId,resetMatchday);break}};ctrl.setMatchdaysForTournament=function(seasonId,roundId){SportData.getRoundBySeason(seasonId).then(function(season){var groups=$filter("keyValueFilter")(season.round,function(round){return+round.round_mode.id===SportData.ROUND_MODE.LEAGUE});$scope.standings.data.standard.groups=groups;var firstGroup=$filter("keyValueFilter")(groups,function(group){return+group.id===+roundId})[0];$scope.groups=$filter("keyValueFilter")(groups,{round_order:firstGroup.round_order});var groupId=$route.current.params.groupId;if(groupId){$scope.currentGroup=$filter("keyValueFilter")($scope.groups,{id:groupId})}if(angular.isDefined($scope.currentGroup)&&$scope.currentGroup.length){$scope.currentGroup=$scope.currentGroup[0]}else{$scope.currentGroup=$scope.groups[0]}if(angular.isArray($scope.rounds)&&$scope.rounds.length>1){if($filter("keyValueFilter")($scope.popups,{id:"round"}).length===0){$scope.popups.push(ctrl.popups.round)}}if(!~$scope.popups.indexOf(ctrl.popups.group)){$scope.popups.push(ctrl.popups.group)}ctrl._getStanding(seasonId)})};ctrl.setMatchdaysForLeague=function(seasonId,roundId,resetMatchday){SportData.getRoundsBySeason(seasonId).then(function(season){var newMatchdayId;var round;if(season.round.length){round=season.round[0]}else{return false}newMatchdayId=round.current_matchday;if(!resetMatchday){newMatchdayId=$route.current.params.matchdayId||newMatchdayId}if(round&&!round.matchdays_extended){round.matchdays_extended=[]}while($scope.matchdays.pop()){}angular.forEach(round.matchdays_extended,function(item){var matchdayName=item.name;if(round.name==="Spielwoche"){matchdayName=item.matchday+". Woche ("+item.start_date.substr(0,6)+" - "+item.end_date.substr(0,6)+")"}$scope.matchdays.push({matchday:item.matchday,name:matchdayName});if(parseInt(item.matchday,10)===parseInt(newMatchdayId,10)){$scope.currentMatchday={matchday:item.matchday,name:matchdayName}}});$scope.matchdays.loading=false;if(!~$scope.popups.indexOf(ctrl.popups.matchday)){$scope.popups.push(ctrl.popups.matchday)}ctrl._getStanding(seasonId,newMatchdayId)})};ctrl._getStanding=function(seasonId,matchdayId,abortMission){$scope.standings.loading=true;if(angular.isDefined(seasonId)&&angular.isDefined(matchdayId)){switch($scope.competition._type){case SportData._COMPETITION_TYPE.TOURNAMENT:switch($scope.currentTab.path){case SportData.STANDINGS_TYPE.DEFAULT:ctrl._getStandingForTournament(seasonId,matchdayId);break;case SportData.STANDINGS_TYPE.HOME_AWAY:console.log("TBI");break;case SportData.STANDINGS_TYPE.HALFS_OF_SEASON:console.log("TBI");break}break;case SportData._COMPETITION_TYPE.LEAGUE:switch($scope.currentTab.path){case SportData.STANDINGS_TYPE.DEFAULT:ctrl._getStandingForLeague(seasonId,matchdayId);break;case SportData.STANDINGS_TYPE.HOME_AWAY:ctrl._getStandingByHomeAwayForLeague(seasonId,matchdayId);break;case SportData.STANDINGS_TYPE.HALFS_OF_SEASON:console.log("TBI");break}break;case SportData._COMPETITION_TYPE.DIVISION:switch($scope.currentTab.path){case SportData.STANDINGS_TYPE.DEFAULT:ctrl._getStandingForDivision(seasonId,matchdayId);break}break}}else if(!abortMission){$scope.competition.$promise.then(function(competition){ctrl._getStanding(competition.current_season_id,competition.current_matchday,true)})}};ctrl._getStandingForTournament=function(seasonId,matchdayId){var groupMatchday=0;if($scope.rounds&&$scope.rounds.length){groupMatchday=$route.current.params.matchdayId||$scope.rounds[0].current_group_matchday}var c=$scope.competition;var s=$scope.currentSeason;var displayLiveTable=parseInt(c.current_season_id)===parseInt(s.id)&&parseInt(s.current_group_matchday)===parseInt(groupMatchday);if(displayLiveTable){SportData.getStandingLive(c.id).then(function(liveStandings){var liveGroup=$filter("keyValueFilter")(liveStandings.round,{id:$scope.currentGroup.id});if(liveGroup.length){$scope.standings.data.standard.content=liveGroup[0].standing;$scope.standings.data.standard.glossary=liveGroup[0].round_marker;ctrl.setLiveStatusForGroup(liveGroup.content);SportData.setLinksForGroup(c,$scope.competition);$scope.standings.loading=false}})}else{SportData.getStanding($scope.competition.id,$scope.currentGroup.id,matchdayId).then(function(data){$scope.standings.data.standard.content=data.standing;$scope.standings.data.standard.glossary=data.round_marker;SportData.setLinksForGroup(data.standing,$scope.competition);$scope.standings.loading=false})}};ctrl._getStandingForLeague=function(seasonId,matchdayId){var seasons=$filter("keyValueFilter")($scope.seasons,{id:seasonId});var roundId;if(seasons.length){roundId=seasons[0].current_round_id}else{return false}SportData.getStanding($scope.competition.id,roundId,matchdayId).then(function(data){var c=$scope.competition;if(parseInt(c.current_season_id)===parseInt(seasonId)&&parseInt(c.current_matchday)===parseInt(matchdayId)){SportData.getStandingLive(c.id).then(function(liveData){ctrl.setLiveStatusForGroup(liveData.round[0].standing);SportData.setLinksForGroup(liveData.round[0].standing,$scope.competition);$scope.standings.data.standard.content=liveData.round[0].standing;$scope.standings.loading=false})}else{ctrl.setLiveStatusForGroup(data.standing);SportData.setLinksForGroup(data.standing,$scope.competition);$scope.standings.data.standard.content=data.standing;$scope.standings.loading=false}$scope.standings.data.standard.glossary=data.round_marker})};ctrl._getStandingByHomeAwayForLeague=function(seasonId,matchdayId){var currentSeason=$filter("keyValueFilter")($scope.seasons,{id:seasonId});var roundId;if(currentSeason.length){roundId=currentSeason[0].current_round_id}else{return false}SportData.getStandingHome($scope.competition.id,roundId,matchdayId).then(function(data){$scope.standings.data.home.content=data.standing;$scope.standings.loading=false});SportData.getStandingAway($scope.competition.id,roundId,matchdayId).then(function(data){$scope.standings.data.away.content=data.standing;$scope.standings.loading=false})};ctrl._getStandingForDivision=function(seasonId,matchdayId){var seasons=$filter("keyValueFilter")($scope.seasons,{id:seasonId});var roundId;if(seasons.length){roundId=seasons[0].current_round_id}else{return false}var $standingsPromise;if($scope.currentUsGroup.id===0){$standingsPromise=SportData.getStanding($scope.competition.id,roundId,matchdayId)}else{$standingsPromise=SportData.getStandingByConference($scope.competition.id,roundId,matchdayId)}$standingsPromise.then(function(data){if(!$scope.standings.data.standard.groups){$scope.standings.data.standard.groups=[]}while($scope.standings.data.standard.groups.length){$scope.standings.data.standard.groups.pop()}if($scope.currentUsGroup.id===0){data.standing.forEach(function(standing){function addStandingToGroup(group){group.content.push(standing);return true}var addedStandingToGroup=$scope.standings.data.standard.groups.some(function(group){if(group.id===standing.group.id){return addStandingToGroup(group)}return false});if(!addedStandingToGroup){var group=angular.extend(standing.group,{content:[]});addStandingToGroup(group);$scope.standings.data.standard.groups.push(group)}})}else{angular.forEach(data.round[0].group,function(conference){conference.content=conference.standing;$scope.standings.data.standard.groups.push(conference)})}ctrl.setLiveStatusForGroups($scope.standings.data.standard.groups);SportData.setLinksForGroup($scope.standings.data.standard.groups,$scope.competition);$scope.standings.loading=false})};ctrl.setLiveStatusForGroups=function(groups){angular.forEach(groups,function(group){ctrl.setLiveStatusForGroup(group)})};ctrl.setLiveStatusForGroup=function(group){ctrl.live.$promise.then(function(){angular.forEach(ctrl.live.teams,function(liveTeam){SportData.getSystemDate().then(function(systemTime){var isoDate=Sport1Tools.getDate(liveTeam.match.match_date,liveTeam.match.match_time);var isLive=liveTeam.match.finished!=="yes"&&systemTime>=isoDate;if(isLive){var team=$filter("keyValueFilter")(group,function(item){return item.team.id===liveTeam.id});if(team.length){team[0].isLive=isLive}}})})})};ctrl._buildLocationPath=function(params){var path="";if(angular.isDefined(params.tabId)&&params.tabId.length){path+="/ansicht/"+params.tabId}if(angular.isDefined(params.seasonId)&&params.seasonId.length){path+="/saison/"+params.seasonId}if(angular.isDefined(params.roundId)&&params.roundId.length){path+="/runde/"+params.roundId}if(angular.isDefined(params.groupId)&&params.groupId.length){path+="/gruppe/"+params.groupId}if(angular.isDefined(params.usGroupSlug)&&params.usGroupSlug.length){path+="/ansicht/"+params.usGroupSlug}if(angular.isDefined(params.matchdayId)&&params.matchdayId.length){path+="/spieltag/"+params.matchdayId}return path};ctrl._updateLocationPath=function(params){var tabId=$scope.tabs.length?$scope.currentTab.path:"";var newParams=angular.extend({},params,{tabId:tabId});$location.path(ctrl._buildLocationPath(newParams))};$scope.$watch("currentTab",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){var tabId=newValue.path;var params=angular.extend({},$route.current.params,{tabId:tabId});ctrl._updateLocationPath(params)}});$scope.$watch("currentSeason",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){ctrl._updateLocationPath({seasonId:newValue.id})}});$scope.$watch("currentRound",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){var seasonId=$scope.currentSeason.id;var roundId=newValue.id;ctrl._updateLocationPath({seasonId:seasonId,roundId:roundId})}});$scope.$watch("currentMatchday",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){var seasonId=$scope.currentSeason.id;var matchdayId=newValue.matchday;ctrl._updateLocationPath({seasonId:seasonId,matchdayId:matchdayId})}});$scope.$watch("currentGroup",function(newValue,oldVal){if(angular.isDefined(oldVal)&&newValue!==oldVal){var seasonId=$scope.currentSeason.id;var roundId;if($scope.rounds.length>1){roundId=$scope.currentRound.id}ctrl._updateLocationPath({seasonId:seasonId,roundId:roundId,groupId:newValue.id})}});$scope.$watch("currentUsGroup",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){var seasonId=$scope.currentSeason.id;var matchdayId=$scope.currentMatchday.matchday;ctrl._updateLocationPath({seasonId:seasonId,usGroupSlug:newValue.slug,matchdayId:matchdayId})}});$scope.$on("$routeChangeSuccess",function(event,current,prev){if(angular.isDefined(current.params.tabId)){var currentTab=$filter("keyValueFilter")($scope.tabs,{path:current.params.tabId});if(currentTab.length){$scope.currentTab=currentTab[0]}else{$scope.currentTab=$scope.tabs[0]}}$scope.templateUrl=$scope.currentTab.templateUrl;if(!prev){ctrl.initCompetition()}else{if(angular.isDefined(current.params.matchdayId)){ctrl._getStanding(current.params.seasonId,current.params.matchdayId)}else if(angular.isDefined(current.params.roundId)){ctrl.setMatchdays(current.params.seasonId,current.params.roundId)}else if(angular.isDefined(current.params.seasonId)){ctrl.setRounds(current.params.seasonId)}else if(angular.isDefined(current.params.tabId)){ctrl._setSeasons()}else{ctrl.initCompetition()}}})}]);(function(){"use strict";var BaseController;BaseController=function($rootScope){$rootScope.PLATFORM=Sport1Tools.isMobileSite()?"mobile":"desktop"};BaseController.$inject=["$rootScope"];return angular.module("sport1.controllers").controller("BaseController",BaseController)})();appControllers.controller("EPGAppCtrl",["$controller","$rootScope","$scope","$filter","$locale","epgDataService",function($controller,$rootScope,$scope,$filter,$locale,epgDataService){"use strict";$controller("BaseController",{$rootScope:$rootScope});$scope.$filter=$filter;$scope.$locale=$locale;$scope.$locale.id="de-de";$scope.tvEpg=null;$scope.fmEpg=null;$scope.getCurrentEPG=function(){epgDataService.getTV().then(function(epg){$scope.tvEpg=epg});epgDataService.getFM().then(function(epg){$scope.fmEpg=epg})};$scope.initVars=function(baseUrl){epgDataService.setBaseUrl(baseUrl)}}]);appControllers.controller("GalleryCtrl",["$controller","$rootScope","$scope","$swipe",function($controller,$rootScope,$scope,$swipe){"use strict";$controller("BaseController",{$rootScope:$rootScope});var index=0;var length=0;var imageGallery=[];var imgEle=null;$scope.imageIndex=1;$scope.isLoading=false;$scope.hasOutbrain=false;$scope.showOutbrain=false;$scope.hasPrevious=true;function triggerGalleryAds(){if(!window.myAd||!window.myAd.updateAds){return}var slots=window.SOI_SITE==="sport1-mew"?["mbanner1"]:["skyscraper1","performance2"];return window.myAd.updateAds({slots:slots})}var setImage=function(image){$scope.image=image;imgEle.attr("src",image.src);imgEle.attr("alt",image.alt);var galleryTitle=angular.element("div.s1-gallery-content > nav > ul > li:last").text();angular.element("#gallery-title").text(image.title===image.description||image.title.length>150?galleryTitle:image.title);$scope.isLoading=true;if(history&&history.replaceState){history.replaceState($scope.image.id,$scope.image.alt,"?id="+$scope.image.id)}};var checkLinks=function(){$scope.hasPrevious=index>0;$scope.imageIndex=index+1};var updateContent=function(idx){var image=imageGallery[idx];setImage(image);checkLinks();window.ivwPI();if(window.dataLayer){window.dataLayer.push({event:"virtPagePath",virtPath:location.href,virtTitle:image.title})}triggerGalleryAds()};$scope.getNextImage=function(event){event.preventDefault();if($scope.hasOutbrain){if(index===length-1&&!$scope.showOutbrain){$scope.showOutbrain=true;return}else if($scope.showOutbrain){$scope.showOutbrain=false}}if(index<length-1){updateContent(++index)}else{index=0;updateContent(index)}};$scope.getPreviousImage=function(event){if(index>0){updateContent(--index)}$scope.showOutbrain=false;event.preventDefault()};var findImage=function(id){for(var i=0;i<length;i++){var image=imageGallery[i];if(String(image.id)===String(id)){index=i;return image}}return false};$scope.initVars=function(config){var gallery=config.gallery,hasOutbrain=config.hasOutbrain,startingImageId=config.startingImageId;length=gallery.length;imageGallery=gallery;$scope.image=findImage(startingImageId);checkLinks();$scope.hasOutbrain=hasOutbrain||false;imgEle=angular.element("figure.s1-gallery-figure img");imgEle[0].onload=function(){$scope.isLoading=false;$scope.$digest()};var startPoint;$swipe.bind(imgEle,{start:function(obj){startPoint=obj},end:function(obj,e){var delta=startPoint.x-obj.x;if(Math.abs(delta)<10){return}if(delta>0){$scope.getNextImage(e)}else{$scope.getPreviousImage(e)}$scope.$digest()}});angular.element(document).on("keydown",function(e){if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey){return}switch(e.which){case 39:$scope.getNextImage(e);break;case 37:$scope.getPreviousImage(e);break}$scope.$digest()})}}]);appControllers.controller("LiveAppCtrl",["$controller","$rootScope","$scope","$filter","$q","$timeout","sportDataService","graphicService",function($controller,$rootScope,$scope,$filter,$q,$timeout,sportDataService,graphicService){"use strict";$controller("BaseController",{$rootScope:$rootScope});var ctrl=this;$scope.app={loading:true};$scope.today=null;$scope.selectedDate=null;ctrl.liveEvents=null;$scope.liveEvents=null;$scope.eventFilter={};$scope.filteredSport={id:"",name:""};var firstTime=true;$scope.onFilterChange=function(id){$scope.filteredSport=id;window.ivwPI();if(window.ga){window.ga("send","event","liveFilter","click",$scope.eventFilter[id])}};ctrl.countryList=[];$scope.getMatchesByDate=function(date){$scope.liveEvents=[];ctrl.liveEvents=[];$scope.app.loading=true;var $promises={};$promises.countryList=sportDataService.getCountryList();$promises.systemDate=sportDataService.getSystemDate();if(!$scope.sportId){$promises.matches=sportDataService.getMatchesByDate(date)}else{$promises.matches=sportDataService.getMatchesByDateWithSport(date,$scope.sportId)}$q.all($promises).then(function(data){$scope.eventFilter={};ctrl.countryList=data.countryList;ctrl._generateData(data.matches,data.systemDate,date)})};function selectDefault(){var el=angular.element(".s1-live-events-filter .s1-popup-button-menu li:first a");$scope.filteredSport=el.scope().menuItem}ctrl._generateData=function(events,now,loadedDate){if(typeof $scope.selectedDate!=="undefined"&&$scope.selectedDate!==null){var selectedDate=$filter("date")($scope.selectedDate,"yyyy-MM-dd");if(selectedDate!==loadedDate){return}}var competitionPromises=[];var league;var deferred;var createLeague=function(league,competition){league._title=league.name;league.matches=[];for(var z=0;z<league.season[0].round.length;z++){var round=league.season[0].round[z];for(var j=0;j<round.match.length;j++){var event=round.match[j];if(event.match_incident&&parseInt(event.match_incident.id)===sportDataService.MATCH_INCIDENT.RESCHEDULED){continue}sportDataService.getMatchStatus(event);if(event.match_time==="unknown"){event.match_time=""}event.isLive=event._isLive;event.isInPast=event.finished==="yes";sportDataService.setLinkForMatch(event,competition,league.sport_id);if(~~event.matchday&&!round.name.match(/^\d+\./)){event._roundName=event.matchday+". "+round.name}else if(~~round.current_matchday){event._roundName=round.name.replace(/^\d+/,event.matchday)}else{event._roundName=round.name}if(event.live_status!==sportDataService.DETAILS_CONTENT.NONE){league.matches.push(event)}}}league.matchGroups={content:$filter("groupMatchesByStartTime")(league.matches)};for(z=0;z<league.matchGroups.content.length;z++){var matchGroup=league.matchGroups.content[z];matchGroup._startTime=Sport1Tools.getDateFromGermanDateTime(matchGroup.date,matchGroup.time);matchGroup._matchday=matchGroup._roundName}ctrl.udpateCompetition(league);deferred.resolve();return deferred.promise};var onAddedTableOptions=function(data){createLeague(data.league,data.competition)};for(var i=0;i<events.length;i++){league=events[i];deferred=$q.defer();competitionPromises[i]=ctrl.addTableOptions(league).then(onAddedTableOptions)}if(!Sport1Tools.isMobileSite()){$scope.eventFilter[0]={id:"",name:"Alle"}}$scope.liveEvents=ctrl.liveEvents=events;$q.all(competitionPromises).then(function(){if(firstTime||$scope.filteredSport&&!$scope.eventFilter[$scope.filteredSport.id]){firstTime=false;selectDefault()}});$scope.app.loading=false};ctrl.udpateCompetition=function(league){league._sportClass="s1-sport-"+sportDataService.getSportSlug(league.sport);if(league.matches.length){$scope.eventFilter[league.sport_id]={id:league.sport_id,name:league.sport}}league.logo=graphicService.getCompetitionIconUrl(league.id,"50",league.sport_id,league.gender)};$scope.loadPersonName=function(match_result){sportDataService.getPerson(match_result.person_id).then(function(data){match_result.person=data})};$scope.openLink=function(event,url){event.preventDefault();window.open(url)};ctrl.addTableOptions=function(league){var deferred=$q.defer();sportDataService.getCompetition(league.id).then(function(competition){league._tableOptions={renderManual:!!~[40,42,138,237,238,239,246,251,256].indexOf(+competition.sport.id),competition:{id:competition.id,sport:{id:competition.sport.id,name:competition.sport.name},_sport:competition._sport,_type:competition._type},contentType:"gameplan",layout:"livetoday"};league.sport=competition.sport.name;deferred.resolve({league:league,competition:competition})});return deferred.promise};var unwatchSelectedDate=$scope.$watch("selectedDate",function(newValue,oldValue){if(newValue&&newValue!==oldValue){var dateStr=$filter("date")($scope.selectedDate,"yyyy-MM-dd");$scope.getMatchesByDate(dateStr)}});$scope.$on("$destroy",function(){unwatchSelectedDate()});$scope.initVars=function(config){$scope.today=config.today;$scope.selectedDate=$scope.today;$scope.sportId=config.sportId;$scope.getMatchesByDate($scope.today);$scope.tableOptions={competition:{id:-1,sport:{id:-1,name:"generic"},_sport:"generic",_type:"league"},contentType:"gameplan",layout:"livetoday"}}}]);appControllers.controller("LiveConferenceTickerAppCtrl",["$controller","$rootScope","$scope","$filter","$locale","$element","sportDataService","liveTickerTimerService","tickerService","tickerAdService","FlashService","$timeout",function($controller,$rootScope,$scope,$filter,$locale,$element,SportData,timerService,tickerService,tickerAdService,Flash,$timeout){"use strict";$controller("BaseController",{$rootScope:$rootScope});var ctrl=this;var INFINITE_SCROLL_ITEMS=10;$scope.competition={};$scope.presenting={};$scope.app={loading:true};$scope.busy=false;$scope.$filter=$filter;$scope.$locale=$locale;$scope.$locale.id="de-de";$scope.today=null;$scope.leagueId=-1;$scope.matchday={};$scope.matches=[];ctrl.ticker=[];$scope.ticker=[];$scope.cursor=0;$scope.lastTickerUpdateTimestamp=null;$scope.timeSinceUpdate=0;$scope.homeTeam=null;$scope.guestTeam=null;$scope.groupMatchdayId=0;ctrl.tabs={spielverlauf:{title:"Spielverlauf",id:0,path:"spielverlauf",templateUrl:"common/angularjs/apps/generic-widget/templates/live-conference-ticker/ticker.html",headerCssClass:"",enabled:true,visible:true},tabelle:{title:"Tabelle",id:10,path:"tabelle",templateUrl:"common/angularjs/apps/generic-widget/templates/live-conference-ticker/standings.html",headerCssClass:"",enabled:true,visible:false},spielplan:{title:"Spielplan",id:20,path:"spielplan",templateUrl:"common/angularjs/apps/generic-widget/templates/live-conference-ticker/gameplan.html",headerCssClass:"",enabled:true,visible:false}};$scope.tabs=[ctrl.tabs.spielverlauf];$scope.currentTab=$scope.tabs[0];var _timerCallback=null;$scope.refresh=function($event){$scope.app.loading=true;timerService.stopTimer();timerService.resetTime();$scope.timeSinceUpdate=0;$scope.setBusy(false);$scope.$broadcast("live-ticker-refresh");if(angular.isDefined($scope.matchday)){ctrl._prepareReload()}if($event){$event.preventDefault()}};$scope.canRefresh=function(){return timerService.canRefresh($scope.timeSinceUpdate)};$scope.hideStartTime=function(match){if(angular.isDefined(match.detail)){var msUpdate=Date.parse(match.detail.updatedAt);var msStart=Date.parse(match.detail.startTime);if(!isNaN(msUpdate)&&!isNaN(msStart)){return msUpdate>=msStart}}return true};this.getConferenceTickerByDate=function(leagueId,date){SportData.getRound($scope.competition.current_round_id).then(function(round){$scope.displayStandings=~~round.round_mode.id===SportData.ROUND_MODE.LEAGUE;if(Sport1Tools.isMobileSite()&&$scope.displayStandings){$scope.tabs.push(ctrl.tabs.tabelle);$scope.tabs.sort(function(a,b){return a.id-b.id})}});SportData.getConferenceTickerByDate($scope.competition,date).then(function(conference){tickerService.tickerData=conference;ctrl.ticker=[];$scope.ticker=[];if(!conference.length){$scope.app.loading=false;return Flash.warn("lctap_warn_1","Daten stehen zur Zeit leider nicht zur Verfügung.","No API Data for `getConferenceTickerByDate` in this.getConferenceTickerByDate")}angular.forEach(conference,function(ticker,index){if(angular.isDefined(ticker.event)){ticker._display={eventIcon:tickerService.getEventIcon(ticker.event,index,$scope.competition)}}ctrl.ticker.push(ticker)});SportData.sortTicker(ctrl.ticker,true);var hasStarted=$filter("keyValueFilter")(ctrl.ticker,{_hasStarted:true});$scope.matchday._hasStarted=hasStarted.length!==0;var isLive=$filter("keyValueFilter")(ctrl.ticker,{isLive:true});$scope.matchday._isLive=isLive.length!==0;var isFinished=$scope.matchday._hasStarted&&!$scope.matchday._isLive;$scope.matchday._isFinished=isFinished;$timeout(function(){tickerAdService.update(ctrl.ticker,INFINITE_SCROLL_ITEMS);
},200);timerService.startTimer();Flash.clear("lctap_warn_");$scope.app.loading=false})};this._prepareReload=function(){timerService.stopTimer();timerService.resetTime();$scope.timeSinceUpdate=0;ctrl.getConferenceTickerByDate($scope.competition.id,$scope.today)};$scope.loadMoreEvents=function(){var nextEvents=[];if(!angular.isArray($scope.ticker)){$scope.ticker=[]}for(var i=0;i<INFINITE_SCROLL_ITEMS;i++){if(ctrl.ticker.length>$scope.ticker.length+nextEvents.length){nextEvents.push(ctrl.ticker[ctrl.ticker.length-$scope.ticker.length-nextEvents.length-1])}}if(nextEvents.length){$scope.ticker=$scope.ticker.concat(nextEvents)}$scope.setBusy(true)};$scope.gtmTrack=function(action,label){if(!window.dataLayer||!action||!label){return}window.dataLayer.push({event:"ga_event",eventCategory:"Ad",eventAction:action,eventLabel:label})};$scope.initVars=function(config){var competitionId=config.competitionId,today=config.today,presentingLink=config.presentingLink,presentingImageUrl=config.presentingImageUrl,presentingTrackingCode=config.presentingTrackingCode,considerBusyFlag=config.considerBusyFlag;$scope.considerBusyFlag=!!considerBusyFlag;$scope.templateUrl=$scope.currentTab.templateUrl;if(Sport1Tools.isMobileSite()){$scope.tabs.push(ctrl.tabs.spielplan)}$scope.competition.$promise=SportData.getCompetition(competitionId).then(function(competition){SportData.getSeason(competition.current_season_id).then(function(season){$scope.groupMatchdayId=parseInt(season.current_group_matchday)||-1});$scope.competition=angular.extend($scope.competition,competition);$scope.today=today;_timerCallback=function(){$scope.$apply(function(){$scope.timeSinceUpdate=timerService.timeSinceStart()})};timerService.registerCallback(_timerCallback);ctrl._prepareReload();$element.addClass("s1-live-conference-ticker");$element.addClass("s1-"+$scope.competition._sport+"-live-conference-ticker");$scope.presenting.link=presentingLink;$scope.presenting.imageUrl=presentingImageUrl;$scope.presenting.trackingCode=presentingTrackingCode;$scope.gtmTrack("view",presentingTrackingCode)})};$scope.setBusy=function(value){if($scope.considerBusyFlag){$scope.busy=value}};$scope.$watch("currentTab",function(newValue,oldValue){if(angular.isDefined(oldValue)&&newValue!==oldValue){$scope.templateUrl=$scope.currentTab.templateUrl}});$scope.$on("destroy",function(){timerService.stopTimer();timerService.unregisterCallback(_timerCallback)})}]);(function(){"use strict";var Controller;Controller=function($controller,$rootScope,$scope,$element,$compile,$filter,SportView){$controller("BaseController",{$rootScope:$rootScope});$scope.title="Spielplan";$scope.initVars=function(_this){return function(config){_this.competitionId=config.competitionId;_this.today=config.today;_this.roundId=config.roundId;_this.matchdayNo=config.matchdayNo;_this.groupmatchdayNo=config.groupmatchdayNo;_this.toPortal=config.toPortal!=null?config.toPortal:"";_this.linkTarget=config.linkTarget!=null?config.linkTarget:"_self";return _this.init()}}(this);this.init=function(){return SportView.getGameplanWidget(this.competitionId,this.roundId,this.matchdayNo,$element.attr("widget-layout")).then(function(response){var content,ref,scrollElement;$scope.matchdayNo=response.data.competition.current_matchday;content=$compile(response.data.body)($scope);$element.find(".s1-api-view-content").replaceWith(content);$element.addClass("s1-layout-widget");$scope.title=$filter("competitionDashboardTitle")(response.data.title,response.data.competition);if(response.data.competition.id!=null&&((ref=response.data.competition.id)==="19"||ref==="132")){scrollElement=$element.find(".s1-table-row.s1-match.s1-live:first");if(scrollElement.length===0){scrollElement=$element.find('.s1-table-row-result.s1-table-cell-bold.s1-table-cell-center:contains("- : -"):first')}if(scrollElement.length===1){$element.find(".s1-scroll-view>div:first").animate({scrollTop:scrollElement.position().top},1500,"swing")}}if(response.data.config!=null){$element.addClass("s1-sport-"+response.data.config.sp_slug);return $element.addClass("s1-competition-"+response.data.config.co_ctype)}})};$scope.anchorTag={getLink:function(_this){return function(path){return""+_this.toPortal+path}}(this),getTarget:function(_this){return function(){return _this.linkTarget}}(this)}};Controller.$inject=["$controller","$rootScope","$scope","$element","$compile","$filter","sportViewService"];return angular.module("sport1.controllers").controller("MiniMatchdayAppCtrl",Controller)})();(function(){"use strict";var Controller;Controller=function($controller,$rootScope,$scope,$element,$compile,$filter,SportView,Flash,SportData){$controller("BaseController",{$rootScope:$rootScope});$scope.title="Tabelle";$scope.$on("audioplayer-update-standing",function(event,data){var ref;return event.currentScope.initVars({competitionId:data.coId,today:(ref=data.match)!=null?ref.match_date:void 0,roundId:data.roundId,matchdayNo:data.match.matchday,groupmatchdayNo:data.match.group_matchday,toPortal:data.toPortal,linkTarget:data.linkTarget})});$scope.initVars=function(_this){return function(config){var ref,ref1,ref2;_this.competitionId=config.competitionId;_this.today=config.today;_this.roundId=config.roundId;_this.matchdayNo=config.matchdayNo;_this.groupmatchdayNo=config.groupmatchdayNo;_this.toPortal=(ref=config.toPortal)!=null?ref:"";_this.linkTarget=(ref1=config.linkTarget)!=null?ref1:"_self";_this.withSeasonInfo=(ref2=config.withSeasonInfo)!=null?ref2:false;return _this.init()}}(this);this.init=function(_this){return function(){var withSeasonInfo;$scope.loading=true;withSeasonInfo=_this.withSeasonInfo;return SportView.getStandingWidget(_this.competitionId,_this.roundId,_this.matchdayNo).then(function(response){var clickHandler,content,groups,parent,updateLinks;$scope.matchdayNo=response.data.competition.current_matchday;content=$compile(response.data.body)($scope);$element.find(".s1-api-view-content").empty();$element.find(".s1-api-view-content").append(content);groups=$element.find(".s1-table > div:not([class])");if(groups&&groups.length>1){updateLinks=function(nextElement){if(nextElement.next().length){$(".s1-next",content).css("display","block")}else{$(".s1-next",content).css("display","none")}if(nextElement.prev().length){return $(".s1-prev",content).css("display","block")}else{return $(".s1-prev",content).css("display","none")}};clickHandler=function(next){var clickedElement,nextElement;window.ivwPI();clickedElement=$element.find(".s1-table > div[style]:visible");nextElement=next?clickedElement.next():clickedElement.prev();nextElement.css("display","block");clickedElement.css("display","none");return updateLinks(nextElement)};groups.each(function(index,element){var header,newHeader;element=angular.element(element);header=element.find(".s1-table-headline");newHeader=angular.element('<div class="s1-table-headline s1-table-headline-group"><span class="s1-prev"></span>'+header.html()+'<span class="s1-next"></span></div>');return element.find(".s1-table-headline").replaceWith(newHeader)});$(content).delegate(".s1-next","click",function(){return clickHandler(true)});$(content).delegate(".s1-prev","click",function(){return clickHandler(false)});groups.css("display","none");parent=$('[s1-full-name="Deutschland"]',content).closest("div[style]");parent=parent.length?parent:groups.first();parent.css("display","block");updateLinks(parent)}$element.addClass("s1-layout-widget");$scope.title=$filter("competitionDashboardTitle")($scope.title,response.data.competition);if(response.data.config){$element.addClass("s1-sport-"+response.data.config.sp_slug);$element.addClass("s1-competition-"+response.data.config.co_ctype)}$scope.loading=false;if(withSeasonInfo){return SportData.getSeason(response.data.competition.current_season_id).then(function(response){$scope.seasonTitle=response.name})}})}}(this);$scope.anchorTag={getLink:function(_this){return function(path){return""+_this.toPortal+path}}(this),getTarget:function(_this){return function(){return _this.linkTarget}}(this)}};Controller.$inject=["$controller","$rootScope","$scope","$element","$compile","$filter","sportViewService","FlashService","sportDataService"];return angular.module("sport1.controllers").controller("MiniStandingsAppCtrl",Controller)})();appControllers.controller("SuperLeadAppCtrl",["$controller","$rootScope","$scope",function($controller,$rootScope,$scope){"use strict";function hasUserInteraction(){$scope.userInteraction=true;if(window.ivwPI){window.ivwPI()}}$controller("BaseController",{$rootScope:$rootScope});$scope.selectedIndex=0;$scope.userInteraction=false;$scope.sendGoogleAnalyticsEvent=function(type){var url=$("a",$scope.teasers[$scope.selectedIndex]).attr("href"),eventLabel=$scope.selectedIndex+1+" | "+url;if(window.ga){window.ga("send","event","Superaufmacher",type,eventLabel)}};$scope.selectItemAtIndex=function($event,index){$scope.selectedIndex=index>=0&&index<$scope.teasers.length?index:index<0?$scope.teasers.length-1:0;hasUserInteraction();$event.preventDefault()};function next(){$scope.$apply(function(){$scope.selectedIndex=$scope.selectedIndex<$scope.teasers.length-1?$scope.selectedIndex+1:0;hasUserInteraction()})}function prev(){$scope.$apply(function(){$scope.selectedIndex=$scope.selectedIndex===0?$scope.teasers.length-1:$scope.selectedIndex-1;hasUserInteraction()})}$(document).keydown(function(e){if(e.keyCode===39){next()}else if(e.keyCode===37){prev()}})}]);appControllers.controller("VideoChannelAppCtrl",["$controller","$rootScope","$scope","videoService",function($controller,$rootScope,$scope,videoService){"use strict";$controller("BaseController",{$rootScope:$rootScope});var LOADMORETEXT=/\.fm\b|\bfm\./.test(location.hostname)?"mehr laden":"mehr Videos laden";var LOADINGTEXT="wird nachgeladen";var self=this;this.page=0;this.count=10;this.playlistId="";$scope.videos=[];$scope.previewImageWidth=195;$scope.previewImageHeight=110;$scope.playlistVideoCount=0;$scope.loadingTitle=LOADMORETEXT;$scope.loading=false;this.getVideosForPage=function(page){return videoService.getPaginatedPlaylist(self.playlistId,page,self.count).then(function(playlist){$scope.playlistVideoCount=playlist.playlistCount;if($scope.videos.length+playlist.videos.length<=$scope.playlistVideoCount){$scope.videos=$scope.videos.concat(playlist.videos)}else{playlist.videos=playlist.videos.slice(0,$scope.playlistVideoCount%self.count%playlist.videos.length);$scope.videos=$scope.videos.concat(playlist.videos)}self.page=page},function(error){console.error(error)})};var getVideosOfNextPageCallback=function(){$scope.loadingTitle=LOADMORETEXT;$scope.loading=false};$scope.getVideosOfNextPage=function($event){$scope.loadingTitle=LOADINGTEXT;$scope.loading=true;if($scope.outbrainConfig){self.getOutbrainVideos()}else{self.getVideosForPage(self.page+1)["finally"](getVideosOfNextPageCallback)}if($event){$event.preventDefault()}};this.getOutbrainVideos=function(){videoService.getOutbrainRecommendation($scope.outbrainConfig).then(function(data){$scope.videos=$scope.videos.concat(data.videos);getVideosOfNextPageCallback()})};$scope.initVars=function(config){$scope.outbrainConfig=config.outbrain;if($scope.outbrainConfig){$scope.playlistVideoCount=$scope.outbrainConfig.maxVideoCount;self.getOutbrainVideos()}else{videoService.setBaseUrl(config.baseUrl);self.count=config.count;self.playlistId=config.kalturaId;self.getVideosForPage(0)}};$scope.$watch(function(){return self.count},function(newVal,oldVal){if(!$scope.count||newVal!==oldVal){$scope.count=self.count}});$scope.getVideoSubCategory=function(headline){return headline.split(">").splice(-1).toLocaleString()}}]);appControllers.controller("VideoDashboardAppCtrl",["$controller","$rootScope","$scope","$resource",function($controller,$rootScope,$scope,$resource){"use strict";$controller("BaseController",{$rootScope:$rootScope});$scope.videos=null;$scope.initVars=function(baseUrl){var Playlist=$resource(baseUrl);var promise=Playlist.get().$promise;promise.then(function(response){$scope.videos=response.videos})};$scope.getVideoSubCategory=function(headline){return headline.split(">").splice(-1).toLocaleString()}}]);appDirectives.directive("anchorTarget",[function(){"use strict";return{restrict:"A",replace:true,link:function(scope,elm,attrs){if(attrs.hasOwnProperty("anchorTarget")){var target=attrs.anchorTarget;var anchor=elm.find("a");if(anchor){anchor.attr("target",target)}}}}}]);appDirectives.directive("bwinBet",["$compile","$filter","sportDataService","$timeout",function($compile,$filter,SportData,$timeout){"use strict";function generateTooltip(scope,element,cssClass){element.addClass(cssClass);var bwinElement=$compile('<span class="bwinBet" '+'style="width: 100%; height: 100%; display: inline-block;" '+'tooltip-html-unsafe=\'<iframe frameborder="0" height="42" width="238" src="http://bwin.ad.ergebnis-dienst.de/tooltip/sport1/co[[competitionId]]/th[[homeId]]/ta[[awayId]]/da[[date]]/#/affiliateId4450936" '+'scrolling="no">iframe</iframe>\' '+'tooltip-append-to-body="true"></span>')(scope);element.append(bwinElement);scope.$emit("ga_event",{event:"ga_event",eventCategory:"Ad",eventAction:"view",eventLabel:"bwin"},true)}return{restrict:"A",scope:{match:"=bwinMatch",competitionId:"@bwinCompetitionId",matchDate:"@bwinDate",matchHomeId:"@bwinHomeId",matchAwayId:"@bwinAwayId",matchFinished:"@bwinFinished"},link:function(scope,element){if(~SportData.VALID_BWIN_COMPETITIONS.indexOf(+scope.competitionId)){scope.homeId=scope.matchHomeId||scope.match.home.id;scope.awayId=scope.matchAwayId||scope.match.away.id;if(!angular.isDefined(scope.matchDate)){if(angular.isDefined(scope.match._isoDate)){scope.date=$filter("date")(scope.match._isoDate,"yyyy-MM-dd")}else{scope.date=$filter("date")(Sport1Tools.getDateFromGermanDateTime(scope.match.match_date,scope.match.match_time),"yyyy-MM-dd")}}else{scope.date=scope.matchDate}scope.matchFinished=scope.matchFinished||scope.match.finished==="yes";generateTooltip(scope,element,!scope.matchFinished?"s1-active":"s1-passive")}else{element.hide()}var status={hovered:false,leaveTriggered:false};var mouseenterHandler=function(){status.hovered=true;status.leaveTriggered=false};var mouseleaveHandler=function(){status.leaveTriggered=true;$timeout(function(){if(status.leaveTriggered){status.hovered=false;element.find(".bwinBet").trigger("mouseleaveTooltip")}},500)};var clickHandler=function(event){event.preventDefault();scope.$emit("ga_event",{event:"ga_event",eventCategory:"Ad",eventAction:"click",eventLabel:"bwin"});window.open("https://ad.doubleclick.net/ddm/trackclk/N8807.102577.SPORT1.DE/B8507502.128913367;dc_trk_aid=301790063;dc_trk_cid=69062916;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=")};angular.element("body").on("mouseenter",".tooltip",mouseenterHandler);angular.element("body").on("mouseleave",".tooltip",mouseleaveHandler);element.on("mouseenter",mouseenterHandler);element.on("mouseleave",mouseleaveHandler);element.on("click",clickHandler)}}}]);appDirectives.directive("clickToOpen",function(){"use strict";return{restrict:"A",link:function(scope,element,attrs){var targetElement=element.closest(attrs.clickToOpen);element.bind("click",function(){var top=targetElement.offset().top;targetElement.toggleClass("s1-open");$("body").animate({scrollTop:top})})}}});appDirectives.directive("countDown",["$interval",function($interval){"use strict";var TIMEOUT=1e3;var SECONDS=1e3;var MIN=SECONDS*60;var HOUR=MIN*60;var DAY=HOUR*24;var controller=["$scope",function($scope){$scope.hide=false}];function pad(x,length,character){x=String(x);return length>x.length?pad(character+x,length,character):x}function link(scope,element,attrs){var targetTimestamp=parseInt(attrs.endDate,10)*1e3,remainingTime=targetTimestamp-Date.now(),timeoutId;scope.headline=attrs.headline;function updateTime(date){if(date<0){scope.hide=true;return $interval.cancel(timeoutId)}scope.days=pad(Math.floor(date/DAY),2,0);scope.hours=pad(Math.floor(date%DAY/HOUR),2,0);scope.minutes=pad(Math.floor(date%HOUR/MIN),2,0);scope.seconds=pad(Math.floor(date%MIN/SECONDS),2,0)}element.on("$destroy",function(){$interval.cancel(timeoutId)});timeoutId=$interval(function(){updateTime(remainingTime-=TIMEOUT)},TIMEOUT)}return{controller:controller,restrict:"E",scope:{headline:"@"},template:'<span ng-if="headline" class="s1-count-down-title">{{headline}}</span>'+'<div ng-hide="hide" class="s1-count-down">'+'[[days]]<span class="s1-count-down-label">tage</span><span class="s1-count-down-delimiter"></span>'+'[[hours]]<span class="s1-count-down-label">std.</span><span class="s1-count-down-delimiter"></span>'+'[[minutes]]<span class="s1-count-down-label">min.</span><span class="s1-count-down-delimiter"></span>'+'[[seconds]]<span class="s1-count-down-label">sek.</span>'+"</div>",link:link}}]);(function(){"use strict";var Directive;Directive=function(){return{restrict:"A",link:function(scope,element,attrs){return element.bind("error",function(){if(attrs.src!==attrs.fallbackImage){return attrs.$set("src",attrs.fallbackImage)}})}}};Directive.$inject=[];return angular.module("sport1.directives").directive("fallbackImage",Directive)})();(function(){"use strict";var Directive;Directive=function(gaService){return{restrict:"A",link:function(scope,element,attrs){return element.on("click",function(event){var gaData,href,name;event.preventDefault();gaData=scope.$eval(attrs.gaData);href=element.attr("href");if(href){gaData.hitCallback=function(){document.location=href}}if(typeof gaService[name=attrs.gaCommand]==="function"){gaService[name](gaData)}})}}};Directive.$inject=["gaService"];return angular.module("sport1.directives").directive("gaDirective",Directive)})();appDirectives.directive("liveCalendar",["$timeout","$filter",function($timeout,$filter){"use strict";return{restrict:"E",replace:true,scope:{today:"=",futureDates:"=",pastDates:"=",selectedDate:"="},controller:["$scope",function($scope){$scope.calendarDates=[];$scope.selectedIndex=-1;$scope.currentDateIndex=90;var _dateFromString=function(dateStr){var year=parseInt($filter("date")(dateStr,"yyyy"),10);var month=parseInt($filter("date")(dateStr,"M"),10);var day=parseInt($filter("date")(dateStr,"d"),10);return new Date(year,month-1,day)};$scope.hasTransparencyAtIndex=function(index){if(index===$scope.selectedIndex||index===$scope.currentDateIndex){return false}return true};$scope.selectDateAtIndex=function($event,index){if(0<=index&&index<$scope.calendarDates.length){$scope.selectedIndex=index;$scope.selectedDate=$scope.calendarDates[index];if($scope.selectedDate){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"ga_event",eventCategory:"LiveCalendar",eventLabel:location.pathname+"/"+$scope.selectedDate.toISOString(),eventAction:"selectDate"})}}$event.preventDefault()};$scope.shortWeekday=function(date){var weekday=new Array("S","M","D","M","D","F","S");var day=weekday[date.getDay()];return day};$scope.setupDatesToDisplay=function(){var twentyFourHours=24*60*60*1e3;var todayMS=Date.parse(_dateFromString($scope.today));todayMS=todayMS+twentyFourHours/2;var i;var date;for(i=$scope.pastDates;i>=0;--i){date=new Date(todayMS-i*twentyFourHours);$scope.calendarDates.push(date)}$scope.selectedIndex=$scope.pastDates;for(i=0;i<$scope.futureDates;++i){date=new Date(todayMS+(i+1)*twentyFourHours);$scope.calendarDates.push(date)}}}],template:'<nav class="s1-live-calendar-nav">'+'<a class="s1-prev" href="#" ng-click="selectDateAtIndex($event, selectedIndex-1)" title="Zurück"></a>'+'<div class="s1-crop">'+'<ul class="s1-live-calendar" role="menu">'+"<li ng-repeat=\"calendarDate in calendarDates track by $index\" ng-class=\"{'active': $index === selectedIndex, 's1-calendar-today-bar': $index === currentDateIndex, 's1-pass-through': hasTransparencyAtIndex($index)}\" role=\"presentation\">"+'<a class="s1-live-calendar-item" href="#" ng-click="selectDateAtIndex($event, $index)" title="Zur Live-Übersicht von [[calendarDate | date: \'EEE, d. MMMM. yyyy\']]" role="menuitem">'+"<div ng-class=\"{ 's1-calendar-sunday': calendarDate.getDay() === 0, 's1-active-sunday': $index === selectedIndex}\"></div>"+'<div class="s1-day" ng-class="{\'s1-calendar-today\': $index === currentDateIndex}"> [[shortWeekday(calendarDate)]] </div>'+"<div class=\"s1-date\">[[calendarDate | date: 'd. MMM']]</div>"+"</a>"+"</li>"+"</ul>"+"</div>"+'<a class="s1-next" href="#" ng-click="selectDateAtIndex($event, selectedIndex+1)" title="Weiter"></a>'+"</nav>",link:function(scope,element){var _centerCalendarItemAtIndex=function(index,animated){var $crop=$(".s1-crop",element);var $list=$(".s1-live-calendar",$crop);var $items=$("li",$list);if(0<=index&&index<$items.length){var $item=$($items.get(index));var itemLeft=$item.position().left;var itemWidth=$item.outerWidth(true);var listLeft=$list.position().left;var listWidth=$($items.last()).position().left+itemWidth;var totalWidth=$crop.width();var middle=totalWidth/2;var left=middle-itemLeft-itemWidth;left-=left%itemWidth;left=0>=left?left:0;left=totalWidth-listWidth<=left?left:totalWidth-listWidth;if(listLeft!==left){if(animated){$list.animate({left:Math.floor(left)},"fast")}else{$list.css({left:Math.floor(left)})}}}};var unwatchSelectedIndex=scope.$watch("selectedIndex",function(newValue){if(-1<newValue){_centerCalendarItemAtIndex(scope.selectedIndex,false)}});scope.$on("$destroy",function(){unwatchSelectedIndex()});if(scope.selectedDate&&undefined!==scope.selectedDate){scope.setupDatesToDisplay();$timeout(function(){_centerCalendarItemAtIndex(scope.selectedIndex,false)},500,false)}}}}]);appDirectives.directive("mobileSuperTeaser",[function(){"use strict";return{restrict:"A",link:function(){var renderBullets=function(index,className){return'<span class="'+className+' s1-swiper-pagination-bullet"></span>'};new Swiper(".swiper-container",{direction:"horizontal",pagination:".swiper-pagination",paginationClickable:true,paginationBulletRender:renderBullets,preventClicks:true,loop:true})}}}]);appDirectives.directive("simpleCarousel",[function(){"use strict";return{restrict:"A",controller:function($scope,$element){var c=$element;var d=1;var offset=150;var duration=180;var aniActive=false;var maxScrollLeft=c[0].scrollWidth-c[0].clientWidth;function retrieveHMargin(element){return parseInt(element.css("margin-left").replace("px",""))+parseInt(element.css("margin-right").replace("px",""))}function checkEdge(){var hMargin;var width=Math.abs(offset);var listElement=null;var listElementWidth;var l=null;if(d===-1&&c.scrollLeft()-Math.abs(offset)<=0){while(width>0){l=c.find("li");listElement=l.last();if(!hMargin){hMargin=retrieveHMargin(listElement)}listElementWidth=listElement.width();width-=listElementWidth;c.scrollLeft(c.scrollLeft()+listElementWidth+hMargin);c.prepend(listElement)}}else if(d===1&&c.scrollLeft()+Math.abs(offset)>=maxScrollLeft){while(width>0){l=c.find("li");listElement=l.first();listElementWidth=listElement.width();c.append(listElement);if(!hMargin){hMargin=retrieveHMargin(listElement)}width-=listElementWidth;c.scrollLeft(c.scrollLeft()-listElementWidth-hMargin)}}aniActive=false}function scroll(direction){if(!aniActive){d=direction;aniActive=true;var o=offset*d;c.animate({scrollLeft:"+="+o.toString()},duration,"swing",checkEdge)}}$scope.scrollRight=function(){scroll(-1)};$scope.scrollLeft=function(){scroll(1)};checkEdge()}}}]);appDirectives.directive("soccerEvent",[function(){"use strict";return{restrict:"E",replace:true,scope:{event:"="},template:'<li class="s1-soccer-event" role="listitem"><span class="event [[event.type | soccerEventMapping]]">[[event.minute]].</span></li>'}}]);appDirectives.directive("soccerPlayer",[function(){"use strict";return{restrict:"E",replace:true,templateUrl:"common/angularjs/directives/soccerPlayerDirective/soccer-player.html"}}]);appDirectives.directive("s1Spinner",[function(){"use strict";return{restrict:"E",replace:true,scope:{visible:"=s1Visible"},template:""+'<div class="s1-spinner-container" ng-if="visible">'+'<div class="s1-spinner s1-spinner-wave">'+'<div class="s1-rect1"></div>'+'<div class="s1-rect2"></div>'+'<div class="s1-rect3"></div>'+'<div class="s1-rect4"></div>'+'<div class="s1-rect5"></div>'+"</div>"+"</div>"}}]);appDirectives.directive("textRotation",[function(){"use strict";return{restrict:"A",scope:{animate:"&animateTextRotation"},link:function(scope,element,attrs){var $content=$("> div",element);var _delay=6e3;var _deltaY=-parseInt(attrs.textRotation,10);var _interval=-1;function _stopAnimation(){if(-1!==_interval){clearInterval(_interval);_interval=-1}}function _animate(){var top=$content.position().top;var height=$content.height();if(height<=-_deltaY){_stopAnimation();return}$content.animate({top:top+_deltaY>-height?top+_deltaY:0},"fast")}function _startAnimation(){if(-1===_interval){_interval=setInterval(_animate,_delay)}}var unwatchAnimate=scope.$watch(function(){return scope.animate()},function(){if(scope.animate()){_startAnimation()}else{_stopAnimation()}});scope.$on("start-text-rotation",function(){});scope.$on("$destroy",function(){unwatchAnimate();_stopAnimation()})}}}]);appDirectives.directive("tipicoBet",["$compile","$filter","sportDataService","$timeout",function($compile,$filter,SportData,$timeout){"use strict";function generateTooltip(scope,element,cssClass,tooltipPlacement){element.addClass(cssClass);var tipicoElement=$compile('<span class="tipicoBet" '+'style="width: 100%; height: 100%; display: inline-block;" '+'tooltip-html-unsafe=\'<iframe frameborder="0" height="48" width="238" src="http://ads.tipico.com/tooltip/sport1/de/co[[competitionId]]/th[[homeId]]/ta[[awayId]]/da[[date]]/#/affiliateId336519" '+'scrolling="no">iframe</iframe>\' '+'tooltip-append-to-body="true" tooltip-placement='+tooltipPlacement+"></span>")(scope);element.append(tipicoElement);scope.$emit("ga_event",{event:"ga_event",eventCategory:"Ad",eventAction:"view",eventLabel:"tipico"},true)}return{restrict:"A",scope:{match:"=tipicoMatch",competitionId:"@tipicoCompetitionId",matchDate:"@tipicoDate",matchHomeId:"@tipicoHomeId",matchAwayId:"@tipicoAwayId",matchFinished:"@tipicoFinished"},link:function(scope,element,attrs){if(~SportData.VALID_TIPICO_COMPETITIONS.indexOf(+scope.competitionId)){scope.homeId=scope.matchHomeId||scope.match.home.id;scope.awayId=scope.matchAwayId||scope.match.away.id;if(!angular.isDefined(scope.matchDate)){if(angular.isDefined(scope.match._isoDate)){scope.date=$filter("date")(scope.match._isoDate,"yyyy-MM-dd")}else{scope.date=$filter("date")(Sport1Tools.getDateFromGermanDateTime(scope.match.match_date,scope.match.match_time),"yyyy-MM-dd")}}else{scope.date=scope.matchDate}var tooltipPlacement=attrs.tooltipPlacement||"top";scope.matchFinished=scope.matchFinished||scope.match.finished!=="yes";generateTooltip(scope,element,scope.matchFinished?"s1-active":"s1-passive",tooltipPlacement)}else{element.hide()}var status={hovered:false,leaveTriggered:false};var mouseenterHandler=function(){status.hovered=true;status.leaveTriggered=false};var mouseleaveHandler=function(){status.leaveTriggered=true;$timeout(function(){if(status.leaveTriggered){status.hovered=false;element.find(".tipicoBet").trigger("mouseleaveTooltip")}},500)};var clickHandler=function(event){event.preventDefault();scope.$emit("ga_event",{event:"ga_event",eventCategory:"Ad",eventAction:"click",eventLabel:"tipico"});window.open("https://www.tipico.de/?affiliateId=405519")};angular.element("body").on("mouseenter",".tooltip",mouseenterHandler);angular.element("body").on("mouseleave",".tooltip",mouseleaveHandler);element.on("mouseenter",mouseenterHandler);element.on("mouseleave",mouseleaveHandler);element.on("click",clickHandler)}}}]);appDirectives.directive("videoObserverHideOnCompleteBehaviour",["videoObservableService",function(videoObservableService){"use strict";return{restrict:"A",link:function(scope){function handleEvent(event){if(event===videoObservableService.VIDEO_COMPLETE||event===videoObservableService.VIDEO_PAUSE){scope.hideElement=true}if(event===videoObservableService.VIDEO_START||event===videoObservableService.VIDEO_PLAY){scope.hideElement=false}}function notify(state){var initialState=scope.hideElement;handleEvent(state);if(initialState!==scope.hideElement){scope.$apply()}}scope.hideElement=false;videoObservableService.registerUpdateHandler(notify)}}}]);appDirectives.directive("videoOverlayLink",["$compile",function($compile){"use strict";function loadVideoOverlay(scope,element){scope.width=element.width();scope.height=element.height();var videoElement=$compile('<div video-overlay-player video-id="[[videoId]]" video-base-url="[[videoBaseUrl]]" video-autostart="true" video-title="[[videoTitle]]" video-gtm-tracking-label="[[videoGtmTrackingLabel]]" class="[[videoClass]]" width="[[width]]" height="[[height]]" video-inline-player="true"></div>')(scope);if(element.hasClass("s1-super-lead-teaser")){var superTeaserElement=element.parents(".s1-super-lead");superTeaserElement.trigger("pause")}element.replaceWith(videoElement);return videoElement}return{restrict:"A",scope:{videoId:"@",videoRelatedPlaylistId:"@",videoBaseUrl:"@",videoClass:"@",videoGtmTrackingLabel:"@",videoTitle:"@",videoAdsEnabled:"@"},link:function(scope,element){scope.videoOverlayParent=element.parent();var videoTeaser=element;element.on("click",function(){loadVideoOverlay(scope,element);return false});element.parents(".s1-super-lead").on("restartTabAnimation",function(){element.removeAttr("ng-switch-when");scope.videoOverlayParent.children().replaceWith($compile(videoTeaser)(scope))});scope.$on("$destroy",function(){})}}}]);appDirectives.directive("articleRecommender",["$http",function($http){"use strict";var recommendedArticlesController=["$scope","$location",function($scope,$location){$scope.init=function(){$scope.loadHybrid()};$scope.getArticleByPath=function(recommendedArticle){$http({method:"GET",url:$location.protocol()+"://"+$location.host()+"/api/recommender/article",contentType:"application/json; charset=utf-8",params:{path:recommendedArticle.article}}).then(function mySucces(response){if($scope.recommendedArticles===undefined||$scope.recommendedArticles===null){$scope.recommendedArticles=[]}var article=response.data;article.similarity=recommendedArticle.similarity;$scope.recommendedArticles.push(article)},function myError(response){console.log(response.statusText)})};$scope.loadHybrid=function(){var userProfile=localStorage.getItem("s1-recommender-profile");var user=localStorage.getItem("s1-guid");$http({method:"POST",url:Sport1Tools.getRecommenderUrl()+"/recommendations/hybrid",contentType:"application/json; charset=utf-8",data:{userProfile:userProfile,user:user}}).then(function mySucces(response){$scope.retrievedArticles=response.data;$scope.loadNextArticles(9)},function myError(response){console.log(response.statusText)})};$scope.loadNextArticles=function(count){if($scope.retrievedArticles!==undefined&&$scope.retrievedArticles.length>0){var min=Math.min(count,$scope.retrievedArticles.length);for(var i=0;i<min;i++){$scope.getArticleByPath($scope.retrievedArticles[i])}$scope.retrievedArticles.splice(0,min)}};$scope.init()}];var getTemplate=function(){return"common/angularjs/directives/articleRecommenderDirectives/recommenderContent.html"};return{controller:recommendedArticlesController,restrict:"E",scope:{count:"="},replace:true,templateUrl:getTemplate}}]);appDirectives.directive("fmHighlights",[function(){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/audioPlayerDirectives/fm-highlights.html",controller:["$scope","$element",function($scope,$element){this.playing=false;var _self=this;var config={};var player=null;var button=null;var onReady=function(){player=jwplayer("fmHighlightsPlayer");_self.setVolume($scope.$parent.volume)};var onPlay=function(){$scope.$emit("audioplayer-play-highlight");_self.playing=true};var onPause=function(){_self.playing=false;$scope.$apply()};var onError=function(){};var initPlayer=function(audioFeed){var events={onReady:onReady,onPlay:onPlay,onPause:onPause,onPlaylistComplete:onPause,onSetupError:onError,onError:onError};config.id="fmHighlightsPlayer";
config.playlist=[{file:audioFeed}];config.controls=false;config.primary="flash";config.autostart=false;config.width=1;config.height=1;config.events=events;jwplayer.key="vQ588HitWJxPu/Um4QWiZ8ZErot4bLHE/A5VIg==";jwplayer("fmHighlightsPlayer").setup(config)};this.initVars=function(highlightData){this.highlightData=highlightData;if(!player){initPlayer(highlightData.audio_feed)}};this.setVolume=function(percentage){if(player){player.setVolume(percentage)}};var buttonClickHandler=function(){if(player){player.play()}};var onRadioStreamPlayed=function(){if(player&&(player.getState()==="PLAYING"||player.getState()==="BUFFERING")){player.pause()}};button=jQuery(".s1-fm-highlights-play-button");button.on("click",buttonClickHandler);var unwatchRadioStreamPlayed=$scope.$parent.$on("audioplayer-play-radio-stream",onRadioStreamPlayed);var unwatchVolume=$scope.$parent.$watch("volume",function(newValue,oldValue){if(newValue!==oldValue){_self.setVolume($scope.volume)}});$scope.$on("$destroy",function(){if(player){player.remove()}unwatchRadioStreamPlayed();unwatchVolume();$element.remove()})}],controllerAs:"fmHighlightsCtrl"}}]);appDirectives.directive("fmPlayer",[function(){"use strict";return{restrict:"A",controller:["$scope","$element","$attrs","$timeout","fmPopUpPlayerAdService",function($scope,$element,$attrs,$timeout,fmPopUpPlayerAdService){this.playing=false;this.buffered=false;this.activeLiveStreamElement=null;$scope.volume=0;$scope.playingElement=null;var _self=this;var uuidParam=null;var liveFmUrl="http://stream.sport1.fm/api/livestream-redirect/Sport1fm_24_7.mp3";var player=null;var config={};var playPreroll=true;var isMobileSite=window.SOI_SITE==="sport1fm-mew";var gtmPlayPromise=null;var ivwTrackingString="Ax_fm_popup-player";var triggerAdReload=function(){fmPopUpPlayerAdService.reloadAd($scope.activeSportData.coId,$scope.activeSportData.sportId)};var reset=function(){_self.playing=false;_self.buffered=false;_self.activeLiveStreamElement=null;$scope.playingElement=null};var gtmTrack=function(action,label){if(!window.dataLayer||!action||!label){return}window.dataLayer.push({event:"ga_event",eventCategory:"Sport1FmPopUp",eventAction:action,eventLabel:label})};var trackPlayForGA=function(){gtmPlayPromise=$timeout(gtmTrack,6e4,false,"play",_self.activeLiveStreamElement.gtmLabel)};var trackContentSpread=function(){var itagVars={};itagVars.csClient="sport1";itagVars.csItagId="0585ba";var custVars={};custVars.csTouchpoint="sport1-fm-radio";var ps="";var k;for(k in itagVars){ps+="&"+k+"="+encodeURIComponent(itagVars[k])}for(k in custVars){ps+="&"+k+"="+encodeURIComponent(custVars[k])}jQuery(document.body).append("<sc"+'ript async="async" src="http'+(location.protocol==="https:"?"s":"")+"://cdn.contentspread.net/cdn/toolbox/itag.dyn?"+ps+'"></sc'+"ript>")};function trackFacebookPlay(){var trackId=Sport1Tools.isMobileSite()?"6029394609145":"6029394575745";(function(){var _fbq=window._fbq||(window._fbq=[]);if(!_fbq.loaded){var fbds=document.createElement("script");fbds.async=true;fbds.src="//connect.facebook.net/en_US/fbds.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(fbds,s);_fbq.loaded=true}})();window._fbq=window._fbq||[];window._fbq.push(["track",trackId,{value:"0.00",currency:"EUR"}])}var applyStatusChange=function(){$scope.$apply()};var startPlay=function(){var isMobileBrowser=Sport1Tools.deeplinking.isMobile()?true:false;if(!isMobileBrowser){var selectedMatch=$scope.selectedMatch;var liveStreamUrl=liveFmUrl;if(selectedMatch&&selectedMatch.streamUrl&&selectedMatch.scheduleStatus==="isLive"){liveStreamUrl=selectedMatch.streamUrl;_self.activeLiveStreamElement=selectedMatch;$scope.playingElement=selectedMatch}else{_self.activeLiveStreamElement=$scope.getPlayableElement();$scope.playingElement=$scope.activeEPGElement;_self.activeLiveStreamElement=selectedMatch}liveStreamUrl+=uuidParam;player.load([{file:liveStreamUrl}]);player.play(true);triggerAdReload();trackPlayForGA();trackFacebookPlay();trackContentSpread()}else{reset();$timeout(applyStatusChange,10)}};var play=function(){try{_self.playing=true;player.play(true);triggerAdReload();window.ivwPI(ivwTrackingString);trackPlayForGA();trackFacebookPlay();trackContentSpread()}catch(e){console.error("PLAY ERROR",e);reset();$timeout(applyStatusChange,10)}};var broadCastStartPlayingEvent=function(){$scope.$broadcast("audioplayer-play-radio-stream")};var triggerPreroll=function(){$scope.prerollCtrl.playPreroll();playPreroll=false;_self.playing=true;window.ivwPI(ivwTrackingString);broadCastStartPlayingEvent()};var registerA11y=function(){var active,explanation=document.getElementById("s1-a11y-popup-explanation"),explanationInitial=explanation.value,map={80:"p",48:0,49:1,50:2,51:3,52:4,53:5,54:6,55:7,56:8,57:9};$scope.$watch("playingElement.scheduleStatus",function handlePlayingElementStatusChange(newValue){if(newValue&&$scope.playingElement&&newValue.toString()==="isInPast"){$scope.playingElement=$scope.activeEPGElement;_self.activeLiveStreamElement=$scope.activeEPGElement}});$scope.$watch(function(){return $scope.liveFMMatches.length},function(length,old){if(length===old||!length){return}var text=$scope.liveFMMatches.map(function(match,i){return"\nAlt "+(i+1)+": "+match.label}).join("");explanation.value=explanationInitial.replace(/\n.*?$/,text)});angular.element(document).keyup(function(event){if(!event.altKey){return}var key=map[event.which||event.keyCode||event.charCode];active=active||_self.activeLiveStreamElement||$scope.getPlayableElement();if(undefined===key){return}event.preventDefault();if("p"===key){var activeMatch=$scope.liveFMMatches.filter(function(match){return match===active})[0];_self.playStream(active,activeMatch&&activeMatch.streamUrl,true)}else if(0===key){active=$scope.activeEPGElement;_self.playStream(active,liveFmUrl,true)}else{var matchData=$scope.liveFMMatches[key-1];if(typeof key==="number"&&matchData){active=matchData;_self.playStream(matchData,matchData.streamUrl,true)}}$timeout(applyStatusChange,10)})};var onReady=function(){player=jwplayer("s1FmPlayer");$scope.volume=_self.getVolume()};var onBuffer=function(callback){if(callback.oldstate==="PLAYING"){_self.buffered=false;$timeout(applyStatusChange,10)}};var onBufferChange=function(callback){var state=player.getState();var buffered=(callback.bufferPercent>=100||state==="PLAYING")&&state!=="PAUSED";if(buffered!==_self.buffered){_self.buffered=buffered;$timeout(applyStatusChange,10)}};var onPlay=function(callback){if(callback.oldstate==="PAUSED"){$timeout(player.pause,1,true,true);return}broadCastStartPlayingEvent();_self.playing=true;_self.buffered=true;$timeout(applyStatusChange,10)};var onPause=function(){reset()};var onError=function(){reset();$timeout(applyStatusChange,10)};this.startFMBroadcast=function(){startPlay()};this.playStream=function(element,streamUrl,omitPreroll){if(omitPreroll){playPreroll=false}if(playPreroll&&!isMobileSite){_self.activeLiveStreamElement=element;$scope.playingElement=element;triggerPreroll()}else if(player){if(element!==_self.activeLiveStreamElement){var url=streamUrl?streamUrl:liveFmUrl;url+=uuidParam;$scope.playingElement=element;player.load([{file:url}]);_self.activeLiveStreamElement=element;play()}else{var activeElement=_self.activeLiveStreamElement;player.pause(true);window.ivwPI(ivwTrackingString);gtmTrack("pause",activeElement.gtmLabel);$timeout.cancel(gtmPlayPromise)}}};this.setVolume=function(percentage){if(player){player.setVolume(percentage)}};this.getVolume=function(){if(player){return player.getVolume()}};var initPlayer=function(){var events={onReady:onReady,onBuffer:onBuffer,onBufferChange:onBufferChange,onPlay:onPlay,onPause:onPause,onError:onError};config.id="s1FmPlayer";config.playlist=[{file:liveFmUrl}];config.controls=false;config.primary="html5";config.autostart=false;config.width=1;config.height=1;config.events=events;jwplayer.key="vQ588HitWJxPu/Um4QWiZ8ZErot4bLHE/A5VIg==";jwplayer("s1FmPlayer").setup(config)};initPlayer();registerA11y();uuidParam="?uuid="+Sport1Tools.createUUID();$scope.$watch("volume",function(newValue,oldValue){if(newValue!==oldValue){_self.setVolume($scope.volume)}});$scope.$on("$destroy",function(){$element.remove()})}],controllerAs:"jwCtrl"}}]);appDirectives.directive("onairFmStream",[function(){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/audioPlayerDirectives/onair-24-7.html",link:function(scope,element){var imgElement=jQuery("#onairImg247");var imageFilter="http://assets.sport1.de/imagix/filter2/jpeg/_set=dyn_size,width=388,height=354,focus=50x50/";var onImageLoaded=function(){scope.loading=false;scope.$apply()};var onImageError=function(){scope.loading=false;scope.$apply();imgElement.attr("src","bundles/sport1portal/images/Konferenz_bild.jpg")};var getImageFilterUrl=function(imageUrl){var result="errorUrl";if(imageUrl){result=imageFilter+imageUrl.replace("http://assets.sport1.de","")}return result};scope.loading=true;imgElement.on("load",onImageLoaded).on("error",onImageError);var unwatchActiveEpgElement=scope.$parent.$watch("activeEPGElement",function(newValue,oldValue){if(newValue!==oldValue||newValue&&!imgElement.attr("src")){if(newValue&&oldValue&&newValue.image===oldValue.image&&imgElement.attr("src")){return}scope.loading=true;scope.imgUrl=getImageFilterUrl(newValue.image)}});scope.$on("$destroy",function(){unwatchActiveEpgElement();imgElement.off("load",onImageLoaded).off("error",onImageError);element.remove()})}}}]);appDirectives.directive("onairLive",["graphicService",function(graphicService){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/audioPlayerDirectives/onair-live.html",link:function(scope,element){var venueFallbackImgUrl="/bundles/sport1portal/images/Stadion_fallback.jpg";var dtmImage="/bundles/sport1portal/images/DTM_Teaser.jpg";var lastLoadedImgUrl=null;scope.venueUrl="";var showFallbackVenueImage=function(){var imgTag=jQuery("#venue-image");if(imgTag.attr("src")!==venueFallbackImgUrl){jQuery("#venue-image").attr("src",scope.selectedMatch.sportId==="42"?dtmImage:venueFallbackImgUrl);jQuery(".s1-inner-venue-container").addClass("fallback");jQuery(".s1-venue-image-cover").hide()}};var onImageLoaded=function(event){if(event.target.naturalWidth<=1&&event.target.naturalHeight<=1){showFallbackVenueImage()}else if(!event.target.src.match(venueFallbackImgUrl)){var innerVenueContainer=jQuery(".s1-inner-venue-container");if(innerVenueContainer.hasClass("fallback")){innerVenueContainer.removeClass("fallback");jQuery(".s1-venue-image-cover").show()}scope.loading=false;lastLoadedImgUrl=event.target.src;scope.$apply()}else{lastLoadedImgUrl=venueFallbackImgUrl;scope.loading=false;scope.$apply()}};var onImageError=function(){showFallbackVenueImage()};var checkForVenueData=function(){var selectedMatch=scope.selectedMatch;if(selectedMatch&&!selectedMatch.hasOwnProperty("venueId")){showFallbackVenueImage()}else{jQuery("#venue-image").attr("src","");scope.venueUrl=graphicService.getVenueImageUrl(selectedMatch.venueId)}};scope.loading=true;checkForVenueData();jQuery("#venue-image").on("load",onImageLoaded).on("error",onImageError);var unwatchSelectedMatch=scope.$watch("selectedMatch",function(newValue,oldValue){if(newValue!==oldValue&&newValue.id!==oldValue.id){checkForVenueData();var selectedMatch=newValue;var selectedMatchVenueImageUrl=selectedMatch.venueId?graphicService.getVenueImageUrl(selectedMatch.venueId):venueFallbackImgUrl;if(lastLoadedImgUrl&&lastLoadedImgUrl!==selectedMatchVenueImageUrl){scope.loading=true;scope.venueUrl=selectedMatchVenueImageUrl}}});scope.$on("$destroy",function(){unwatchSelectedMatch();jQuery("#venue-image").off("load",onImageLoaded).off("error",onImageError);element.remove()})}}}]);appDirectives.directive("onairLiveSi",[function(){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/audioPlayerDirectives/onair-live-si.html",link:function(scope,element){var imgElement=jQuery("#onairLiveSiImg");var imageFilter="http://assets.sport1.de/imagix/filter2/jpeg/_set=dyn_size,width=388,height=354,focus=50x50/";var onImageLoaded=function(){scope.loading=false;scope.$apply()};var onImageError=function(){scope.loading=false;scope.$apply();imgElement.attr("src","bundles/sport1portal/images/Konferenz_bild.jpg")};var getImageFilterUrl=function(imageUrl){var result="errorUrl";if(imageUrl){result=imageFilter+imageUrl.replace("http://assets.sport1.de","")}return result};imgElement.on("load",onImageLoaded).on("error",onImageError);if(scope.$parent.selectedMatch.type==="epg"){scope.loading=true;scope.imageUrl=getImageFilterUrl(scope.$parent.selectedMatch.image);scope.title=scope.$parent.selectedMatch.title}var unwatchActiveEpgElement=scope.$parent.$watch("selectedMatch",function(newValue,oldValue){if(newValue!==oldValue&&newValue.type==="epg"){scope.title=newValue.title;if(newValue&&oldValue&&newValue.image===oldValue.image){return}scope.loading=true;scope.imageUrl=getImageFilterUrl(newValue.image)}});scope.$on("$destroy",function(){unwatchActiveEpgElement();imgElement.off("load",onImageLoaded).off("error",onImageError);element.remove()})}}}]);appDirectives.directive("prerollVideo",["fmPopUpPlayerAdService",function(fmPopUpPlayerAdService){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/audioPlayerDirectives/video-preroll-container.html",controller:["$scope","$element",function($scope,$element){var pseudoVideo="/bundles/sport1portal/images/fmpopupPseudoVideo.m4v";var player=null;var config={};var _self=this;var prerollFinished=false;var prerollStarted=false;var startPrerollTries=0;var startPrerollTimeoutId;var checkPrerollStateTimeoutId;var hasPreroll=function(){if(window.myAd){var adbreaks={preroll1:"pre"};window.myAd.addAdvertisingToJWConfig(config,adbreaks)}return config.hasOwnProperty("advertising")};var fadeOutPrerollCover=function(){jQuery(".s1-video-preroll-cover").fadeOut(200)};var sizeBlockerElementsDown=function(){jQuery(".s1-fm-audio-player").addClass("preroll-finished");jQuery(".s1-fm-audio-player-container").addClass("preroll-finished")};var handleAdComplete=function(){fadeOutPrerollCover();sizeBlockerElementsDown();$scope.jwCtrl.startFMBroadcast();prerollFinished=true;prerollStarted=false;startPrerollTries=0;window.clearTimeout(startPrerollTimeoutId);window.clearTimeout(checkPrerollStateTimeoutId)};var handleError=function(){console.log("Preroll error!!");if(player){player.pause(true)}handleAdComplete()};var checkPrerollState;var startPreroll=function(){if(startPrerollTries<2){startPrerollTimeoutId=window.setTimeout(player.play,50,true);checkPrerollStateTimeoutId=window.setTimeout(checkPrerollState,2e3);startPrerollTries++}else{handleError()}};checkPrerollState=function(){if(!prerollStarted){if(player&&player.getState()!=="BUFFERING"){startPreroll()}}};var onPrerollCoverFadedIn=function(){jQuery(".s1-fm-audio-player-container").addClass("preroll-loaded ")};var fadeInPrerollCover=function(){jQuery(".s1-video-preroll-cover").fadeIn(200,onPrerollCoverFadedIn)};var sizeBlockerElementsUp=function(){jQuery(".s1-fm-audio-player").removeClass("preroll-finished");jQuery(".s1-fm-audio-player-container").removeClass("preroll-finished")};var onReady=function(){var isMobileBrowser=Sport1Tools.deeplinking.isMobile()?true:false;if(isMobileBrowser){jQuery(".s1-fm-audio-player-container").addClass("preroll-loaded ")}player=jwplayer("fmPrerollPlayer");if(!isMobileBrowser){startPreroll()}};var onAdImpression=function(){prerollStarted=true};var gtmTrack=function(action,label){if(!window.dataLayer||!action||!label){return}window.dataLayer.push({event:"ga_event",eventCategory:"Sport1FmPopUp",eventAction:action,eventLabel:label})};var onAdComplete=function(){gtmTrack("viewed","preroll");handleAdComplete()};var onPlay=function(){if(prerollFinished){player.stop()}};var onError=function(){handleError()};var initPlayer=function(){var isMobileBrowser=Sport1Tools.deeplinking.isMobile()?true:false;var events={onReady:onReady,onAdImpression:onAdImpression,onAdComplete:onAdComplete,onPlay:onPlay,onSetupError:onError,onAdError:onError,onError:onError};config.id="fmPrerollPlayer";config.playlist=[{file:pseudoVideo}];config.primary="flash";config.width=728;config.height=410;config.events=events;config.controls=true;config.autostart=false;if(isMobileBrowser){config.skin=jwplayer.version.split(".")[1]>=10?"five":undefined}jwplayer.key="vQ588HitWJxPu/Um4QWiZ8ZErot4bLHE/A5VIg==";jwplayer("fmPrerollPlayer").setup(config)};this.playPreroll=function(){try{if(fmPopUpPlayerAdService.areAdsInitialized()){if(hasPreroll()){initPlayer();sizeBlockerElementsUp();fadeInPrerollCover()}else{handleAdComplete()}}else{if(window.myAd&&typeof window.myAd==="object"){fadeInPrerollCover();fmPopUpPlayerAdService.registerObserverForAdInitUpdate(_self)}else{$scope.jwCtrl.startFMBroadcast()}}}catch(e){handleError()}};this.notify=function(){if(fmPopUpPlayerAdService.areAdsInitialized()){_self.playPreroll();fmPopUpPlayerAdService.unregisterObserverForAdInitUpdate(_self)}};sizeBlockerElementsDown();$scope.$on("$destroy",function(){$element.remove()})}],controllerAs:"prerollCtrl"}}]);appDirectives.directive("volumeButton",[function(){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/audioPlayerDirectives/volume-button.html",controllerAs:"volumeCtrl",controller:["$scope","$element","$attrs","$timeout",function($scope,$element,$attrs,$timeout){var _self=this;var sliderInitialized=false;var sliderBox=jQuery(".s1-audio-player-slider-box");var isMouseOverSliderBox=false;var checkToCloseSliderBoxTimeout=null;_self.showSlider=false;var updateVolumeOnSliderShow=function(){$scope.volume=$scope.volume+1;$scope.$apply()};var removeMouseEventsToSliderBox=function(){sliderBox.off()};var checkToCloseSliderBox=function(){if(!isMouseOverSliderBox){_self.showSlider=false;$timeout.cancel(checkToCloseSliderBoxTimeout);removeMouseEventsToSliderBox()}};var addMouseEventsToSliderBox=function(){sliderBox.on("mouseenter",function(){$timeout.cancel(checkToCloseSliderBoxTimeout);isMouseOverSliderBox=true});sliderBox.on("mouseleave",function(){isMouseOverSliderBox=false;checkToCloseSliderBoxTimeout=$timeout(checkToCloseSliderBox,1e3)})};jQuery(".s1-audio-player-volume-button").on("click",function(event){if(!_self.showSlider&&event.eventPhase===2){_self.showSlider=true;$scope.$apply();updateVolumeOnSliderShow();sliderInitialized=true;addMouseEventsToSliderBox();checkToCloseSliderBoxTimeout=$timeout(checkToCloseSliderBox,1e3)}})}]}}]);(function(){"use strict";var Directive;Directive=function($window){return{template:'<div id="disqus_thread"></div>',restrict:"A",link:function(scope,element,attrs){var dsq;if(!attrs.disqusShortname||!attrs.disqusIdentifier){return false}$window.disqus_config=function(){var trackGoogle;trackGoogle=function(label){var ref;if(label){return(ref=window.dataLayer)!=null?ref.push({event:"ga_event",eventAction:"click",eventCategory:"disqus",eventLabel:label}):void 0}};this.callbacks.onNewComment=[$.proxy(trackGoogle,null,"comment"),window.ivwPI];this.callbacks.onPaginate=[$.proxy(trackGoogle,null,"paginate"),window.ivwPI]};$window.disqus_identifier=attrs.disqusIdentifier;dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src="//"+attrs.disqusShortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);return $("#disqus_thread",element).sport1Disqus({more:"Mehr anzeigen",click:function(){window.ivwPI();if(window.dataLayer){return window.dataLayer.push({event:"ga_event",eventAction:"click",eventCategory:"disqus",eventLabel:"more"})}}})}}};Directive.$inject=["$window"];return angular.module("sport1.controllers").directive("disqusBlock",Directive)})();appDirectives.directive("scheduleElementMatchInfo",["$templateRequest","$compile",function($templateRequest,$compile){"use strict";return{restrict:"E",replace:"true",scope:{element:"="},link:function(scope,element){var matchElement=scope.element,sportId=matchElement.sportId,template;var resolveTemplate=function(sportId){var platform=Sport1Tools.isMobileSite()?"mobile":"desktop";if(sportId==="1"){return platform+"/angularjs/directives/fmplayer/templates/schedule-element-soccer-info.html"}else if(sportId==="42"){return platform+"/angularjs/directives/fmplayer/templates/schedule-element-dtm-info.html"}};template=resolveTemplate(sportId);if(template){$templateRequest(template).then(function(html){element.html(html);$compile(element.contents())(scope)})}}}}]);appDirectives.directive("scheduleElement",["$compile","$templateRequest",function($compile,$templateRequest){"use strict";return{restrict:"E",compile:function compile(){return{pre:function preLink(scope,iElement,iAttrs){var type=iAttrs.type,platform=Sport1Tools.isMobileSite()?"mobile":"desktop";$templateRequest(platform+"/angularjs/directives/fmplayer/templates/"+type+"-schedule-element.html").then(function(html){iElement.html(html);$compile(iElement.contents())(scope)})},post:function postLink(scope,iElement){scope.element.scrollToBehaviour=function(){iElement[0].scrollIntoView(true,{behaviour:"instant",block:"start"})}}}}}}]);(function(){"use strict";var Directive;Directive=function($compile,$q){return{restrict:"E",scope:false,replace:true,compile:function(){Directive=function(){function Directive(scope1,definition,competition,tableRow,tableData){var column,content,i,j,key,len,len1,newClass,promiseResultKey,ref,ref1,ref2,template,value;this.scope=scope1;this.definition=definition;this.competition=competition;this.tableRow=tableRow;this.tableData=tableData;this.elements=[];this.contentPromises={};ref=this.definition.columns;for(i=0,len=ref.length;i<len;i++){column=ref[i];this.compile=column.compile||false;this.attributes=[];content="";if(column.content!=null){content=column.content({competition:this.competition,tableRow:this.tableRow,tableData:this.tableData})}switch(column.type){case"html":this.compile=true;break;case"textPromise":this.compile=true;promiseResultKey=("promise_"+column.id).replace(/-/g,"_");this.attributes.push('ng-bind="'+promiseResultKey+'"');this.contentPromises[promiseResultKey]=content;content=""}this.classes=["s1-table-row-"+column.slug];if(column.staticClasses!=null){ref1=column.staticClasses;for(j=0,len1=ref1.length;j<len1;j++){newClass=ref1[j];this.classes.push(newClass)}}if(column["class"]!=null){newClass=column["class"]({competition:this.competition,tableRow:this.tableRow,tableData:this.tableData});if(newClass!=null&&newClass){this.classes.push(""+(column.classPrefix?column.classPrefix:"")+newClass+(column.classSuffix!=null?column.classSuffix:""))}}if(column.customAttributes!=null){ref2=column.customAttributes;for(key in ref2){value=ref2[key];this.attributes.push(key+'="'+value({tableRow:this.tableRow,tableData:this.tableData})+'"')}}template=angular.element('<div\n  class="'+this.classes.join(" ")+'"\n  '+this.attributes.join(" ")+">\n    "+content+"\n</div>");if(this.compile){$compile(template)(this.scope)}this.elements.push(template)}$q.all(this.contentPromises).then(function(_this){return function(responses){return _this.scope.$evalAsync(function(){var results;results=[];for(key in responses){value=responses[key];results.push(_this.scope[key]=value)}return results})}}(this))}return Directive}();return{pre:function(scope,element){return scope.$watch("options.layout",function(layout){var dir;if(layout!=null){dir=new Directive(scope,scope.tableDefinition,scope.options.competition,scope.tableRow,scope.tableData);return element.replaceWith(dir.elements)}})}}}}};Directive.$inject=["$compile","$q"];return angular.module("sport1.directives").directive("genericTableCells",Directive)})();appDirectives.directive("genericTableBody",["$http","$templateCache","$compile",function($http,$templateCache,$compile){"use strict";return{restrict:"E",link:{pre:function(scope,element,attrs){var loadTemplate=function(options){var templateUrl="common/angularjs/directives/genericTableDirective/";templateUrl+="body";templateUrl+=".";templateUrl+=options.contentType;templateUrl+=".";templateUrl+=attrs.customStyle||options.competition._type;templateUrl+=".";templateUrl+=options.layout;templateUrl+=".html";var templateContent=$templateCache.get(templateUrl);if(templateContent){element.replaceWith($compile(templateContent)(scope))}};scope.$watch("options.layout",function(layout){if(typeof layout!=="undefined"){loadTemplate(scope.options)}})}}}}]);appDirectives.directive("genericTable",["$http","$templateCache","$compile",function($http,$templateCache,$compile){"use strict";return{restrict:"E",scope:{tableData:"=",options:"=tableOptions",loading:"=tableLoading",toPortal:"=toPortal"},link:{pre:function(scope,element){var loadTemplate=function(options){var prefix="common";if(options.contentType==="standings"&&options.competition._type.indexOf(["division","tournament"])!==-1){prefix=Sport1Tools.isMobileSite()?"mobile":"desktop"}var templateUrl=prefix+"/angularjs/directives/genericTableDirective/";templateUrl+="table";templateUrl+=".";templateUrl+=options.contentType;templateUrl+=".";templateUrl+=options.competition._type;templateUrl+=".";templateUrl+=options.layout;templateUrl+=".html";var templateContent=$templateCache.get(templateUrl);if(templateContent){element.empty();var table=angular.element(templateContent);table.attr("ng-show","!loading");element.append($compile(table)(scope));var spinner=angular.element('<s1-spinner s1-visible="loading"></s1-spinner>');table.before($compile(spinner)(scope))}};scope.$watch("options.layout",function(layout){if(typeof layout!=="undefined"){loadTemplate(scope.options)}})}},controller:["$scope","tableDefinitionService",function($scope,TableDefinition){var ctrl=this;ctrl.optionsWatcher=$scope.$watch("options.layout",function(layout){if(typeof layout==="undefined"||!layout.length){return false}$scope.tableDefinition=TableDefinition.getDefinition({competition:{sport:$scope.options.competition._sport,type:$scope.options.competition._type},layout:$scope.options.layout,content:$scope.options.contentType});$scope.tableClass=["s1-content-"+$scope.options.contentType,"s1-competition-"+$scope.options.competition._type,"s1-competition-id-"+$scope.options.competition.id,"s1-layout-"+$scope.options.layout]});ctrl.toPortal=$scope.toPortal;ctrl.rowCount=0;$scope.initRowCount=function(){ctrl.rowCount=0};$scope.incRowCount=function(row){ctrl.rowCount++;row._totalIndex=ctrl.rowCount}}]}}]);(function(){"use strict";var Directive;Directive=function(){return{restrict:"E",scope:false,replace:true,template:'<div class="s1-table-header"></div>',compile:function(){Directive=function(){function Directive(definition,competition,group,tableData){var column,i,j,len,len1,newClass,ref,ref1,title;this.definition=definition;this.competition=competition;this.group=group;this.tableData=tableData;this.elements=[];ref=this.definition.columns;for(i=0,len=ref.length;i<len;i++){column=ref[i];if(column.title!=null){title=column.title({competition:this.competition,group:this.group,tableData:this.tableData})}else{title=""}this.classes=["s1-table-header-"+column.slug];if(column.staticClasses!=null){ref1=column.staticClasses;for(j=0,len1=ref1.length;j<len1;j++){newClass=ref1[j];this.classes.push(newClass)}}if(column.titleClass!=null){this.classes.push(column.titleClass)}this.elements.push('<div\n  class="'+this.classes.join(" ")+'">\n    '+title+"\n</div>")}}return Directive}();return{pre:function(scope,element){return scope.$watch("options.layout",function(layout){var dir;if(layout!=null){dir=new Directive(scope.tableDefinition,scope.options.competition,scope.group,scope.tableData);return element.html(dir.elements)}})},post:function(){}}}}};Directive.$inject=[];return angular.module("sport1.directives").directive("genericTableHeader",Directive)})();(function(){"use strict";var Directive;Directive=function($timeout,SportData,TickerAd,Ticker,Flash){var INFINITE_SCROLL_ITEMS;INFINITE_SCROLL_ITEMS=10;return{restrict:"E",templateUrl:"common/angularjs/directives/liveticker/liveticker.directive.html",scope:{loading:"=",competition:"=",match:"=",telegram:"="},link:function(scope,element){var dir,unwatchMatch;if(scope.telegram==null){scope.telegram=false}dir={tickerData:[],init:function(){scope.loading=true;scope.tickerData=[];if(scope.match!=null){if(scope.match.home!=null){Ticker.setHomeTeam(angular.copy(scope.match.home))}if(scope.match.away!=null){Ticker.setAwayTeam(angular.copy(scope.match.away))}}scope.$on("reloadLiveTicker",function(event,competitionId,matchId){return dir.reloadLiveTicker(competitionId,matchId)});scope.$watch("telegram",function(newValue,oldValue){if(newValue!=null&&newValue!==oldValue){return dir.reloadLiveTicker()}});if(scope.competition!=null&&scope.match!=null){return dir.reloadLiveTicker()}},reloadLiveTicker:function(competitionId,matchId){var ref,ref1;scope.currentRunId=Date.now();if(competitionId==null){competitionId=(ref=scope.competition)!=null?ref.id:void 0}if(matchId==null){matchId=(ref1=scope.match)!=null?ref1.id:void 0}if(competitionId!=null&&matchId!=null){if(scope.telegram){return SportData.getMatchEvents(matchId).then(function(data){return dir.setLiveTicker(data,scope.currentRunId)})}else{return SportData.getMatchTicker(competitionId,matchId).then(function(data){return dir.setLiveTicker(data,scope.currentRunId)})}}else{return false}},setLiveTicker:function(tickerData,runId){if(scope.currentRunId!==runId){return false}dir.updateTickerData(tickerData,runId);return $timeout(function(){return TickerAd.update(dir.tickerData,INFINITE_SCROLL_ITEMS)},200)},updateTickerData:function(tickerData,runId){var event,index,j,len,ref,ref1,ticker;if(scope.currentRunId!==runId){return false}Ticker.setTickerData(tickerData);dir.tickerData=[];scope.tickerData=[];if(!tickerData.length){return dir.displayNoDataMessage()}else{Flash.clear("ltac_warn_1");for(index=j=0,len=tickerData.length;j<len;index=++j){ticker=tickerData[index];event=scope.telegram?ticker:ticker.event;if(event!=null){if(scope.telegram){ticker._display={eventIcon:Ticker.getEventIcon(event,index,scope.competition),eventHeaderMain:Ticker.getEventHeaderMain(event,index,scope.competition),eventHeaderSub:Ticker.getEventHeaderSub(event,index,scope.competition),eventHeaderSubAdd:Ticker.getEventHeaderSubAdd(event,index,scope.competition),eventContent:Ticker.getEventContent(event,index,scope.competition)};ticker.content="";if((ref=event.kind)!==""&&ref!=="lineup"&&ref!=="bench"){dir.tickerData.push(ticker)}}else{ticker._display={eventIcon:Ticker.getEventIcon(event,index,scope.competition)};ticker=Ticker.getReplacedContent(ticker,index,scope.competition);if((ref1=event.kind)!=="lineup"&&ref1!=="bench"){dir.tickerData.push(ticker)}}}else if(!scope.telegram){dir.tickerData.push(ticker)}}if(dir.tickerData.length){SportData.sortTicker(dir.tickerData);scope.loading=false;return $timeout(function(){return dir.displayMoreEvents()},100)}else{return dir.displayNoDataMessage()}}},displayNoDataMessage:function(){scope.loading=false;scope.moreTickerDataExists=false;return Flash.warn("ltac_warn_1","Daten stehen zur Zeit leider nicht zur Verfügung.","No API Data for `getMatchTicker` in ctrl.updateTickerData")},displayMoreEvents:function(){var i,j,nextEvents,ref,ref1;nextEvents=[];if(dir.tickerData==null){dir.tickerData=[]}for(i=j=1,ref=INFINITE_SCROLL_ITEMS;1<=ref?j<=ref:j>=ref;i=1<=ref?++j:--j){if(dir.tickerData.length>scope.tickerData.length+nextEvents.length){nextEvents.push(dir.tickerData[dir.tickerData.length-scope.tickerData.length-nextEvents.length-1])}}if(nextEvents.length){(ref1=scope.tickerData).push.apply(ref1,nextEvents)}if(typeof event!=="undefined"&&event!==null&&window.ivwPI!=null){window.ivwPI()}scope.moreTickerDataExists=dir.tickerData.length>scope.tickerData.length;return scope.moreTickerDataExists}};scope.displayMoreEvents=dir.displayMoreEvents;dir.init();unwatchMatch=scope.$watch("match",function(newValue,oldValue){if(newValue!=null&&newValue!==oldValue){Flash.clear("ltac_warn_1");return dir.init()}});return element.on("$destroy",function(){
unwatchMatch();return Flash.clear("ltac_warn_1")})}}};Directive.$inject=["$timeout","sportDataService","tickerAdService","tickerService","FlashService"];return angular.module("sport1.directives").directive("liveticker",Directive)})();appDirectives.directive("chooseFavourites",["sportDataService","graphicService",function(sportDataService,graphicService){"use strict";var chooseFavouritesController=["$scope",function($scope){$scope.showTeam=true;$scope.sportSelected=false;$scope.settingsStored=!!localStorage.getItem("s1-recommender-fav-sport");$scope.init=function(){if($scope.teamId!==null){$scope.setTeamStatistics($scope.teamId)}};$scope.resetFavourites=function(){localStorage.removeItem("s1-recommender-fav-sport");localStorage.removeItem("s1-recommender-fav-team");localStorage.removeItem("s1-recommender-fav-team-id");$scope.teamName=null;$scope.teamId=null;$scope.settingsStored=false};$scope.inputFavouriteSport=function(sportName){$scope.sportSelected=true;$scope.sportName=sportName;$scope.showTeam=sportName==="Fußball";if(!$scope.showTeam){$scope.teamName=null;$scope.teamId=null}};$scope.inputFavouriteTeam=function(teamName,teamId){$scope.teamName=teamName;$scope.teamId=teamId};$scope.inputTeamMobile=function(){if($scope.selected===""){$scope.storeNoFavourites()}else{var inputTeam=$scope.selected.split("--");$scope.inputFavouriteTeam(inputTeam[0],inputTeam[1])}};$scope.storeNoFavourites=function(){console.log("Favourites settings stored");$scope.settingsStored=true;localStorage.setItem("s1-recommender-fav-sport","None");if(localStorage.getItem("s1-recommender-profile")===null){localStorage.setItem("s1-recommender-profile",JSON.stringify([]))}$("#s1-news-recommender").show(500)};$scope.storeFavourites=function(){if($scope.sportName!==undefined){localStorage.setItem("s1-recommender-fav-sport",$scope.sportName);if($scope.teamName!==null&&$scope.teamId!==null){localStorage.setItem("s1-recommender-fav-team",$scope.teamName);localStorage.setItem("s1-recommender-fav-team-id",$scope.teamId)}if(localStorage.getItem("s1-recommender-profile")===null){var userProfile=[[$scope.sportName,1]];localStorage.setItem("s1-recommender-profile",JSON.stringify(userProfile))}console.log("Favourites settings stored");$scope.settingsStored=true;$scope.init();$("#s1-news-recommender").show(500)}else{console.log("No sport selected")}};$scope.setLastMatches=function(teamId){var dateFrom=new Date;dateFrom.setFullYear(dateFrom.getFullYear()-1);var dateTo=new Date;sportDataService.getMatchesFromToByTeam(Sport1Tools.dateToDateString(dateFrom),Sport1Tools.dateToDateString(dateTo),teamId).then(function(matchesFromTo){var lastMatches=[];matchesFromTo.forEach(function(competition){competition.season.forEach(function(season){season.round.forEach(function(round){if(typeof round.match!=="undefined"){var matches=round.match;matches.forEach(function(match){var opponentTeam,goalsTeam,goalsOpponent;if(match.home.id===teamId){opponentTeam=match.away;goalsTeam=match.match_result[0].match_result;goalsOpponent=match.match_result[1].match_result}else{opponentTeam=match.home;goalsTeam=match.match_result[1].match_result;goalsOpponent=match.match_result[0].match_result}var team={id:opponentTeam.id};sportDataService.setTeamLogo(team,"100x100");lastMatches.unshift({id:match.id,competition:matchesFromTo[0].name,season:season.name,matchday:match.matchday,match_date:match.match_date,date:Sport1Tools.getDateFromGermanDateTime(match.match_date).getTime(),match_result:{team:goalsTeam,opponent:goalsOpponent},opponentTeam:opponentTeam,opponentTeamLogo:team.logo})})}})})});lastMatches.sort(function(a,b){return a.date<=b.date?1:-1});lastMatches.slice(0,10);$scope.lastMatches={competition:matchesFromTo[0].name,matches:lastMatches}})};$scope.setTopScorer=function(teamId){var players=[];sportDataService.getSeasonsByTeam(teamId).then(function(seasonsByCurrentTeam){if(seasonsByCurrentTeam[0]!==undefined){sportDataService.getPersonStatsBySeasonTeam(seasonsByCurrentTeam[0].season[0].id,teamId).then(function(teamStats){teamStats.squad.forEach(function(player){if(player.person.person_stats!==undefined){player.person.logo=graphicService.getPersonImgUrl(player.person.id,"l");player.person.logoNation=graphicService.getNationImgUrl(player.person.country[0].id,"60x60");players.push(player.person)}});if(players.length!==0){players.sort(function(a,b){return parseInt(a.person_stats.score,10)<=parseInt(b.person_stats.score,10)?1:-1})}$scope.topScorers=players})}})};$scope.setNextMatches=function(teamId){var nextMatches=[];var dateFrom=new Date;var dateTo=new Date;dateTo.setFullYear(dateTo.getFullYear()+1);sportDataService.getMatchesFromToByTeam(Sport1Tools.dateToDateString(dateFrom),Sport1Tools.dateToDateString(dateTo),teamId).then(function(matchesFromTo){matchesFromTo.forEach(function(competition){competition.season.forEach(function(season){season.round.forEach(function(round){if(typeof round.match!=="undefined"){var matches=round.match;matches.forEach(function(match){sportDataService.setTeamLogo(match.home,"100x100");sportDataService.setTeamLogo(match.away,"100x100");nextMatches.push({home:match.home,away:match.away,season:season.name,match_date:match.match_date,match_time:match.match_time,date:Sport1Tools.getDateFromGermanDateTime(match.match_date).getTime(),league:{name:competition.name,logo:graphicService.getCompetitionIconUrl(competition.id,50)},atHome:match.home.id===teamId})})}})})});nextMatches.sort(function(a,b){return a.date>=b.date?1:-1});$scope.nextMatches=nextMatches})};$scope.setTeamStatistics=function(teamId){$scope.setLastMatches(teamId);$scope.setTopScorer(teamId);$scope.setNextMatches(teamId)};$scope.sportName="Fußball";$scope.teamName=localStorage.getItem("s1-recommender-fav-team");$scope.teamId=localStorage.getItem("s1-recommender-fav-team-id");$scope.init()}];var getTemplate=function(){return"common/angularjs/directives/newsRecommenderDirectives/teaminfos.html"};var link=function(){angular.element("#s1-select-fav-sport").sport1PopupButton({dynamic:true,dynamicPropagation:true});angular.element("#s1-select-fav-team").sport1PopupButton({dynamic:true,dynamicPropagation:true})};return{controller:chooseFavouritesController,restrict:"E",replace:true,templateUrl:getTemplate,link:link}}]);appDirectives.directive("readArticles",[function(){"use strict";var link=function(scope){var articles=$.parseJSON(localStorage.getItem("articles"));var maxArticles=10;if(articles){var lastReadArticles=[];$.each(articles.reverse().slice(0,maxArticles),function(index,value){lastReadArticles.push(value)});scope.lastReadArticles=lastReadArticles;if(scope.lastReadArticles.length>0){angular.element(".s1-last-read-articles-widget").show()}}};return{restrict:"E",replace:true,templateUrl:"common/angularjs/directives/newsRecommenderDirectives/readArticlesContent.html",link:link}}]);appDirectives.directive("recommendedArticles",["$http",function($http){"use strict";var recommendedArticlesController=["$scope","$location",function($scope,$location){$scope.init=function(){var index=parseInt(localStorage.getItem("s1-recommender-index"),10);var percentage=parseInt(localStorage.getItem("s1-recommender-percentage"),10);if(index<=percentage){if(!localStorage.getItem("s1-recommender-fav-sport")){$("#s1-news-recommender").hide();$scope.recommendedArticles=[]}else{$scope.loadContentBased()}}};$scope.getArticleByPath=function(recommendedArticle){$http({method:"GET",url:$location.protocol()+"://"+$location.host()+"/api/recommender/article",contentType:"application/json; charset=utf-8",params:{path:recommendedArticle.article}}).then(function mySucces(response){if($scope.recommendedArticles===undefined||$scope.recommendedArticles===null){$scope.recommendedArticles=[]}var article=response.data;article.similarity=recommendedArticle.similarity;$scope.recommendedArticles.push(article)},function myError(response){console.log(response.statusText)})};$scope.loadContentBased=function(){var userProfile=localStorage.getItem("s1-recommender-profile");var user=localStorage.getItem("s1-guid");$http({method:"POST",url:Sport1Tools.getRecommenderUrl()+"/recommendations/content-based",contentType:"application/json; charset=utf-8",data:{userProfile:userProfile,user:user}}).then(function mySucces(response){$scope.retrievedArticles=response.data;$scope.loadNextArticles(12)},function myError(response){console.log(response.statusText)})};$scope.sliceBodyTextForPreview=function(body){var result;if(body.length>150){result=body.slice(0,150)+"..."}else{result=body}return result};$scope.loadNextArticles=function(count){if($scope.retrievedArticles!==undefined&&$scope.retrievedArticles.length>0){var min=Math.min(count,$scope.retrievedArticles.length);for(var i=0;i<min;i++){$scope.getArticleByPath($scope.retrievedArticles[i])}$scope.retrievedArticles.splice(0,min)}};$scope.removeArticleFromRecommender=function(){var index=$scope.recommendedArticles.indexOf(this.articleWithSimilarity);var userId=localStorage.getItem("s1-guid");$http({method:"POST",url:Sport1Tools.getRecommenderUrl()+"/rating",contentType:"application/json; charset=utf-8",data:{user:userId,rating:1,article:$scope.recommendedArticles[index].path,tags:[]}}).then(function mySucces(response){console.log(response.data)},function myError(response){console.log(response.statusText)});$scope.recommendedArticles.splice(index,1);if($scope.recommendedArticles.length<10){$scope.loadNextArticles(12-$scope.recommendedArticles.length)}};$scope.init()}];var getTemplate=function(){if(Sport1Tools.isMobileSite()){return"common/angularjs/directives/newsRecommenderDirectives/recommenderContentMobile.html"}else{return"common/angularjs/directives/newsRecommenderDirectives/recommenderContent.html"}};return{controller:recommendedArticlesController,restrict:"E",replace:true,templateUrl:getTemplate}}]);appDirectives.directive("userProfileGeneration",["$http",function($http){"use strict";var userProfileGenerationController=["$scope",function($scope){$scope.init=function(){$scope.saveToUserProfile()};$scope.saveRating=function(userId,url,rating,keywordsArray){var weightedKeywords=[];keywordsArray.forEach(function(entry){var obj={};obj.keyword=entry;obj.weight=1;weightedKeywords.push(obj)});var index=parseInt(localStorage.getItem("s1-recommender-index"),10);var percentage=parseInt(localStorage.getItem("s1-recommender-percentage"),10);if(index<=percentage){$http({method:"POST",url:Sport1Tools.getRecommenderUrl()+"/rating",contentType:"application/json; charset=utf-8",data:{user:userId,rating:rating,article:url,tags:weightedKeywords}}).then(function mySucces(response){console.log(response.data)},function myError(response){console.log(response.statusText)})}};$scope.saveToUserProfile=function(){var storedArticles=$.parseJSON(localStorage.getItem("articles"));var userId=localStorage.getItem("s1-guid");var userProfile=$.parseJSON(localStorage.getItem("s1-recommender-profile"));var url=window.location.pathname;if(userProfile===null){userProfile=[]}var keywords=$("meta[name=news_keywords]").attr("content");var keywordsArray=keywords.split(",");keywordsArray.forEach(function(entry){var inside=false;userProfile.forEach(function(profileKeyword){if(profileKeyword[0]===entry){inside=true;profileKeyword[1]+=1}});if(!inside){userProfile.push([entry,1])}});localStorage.setItem("s1-recommender-profile",JSON.stringify(userProfile));if(storedArticles===null){storedArticles=[]}var inside=false;for(var i=0;i<storedArticles.length;i++){if(storedArticles[i][0]===url){inside=true;break}}var imgUrl=$("meta[name=gsa_thumbnail]").attr("content");if(inside===false){$scope.saveRating(userId,url,3,keywordsArray);var headline=angular.element(".s1-article-headline").text();storedArticles.push([url,headline,imgUrl]);localStorage.setItem("articles",JSON.stringify(storedArticles))}};$scope.init()}];return{controller:userProfileGenerationController,restrict:"E",replace:false,template:""}}]);appDirectives.directive("popupButton",["$document",function($document){"use strict";return{restrict:"E",replace:true,scope:{menuItems:"=",selected:"=",titleId:"@",menuItemLabel:"@",menuItemPrefix:"@",menuItemPostfix:"@",menuItemImage:"=selectedMenuItemImage",menuItemImageClass:"@",menuItemsLoading:"=",menuItemClickHandler:"="},transclude:true,templateUrl:"common/angularjs/directives/popup-button/popup-button.html",link:function(scope,element){var $scrollContent;if(!Sport1Tools.isMobileSite()){$scrollContent=$(".s1-scroll-content",element)}else{$scrollContent=$(".s1-scroll-view",element)}var $popupButton=$(".s1-popup-button",element);var $title=$(".s1-popup-button-title",$popupButton);var $scrollView=$(".s1-scroll-view",$popupButton);var $menu=$(".s1-popup-button-menu",$scrollView);var menuOpenClass="s1-open";var _toggleMenu;var _toggleMenuClickHandler;var _keyUpHandler;_toggleMenu=function(){$popupButton.toggleClass(menuOpenClass);if(!Sport1Tools.isMobileSite()){$scrollContent.scrollTop($scrollContent.find("li.active").position().top)}else{$scrollContent.scrollTop($scrollContent.scrollTop()+$scrollContent.find("li.active").position().top)}setTimeout(function(){if($popupButton.hasClass(menuOpenClass)){$title.off("click",_toggleMenuClickHandler);$document.on("click touchend",_toggleMenuClickHandler);$document.on("keyup",_keyUpHandler)}else{$title.on("click",_toggleMenuClickHandler);$document.off("click touchend",_toggleMenuClickHandler);$document.off("keyup",_keyUpHandler)}},250)};_toggleMenuClickHandler=function(evt){if(!$.contains($menu.get(0),evt.target)){_toggleMenu();evt.preventDefault()}};_keyUpHandler=function(evt){var keyCode=evt.keyCode;switch(keyCode){case 27:var e=jQuery.Event("click touchend");_toggleMenuClickHandler(e);break}};$title.on("click",_toggleMenuClickHandler);scope.isActiveMenuItem=function(menuItem){return scope.selected[scope.menuItemLabel].toString()===menuItem[scope.menuItemLabel].toString()};scope.labelForMenuItem=function(menuItem){var label="";if(menuItem){label=menuItem[scope.menuItemLabel];if(angular.isDefined(scope.menuItemPrefix)){label=scope.menuItemPrefix+" "+label}if(angular.isDefined(scope.menuItemPostfix)){label=label+""+scope.menuItemPostfix}}return label};scope.selectMenuItem=function($event,item){if(scope.selected!==item&&scope.menuItemClickHandler&&jQuery.isFunction(scope.menuItemClickHandler)){scope.menuItemClickHandler(item,$event)}scope.selected=item;_toggleMenu();$event.preventDefault()};scope.$on("$destroy",function(){$title.off("click",_toggleMenuClickHandler)})}}}]);appDirectives.directive("articleRating",["$http",function($http){"use strict";var controller=["$scope",function($scope){$scope.storeRatingOnServer=function(rating){var index=parseInt(localStorage.getItem("s1-recommender-index"),10);var percentage=parseInt(localStorage.getItem("s1-recommender-percentage"),10);if(index<=percentage){var userId=localStorage.getItem("s1-guid");var url=window.location.pathname;$http({method:"POST",url:Sport1Tools.getRecommenderUrl()+"/rating",contentType:"application/json; charset=utf-8",data:{user:userId,rating:rating,article:url,tags:[]}}).then(function mySucces(response){console.log(response.data);console.log("Rating stored")},function myError(response){console.log(response.statusText)})}}}];var link=function(scope){var id;if(Sport1Tools.isMobileSite()){id=8354253}else{id=8388246}$("#pd_rating_holder_"+id+"_p").on("click",".rating-star-icon",function(){var stars=0;switch(this.id){case"PDRTJS_"+id+"_p_stars_5":stars=5;break;case"PDRTJS_"+id+"_p_stars_4":stars=4;break;case"PDRTJS_"+id+"_p_stars_3":stars=3;break;case"PDRTJS_"+id+"_p_stars_2":stars=2;break;case"PDRTJS_"+id+"_p_stars_1":stars=1;break;default:console.log("Default Stars clicked")}if(stars!==0){scope.storeRatingOnServer(stars)}});$("#pd_rating_holder_"+id+"_a").on("click",".rating-star-icon",function(){var stars=0;switch(this.id){case"PDRTJS_"+id+"_a_stars_5":stars=5;break;case"PDRTJS_"+id+"_a_stars_4":stars=4;break;case"PDRTJS_"+id+"_a_stars_3":stars=3;break;case"PDRTJS_"+id+"_a_stars_2":stars=2;break;case"PDRTJS_"+id+"_a_stars_1":stars=1;break;default:console.log("Default Stars clicked")}if(stars!==0){scope.storeRatingOnServer(stars)}})};return{controller:controller,restrict:"E",replace:true,template:"",link:link}}]);appDirectives.directive("s1Glossary",["$templateCache","$http","$compile",function($templateCache,$http,$compile){"use strict";return{restrict:"E",scope:{data:"=",options:"=?"},link:{pre:function(scope,element){var loadTemplate=function(){var templateUrl="common/angularjs/directives/s1GlossaryDirective/glossary."+scope.options.contentType+".html";$http.get(templateUrl,{cache:$templateCache}).success(function(templateContent){element.replaceWith($compile(templateContent)(scope))})};scope.$watch("options",function(options){if(angular.isDefined(options.competition.id)){loadTemplate(options)}})}},controller:["$scope","tableDefinitionService","sportDataService",function($scope){$scope.options=angular.extend({competition:{},contentType:"",layout:""},$scope.options)}]}}]);appDirectives.directive("playerList",[function(){"use strict";return{restrict:"E",replace:true,scope:{players:"=",list:"=",competition:"="},templateUrl:"common/angularjs/directives/soccerTeamListDirective/playerList.html",compile:function(tElement,tAttrs){if(tAttrs.hasOwnProperty("target")){tElement.find("li").attr("anchor-target",tAttrs.target)}else{tElement.find("li").attr("anchor-target","_self")}}}}]);appDirectives.directive("soccerTeamList",[function(){"use strict";return{restrict:"E",replace:true,scope:{players:"=",competition:"="},templateUrl:"common/angularjs/directives/soccerTeamListDirective/soccerTeamList.html",compile:function(tElement,tAttrs){if(tAttrs.hasOwnProperty("target")){tElement.find("player-list").attr("target",tAttrs.target)}}}}]);appDirectives.directive("matchStatistics",["sportDataService",function(sportDataService){"use strict";return{restrict:"E",templateUrl:function(elem,attrs){return attrs.templateUrl},scope:{competitionid:"@",sportid:"@",match:"="},link:function(scope){scope.statistics=[];scope.loading=true;scope.isLive=false;function setRatio(statistics){statistics.forEach(function(statisticData){var homeValue=~~statisticData.home,awayValue=~~statisticData.away,sum=0;statisticData.home_ratio=.5;statisticData.away_ratio=.5;if(!isNaN(homeValue)&&!isNaN(awayValue)){sum=homeValue+awayValue;if(sum>0){statisticData.home_ratio=Math.round(homeValue/sum*100)*.01;statisticData.away_ratio=Math.round(awayValue/sum*100)*.01}}})}function getMatchStatistics(competitionId,sportId,match){if(competitionId&&sportId&&match){var isMatchFinished=match.hasOwnProperty("finished")&&match.finished==="yes"?true:false;scope.isLive=scope.match.isLive;sportDataService.getCompleteMatchTeamStats(competitionId,sportId,match.id,isMatchFinished).then(function(statistics){setRatio(statistics);scope.statistics=statistics;scope.loading=false})}else{console.error("received invalid data")}}getMatchStatistics(scope.competitionid,scope.sportid,scope.match);var unwatchForMatchUpdate=scope.$watch("match",function(newValue,oldValue){if(newValue!==oldValue){scope.loading=true;getMatchStatistics(scope.competitionid,scope.sportid,scope.match)}});scope.$on("$destroy",function(){unwatchForMatchUpdate()})}}}]);appDirectives.directive("videoOnly",["videoService",function(videoService){"use strict";jwplayer.key="vQ588HitWJxPu/Um4QWiZ8ZErot4bLHE/A5VIg==";var baseUrl="//www.sport1.de/api";var controller=["$scope",function($scope){$scope.loading=true;$scope.id=Math.floor(Math.random()*1e3);videoService.setBaseUrl(baseUrl)}];return{controller:controller,restrict:"E",replace:true,scope:{videoId:"@",height:"@",width:"@"},template:'<div id="videoPlayer_{{id}}"><s1-spinner s1-visible="loading"></s1-spinner></div>',link:function(scope,element){videoService.getVideo(scope.videoId).then(function(video){var videoUrls=video.url,imageUrl=video.image+"/width/"+scope.width+"/height/"+scope.height+".jpg",div=element[0];jwplayer(div).setup({id:div.id,skin:jwplayer.version&&jwplayer.version.split(".")[1]>=10?"five":undefined,file:videoUrls.high_quality||videoUrls.mid_quality||videoUrls.low_quality,image:imageUrl,primary:"flash",height:scope.height,width:scope.width})}).finally(function(){scope.loading=false})}}}]);appDirectives.directive("videoOverlay",["videoService","$document","$timeout","urlResolverService",function(videoService,$document,$timeout,urlResolverService){"use strict";return{restrict:"E",templateUrl:"common/angularjs/directives/videoOverlayDirective/videoOverlay.html",scope:{videoId:"@",videoRelatedPlaylistId:"@",videoBaseUrl:"@"},controller:["$scope","$element",function($scope,$element){var getVideo=function(){$element.addClass("loading");videoService.getVideo($scope.videoId).then(function(video){$scope.video=video;$element.removeClass("loading")})};videoService.setBaseUrl($scope.videoBaseUrl);$scope.$watch("videoId",function(newVal){getVideo(newVal)});$scope.close=function(){$scope.$broadcast("$destroy")}}],link:function(scope,element){angular.element("body").addClass("s1-overlay-noscroll");angular.element("html").addClass("s1-overlay-noscroll");$document.on("keyup.videoOverlay",function(evt){if(evt.keyCode===27){scope.$broadcast("$destroy")}});scope.$on("$destroy",function(){angular.element("body").removeClass("s1-overlay-noscroll");angular.element("html").removeClass("s1-overlay-noscroll");element.remove();$document.off(".videoOverlay")});scope.videoDetailPageUrl=urlResolverService.getUrlToVideoPage(scope.videoId)}}}]);appDirectives.directive("videoOverlayBackdrop",[function(){"use strict";return{restrict:"A",link:function(scope,element){element.click(function(evt){if(evt.target===element[0]){scope.$broadcast("$destroy")}})}}}]);appDirectives.directive("videoOverlayPlayer",["videoService","$timeout","videoTrackingService","videoObservableService","semaphoreFactory","videoPlayerFactory",function(videoService,$timeout,videoTrackingService,videoObservableService,semaphoreFactory,videoPlayerFactory){"use strict";return{restrict:"EA",scope:{videoId:"@",videoBaseUrl:"@",videoAutostart:"@",videoGtmTrackingLabel:"@",videoTitle:"@",videoDuration:"@",videoInlinePlayer:"@",videoCategories:"@",videoExpired:"@"},template:'<div class="s1-video-wait-for-next" ng-if="showWait">Das nächste Video startet in [[waitForNext]] Sekunden</div><div class="s1-video-player" id="[[classId]][[randomId]]"><s1-spinner s1-visible="loading"></s1-spinner></div><style ng-bind="randomStyle"></style>',link:function(scope,element,attrs){var initPlayerSemaphore;var player=null;var container=element.children()[0];scope.waitForNext=4;scope.showWait=false;scope.classId="video-player-";if(jQuery("#s1-video-player").length===0){scope.classId="s1-video-player";scope.randomId="";scope.randomStyle="#s1-video-player_controlBar { overflow: hidden } #s1-video-player_playbutton { height: 20px; width:20px; } #s1-video-player_mutebutton { height: 20px; width:20px; } "}else{scope.randomId=Math.floor(Math.random()*6+1);scope.randomStyle="#video-player-"+scope.randomId+"_controlBar { overflow: hidden } #video-player-"+scope.randomId+"_playbutton { height: 20px; width:20px; } #video-player-"+scope.randomId+"_mutebutton { height: 20px; width:20px; } "}var width,height,videoAutostart,changeMovie,gotoNextPromise;width=element.width();height=element.height();if(attrs.width){width=attrs.width}if(attrs.height){height=attrs.height}var attributes=scope.$eval(attrs.videoOverlayPlayer);if(attributes&&attributes.width){width=attributes.width}if(attributes&&attributes.height){height=attributes.height}if(attrs.showPlaylist){scope.showPlaylist=scope.$eval(attrs.showPlaylist)}if(scope.videoBaseUrl){videoService.setBaseUrl(scope.videoBaseUrl)}scope.nextVideo=false;if(attrs.nextVideo){scope.nextVideo=attrs.nextVideo}videoAutostart=true;if(scope.videoAutostart){videoAutostart=scope.videoAutostart===true||scope.videoAutostart==="true"}changeMovie=sessionStorage.getItem("changeMovie")==="true";sessionStorage.removeItem("changeMovie");var addFullscreenTrigger=function(videoPlayerNode){function triggerFullscreen(){player.requestFullscreen();videoPlayerNode.removeEventListener("click",triggerFullscreen,true);player.removeEventListener("s1_lifecycle_start",triggerFullscreen,true)}if(videoPlayerNode&&player){videoPlayerNode.addEventListener("click",triggerFullscreen,true);player.addEventListener("s1_lifecycle_start",triggerFullscreen,true)}};var addGlobalVideoPlayerEventListener=function(){var gves=Sport1Tools.globalVideoEventService;var playerId=player.getId();gves.registerSport1VideoPlayer(player);gves.registerEventHandler(function(event){if((event.type===gves.VIDEO_START||event.type===gves.VIDEO_PLAY||event.type===gves.VIDEO_AD_PLAY)&&event.target.playerId!==playerId){player.pause()}})};var retrieveGtmTrackingLabelFromVideo=function(video){var result="";if(video&&video.hasOwnProperty("headline")&&video.hasOwnProperty("title")){result=video.headline+"/"+video.title}return result};var initPlayer=function(){if(player){initPlayerSemaphore=null;var videos=scope.video;var spec={autoplay:scope.videoInlinePlayer!=="true"&&videoAutostart,changeMovie:changeMovie,label:scope.videoGtmTrackingLabel||retrieveGtmTrackingLabelFromVideo(scope.video),player:player,categories:scope.videoCategories||scope.video.categories,title:scope.videoTitle,boomingTrackingCode:scope.videoId+"_"+Date.now(),videoId:scope.videoId};var isSpecialsCategory=spec.categories&&spec.categories.search(/\bSpecials\b/)!==-1;if(isSpecialsCategory){window.SOI_WERBUNG=false;window.SOI_VA1=false;window.SOI_VA2=false;window.SOI_VA3=false;window.SOI_VA4=false;window.SOI_VA5=false}videoTrackingService.init(player,spec);player.addEventListener("s1_lifecycle_start",function(){$timeout.cancel(gotoNextPromise);scope.waitForNext=4;scope.showWait=false;scope.$apply()});player.addEventListener("s1_lifecycle_complete",function(){function gotoNext(){if(0===scope.waitForNext){sessionStorage.setItem("changeMovie",true);window.location.pathname="/"+scope.nextVideo;return}scope.waitForNext-=1;scope.showWait=true;gotoNextPromise=$timeout(gotoNext,1e3)}if(scope.nextVideo){var playingAd=false;gotoNextPromise=$timeout(function(){if(!playingAd){gotoNext()}},3e3)}});player.setup(videos,videoAutostart);if(Sport1Tools.isMobileSite()){addFullscreenTrigger(element[0])}addGlobalVideoPlayerEventListener();videoObservableService.setObservable(player)}};var initVideo=function(){var videoPlayerContainer=element.find(".s1-video-player");if(scope.videoExpired==="1"){return videoPlayerContainer.addClass("expired")}videoPlayerContainer.addClass("loading");scope.loading=true;videoService.getVideo(scope.videoId).then(function(video){scope.video=video;if(initPlayerSemaphore){initPlayerSemaphore.release()}else{initPlayer()}},function(){videoPlayerContainer.addClass("expired")}).finally(function(){scope.loading=false;videoPlayerContainer.removeClass("loading")})};var retrievePlayerVendor=function(){var result="kolibri";if(/\bjw=1\b/.test(location.search)){result="jw"}else if(/\bkv2=1\b/.test(location.search)){result="kolibriV2"}else if(/\bkv1=1\b/.test(location.search)){result="kolibri"}else if(/\bstage\b/.test(location.hostname)){result="kolibriV2"}return result};initPlayerSemaphore=semaphoreFactory.createSemaphore(2,initPlayer);var playerConfig={container:container,width:width,height:height,randomId:scope.randomId};var playerVendor=retrievePlayerVendor();videoPlayerFactory.createVideoPlayer(playerVendor,playerConfig).then(function(instance){player=instance;initPlayerSemaphore.release()});scope.$watch("videoId",function(){initVideo()});scope.$on("$destroy",function(){element.remove()})}}}]);appDirectives.directive("videoOverlayPlaylist",["videoService",function(videoService){"use strict";return{restrict:"AE",templateUrl:"common/angularjs/directives/videoOverlayDirective/videoOverlayPlaylist.html",scope:{videoId:"=",videoRelatedPlaylistId:"="},link:function(scope,element){var loadPlaylist=function(){var loadingList=element.find("[loading-spinner]");loadingList.addClass("loading");videoService.getPlaylist(scope.videoRelatedPlaylistId).then(function(playlist){scope.playlist=playlist;loadingList.removeClass("loading")})};scope.$watch("videoRelatedPlaylistId",function(){loadPlaylist()});scope.loadVideo=function(videoId){scope.videoId=videoId};scope.$on("$destroy",function(){element.remove()})}}}]);appDirectives.directive("videoRecommendation",["$q","$templateRequest","$compile","videoService","videoObservableService",function($q,$templateRequest,$compile,videoService,videoObservableService){"use strict";return{restrict:"A",link:function(scope,element,attr){var template="common/angularjs/directives/videoRecommendationDirective/recommendation.html";var container=null;var obrRequestData={widgetId:"APP_2",permalink:attr.videoPermalink,maxVideoCount:9};function addGTMTracking(element){var localStorageKey="s1-outbrain-video-rec-click-count";var videoTeaserContainer=element.find("#s1-video-teaser-container");function track(count){if(window.dataLayer){window.dataLayer.push({event:"ga_event",eventCategory:"recommendation",eventLabel:count,eventAction:"outbrain"})}}function clickHandler(){var count="1";videoTeaserContainer.off("click",clickHandler);if(!localStorage.getItem(localStorageKey)){localStorage.setItem(localStorageKey,count);track(count)}else{count=parseInt(localStorage.getItem(localStorageKey));if(!isNaN(count)){count=(++count).toString();localStorage.setItem(localStorageKey,count);track(count)}}}if(videoTeaserContainer&&Sport1Tools.storageAvailable("localStorage")){videoTeaserContainer.on("click",clickHandler)}}function getTemplate(){var deferred=$q.defer();$templateRequest(template).then(function(html){deferred.resolve(html)},function(reason){deferred.reject(reason)});return deferred.promise}function onVideoStart(){if(container){container.empty();container.remove()}var promises={template:getTemplate(),rec:videoService.getOutbrainRecommendation(obrRequestData)};$q.all(promises).then(function(result){scope.videos=result.rec.videos;container=window.angular.element(document.createElement("div"));container.html(result.template);$compile(container.contents())(scope);addGTMTracking(container)},function(reason){window.console.warn(reason)})}function onVideoPlayerEvent(event){if(event===videoObservableService.VIDEO_START){onVideoStart()}if(event===videoObservableService.VIDEO_COMPLETE){if(scope.videos&&scope.videos.length){element.append(container)}}}videoObservableService.registerUpdateHandler(onVideoPlayerEvent)}}}]);appFilters.filter("competitionDashboardTitle",[function(){"use strict";var MAX_LENGTH=36;var setAffix=function(base,possibleAffixes,seperator,isSuffix){seperator=seperator||" ";if(possibleAffixes.constructor!==Array){possibleAffixes=[possibleAffixes]}for(var i in possibleAffixes){var affix=possibleAffixes[i];var tmp=(isSuffix?base:affix)+seperator+(isSuffix?affix:base);if(tmp.length<=MAX_LENGTH){return tmp}}return base};var setPrefix=function(base,possiblePrefixes,seperator){return setAffix(base,possiblePrefixes,seperator)};return function(title,competition){if(!competition){return title}var newTitle;newTitle=setPrefix(title,[competition.name,competition.shortname,competition.microname]);if(competition.age&&competition.age.name){newTitle=setPrefix(newTitle,competition.age.name,"-")}if(competition.sport&&competition.sport.name){newTitle=setPrefix(newTitle,competition.sport.name)}return newTitle}}]);(function(){"use strict";var Filter;Filter=function(){var matchdayCrossdate,matchdayList;matchdayCrossdate={};matchdayList={};return function(items,today){var diffToMatchday1,diffToMatchday2,i,item,len,matchDate,name;if(today==null){today=new Date}for(i=0,len=items.length;i<len;i++){item=items[i];matchDate=new Date(item.match_date.split(".").reverse().join("-"));if(~~item.matchday===1&&(!matchdayCrossdate["1"]||matchdayCrossdate["1"]<matchDate)){matchdayCrossdate["1"]=matchDate}if(~~item.matchday===2&&(!matchdayCrossdate["2"]||matchdayCrossdate["2"]>matchDate)){matchdayCrossdate["2"]=matchDate}name=item.matchday;if(!matchdayList[name]){matchdayList[name]=[];
}matchdayList[item.matchday].push(item)}diffToMatchday1=today-matchdayCrossdate["1"];diffToMatchday2=matchdayCrossdate["2"]-today;if(matchdayList["1"]&&(today<matchdayCrossdate["1"]||diffToMatchday1<diffToMatchday2)){return matchdayList["1"]}else{return matchdayList["2"]}}};return angular.module("sport1.filters").filter("currentMatdchdayMatches",Filter)})();appFilters.filter("dateLabel",["$filter",function($filter){"use strict";var hour=60*60*1e3,day=24*hour;function _changeDateTimeToMidnight(dateInMs){var ms=dateInMs;if(!isNaN(dateInMs)){ms=dateInMs-dateInMs%day}return ms}return function(dateStr,refDateStr,forNewsBox){if(!angular.isDefined(refDateStr)){refDateStr=new Date}var parsedDate=Date.parse(dateStr),parsedRefDate=Date.parse(refDateStr),msDate=_changeDateTimeToMidnight(parsedDate),msRefDate=_changeDateTimeToMidnight(parsedRefDate),delta=Math.round((msDate-msRefDate)/day),label="";if(!isNaN(delta)){if(0===delta){var deltaInSeconds=parsedRefDate-parsedDate;if(forNewsBox&&deltaInSeconds<hour){label='<span title="'+$filter("date")(dateStr,"H:mm")+'">'+$filter("date")(deltaInSeconds,"m")+" min</span>"}else if(forNewsBox){label=$filter("date")(dateStr,"HH:mm")}else{label="Heute"}}else if(1===delta){label="Morgen"}else if(-1===delta){label="Gestern"}else if(forNewsBox){label=$filter("date")(dateStr,"dd.MM.yy")}else if(delta<=-2&&delta>-8){label="letzten "+$filter("date")(dateStr,"EEEE")}else if(2<=delta&&delta<8){label=$filter("date")(dateStr,"EEEE")}else{label=$filter("date")(dateStr,"dd.MM.yyyy")}}return label}}]);appFilters.filter("getMatchesForLiveTeaser",["$filter",function($filter){"use strict";var _filter=function(rounds,now,matchesMeta){var matches=[];var filteredMatches=[],preFilterMatches=!!matchesMeta&&matchesMeta.length>0;if(preFilterMatches){filteredMatches=matchesMeta.map(function(m){return m.matchId})}angular.forEach(rounds,function(round){if(!angular.isDefined(round.match)){console.error("$filter","getMatchesForLiveTeaser","invalid data provided for round.match");return[]}var tmp=round.match;if(preFilterMatches){tmp=tmp.filter(function(match){return filteredMatches.indexOf(match.id)>-1})}matches=matches.concat(tmp)});var matchGroups=$filter("groupMatchesByStartTime")(matches);matchGroups=$filter("orderBy")(matchGroups,["isoDate"]);if(!matchGroups.length){console.error("$filter","getMatchesForLiveTeaser","there are no matchGroups available");return[]}var nowInMs=now.getTime();if(nowInMs<matchGroups[0].isoDate.getTime()){return matchGroups[0].matches}else{var nowDate=new Date(now.getFullYear(),now.getMonth(),now.getDate());var matchGroupsToday=$filter("keyValueFilter")(matchGroups,function(matchGroup){var d=matchGroup.isoDate;var groupDate=new Date(d.getFullYear(),d.getMonth(),d.getDate());return groupDate.getTime()>=nowDate.getTime()});var matchGroupsTodayAlreadyStarted=$filter("keyValueFilter")(matchGroupsToday,function(matchGroup){return matchGroup.isoDate.getTime()<=now.getTime()});if(matchGroupsTodayAlreadyStarted.length){var latestMatches=matchGroupsTodayAlreadyStarted[matchGroupsTodayAlreadyStarted.length-1].matches;var unfinishedMatches=[];angular.forEach(matchGroupsTodayAlreadyStarted,function(matchGroup){angular.forEach(matchGroup.matches,function(match){if(match.finished==="no"){if(!$filter("keyValueFilter")(latestMatches,{id:match.id}).length){unfinishedMatches.push(match)}}})});return[].concat(unfinishedMatches,latestMatches)}if(matchGroupsToday.length){return matchGroupsToday[0].matches}else{return matchGroups[matchGroups.length-1].matches}}};return function(matchday,now,matchesMeta){if(angular.isDefined(matchday.round)){return _filter(matchday.round,now,matchesMeta)}else if(angular.isDefined(matchday.match)){return _filter([matchday],now,matchesMeta)}else{console.error("$filter","getMatchesForLiveTeaser","invalid data provided for matchday.round");return[]}}}]);appFilters.filter("groupMatchesByStartTime",[function(){"use strict";return function(ungroupedMatches){var groups=[];var group={isLive:false,date:undefined,time:undefined,matches:[]};for(var i=0;i<ungroupedMatches.length;i++){var match=ungroupedMatches[i];if(!angular.isDefined(match)){console.warn("$filter `groupMatchesByStartTime`","No Matches to Filter");break}if(!group.date||group.date===match.match_date&&group.time===match.match_time&&group._roundName===match._roundName){group.matches.push(match)}else{if(group.matches.length){groups.push(group)}group={isLive:false,date:match.match_date,matches:[match]}}group.date=match.match_date;group.time=match.match_time;group.isoDate=Sport1Tools.getDateFromGermanDateTime(group.date,group.time);group._roundName=match._roundName}if(0<group.matches.length){groups.push(group)}return groups}}]);appFilters.filter("groupPlayoffsByTeams",["$filter",function($filter){"use strict";var addNewGroup=function(result,match){return result.push({home:match.home,away:match.away,matches:[],score:{home:0,away:0}})};return function(arr){var result=[];if(!angular.isArray(arr)){return result}arr.forEach(function(match){if(result.length===0){addNewGroup(result,match)}var group=$filter("keyValueFilter")(result,function(group){return[group.home.id,group.away.id].indexOf(match.home.id)!==-1});if(!group.length){addNewGroup(result,match);group=result[result.length-1]}else{group=group[0]}var winnerTeamId=match.winner_team_id;if(!~[group.home.id,group.away.id].indexOf(winnerTeamId)){var resultHome=$filter("keyValueFilter")(match.match_result,function(result){return result.match_result_at==="0"&&~["home","none_home"].indexOf(result.place)});resultHome=resultHome.length?parseInt(resultHome[0].match_result,10):0;var resultAway=$filter("keyValueFilter")(match.match_result,function(result){return result.match_result_at==="0"&&~["away","none_away"].indexOf(result.place)});resultAway=resultAway.length?parseInt(resultAway[0].match_result,10):0;winnerTeamId=resultHome>resultAway?match.home.id:resultHome<resultAway?match.away.id:"0"}if(winnerTeamId===group.home.id){group.score.home++}else if(winnerTeamId===group.away.id){group.score.away++}else{}group.matches.push(match)});angular.forEach(result,function(group){group.matches.sort(function(a,b){var dateA=Sport1Tools.getDate(a.match_date,a.match_time);var dateB=Sport1Tools.getDate(b.match_date,b.match_time);if(angular.isDate(dateA)&&angular.isDate(dateB)){return dateA.getTime()-dateB.getTime()}return 0})});return result}}]);appFilters.filter("htmlToPlaintext",[function(){"use strict";return function(text){return String(text).replace(/<[^>]+>/gm,"")}}]);appFilters.filter("isEmptyObject",[function(){"use strict";return function(obj){for(var bar in obj){if(obj.hasOwnProperty(bar)){return false}}return true}}]);appFilters.filter("keyValueFilter",[function(){"use strict";var filterArrayByObject=function(array,filter){var result=[];array.forEach(function(item){var addItem=true;Object.keys(filter).forEach(function(attr){if(item[attr]!==filter[attr]){addItem=false}});if(addItem){result.push(item)}});return result};var filterArrayByFunction=function(array,filter){var result=[];array.forEach(function(item,index){if(filter(item,index)){result.push(item)}});return result};var filterArrayByAttribute=function(array,filter){var result=[];array.forEach(function(item){if(item[filter]===true){result.push(item)}});return result};return function(array,filter){if(!angular.isDefined(filter)){return array}else if(typeof filter==="object"){return filterArrayByObject(array,filter)}else if(typeof filter==="function"){return filterArrayByFunction(array,filter)}else if(typeof filter==="string"){return filterArrayByAttribute(array,filter)}else{return array}}}]);appFilters.filter("objectToArray",[function(){"use strict";return function(input){var out=[];for(var i in input){out.push(input[i])}return out}}]);appFilters.filter("resultLabel",[function(){"use strict";return function(index){var label="";switch(index){case 1:label="Sieg";break;case 2:label="Finale";break;case 3:label="Halbfinale";break;case 4:label="Foo";break;case 5:label="Bar";break}return label}}]);appFilters.filter("shortDateLabel",["$filter",function($filter){"use strict";var _day=24*60*60*1e3;return function(dateStr,refDateStr){var msDate=Date.parse(dateStr);var msRefDate=Date.parse(refDateStr);var delta=Math.round((msDate-msRefDate)/_day);var label="";if(!isNaN(delta)){if(0===delta){label="Heute"}else if(1===delta){label="Morgen"}else if(-1===delta){label="Gestern"}else{label=$filter("date")(dateStr,"EEE")}}return label}}]);appFilters.filter("slice",[function(){"use strict";return function(arr,start,end){if(angular.isArray(arr)){return arr.slice(start,end)}return[]}}]);appFilters.filter("soccerEventMapping",[function(){"use strict";return function(eventType){if(eventType==="goal"){return"s1-goal"}else if(eventType==="card-yellow"){return"s1-yellow-card"}else if(eventType==="card-red"){return"s1-red-card"}else if(eventType==="card-yellow-red"){return"s1-yellow-red-card"}else if(eventType==="substitute-in"){return"s1-changed-in"}else if(eventType==="substitute-out"){return"s1-changed-out"}return""}}]);appFilters.filter("statisticKeyToLabel",function(){"use strict";var keyToLabelMap={average_age:"Durchschnittsalter",score:"Tore",shots:"Torschüsse",shots_on_goal:"Torschüsse (auf das Tor)",duels_won_percentage:"gewonnene Zweikämpfe (%)",duels_won:"gewonnene Zweikämpfe",balls_touched_percentage:"Ballbesitz (%)",balls_touched:"Ballkontakte",passes_complete_percentage:"angekommene Pässe (%)",passes_failed:"Fehlpässe",tracking_distance:"Laufweite (km)",tracking_sprints:"Sprints",offsides:"Abseits",freekicks:"Freistöße",corner_kicks:"Eckstöße",fouls_suffered:"gefoult worden",card_yellow:"Gelbe Karten",card_yellow_red:"Gelb-Rote Karten",card_red:"Rote Karten"};var keyToLabel=function(key){var result=key||"";if(keyToLabelMap.hasOwnProperty(key)){result=keyToLabelMap[key]}else{console.error("didnt find label for key: "+key)}return result};return function(key){return keyToLabel(key)}});appFilters.filter("tickerAddedTimeFilter",[function(){"use strict";return function(minuteString){if(minuteString!==null){return"+"+minuteString+"'"}return null}}]);appFilters.filter("tickerMinuteFilter",[function(){"use strict";return function(minuteString){if(parseInt(minuteString)===0){return""}if(minuteString!==null){return minuteString+"."}return null}}]);appFilters.filter("relevantFMMatches",["fmMatchDataFactory",function(fmMatchDataFactory){"use strict";var SINGLE_STREAM="sport1.fm-single-url.mp3",PROMI_STREAM="fm-single-special-url.mp3",AUDI_STREAM="sport1.fm-single-url-audi.mp3",BMW_STREAM="sport1.fm-single-url-bmw.mp3",MERCEDES_STREAM="sport1.fm-single-url-mercedes.mp3";var relevantStreams=[SINGLE_STREAM,PROMI_STREAM,AUDI_STREAM,BMW_STREAM,MERCEDES_STREAM];var relevantCoIds=["33"];var getMatches=function(data){var result=[];function getDataByKey(data,key){if(data&&typeof data==="object"){if(data.hasOwnProperty(key)){return data[key]}else{if(data&&typeof data==="object"){for(var prop in data){var m=getDataByKey(data[prop],key);if(m){return m}}}}}else{return undefined}}function getStreamDataByIdentifier(match,identifier){var matchMeta=getDataByKey(match,"match_meta");var streamDataFilterResult=[];if(matchMeta){streamDataFilterResult=matchMeta.filter(function(metaData){return metaData.hasOwnProperty("kind")&&metaData.hasOwnProperty("content")&&metaData.kind.match(identifier)})}return streamDataFilterResult.length>0?streamDataFilterResult[0]:null}function getStreamUrlByIdentifier(match,identifier){var streamData=getStreamDataByIdentifier(match,identifier);return streamData?streamData.content:null}function setSingleStreamUrl(match,url){var singleStreamData=getStreamDataByIdentifier(match,SINGLE_STREAM);if(singleStreamData){singleStreamData.content=url}}function getSpecialMatchDataFromMatch(match){var specialStreamUrl=getStreamUrlByIdentifier(match,SINGLE_STREAM);var specialMatch=null;if(specialStreamUrl){specialMatch=angular.copy(match);setSingleStreamUrl(specialMatch,specialStreamUrl);specialMatch.home.microname="PROMI";specialMatch.away.microname="KOM"}return specialMatch}function pushFMMatchDataToResult(matches,competitionData,isRelevantCo){var specialMatchCompetitionData=null,streamUrl=null,competitionDataCopy=null,hasMatchSingleStream=false;angular.forEach(matches,function(match){competitionData.match=match;competitionData.isSingleMatch=false;competitionData.isPromentatorMatch=false;competitionData.sportId=getDataByKey(competitionData,"sport_id");hasMatchSingleStream=getStreamUrlByIdentifier(match,SINGLE_STREAM);if(hasMatchSingleStream){angular.forEach(relevantStreams,function(identifier){streamUrl=getStreamUrlByIdentifier(match,identifier);if(streamUrl){if(identifier===PROMI_STREAM){specialMatchCompetitionData=angular.copy(competitionData);specialMatchCompetitionData.match=getSpecialMatchDataFromMatch(match);specialMatchCompetitionData.streamUrl=streamUrl;specialMatchCompetitionData.streamIdentifier=identifier;specialMatchCompetitionData.isPromentatorMatch=true;result.unshift(fmMatchDataFactory.createFMMatchData(specialMatchCompetitionData))}else{competitionDataCopy=angular.copy(competitionData);competitionDataCopy.streamUrl=streamUrl;competitionDataCopy.streamIdentifier=identifier;result.unshift(fmMatchDataFactory.createFMMatchData(competitionDataCopy))}}})}else if(isRelevantCo){competitionDataCopy=angular.copy(competitionData);competitionDataCopy.streamUrl=undefined;competitionDataCopy.streamIdentifier=undefined;result.unshift(fmMatchDataFactory.createFMMatchData(competitionDataCopy))}})}if(typeof data==="object"){angular.forEach(data,function(value){var matches,match,rounds,season=null;season=getDataByKey(value,"season");rounds=getDataByKey(season,"round");var isRelevantCo=relevantCoIds.indexOf(getDataByKey(season,"competition_id"))!==-1;if(rounds){angular.forEach(rounds,function(round){matches=getDataByKey(round,"match");if(matches instanceof Array){var n=matches.length;for(var i=0;i<n;i++){match=matches[i];if(getStreamUrlByIdentifier(match,SINGLE_STREAM)||isRelevantCo){pushFMMatchDataToResult(matches,value,isRelevantCo);break}}}})}})}return result};return function(data){return getMatches(data)}}]);appServices.factory("coIdToAdPathService",[function(){"use strict";var coIdToAdPathMap={3:["fussball","2bundesliga"],12:["fussball","bundesliga"],33:["fussball","dfbpokal"],19:["fussball","championsleague"],562:["fussball","championsleague"],132:["fussball","uefacup"],563:["fussball","uefacup"],36:["fussball","em"],1172:["fussball","em"],571:["fussball","international"]};return{getAdPathByCompetitionAndSportId:function(coId,sportId){if(sportId==="42"){return["motorsport","dtm"]}else if(coIdToAdPathMap.hasOwnProperty(coId)){return coIdToAdPathMap[coId]}else{return["fussball"]}}}}]);appServices.value("epgDataServiceURLs",{tv:"/epg/tv",fm:"/epg/fm"});appServices.provider("epgDataService",function epgDataServiceProvider(){"use strict";var host="";this.$get=["$resource","epgDataServiceURLs","$filter",function($resource,epgDataServiceURLs,$filter){function getJSONURLForKey(key){return host+epgDataServiceURLs[key]}function buildDateUrl(date,url){return date?url+"/"+$filter("date")(date,"yyyy-MM-dd"):url}return{setBaseUrl:function(baseUrl){host=baseUrl},getTV:function(){return $resource(getJSONURLForKey("tv")).get().$promise},getFM:function(date){var url=getJSONURLForKey("fm");url=date&&date instanceof Date?buildDateUrl(date,url):url;return $resource(url).get().$promise}}}]});appServices.factory("FlashService",["$filter",function($filter){"use strict";var _private={};var svc={_flashes:[]};_private.addUserMessage=function(id,type,message){var flashContainer=null;if($filter("keyValueFilter")(svc._flashes,{id:id}).length){return false}svc._flashes.push({id:id,type:type,message:message});flashContainer=$(".s1-flash-container");if(flashContainer.length){var $message=$('<div id="s1-flash-'+id+'" class="s1-flash-type-'+type+'">'+message+"</div>");flashContainer.append($message)}};_private.clear=function(id,type){for(var i=svc._flashes.length-1;i>-1;i--){var flash=svc._flashes[i];if(!angular.isDefined(id)&&!angular.isDefined(type)||flash.type===type||flash.id.indexOf(id)===0){$("#s1-flash-"+flash.id).remove();svc._flashes.splice(i,1)}}};svc.error=function(id,userMessage){_private.addUserMessage(id,"error",userMessage)};svc.warn=function(id,userMessage){_private.addUserMessage(id,"warn",userMessage)};svc.clear=function(args){if(!angular.isDefined(args)){args={}}_private.clear(args.id,args.type)};return svc}]);appServices.factory("fmMatchHighlightsService",["$q","$http",function($q,$http){"use strict";var svc={};var PATH="/api/fm/highlights/";svc.getMatchHighlights=function(match){var deferred=$q.defer();$http.get(PATH+match.id).success(function(data){if(data!=='""'){deferred.resolve(data)}else{deferred.reject()}}).error(function(){deferred.reject()});return deferred.promise};return svc}]);appServices.factory("fmPopUpPlayerAdService",["coIdToAdPathService","$timeout",function(coIdToAdPathService,$timeout){"use strict";var adsInitialized=false;var lastUsedAdPath=null;var timeout=null;var triggerCallback=null;var observers=[];var isMobileSite=window.SOI_SITE==="sport1fm-mew";function triggerReload(adPath,adCallback){if(!isMobileSite){triggerRadioAds(adPath,adCallback)}}function notifyObserver(observer){if(observer&&observer.hasOwnProperty("notify")){observer.notify.apply()}}function adCallback(){if(timeout){$timeout.cancel(timeout);timeout=null}if(triggerCallback){triggerCallback.apply();triggerCallback=null}if(!adsInitialized){adsInitialized=true;observers.forEach(notifyObserver)}}return{reloadAd:function(coId,sportId,force,callback){var adPath=coIdToAdPathService.getAdPathByCompetitionAndSportId(coId,sportId);timeout=$timeout(adCallback,3e3);triggerCallback=callback;if(typeof force!=="boolean"){force=false}if(lastUsedAdPath&&lastUsedAdPath.toString()!==adPath.toString()){adsInitialized=false;observers.forEach(notifyObserver)}lastUsedAdPath=adPath;triggerReload(adPath,force,adCallback)},areAdsInitialized:function(){return adsInitialized},registerObserverForAdInitUpdate:function(observer){if(observer&&observers.indexOf(observer)===-1){observers.push(observer)}},unregisterObserverForAdInitUpdate:function(observer){var i=observers.indexOf(observer);if(i!==-1){observers.splice(i,1)}}}}]);appServices.factory("siTitleToCoIdService",[function(){"use strict";var siTitleToCoIdMap={"Bundesliga LIVE":"12","Bundesligakonferenz LIVE":"12","2. Bundesliga LIVE":"3","Zweitligakonferenz LIVE":"3","DFB Pokal LIVE":"33","DFB-Pokal LIVE":"33","DFB-Pokal-Konferenz LIVE":"33","Europa League LIVE":"132","Europa-League-Konferenz LIVE":"132","Champions League LIVE":"19","Champions-League-Konferenz LIVE":"19","Nationalmannschaft LIVE":"571","UEFA EURO 2016 LIVE":"36"};return{getCompetitionIdFromSiTitle:function(siTitle){if(siTitle&&siTitleToCoIdMap.hasOwnProperty(siTitle)){return siTitleToCoIdMap[siTitle]}else{return undefined}}}}]);(function(){"use strict";var GaService;GaService=function($rootScope){GaService=function(){function GaService(){this.tracked={}}GaService.prototype.initTracking=function(){return $rootScope.$on("ga_event",function(_this){return function(event,config,singleCall){var ref;if(singleCall&&_this.tracked[config.eventLabel]){return}_this.tracked[config.eventLabel]=true;return(ref=window.dataLayer)!=null?ref.push(config):void 0}}(this))};GaService.prototype.send=function(gaData){return(typeof window.ga==="function"?window.ga("send",gaData):void 0)||(typeof gaData.hitCallback==="function"?gaData.hitCallback():void 0)};return GaService}();return new GaService};GaService.$inject=["$rootScope"];return angular.module("sport1.services").factory("gaService",GaService)})();(function(){"use strict";var GraphicService;GraphicService=function(){GraphicService=function(){var svc;svc={};function GraphicService(){}GraphicService.prototype.HOST_WS="http://assets.sport1.de/imagix/filter2/png/_set=/http://sport1.weltsport.net";GraphicService.prototype.setTeamLogo=function(team,size){team.logo=this.HOST_WS+"/gfx/emblem/common/"+size+"/"+team.id+".png";team.logo_fallback="/bundles/sport1portal/images/team-logo-fallback.svg";return team.logo_fallback};GraphicService.prototype.getPersonImgUrl=function(personId,size){return this.HOST_WS+"/gfx/person/"+size+"/"+personId+".jpg"};GraphicService.prototype.getNationImgUrl=function(nationId,size){return this.HOST_WS+"/gfx/flags/common/"+size+"/"+nationId+".png"};GraphicService.prototype.getCompetitionIconUrl=function(competitionId,size,sportId,gender){var ref,ref1;if((ref=+competitionId)===543||ref===544||ref===545||ref===559||ref===546||ref===548||ref===549||ref===2548||ref===551||ref===552||ref===553||ref===555||ref===556||ref===557||ref===558||ref===2715||ref===2193||ref===560||ref===948){return"http://assets.sport1.de/imagix/svg/7568b931-c343-11e4-a4f7-f80f41fc63ce"}else if(+sportId===5){if(gender==="male"){return"/bundles/sport1portal/images/ic_ligen_tennis_atp.svg"}else{return"/bundles/sport1portal/images/ic_ligen_tennis_wta.svg"}}else if(+sportId===246){return"http://assets.sport1.de/imagix/svg/8adf15d6-c98b-11e4-a4f7-f80f41fc63ce"}else if((ref1=+sportId)===237||ref1===238||ref1===239){return"/bundles/sport1portal/images/moto-gp.svg"}else if(+sportId===265){return"/bundles/sport1portal/images/verizon_indycar_red_14.svg"}else if(+sportId===42){return"http://assets.sport1.de/imagix/svg/9fba5d3a-c343-11e4-a4f7-f80f41fc63ce"}else{return this.HOST_WS+"/gfx/competition/png/normal/"+size+"x"+size+"/"+competitionId+".png"}};GraphicService.prototype.getEventIcon=function(eventId){return"/bundles/sport1portal/images/icon-event-"+eventId+".svg"};GraphicService.prototype.getVenueImageUrl=function(venueId){return"http://sport1.weltsport.net/gfx/venue/768/"+venueId+".jpg"};return GraphicService}();return new GraphicService};return angular.module("sport1.services").factory("graphicService",GraphicService)})();appServices.factory("lineupService",[function(){"use strict";var svc={};var isMobile=Sport1Tools.isMobileSite();var defaultContainerWidth=isMobile?300:500;var defaultContainerHeight=isMobile?265:435;var defaultPlayerSize=isMobile?{width:57,height:40}:{width:80,height:69};var containerWidth;var containerHeight;var playerSize;var minX=2;var maxX=18;var field={x:{min:0,max:20,get width(){return this.min+this.max}},y:{min:0,max:12,get width(){return this.min+this.max}}};function limitRange(offset){return Math.min(1,Math.max(0,offset))}function compareCoords(isHomeTeam,a,b){if(a.coords&&b.coords){if(a.coords.y!==b.coords.y){return a.coords.y-b.coords.y}else{return isHomeTeam?b.coords.x-a.coords.x:a.coords.x-b.coords.x}}return 0}function setPlayerOffset(player,isHomeTeam){player.offset={isHomeTeam:isHomeTeam,x:containerWidth*limitRange(player.coords.x/field.x.width),y:containerHeight*limitRange(player.coords.y/field.y.width),get top(){return this.topInt+"px"},get topInt(){return this.isHomeTeam?this.y:containerHeight-this.y},get left(){return this.leftInt+"px"},get leftInt(){return this.isHomeTeam?containerWidth-this.x:this.x}}}function doPlayersIntersect(a,b){return!(a.offset.leftInt+playerSize.width<b.offset.leftInt||b.offset.leftInt+playerSize.width<a.offset.leftInt||a.offset.topInt+playerSize.height<b.offset.topInt||b.offset.topInt+playerSize.height<a.offset.topInt)}function checkPlayerIntersection(player,players,isHomeTeam){var playerToCompare;var hasIntersection=false;var coordFactor=isHomeTeam?-1:1;if(player&&players.length){player.movedBy=0;for(var i=0,n=players.length;i<n;i++){playerToCompare=players[i];hasIntersection=doPlayersIntersect(player,playerToCompare);if(hasIntersection){if(player.coords.y===playerToCompare.coords.y){if(player.offset.leftInt>containerWidth*.5){if(minX<player.coords.x&&player.coords.x<maxX){if(player.movedBy>-1){player.coords.x+=coordFactor;player.movedBy++}else{hasIntersection=false}}else if(player.movedBy<1){playerToCompare.coords.x-=coordFactor;playerToCompare.movedBy--;setPlayerOffset(playerToCompare,isHomeTeam)}else{hasIntersection=false}}else{if(playerToCompare.coords.x<maxX&&playerToCompare.coords.x>minX&&!playerToCompare.movedBy){playerToCompare.coords.x-=coordFactor;playerToCompare.movedBy--;setPlayerOffset(playerToCompare,isHomeTeam)}else{player.coords.x+=coordFactor;player.movedOppositeDir=true;player.movedBy++}}}else if(player.coords.x===playerToCompare.coords.x){if(playerToCompare.coords.y>minX){playerToCompare.coords.y--;setPlayerOffset(playerToCompare,isHomeTeam)}else{hasIntersection=false}}}if(hasIntersection){break}}}return hasIntersection}svc.setPlayerCoords=function(player,tactical){if(player){player.coords={x:Math.min(Math.max(Number(tactical.xpos),minX),maxX),y:Number(tactical.ypos)};player.shirtnumber=tactical.shirtnumber;player._sortId=Number(player.shirtnumber);player.offset={}}};function calculatePlayerPosition(lineup,isHomeTeam,index,players,lastCoords){index=index||0;players=players||[];var player=lineup[index];if(!player.coords){player.coords=lastCoords}if(player.coords&&player.coords.x&&player.coords.y){setPlayerOffset(player,isHomeTeam);lastCoords=player.coords;if(!checkPlayerIntersection(player,players,isHomeTeam)){players.push(player);player._sortId=index;index++}}else{index++}if(index<lineup.length){calculatePlayerPosition(lineup,isHomeTeam,index,players,lastCoords)}}svc.calculatePlayerPositions=function(lineup,isHomeTeam,customContainer,customPlayerSize){containerWidth=customContainer&&customContainer.width?customContainer.width:defaultContainerWidth;containerHeight=customContainer&&customContainer.height?customContainer.height:defaultContainerHeight;playerSize=customPlayerSize&&customPlayerSize.width&&customPlayerSize.height?customPlayerSize:defaultPlayerSize;lineup.sort(compareCoords.bind(null,isHomeTeam));calculatePlayerPosition(lineup,isHomeTeam)};return svc}]);appServices.factory("liveTickerTimerService",[function(){"use strict";var svc={};var _callbacks=[];var _intervalId=-1;var _milliseconds=0;var _triggerDelay=1e3;var _startTime=0;var _trigger=function(){_milliseconds=(new Date).getTime()-_startTime;for(var i=0;i<_callbacks.length;++i){_callbacks[i](_milliseconds)}};svc.timeSinceStart=function(){return _milliseconds};svc.resetTime=function(autostart){_milliseconds=0;if(autostart){svc.startTimer()}};svc.stopTimer=function(){if(-1!==_intervalId){clearInterval(_intervalId);_intervalId=-1}};svc.startTimer=function(){if(-1===_intervalId){_startTime=(new Date).getTime();_intervalId=setInterval(_trigger,_triggerDelay)}};svc.registerCallback=function(callback){if(angular.isDefined(callback)&&"function"===typeof callback){_callbacks.push(callback)}};svc.unregisterCallback=function(callback){if(angular.isDefined(callback)&&"function"===typeof callback){var index=_callbacks.indexOf(callback);if(-1!==index){_callbacks.splice(index,1)}}};svc.canRefresh=function(){var refresh=false;var minMilliSeconds=59999;refresh=minMilliSeconds<_milliseconds;return refresh};return svc}]);appServices.factory("semaphoreFactory",[function(){"use strict";var Semaphore=function(count,callback){this.count=count;this.callback=callback;this.checkCount=function(){if(this.count===0){callback.apply();this.callback=null}}};Semaphore.prototype.release=function(){this.count--;this.checkCount()};var createSemaphore=function(count,callback){return new Semaphore(count,callback)};return{createSemaphore:createSemaphore}}]);(function(){"use strict";var Service;Service=function($sce,$resource,sportDataServiceURLs,$q,$http,$filter,graphicService){Service=function(){function Service(){var _AGE_ID,_COMPETITION_TYPE,_DETAILS_CONTENT,_INCIDENT_ID,_LINKS,_MATCH_INCIDENT,_ROUND_MODE,_SPORT,_SPORT_ID,_STANDINGS_TYPE,_TOPIC,_VALID_BWIN_COMPETITIONS,_VALID_COMPETITIONS_FOR_MATCH_LINKS,_VALID_FM_COMPETITIONS,_VALID_SPORTS_FOR_CONFERENCE_LINKS,_VALID_SPORTS_FOR_MATCH_LINKS,_VALID_SPORTS_FOR_PERSON_LINKS,_VALID_SPORTS_FOR_TEAM_LINKS,_VALID_TIPICO_COMPETITIONS,__COMPETITION_TYPE,__HARDCODED_COMPETITION_TYPE,_getCachedPromise,_getCompetition,_getCompetitionConfig,_getConferenceTickerByDateForLeague,_getConferenceTickerByDateForTournament,_getFmLinkForMatch,_getGameplanByGroupMatchday,_getGameplanByMatchday,_getGameplanByRound,_getJsonUrlForKey,_getMatchStatus,_getMatchTicker,_getPerson,_getPromiseCache,_getRound,_getSeason,_getSport,_getSportSlug,_getStanding,_getSystemDate,_handleTickersArray,_promiseCache,_setLinkForTeam,_setTeamDetails,_setTeamLogo,_sortTicker,_systemDate,fakeSystemDate;fakeSystemDate=false;__COMPETITION_TYPE={LEAGUE:"league",TOURNAMENT:"tournament",DIVISION:"division"};Object.defineProperty(this,"_COMPETITION_TYPE",{get:function(){return __COMPETITION_TYPE}});__HARDCODED_COMPETITION_TYPE={140:__COMPETITION_TYPE.LEAGUE,481:__COMPETITION_TYPE.LEAGUE};Object.defineProperty(this,"HARDCODED_COMPETITION_TYPE",{get:function(){return __HARDCODED_COMPETITION_TYPE}});_COMPETITION_TYPE={CLUB:"club",NATIONAL:"national"};Object.defineProperty(this,"COMPETITION_TYPE",{get:function(){return _COMPETITION_TYPE}});_STANDINGS_TYPE={DEFAULT:"standard",HOME_AWAY:"heimgast",HALFS_OF_SEASON:"hinrueck"};Object.defineProperty(this,"STANDINGS_TYPE",{get:function(){return _STANDINGS_TYPE}});_ROUND_MODE={LEAGUE:1,KO:2,DOUBLE_KO:3,PLAYOFF:4};Object.defineProperty(this,"ROUND_MODE",{get:function(){return _ROUND_MODE}});_TOPIC={MOTORSPORTS:1,US_SPORTS:2};Object.defineProperty(this,"TOPIC",{get:function(){return _TOPIC}});_DETAILS_CONTENT={NONE:"none",RESULT:"result",GOALS:"goals",DATA:"data",FULL:"full"};Object.defineProperty(this,"DETAILS_CONTENT",{get:function(){return _DETAILS_CONTENT}});_SPORT={GENERIC:"generic",SOCCER:"fussball",BASKETBALL:"basketball",ICEHOCKEY:"eishockey",HANDBALL:"handball",AMERICAN_FOOTBALL:"american_football",BASEBALL:"baseball",TENNIS:"tennis",RADSPORT:"radsport",VOLLEYBALL:"volleyball",HOCKEY:"hockey"};Object.defineProperty(this,"SPORT",{get:function(){return _SPORT}});_SPORT_ID={SOCCER:1,BASKETBALL:2,BASEBALL:3,ICEHOCKEY:4,TENNIS:5,HANDBALL:6,RUGBY:12,AMERICAN_FOOTBALL:16,DART:22,VOLLEYBALL:23,HOCKEY:24,FORMEL1:40,DTM:42};Object.defineProperty(this,"SPORT_ID",{get:function(){return _SPORT_ID}});_MATCH_INCIDENT={EXTRA_TIME:1,PENALTY:2,RESCHEDULED:3,CALLED_OF:4,CANCELED:5,NOT_STAGED:6,UNDONE:7,TECHNICAL:8};Object.defineProperty(this,"MATCH_INCIDENT",{get:function(){return _MATCH_INCIDENT}});_VALID_TIPICO_COMPETITIONS=[12,33,132,563];Object.defineProperty(this,"VALID_TIPICO_COMPETITIONS",{get:function(){return _VALID_TIPICO_COMPETITIONS}});_VALID_BWIN_COMPETITIONS=[];Object.defineProperty(this,"VALID_BWIN_COMPETITIONS",{get:function(){return _VALID_BWIN_COMPETITIONS}});_VALID_FM_COMPETITIONS=[12,3,19,132,33];Object.defineProperty(this,"VALID_FM_COMPETITIONS",{get:function(){return _VALID_FM_COMPETITIONS}});_LINKS={TEAM:"/team/:competitionId/:teamId",NATIONAL_TEAM:"/:sport/team/:teamId",LIVE_TICKER:"/live-ticker/:competitionId/:matchId",PERSON:"/person/:competitionId/:personId",LIVE_TICKER_FORMEL1:"/motorsport/formel1/co:competitionId/liveticker/",LIVE_TICKER_DTM:"/motorsport/dtm/co:competitionId/liveticker/"};_VALID_SPORTS_FOR_TEAM_LINKS=[this.SPORT_ID.SOCCER];Object.defineProperty(this,"VALID_SPORTS_FOR_TEAM_LINKS",{get:function(){return _VALID_SPORTS_FOR_TEAM_LINKS}});_VALID_SPORTS_FOR_PERSON_LINKS=[this.SPORT_ID.SOCCER];Object.defineProperty(this,"VALID_SPORTS_FOR_PERSON_LINKS",{get:function(){return _VALID_SPORTS_FOR_PERSON_LINKS}});_VALID_COMPETITIONS_FOR_MATCH_LINKS={919:"/tennis/wimbledon-herren/ma:matchId/liveticker",920:"/tennis/wimbledon-herren/ma:matchId/liveticker",1027:"/tennis/wimbledon-damen/ma:matchId/liveticker",1028:"/tennis/wimbledon-damen/ma:matchId/liveticker",1019:"/tennis/paris-damen/ma:matchId/liveticker",698:"/radsport/tour-de-france/liveticker/ma:matchId/"};Object.defineProperty(this,"VALID_COMPETITIONS_FOR_MATCH_LINKS",{get:function(){return _VALID_COMPETITIONS_FOR_MATCH_LINKS}});_VALID_SPORTS_FOR_MATCH_LINKS=[this.SPORT_ID.SOCCER,this.SPORT_ID.HANDBALL,this.SPORT_ID.FORMEL1,this.SPORT_ID.ICEHOCKEY,this.SPORT_ID.BASKETBALL,this.SPORT_ID.HOCKEY,this.SPORT_ID.VOLLEYBALL,this.SPORT_ID.DTM,this.SPORT_ID.TENNIS];
Object.defineProperty(this,"VALID_SPORTS_FOR_MATCH_LINKS",{get:function(){return _VALID_SPORTS_FOR_MATCH_LINKS}});_VALID_SPORTS_FOR_CONFERENCE_LINKS=[this.SPORT_ID.SOCCER,this.SPORT_ID.HANDBALL,this.SPORT_ID.ICEHOCKEY];Object.defineProperty(this,"VALID_SPORTS_FOR_CONFERENCE_LINKS",{get:function(){return _VALID_SPORTS_FOR_CONFERENCE_LINKS}});_AGE_ID={1:"",2:"U 21",3:"U 20",4:"U 19",5:"U 18",6:"U 17"};Object.defineProperty(this,"AGE_ID",{get:function(){return _AGE_ID}});_INCIDENT_ID={VERLEGT:3,ABGEBROCHEN:5,NICHT_AUSGETRAGEN:6,ANNULIERT:7};_getJsonUrlForKey=function(key){var route;route=sportDataServiceURLs[key];if(route.slice(0,2)==="//"){return route}else{return sportDataServiceURLs.host+sportDataServiceURLs.prefixData+route}};_systemDate={initial:void 0,initialLocal:void 0,promise:void 0};_getSystemDate=this.getSystemDate=function(){var deferred,loadSystemDate,offset;deferred=$q.defer();loadSystemDate=function(url){_systemDate.promise=deferred.promise;return $http.get(url).then(function(response){var isoDate,systemDate;isoDate=response.data.systemtime.split(" ");systemDate=Sport1Tools.getDate(isoDate[0],isoDate[1]);_systemDate.initial=systemDate;_systemDate.initialLocal=new Date;return deferred.resolve(systemDate)})};if(!fakeSystemDate){if(_systemDate.initial!=null){offset=new Date-_systemDate.initialLocal;deferred.resolve(new Date(_systemDate.initial.getTime()+offset))}else if(_systemDate.promise){return _systemDate.promise}else{loadSystemDate(_getJsonUrlForKey("systemTime"))}}else{loadSystemDate("/fake/systemDate.json")}return deferred.promise};_promiseCache={};_getPromiseCache=function(key){if(_promiseCache[key]==null){_promiseCache[key]={}}return _promiseCache[key]};_getCachedPromise=function(key,params,isArray,retention){var $promise,cache,cached,k,path,resource,useCached,v;if(retention==null){retention=60}cache=_getPromiseCache(key);path=function(){var results1;results1=[];for(k in params){v=params[k];if(params.hasOwnProperty(k)){results1.push(v)}}return results1}().join("-");cached=cache[path];useCached=cached!=null&&cached.created.getTime()+retention*1e3>(new Date).getTime();if(useCached){return cached.content}else{resource=$resource(_getJsonUrlForKey(key));$promise=(isArray?resource.query:resource.get)(params).$promise;cache[path]={created:new Date,content:$promise};return cache[path].content}};_getStanding=function(competitionId,roundId,matchdayId,place){var key;key="standingByMatchday"+(place!=null?place[0].toUpperCase()+place.slice(1).toLowerCase():"");if(roundId!=null){return _getCachedPromise(key,{competitionId:competitionId,roundId:roundId,matchdayId:matchdayId},false,10)}else{return _getCachedPromise(key,{competitionId:competitionId},false,10)}};_getSportSlug=this.getSportSlug=function(sport){return sport.replace("ß","ss").replace("ä","ae").replace("ö","oe").replace("ü","ue").replace(" ","_").toLowerCase()};_getCompetitionConfig=function(competition){var _sport,_type,key,ref,sportIsKnown,sportSlug,value;_type=__COMPETITION_TYPE.LEAGUE;sportSlug=_getSportSlug(((ref=competition.sport)!=null?ref.name:void 0)||_SPORT.GENERIC);sportIsKnown=function(){var results1;results1=[];for(key in _SPORT){value=_SPORT[key];if(value===sportSlug){results1.push(value)}}return results1}();_sport=sportIsKnown.length?sportIsKnown[0]:_SPORT.GENERIC;if(competition.current_matchday==null||+competition.current_matchday===0){_type=__COMPETITION_TYPE.TOURNAMENT}if(competition.topic!=null&&+competition.topic.id===+_TOPIC.US_SPORTS){_type=__COMPETITION_TYPE.DIVISION}_type=__HARDCODED_COMPETITION_TYPE[competition.id]?__HARDCODED_COMPETITION_TYPE[competition.id]:_type;return{_type:_type,_sport:_sport}};_getMatchStatus=this.getMatchStatus=function(match){var deferred,hasLiveStatus,r,ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7,resultAway,resultAwayPenalty,resultHome,resultHomePenalty;deferred=$q.defer();if(match._status!=null){deferred.resolve(match._status)}match._isoDate=Sport1Tools.getDate(match.match_date,match.match_time);resultHome=function(){var i,len,ref,ref1,results1;ref=match.match_result||[];results1=[];for(i=0,len=ref.length;i<len;i++){r=ref[i];if(Number(r.match_result_at)===0&&~((ref1=r.place)!=null?ref1.indexOf("home"):void 0)){results1.push(r)}}return results1}();resultAway=function(){var i,len,ref,ref1,results1;ref=match.match_result||[];results1=[];for(i=0,len=ref.length;i<len;i++){r=ref[i];if(Number(r.match_result_at)===0&&~((ref1=r.place)!=null?ref1.indexOf("away"):void 0)){results1.push(r)}}return results1}();match._result={home:resultHome.length?Number((ref=resultHome[0])!=null?ref.match_result:void 0):"-",away:resultAway.length?Number((ref1=resultAway[0])!=null?ref1.match_result:void 0):"-",incident:void 0};if(Number((ref2=match.match_incident)!=null?ref2.id:void 0)===_MATCH_INCIDENT.PENALTY){resultHomePenalty=function(){var i,len,ref3,ref4,results1;ref3=match.match_result||[];results1=[];for(i=0,len=ref3.length;i<len;i++){r=ref3[i];if(Number(r.match_result_at)===21&&~((ref4=r.place)!=null?ref4.indexOf("home"):void 0)){results1.push(r)}}return results1}();match._result.home+=Number((ref3=resultHomePenalty[0])!=null?ref3.match_result:void 0)||0;resultAwayPenalty=function(){var i,len,ref4,ref5,results1;ref4=match.match_result||[];results1=[];for(i=0,len=ref4.length;i<len;i++){r=ref4[i];if(Number(r.match_result_at)===21&&~((ref5=r.place)!=null?ref5.indexOf("away"):void 0)){results1.push(r)}}return results1}();match._result.away+=Number((ref4=resultAwayPenalty[0])!=null?ref4.match_result:void 0)||0;match._result.incident={short:"n.E.",long:"nach Elfmeterschießen",name:"Elfmeterschießen"}}else if(match.match_incident!=null){match._result.incident={short:match.match_incident.shortname,long:match.match_incident.name,name:(ref5=match.match_incident.name)!=null?ref5.replace(/^nach/,"").replace(/^\s+|\s+$/g,""):void 0}}match._result.displayShort=match._result.home+" : "+match._result.away;match._result.display=""+match._result.displayShort;if(match._result.incident!=null){match._result.display+=" "+match._result.incident.short}if(match.finished==="yes"){match._hasStarted=true;match._isLive=match.isLive=false;deferred.resolve("finished")}else if((ref6=+((ref7=match.match_incident)!=null?ref7.id:void 0))===_INCIDENT_ID.VERLEGT||ref6===_INCIDENT_ID.ABGEBROCHEN||ref6===_INCIDENT_ID.NICHT_AUSGETRAGEN||ref6===_INCIDENT_ID.ANNULIERT){match._hasStarted=false;match._isLive=match.isLive=false;match._result={home:"-",away:"-"};match._result.displayShort=match._result.display=""+match.match_incident.shortname;deferred.resolve("finished")}else{hasLiveStatus=match.live_status!==_DETAILS_CONTENT.NONE;_getSystemDate().then(function(now){var isLive;if(hasLiveStatus){isLive=now>=match._isoDate&&match.finished!=="yes";match._hasStarted=isLive;match._isLive=match.isLive=isLive;if(!isLive){match._result={home:"-",away:"-"}}return deferred.resolve(isLive?"live":"none")}else{isLive=now>=match._isoDate;match._hasStarted=isLive;match._isLive=match.isLive=isLive;match._result={home:"-",away:"-"};return deferred.resolve(isLive?"live":"none")}})}return deferred.promise};this.getMatchResultForTeam=function(match,resultAt,team){var deferred;if(resultAt==null){resultAt=0}deferred=$q.defer();_getMatchStatus(match).then(function(status){var r,result,results;if(status==="none"){return deferred.resolve("-")}else{if(resultAt===0){if(team==="home"){return deferred.resolve(match._result.home)}else{return deferred.resolve(match._result.away)}}else{results=match.match_result;result=function(){var i,len,results1;results1=[];for(i=0,len=results.length;i<len;i++){r=results[i];if(+r.match_result_at===resultAt&&~r.place.indexOf(team)){results1.push(r)}}return results1}();return deferred.resolve(result.length?result[0].match_result:"-")}}});return deferred.promise};this.getMatchResultHome=function(match,resultAt){if(resultAt==null){resultAt=0}return this.getMatchResultForTeam(match,resultAt,"home")};this.getMatchResultAway=function(match,resultAt){return this.getMatchResultForTeam(match,resultAt,"away")};this.getMatchResult=function(match,resultAt,noResultPlaceholder){var deferred,promises;if(resultAt==null){resultAt=0}if(noResultPlaceholder==null){noResultPlaceholder="- : -"}deferred=$q.defer();promises={};promises.resultHome=this.getMatchResultHome(match,resultAt);promises.resultAway=this.getMatchResultAway(match,resultAt);$q.all(promises).then(function(results){var result;if(results.resultHome!=="-"){result=results.resultHome+" : "+results.resultAway}else{result=noResultPlaceholder}if(resultAt===0&&match.match_incident!=null){result=match._result.display}return deferred.resolve(result)});return deferred.promise};_setTeamLogo=this.setTeamLogo=function(team,logoSize){if(logoSize==null){logoSize="200x200"}return graphicService.setTeamLogo(team,logoSize)};_setTeamDetails=this.setTeamDetails=function(team,competition,logoSize){if(logoSize==null){logoSize="200x200"}_setTeamLogo(team,logoSize);return _setLinkForTeam(team,competition)};this.setPersonDetails=function(person,competition){var ref;if(ref=+competition.sport.id,window.indexOf.call(_VALID_SPORTS_FOR_PERSON_LINKS,ref)>=0){person._link=_LINKS.PERSON.replace(/:competitionId/g,competition.id).replace(/:personId/g,person.id);person._linkTitle="Zur Profilseite von "+person.surname}};this.setLinksForGroups=function(groups,competition){var group,i,len,results1;results1=[];for(i=0,len=groups.length;i<len;i++){group=groups[i];results1.push(this.setLinksForGroup(group,competition))}return results1};this.setLinksForGroup=function(group,competition){var i,len,rank,ref,results1;ref=group.content||group;results1=[];for(i=0,len=ref.length;i<len;i++){rank=ref[i];results1.push(_setLinkForTeam(rank.team,competition))}return results1};_setLinkForTeam=this.setLinkForTeam=function(team,competition){if(~_VALID_SPORTS_FOR_TEAM_LINKS.indexOf(+competition.sport.id)){team._linkTitle="Zur Vereinsseite von "+team.name;if(competition.type!=null&&competition.type==="national"){team._link=_LINKS.NATIONAL_TEAM.replace(":sport",competition._sport).replace(":teamId",team.id)}else{team._link=_LINKS.TEAM.replace(":competitionId",competition.id).replace(":teamId",team.id)}}};this.setLinkForMatch=function(match,competition,sportId){var ref,ref1;if(~_VALID_SPORTS_FOR_MATCH_LINKS.indexOf(+sportId)||_VALID_COMPETITIONS_FOR_MATCH_LINKS[competition.id]){if((ref=match.live_status)===_DETAILS_CONTENT.GOALS||ref===_DETAILS_CONTENT.DATA||ref===_DETAILS_CONTENT.FULL){if(match.home!=null){match._linkTitle="Zum Liveticker von "+match.home.name+" gegen "+match.away.name}else{match._linkTitle="Zum "+competition.name+" Liveticker"}if(_VALID_COMPETITIONS_FOR_MATCH_LINKS[competition.id]){match._link=_VALID_COMPETITIONS_FOR_MATCH_LINKS[competition.id].replace(":matchId",match.id)}else{match._link=(+sportId===_SPORT_ID.FORMEL1?_LINKS.LIVE_TICKER_FORMEL1:+sportId===_SPORT_ID.DTM?_LINKS.LIVE_TICKER_DTM:_LINKS.LIVE_TICKER).replace(":competitionId",competition.id).replace(":matchId",match.id)}}}if(ref1=+competition.id,window.indexOf.call(_VALID_TIPICO_COMPETITIONS,ref1)>=0){match._tipicoOddsUrl=$sce.trustAsResourceUrl("http://ads.tipico.com/tooltip/sport1/de"+("/co"+competition.id)+("/th"+match.home.id)+("/ta"+match.away.id)+("/da"+$filter("date")(match._isoDate,"yyyy-MM-dd"))+"/#/affiliateId336519")}match._fmLink=_getFmLinkForMatch(match)};_getFmLinkForMatch=this.getFmLinkForMatch=function(match){var filterResult,ref,result;result=null;if(match.match_meta!=null&&Array.isArray(match.match_meta)){filterResult=(ref=match.match_meta)!=null?ref.filter(function(metaObject){return metaObject.content!=null&&metaObject.content.match(".mp3")}):void 0;if(filterResult.length){result="http://www.sport1.fm/"}}return result};_getSport=this.getSport=function(sportId){return _getCachedPromise("sport",{sportId:sportId},false,60*60)};_getCompetition=this.getCompetition=function(competitionId){var $promise;$promise=_getCachedPromise("competition",{competitionId:competitionId},false,60*60);return $promise.then(function(competition){if(competition._sport==null){angular.extend(competition,_getCompetitionConfig(competition));competition.paths={team:_LINKS.TEAM.replace(":competitionId",competitionId),ticker:_LINKS.LIVE_TICKER.replace(":competitionId",competitionId)}}return competition})};_getPerson=this.getPerson=function(personId){return _getCachedPromise("person",{personId:personId},false,10)};this.getPersonStatsBySeasonTeam=function(seasonId,teamId){return _getCachedPromise("personStatsBySeasonTeam",{seasonId:seasonId,teamId:teamId},false,10)};this.getStanding=function(competitionId,roundId,matchdayId){return _getStanding(competitionId,roundId,matchdayId)};this.getStandingLive=function(competitionId){return _getCachedPromise("standingLive",{competitionId:competitionId},false,10)};this.getStandingHome=function(competitionId,roundId,matchdayId){return _getStanding(competitionId,roundId,matchdayId,"home")};this.getStandingAway=function(competitionId,roundId,matchdayId){return _getStanding(competitionId,roundId,matchdayId,"away")};this.getStandingByConference=function(competitionId,roundId,matchdayId){return _getCachedPromise("standingByConference",{competitionId:competitionId,roundId:roundId,matchdayId:matchdayId},false,10)};this.getGameplanBySeason=function(competitionId,seasonId){return _getCachedPromise("gameplanBySeason",{competitionId:competitionId,seasonId:seasonId},false,10)};_getGameplanByRound=this.getGameplanByRound=function(competitionId,seasonId,roundId){return _getCachedPromise("gameplanByRound",{competitionId:competitionId,seasonId:seasonId,roundId:roundId},false,10).then(function(season){return season.round[0]})};this.getGameplanByRoundByGroupMatchday=function(competitionId,seasonId,roundId,groupMatchdayId){var deferred;deferred=$q.defer();_getCachedPromise("gameplanByRoundByGroupMatchday",{competitionId:competitionId({seasonId:seasonId,roundId:roundId,groupMatchdayId:groupMatchdayId},false,10)}).then(function(season){return deferred.resolve(season.round[0])});return deferred.promise};_getGameplanByMatchday=this.getGameplanByMatchday=function(competitionId,seasonId,matchdayId){return _getCachedPromise("gameplanByMatchday",{competitionId:competitionId,seasonId:seasonId,matchdayId:matchdayId},false,10)};_getGameplanByGroupMatchday=this.getGameplanByGroupMatchday=function(competitionId,seasonId,groupMatchdayId){return _getCachedPromise("gameplanByGroupMatchday",{competitionId:competitionId,seasonId:seasonId,groupMatchdayId:groupMatchdayId},false,10)};this.getRoundGameplanByMatchday=function(competitionId,seasonId,matchdayId){return _getCachedPromise("roundGameplanByMatchday",{competitionId:competitionId,seasonId:seasonId,matchdayId:matchdayId},false,10)};this.getCompleteGameplan=function(competitionId,sport){return _getCachedPromise("gameplanComplete",{competitionId:competitionId,sport:sport},true,10)};this.getMatchesByDateForCompetition=function(date,competitionId){return _getCachedPromise("matchesByDateForCompetition",{date:date,competitionId:competitionId},true,10)};this.getCompleteFmAudioStreams=function(){return _getCachedPromise("completeFmAudioStreams",null,true)};_getSeason=this.getSeason=function(seasonId){return _getCachedPromise("season",{seasonId:seasonId},false,60*60)};this.getSeasonsByCompetition=function(competitionId){return _getCachedPromise("seasonsByCompetition",{competitionId:competitionId},false,60*60).then(function(data){return data.season})};this.getSeasonsByTeam=function(teamId){return _getCachedPromise("seasonsByTeam",{teamId:teamId},true,60*60)};_getRound=this.getRound=function(roundId){return _getCachedPromise("round",{roundId:roundId},false,60*60)};this.getRoundBySeason=function(seasonId){return _getCachedPromise("roundBySeason",{seasonId:seasonId},false,60*60)};this.getRoundsBySeason=function(seasonId){return _getCachedPromise("roundsBySeason",{seasonId:seasonId},false,60*60)};this.getMatch=function(matchId){var deferred;deferred=$q.defer();_getCachedPromise("match",{matchId:matchId},false,10).then(function(match){if(!(match!=null?match.match:void 0)){return deferred.reject()}match=match.match;return _getMatchStatus(match).then(function(){return deferred.resolve(match)})});return deferred.promise};this.getMatches=function(IDs){var deferred,get,matches,next;deferred=$q.defer();IDs=IDs.slice();matches=[];get=this.getMatch;next=function(){var id;id=IDs.shift();if(!id){return deferred.resolve(matches)}return get(id).then(function(match){matches.push(match);return next()},next)};next();return deferred.promise};this.getCurrentLiveEvents=function(){return _getCachedPromise("liveEvents",{},true,10)};this.getLiveEventsInSport=function(sport){return _getCachedPromise("sportEvents",{sport:sport},true,10)};this.getLiveEventsInLeague=function(competitionId){return _getCachedPromise("leagueEvents",{competitionId:competitionId},true,10)};this.getLiveCompetitions=function(competitionId){return _getCachedPromise("liveCompetitions",{competitionId:competitionId},true,10)};this.getMatchesByDate=function(date){return _getCachedPromise("matchesByDateShortlist",{date:date},true,10)};this.getMatchesByDateShortlist=function(date){return _getCachedPromise("matchesByDateShortlist",{date:date},true,10)};this.getMatchesFromToByTeam=function(dateFrom,dateTo,teamId){return _getCachedPromise("matchesFromToByTeam",{dateFrom:dateFrom,dateTo:dateTo,teamId:teamId},true,10)};this.getMatchesByDateWithSport=function(date,sport){return _getCachedPromise("matchesByDateWithSport",{date:date,sport:sport},true,10)};_getMatchTicker=this.getMatchTicker=function(competitionId,matchId,lastUpdate){var params,requestName;params={competitionId:competitionId,matchId:matchId};if(lastUpdate!=null){params.lastUpdate=lastUpdate;requestName="matchTickerDelta"}else{requestName="matchTicker"}return _getCachedPromise(requestName,params,true,10)};this.getLivetickerWithMatch=function(competitionId,matchId,lastUpdate){var params,requestName;params={competitionId:competitionId,matchId:matchId};if(lastUpdate!=null){console.error("delta route not available");return false}else{requestName="liveTickerWithMatch"}return _getCachedPromise(requestName,params,false,10)};this.getTeamStatisticsForMatch=function(matchId,teamId){return _getCachedPromise("teamStatisticsForMatch",{matchId:matchId,teamId:teamId},true,10)};this.getCompleteMatchTeamStats=function(competitionId,sport,matchId,isPast){var cacheTime;cacheTime=isPast!=null&&isPast===true?Number.MAX_VALUE:10;return _getCachedPromise("completeMatchTeamsStats",{competitionId:competitionId,sport:sport,matchId:matchId},true,cacheTime)};this.getMatchEvents=function(matchId){return _getCachedPromise("matchEvent",{matchId:matchId},true,10)};this.getMatchTactical=function(matchId){return _getCachedPromise("matchTactical",{matchId:matchId},true,10)};this.getConferenceTickerByDate=function(competition,date){var deferred;deferred=$q.defer();if(competition._type===__COMPETITION_TYPE.TOURNAMENT){_getConferenceTickerByDateForTournament(competition,date,deferred)}else{_getConferenceTickerByDateForLeague(competition,date,deferred)}return deferred.promise};_getConferenceTickerByDateForTournament=function(competition,date,deferred){var handleRounds;handleRounds=function(rounds){var i,j,len,len1,match,matchId,matches,promises,ref,round;promises={};matches={};for(i=0,len=rounds.length;i<len;i++){round=rounds[i];ref=round.match;for(j=0,len1=ref.length;j<len1;j++){match=ref[j];matches[match.id]=match}for(matchId in matches){match=matches[matchId];promises["match-ticker/"+matchId]=_getMatchTicker(competition.id,matchId);promises["match-status/"+matchId]=_getMatchStatus(match)}}promises.now=_getSystemDate();return $q.all(promises).then(function(results){var key,now,result,ticker,tickers;now=results.now;tickers=[];for(key in results){ticker=results[key];if(~key.indexOf("match-ticker/")){tickers[key.match(/match-ticker\/(\d+)/)[1]]=ticker}}_handleTickersArray({competition:competition,tickers:tickers,matches:matches,now:now});result=[];for(key in tickers){ticker=tickers[key];result=result.concat(ticker)}return deferred.resolve(result)})};return _getRound(competition.current_round_id).then(function(round){if(+round.round_mode.id===_ROUND_MODE.LEAGUE){return _getSeason(competition.current_season_id).then(function(season){var groupMatchdayId;groupMatchdayId=season.current_group_matchday;return _getGameplanByGroupMatchday(competition.id,season.id,groupMatchdayId).then(function(season){return handleRounds(season.round)})})}else{return _getGameplanByRound(competition.id,competition.current_season_id,competition.current_round_id).then(function(round){return handleRounds([round])})}})};_getConferenceTickerByDateForLeague=function(competition,date,deferred){return _getGameplanByMatchday(competition.id,competition.current_season,competition.current_matchday).then(function(matchday){var i,len,match,matchId,matches,promises,ref;matches={};ref=matchday.round[0].match;for(i=0,len=ref.length;i<len;i++){match=ref[i];matches[match.id]=match}promises={};for(matchId in matches){match=matches[matchId];promises["match-ticker/"+matchId]=_getMatchTicker(competition.id,matchId);promises["match-status/"+matchId]=_getMatchStatus(match)}promises.now=_getSystemDate();return $q.all(promises).then(function(results){var key,now,result,ticker,tickers;now=results.now;tickers=[];for(key in results){ticker=results[key];if(~key.indexOf("match-ticker/")){tickers[key.match(/match-ticker\/(\d+)/)[1]]=ticker}}_handleTickersArray({competition:competition,tickers:tickers,matches:matches,now:now});result=[];for(key in tickers){ticker=tickers[key];result=result.concat(ticker)}return deferred.resolve(result)})})};_handleTickersArray=function(args){var currentScore,match,matchId,ownGoal,post,ref,results1,scoreAway,scoreHome,ticker;ref=args.tickers;results1=[];var matchResults=function(ticker,match,scoreHome,scoreAway){var i,len,ref1,ref2,ref3,ref4,results;results=[];for(i=0,len=ticker.length;i<len;i++){post=ticker[i];post._isLive=post.isLive=match._isLive;post._hasStarted=match._hasStarted;if(((ref1=post.event)!=null?ref1.action:void 0)==="goal"||((ref2=post.event)!=null?ref2.action:void 0)==="pso"&&((ref3=post.event)!=null?ref3.kind:void 0)==="goal"){ownGoal=((ref4=post.event)!=null?ref4.kind:void 0)==="own-goal";if(Number(post.event.team.id)===Number(match.home.id)){if(!ownGoal){scoreHome++}else{scoreAway++}}else{if(!ownGoal){scoreAway++}else{scoreHome++}}}post._currentScore={home:scoreHome,away:scoreAway};post.home=match.home;results.push(post.away=match.away)}return results};for(matchId in ref){ticker=ref[matchId];match=args.matches[matchId];scoreHome=0;scoreAway=0;currentScore=ticker._currentScore=[{home:scoreHome,away:scoreAway}];_setTeamDetails(match.home,args.competition,"60x60");_setTeamDetails(match.away,args.competition,"60x60");results1.push(matchResults(ticker,match,scoreHome,scoreAway))}return results1};_sortTicker=this.sortTicker=function(ticker,isConference){if(isConference==null){isConference=false}return ticker.sort(function(a,b){var aTime,bTime;aTime=Sport1Tools.getDate.apply(null,(a.tickertime||a.created).split(" "));bTime=Sport1Tools.getDate.apply(null,(b.tickertime||b.created).split(" "));if(!isConference&&Number(a.minute)!==Number(b.minute)){return Number(a.minute)-Number(b.minute)}else if((aTime=typeof aTime.getTime==="function"?aTime.getTime():void 0)!==(bTime=typeof bTime.getTime==="function"?bTime.getTime():void 0)){return aTime-bTime}else{return Number(a.id)-Number(b.id)}})};this.getSeasonTopicsByTopic=function(topicId){return _getCachedPromise("seasonTopicsByTopic",{topicId:topicId},true,Number.MAX_VALUE)};this.getMatchesByTopicForSeason=function(topicId){return _getCachedPromise("matchesByTopicForSeason",{topicId:topicId},false,10)};this.getCountryList=function(){return _getCachedPromise("countryList",{},true)}}return Service}();return new Service};Service.$inject=["$sce","$resource","sportDataServiceURLs","$q","$http","$filter","graphicService"];return angular.module("sport1.services").service("sportDataService",Service)})();(function(){"use strict";var Value;Value={host:"https://api.sport1.de",prefixData:"/api/sports",prefixView:"/html",sport:"/sport/sp:sportId",competition:"/competition/co:competitionId",competitionByTeam:"/seasons-by-team/te:teamId",season:"/season/se:seasonId",seasonsByCompetition:"/seasons-by-competition/co:competitionId",seasonsByTeam:"/seasons-by-team/te:teamId",round:"/round/ro:roundId",roundBySeason:"/round-by-season/se:seasonId",roundsBySeason:"/rounds-by-season/se:seasonId",standing:"/standing/co:competitionId",standingLive:"/standing-live/co:competitionId",standingHome:"/standing-home/co:competitionId",standingAway:"/standing-away/co:competitionId",standingByMatchday:"/standing-round-matchday/co:competitionId/ro:roundId/md:matchdayId",standingByMatchdayHome:"/standing-round-matchday-home/co:competitionId/ro:roundId/md:matchdayId",standingByMatchdayAway:"/standing-round-matchday-away/co:competitionId/ro:roundId/md:matchdayId",standingByConference:"/standing-for-parent-group/co:competitionId/ro:roundId/md:matchdayId",gameplanByMatchday:"/matches-by-season/co:competitionId/se:seasonId/md:matchdayId",gameplanByGroupMatchday:"/matches-by-season/co:competitionId/se:seasonId/gm:groupMatchdayId",gameplanBySeason:"/matches-by-season/co:competitionId/se:seasonId",gameplanByRound:"/matches-by-season/co:competitionId/se:seasonId/ro:roundId",gameplanByRoundByGroupMatchday:"/matches-by-season/co:competitionId/se:seasonId/ro:roundId/gm:groupMatchdayId",gameplanComplete:"/complete-gameplan/co:competitionId/sp:sport",match:"/match/ma:matchId",matchesFromToByTeam:"/matches-from-to/df:dateFrom/dt:dateTo/te:teamId",matchTicker:"/liveticker/co:competitionId/ma:matchId",matchTickerDelta:"/liveticker-delta/co:competitionId/ma:matchId",liveTickerWithMatch:"/liveticker-with-match/co:competitionId/ma:matchId",matchEvent:"/match-event/ma:matchId",matchTactical:"/match-tactical/ma:matchId",conferenceTickerByDate:"/liveticker-by-competition-date/co:competitionId/da:date",matchesByDate:"/matches-by-date/da:date",matchesByDateShortlist:"/matches-by-date-shortlist/da:date",matchesByDateWithSport:"/matches-by-date/da:date/sp:sport",matchesByDateForCompetition:"/matches-by-date/da:date/co:competitionId",liveEvents:"/matches-by-date",sportEvents:"/matches-by-date/sp:sport",leagueEvents:"/matches-by-date/co:competitionId",completeFmAudioStreams:"/complete-fm-audio-streams",teamStatisticsForMatch:"/team-stats-by-match/ma:matchId/te:teamId",completeMatchTeamsStats:"/complete-match-teams-stats/co:competitionId/sp:sport/ma:matchId",liveCompetitions:"/matches-by-date/co:competitionId",systemTime:"/system-time",countryList:"/country-list",person:"/person/pe:personId",personStatsBySeasonTeam:"/person-stats-by-season-team/se:seasonId/te:teamId",seasonTopicsByTopic:"/season-topics-by-topic/to:topicId",matchesByTopicForSeason:"//fm.local.sport1.de/fake/matches-by-topic-for-season/to:topicId.json",standingWidget:"/standing/widget/:competitionId/:roundId/:matchdayNo",gameplanWidget:"/gameplan/widget/:competitionId/:roundId/:matchdayNo/:styleName"};return angular.module("sport1.services").value("sportDataServiceURLs",Value)})();(function(){"use strict";var Service,dependencies;dependencies=[];Service=function(){Service=function(){function Service(){this.translations={generic:{"event__match__game-start":"Anpfiff","event__match__game-end":"Spielende","event__match__first-half-end":"Halbzeit","event__match__second-half-start":"Anpfiff","event__match__second-half-end":"Ende 2. Halbzeit","event__match__first-extra-start":"Anpfiff Verlängerung 1. HZ","event__match__first-extra-end":"Ende Verlängerung 1. HZ","event__match__second-extra-start":"Anpfiff Verlängerung 2. HZ","event__match__second-extra-end":"Ende Verlängerung 2. HZ","event__match__first-third-end":"Ende 1. Drittel","event__match__second-third-start":"Anpfiff 2. Drittel","event__match__second-third-end":"Ende 2. Drittel","event__match__third-third-start":"Anpfiff 3. Drittel","event__match__third-third-end":"Ende 3. Drittel","event__match__first-quarter-end":"Ende 1. Viertel","event__match__second-quarter-start":"Anpfiff 2. Viertel","event__match__second-quarter-end":"Ende 2. Viertel","event__match__third-quarter-start":"Anpfiff 3. Viertel","event__match__third-quarter-end":"Ende 3. Viertel","event__match__fourth-quarter-start":"Anpfiff 4. Viertel","event__match__fourth-quarter-end":"Ende 4. Viertel","event__match__overtime-start":"Anpfiff Verlängerung","event__match__overtime-end":"Ende Verlängerung",event__card__green:"Grüne Karte",event__card__yellow:"Gelbe Karte","event__card__yellow-red":"Gelb-Rote Karte",event__card__red:"Rote Karte","event__playing__substitute-out":"Auswechslung","event__playing__substitute-in":"Einwechslung"},fussball:{"event__special__missed-penalty":"Elfmeter verschossen","event__match__penalty-start":"Das Elfmeterschießen beginnt",event__pso__goal:"Elfmeter verwandelt!",event__pso__miss:"Elfmeter verschossen!"},handball:{"event__special__missed-penalty":"verworfener Siebenmeter","event__match__penalty-start":"Das Siebenmeterwerfen beginnt",event__pso__goal:"Siebenmeter verwandelt!",event__pso__miss:"Siebenmeter verworfen!"},eishockey:{"event__special__missed-penalty":"Penalty vergeben","event__match__penalty-start":"Das Penaltyschießen beginnt",event__pso__goal:"Penalty verwandelt!",event__pso__miss:"Penalty vergeben!"},feldhockey:{"event__special__missed-penalty-corner":"Strafecke vergeben","event__special__missed-penalty":"Penalty vergeben","event__match__penalty-start":"Das Penaltyschießen beginnt",event__pso__goal:"Penalty verwandelt!",event__pso__miss:"Penalty vergeben!"},volleyball:{"event__match__first-set-end":"Ende 1. Satz","event__match__second-set-start":"Anpfiff 2. Satz","event__match__second-set-end":"Ende 2. Satz","event__match__third-set-start":"Anpfiff 3. Satz","event__match__third-set-end":"Ende 3. Satz","event__match__fourth-set-start":"Anpfiff 4. Satz","event__match__fourth-set-end":"Ende 4. Satz","event__match__fifth-set-start":"Anpfiff 5. Satz","event__match__fifth-set-end":"Ende 5. Satz","event__match__golden-set-start":"Anpfiff Golden Set"}}}Service.prototype.translate=function(sport,key){var ref;return((ref=this.translations[sport])!=null?ref[key]:void 0)||this.translations.generic[key]||""};return Service}();return new Service};Service.$inject=dependencies;return angular.module("sport1.services").service("SportTranslationService",Service)})();(function(){"use strict";var Service;Service=function($resource,sportDataServiceURLs,$q,$http){var service;Service=function(){function Service(){this.host=sportDataServiceURLs.host}Service.prototype.getJsonUrlForKey=function(key,params){var route,value;route=sportDataServiceURLs[key];for(key in params){value=params[key];route=route.replace(":"+key,value||0)}if(route.slice(0,2)==="//"){return route}else{return sportDataServiceURLs.host+sportDataServiceURLs.prefixView+route}};Service.prototype.makeRequest=function(url){return $http.get(url)};Service.prototype.getStandingWidget=function(competitionId,roundId,matchdayNo){var url;url=this.getJsonUrlForKey("standingWidget",{competitionId:competitionId,roundId:roundId,matchdayNo:matchdayNo});return this.makeRequest(url)};Service.prototype.getGameplanWidget=function(competitionId,roundId,matchdayNo,styleName){var url;url=this.getJsonUrlForKey("gameplanWidget",{competitionId:competitionId,roundId:roundId,matchdayNo:matchdayNo,styleName:styleName||"full"});return this.makeRequest(url)};return Service}();service=new Service;return service};Service.$inject=["$resource","sportDataServiceURLs","$q","$http"];return angular.module("sport1.services").service("sportViewService",Service)})();(function(){"use strict";var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item){return i}}return-1};var Service;Service=function($filter,SportData){var hasTickerData;this.getMarkerColorId=function(glossary,rank){var i,item,len,marker;if(glossary==null){return""}for(i=0,len=glossary.length;i<len;i++){
item=glossary[i];if(item.from<=rank&&rank<=item.to){marker=item}}if(marker!=null){return marker.colour_id}else{return""}};var awayTeamLogoClasses=Sport1Tools.isMobileSite()?["s1-table-cell-padding-right"]:["s1-table-cell-padding"];this.columns={standings:{position:{id:"position",slug:"position",title:function(){return"Pl."},type:"text",content:function(args){return args.tableRow.rank},class:function(_this){return function(args){return _this.getMarkerColorId(args.tableData.glossary,+args.tableRow.rank)}}(this),classPrefix:"s1-glossary-color-",staticClasses:["s1-table-cell-center"]},trend:{id:"trend",slug:"trend",title:function(){return""},type:"none",content:function(){return""},class:function(args){var lastRank,rank;rank=+args.tableRow.rank;lastRank=+args.tableRow.last_rank;if(!rank||!lastRank){return"none"}else if(rank===lastRank){return"none"}else if(rank<lastRank){return"up"}else{return"down"}},classPrefix:"s1-trend-",staticClasses:["s1-table-cell-center"]},teamLogo:{id:"team-logo",slug:"team-logo",title:function(){return""},type:"html",content:function(args){SportData.setTeamLogo(args.tableRow.team,"40x40");return"<img\n  src='"+args.tableRow.team.logo+"'\n  onerror=\"this.onerror=undefined; this.src='"+args.tableRow.team.logo_fallback+"';\"\n>"}},team:{id:"team",slug:"team",title:function(args){switch(args.competition.type){case SportData.COMPETITION_TYPE.NATIONAL:return"Land";default:return"Verein"}},type:"text",content:function(args){return args.tableRow.team.name},staticClasses:["s1-table-cell-bold","s1-table-cell-text-overflow"]},teamShort:{id:"team-short",slug:"team-short",title:function(args){switch(args.competition.type){case SportData.COMPETITION_TYPE.NATIONAL:return"Land";default:return"Verein"}},type:"text",content:function(args){return args.tableRow.team.shortname},customAttributes:{"s1-full-name":function(args){return args.tableRow.team.name}},staticClasses:["s1-table-cell-bold","s1-table-cell-text-overflow"]},teamMicro:{id:"team-micro",slug:"team-micro",title:function(args){switch(args.competition.type){case SportData.COMPETITION_TYPE.NATIONAL:return"Land";default:return"Verein"}},type:"text",content:function(args){if(args.tableRow.team.microname!=null){return args.tableRow.team.microname}else{return args.tableRow.team.shortname}},customAttributes:{"s1-full-name":function(args){return args.tableRow.team.name}},staticClasses:["s1-table-cell-bold","s1-table-cell-text-overflow"]},games:{id:"games",slug:"games",title:function(){return"Spiele"},type:"text",content:function(args){return args.tableRow.matches},staticClasses:["s1-table-cell-center"]},points:{id:"points",slug:"points",title:function(){return"Pkt."},type:"text",content:function(args){if(args.tableRow.minuspoints){return args.tableRow.points+" : "+args.tableRow.minuspoints}else{return args.tableRow.points}},staticClasses:["s1-table-cell-center","s1-table-cell-bold","s1-table-cell-border-dark"]},winPercentage:{id:"win-percentage",slug:"points",title:function(){return"%"},type:"text",content:function(args){return args.tableRow.percentage},staticClasses:["s1-table-cell-center","s1-table-cell-bold","s1-table-cell-border-dark"]},difference:{id:"difference",slug:"difference",title:function(){return"Diff"},type:"text",content:function(args){return args.tableRow.score-args.tableRow.score_against},staticClasses:["s1-table-cell-center","s1-table-cell-border-dark"]},goalratio:{id:"goalratio",slug:"goalratio",title:function(args){var ref,ref1,ref2;return(ref=args.tableData)!=null?(ref1=ref.content)!=null?(ref2=ref1[0])!=null?ref2.difference_name:void 0:void 0:void 0},type:"text",content:function(args){return args.tableRow.score+" : "+args.tableRow.score_against},staticClasses:["s1-table-cell-center","s1-table-cell-border-dark"]},win:{id:"win",slug:"win",title:function(){return"G"},type:"text",content:function(args){return args.tableRow.win},staticClasses:["s1-table-cell-center","s1-table-cell-border-dark"]},draw:{id:"draw",slug:"draw",title:function(){return"U"},type:"text",content:function(args){return args.tableRow.draw},staticClasses:["s1-table-cell-center","s1-table-cell-border"]},lost:{id:"lost",slug:"lost",title:function(){return"V"},type:"text",content:function(args){return args.tableRow.lost},staticClasses:["s1-table-cell-center","s1-table-cell-border"]},gamesBehind:{id:"games-behind",slug:"games-behind",title:function(){return"GB"},type:"text",content:function(args){var aLosses,aWins,bLosses,bWins,gb,ref,ref1,ref2,ref3;aWins=(ref=args.tableData)!=null?(ref1=ref.content)!=null?ref1[0].win:void 0:void 0;aLosses=(ref2=args.tableData)!=null?(ref3=ref2.content)!=null?ref3[0].lost:void 0:void 0;bWins=args.tableRow.win;bLosses=args.tableRow.lost;gb=(aWins-bWins+(bLosses-aLosses))/2;return Math.round(gb,0)},staticClasses:["s1-table-cell-center","s1-table-cell-border"]},otw:{id:"otw",slug:"otw",type:"text",title:function(){return"OTG"},content:function(args){return args.tableRow.win_on_extra_time},staticClasses:["s1-table-cell-center","s1-table-cell-border"]},psw:{id:"psw",slug:"psw",type:"text",title:function(){return"PSG"},content:function(args){return args.tableRow.win_on_penalty},staticClasses:["s1-table-cell-center","s1-table-cell-border"]},otl:{id:"otl",slug:"otl",type:"text",title:function(){return"OTV"},content:function(args){return args.tableRow.lost_on_extra_time},staticClasses:["s1-table-cell-center","s1-table-cell-border"]},psl:{id:"psl",slug:"psl",type:"text",title:function(){return"PSV"},content:function(args){return args.tableRow.lost_on_penalty},staticClasses:["s1-table-cell-center","s1-table-cell-border"]}},gameplan:{date:{id:"date",slug:"date",title:function(){return"Anstoss"},type:"text",content:function(args){var date,time;date=args.tableRow.match_date;time=args.tableRow.match_time;if(0===args.index){if(date==="unknown"){return"Spieltermine noch nicht festgesetzt"}else if(time==="unknown"){return $filter("date")(date.split(".").reverse().join("-"),"EEE dd.MM.")}else{return $filter("date")(date.split(".").reverse().join("-")+("T"+time),"EEE dd.MM. HH:mm")}}else{return""}},staticClasses:["s1-table-cell-padding"]},teams:{id:"teams",slug:"teams",title:function(args){if(args.group!=null){if(args.group.date==="unknown"){return"Spieltermine noch nicht festgesetzt"}else if(args.group.time==="unknown"){return $filter("date")(args.group.date.split(".").reverse().join("-"),"EEEE, dd. MMMM yyyy")}else{return $filter("date")(args.group._startTime,"EEEE, dd. MMMM yyyy '-' HH:mm 'Uhr'")}}else{return""}},staticClasses:["s1-table-cell-padding"]},homeTeamLogo:{id:"home-team-logo",slug:"home-team-logo",type:"html",content:function(args){SportData.setTeamLogo(args.tableRow.home,"40x40");return"<img\n  src='"+args.tableRow.home.logo+"'\n  onerror=\"this.onerror=undefined; this.src='"+args.tableRow.home.logo_fallback+"';\"\n>"},staticClasses:["s1-table-cell-padding"]},homeTeam:{id:"home-team",slug:"home-team",type:"text",content:function(args){var ref;return(ref=args.tableRow.home)!=null?ref.name:void 0},staticClasses:["s1-table-cell-text-overflow","s1-table-cell-bold"]},homeTeamShort:{id:"home-team-short",slug:"home-team-short",type:"text",content:function(args){var ref;return(ref=args.tableRow.home)!=null?ref.shortname:void 0},customAttributes:{"s1-full-name":function(args){var ref;return(ref=args.tableRow.home)!=null?ref.name:void 0}},staticClasses:["s1-table-cell-text-overflow","s1-table-cell-bold"]},homeTeamMicro:{id:"home-team-micro",slug:"home-team-micro",type:"text",content:function(args){var ref,ref1,ref2;if(((ref=args.tableRow.home)!=null?ref.microname:void 0)!=null){return(ref1=args.tableRow.home)!=null?ref1.microname:void 0}else{return(ref2=args.tableRow.home)!=null?ref2.shortname:void 0}},customAttributes:{"s1-full-name":function(args){var ref;return(ref=args.tableRow.home)!=null?ref.name:void 0}},staticClasses:["s1-table-cell-text-overflow","s1-table-cell-bold"]},resultHome:{id:"result-home",slug:"result-home",title:function(){return"Ergebnis"},type:"textPromise",content:function(args){return SportData.getMatchResultHome(args.tableRow,0)},staticClasses:["s1-table-cell-bold","s1-table-cell-center"]},vs:{id:"vs",slug:"vs",type:"text",content:function(){return":"},staticClasses:["s1-table-cell-center"]},awayTeamLogo:{id:"away-team-logo",slug:"away-team-logo",type:"html",content:function(args){SportData.setTeamLogo(args.tableRow.away,"40x40");return"<img\n  src='"+args.tableRow.away.logo+"'\n  onerror=\"this.onerror=undefined; this.src='"+args.tableRow.away.logo_fallback+"';\"\n>"},staticClasses:awayTeamLogoClasses},awayTeam:{id:"away-team",slug:"away-team",type:"text",content:function(args){var ref;return(ref=args.tableRow.away)!=null?ref.name:void 0},staticClasses:["s1-table-cell-text-overflow","s1-table-cell-bold"]},awayTeamShort:{id:"away-team-short",slug:"away-team-short",type:"text",content:function(args){var ref;return(ref=args.tableRow.away)!=null?ref.shortname:void 0},customAttributes:{"s1-full-name":function(args){var ref;return(ref=args.tableRow.away)!=null?ref.name:void 0}},staticClasses:["s1-table-cell-text-overflow","s1-table-cell-bold"]},awayTeamMicro:{id:"away-team-micro",slug:"away-team-micro",type:"text",content:function(args){var ref,ref1,ref2;if(((ref=args.tableRow.away)!=null?ref.microname:void 0)!=null){return(ref1=args.tableRow.away)!=null?ref1.microname:void 0}else{return(ref2=args.tableRow.away)!=null?ref2.shortname:void 0}},customAttributes:{"s1-full-name":function(args){var ref;return(ref=args.tableRow.away)!=null?ref.name:void 0}},staticClasses:["s1-table-cell-text-overflow","s1-table-cell-bold"]},resultAway:{id:"result-away",slug:"result-away",title:function(){return"Ergebnis"},type:"textPromise",content:function(args){return SportData.getMatchResultAway(args.tableRow,0)},staticClasses:["s1-table-cell-bold","s1-table-cell-center"]},result:{id:"result",slug:"result",title:function(){return"Ergebnis"},type:"textPromise",content:function(args){return SportData.getMatchResult(args.tableRow,0)},staticClasses:["s1-table-cell-bold","s1-table-cell-center",!Sport1Tools.isMobileSite()?"s1-table-cell-border-right":""]},resultBordered:{id:"result",slug:"result",title:function(){return"Ergebnis"},type:"textPromise",content:function(args){return SportData.getMatchResult(args.tableRow,0)},staticClasses:["s1-table-cell-bold","s1-table-cell-center",!Sport1Tools.isMobileSite()?"s1-table-cell-border":"",!Sport1Tools.isMobileSite()?"s1-table-cell-border-right":""]},resultHalftime:{id:"halftime-result",slug:"halftime-result",title:function(){return"Halbzeit"},type:"textPromise",content:function(args){return SportData.getMatchResult(args.tableRow,1)},staticClasses:["s1-table-cell-center","s1-table-cell-border-right"]},resultFirstThird:{id:"third-result-1",slug:"third-result",type:"textPromise",titleClass:"s1-first-third",content:function(args){return SportData.getMatchResult(args.tableRow,1)},staticClasses:["s1-table-cell-center"]},resultSecondThird:{id:"third-result-2",slug:"third-result",type:"textPromise",titleClass:"s1-second-third",content:function(args){return SportData.getMatchResult(args.tableRow,2)},staticClasses:["s1-table-cell-center"]},resultThirdThird:{id:"third-result-3",slug:"third-result",type:"textPromise",titleClass:"s1-third-third",content:function(args){return SportData.getMatchResult(args.tableRow,3)},staticClasses:["s1-table-cell-center"]},resultFirstQuarter:{id:"quarter-result-1",slug:"quarter-result",type:"textPromise",titleClass:"s1-first-quarter",content:function(args){return SportData.getMatchResult(args.tableRow,1)},staticClasses:["s1-table-cell-center"]},resultSecondQuarter:{id:"quarter-result-2",slug:"quarter-result",type:"textPromise",titleClass:"s1-second-quarter",content:function(args){return SportData.getMatchResult(args.tableRow,2)},staticClasses:["s1-table-cell-center"]},resultThirdQuarter:{id:"quarter-result-3",slug:"quarter-result",type:"textPromise",titleClass:"s1-third-quarter",content:function(args){return SportData.getMatchResult(args.tableRow,3)},staticClasses:["s1-table-cell-center"]},resultFourthQuarter:{id:"quarter-result-4",slug:"quarter-result",type:"textPromise",titleClass:"s1-fourth-quarter",content:function(args){return SportData.getMatchResult(args.tableRow,4)},staticClasses:["s1-table-cell-center"]},resultOvertime:{id:"overtime-result",slug:"overtime-result",type:"textPromise",title:function(){return"OT"},content:function(args){return SportData.getMatchResult(args.tableRow,21,"-")},staticClasses:["s1-table-cell-center","s1-table-cell-border-right"]},incident:{id:"incident",slug:"incident",type:"text",content:function(args){var ref;return((ref=args.tableRow._result.incident)!=null?ref.short:void 0)||""},staticClasses:["s1-table-cell-bold"]},links:{id:"links",slug:"links",title:function(){return""},type:"text",content:function(args){if(hasTickerData(args.tableRow.live_status)&&!Sport1Tools.isMobileSite()){if(args.competition._sport===SportData.SPORT.SOCCER){return">"}else{return">"}}else{return""}},class:function(args){if(hasTickerData(args.tableRow.live_status)){return"s1-has-details"}else{return""}},staticClasses:["s1-table-cell-center","dropdown-icon"]},linksLarge:{id:"links",slug:"links",title:function(){return""},type:"text",content:function(args){if(hasTickerData(args.tableRow.live_status)&&!Sport1Tools.isMobileSite()){return"Details >"}else{return""}},class:function(args){if(hasTickerData(args.tableRow.live_status)){return"s1-has-details"}else{return""}},staticClasses:["s1-table-cell-center"]},betIcon:{id:"bet",slug:"bet",title:function(){return""},type:"html",content:function(args){var ref,ref1;if(ref=+args.competition.id,indexOf.call(SportData.VALID_BWIN_COMPETITIONS,ref)>=0){return'<span\n  class="s1-bwin"\n  bwin-bet\n  bwin-match="tableRow"\n  bwin-competition-id="'+args.competition.id+'">\n</span>'}else if(ref1=+args.competition.id,indexOf.call(SportData.VALID_TIPICO_COMPETITIONS,ref1)>=0){return'<span\n  class="s1-tipico"\n  tipico-bet\n  tipico-match="tableRow"\n  tipico-competition-id="'+args.competition.id+'">\n</span>'}else{return""}},staticClasses:["s1-table-cell-center"]},fmIcon:{id:"fm",slug:"fm",type:"html",compile:true,content:function(args){var link;link=SportData.getFmLinkForMatch(args.tableRow);if(link!=null){return'<a ng-href="'+link+'"\n  target="_blank"\n  style="display: block; width: 100%; height: 100%;">\n  <div class="s1-icon-audio"></div>\n</a>'}else{return""}},staticClasses:["s1-table-cell-center","s1-table-cell-border-right"]}}};this.definitions={generic:{generic:{standings:{default:{columns:!Sport1Tools.isMobileSite()?[this.columns.standings.position,this.columns.standings.trend,this.columns.standings.teamLogo,this.columns.standings.team,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference,this.columns.standings.goalratio,this.columns.standings.win,this.columns.standings.draw,this.columns.standings.lost]:[this.columns.standings.position,this.columns.standings.trend,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference]},widget:{columns:[this.columns.standings.position,this.columns.standings.trend,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference]}},gameplan:{default:{groupByDate:true,columns:!Sport1Tools.isMobileSite()?[this.columns.gameplan.teams,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeam,this.columns.gameplan.vs,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeam,this.columns.gameplan.result,this.columns.gameplan.links]:[this.columns.gameplan.homeTeamShort,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.result,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeamShort,this.columns.gameplan.links]},widget:{columns:[this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeamMicro,this.columns.gameplan.vs,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeamMicro,this.columns.gameplan.result]},playoffs:{groupByDate:true,columns:!Sport1Tools.isMobileSite()?[this.columns.gameplan.teams,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeam,this.columns.gameplan.vs,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeam,this.columns.gameplan.resultBordered,this.columns.gameplan.links]:[this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeamShort,this.columns.gameplan.result,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeamShort,this.columns.gameplan.links]},livetoday:function(_this){return function(){if(Sport1Tools.isMobileSite()){return{groupByDate:true,columns:[_this.columns.gameplan.homeTeamShort,_this.columns.gameplan.links,_this.columns.gameplan.result,_this.columns.gameplan.resultHome,_this.columns.gameplan.awayTeamShort,_this.columns.gameplan.resultAway]}}}}(this)()}},division:{standings:{default:{columns:!Sport1Tools.isMobileSite()?[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.team,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference,this.columns.standings.goalratio,this.columns.standings.win,this.columns.standings.draw,this.columns.standings.lost]:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference]},widget:{columns:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference]}}}},fussball:{generic:{standings:{default:function(_this){return function(){if(Sport1Tools.isMobileSite()){return{columns:[_this.columns.standings.position,_this.columns.standings.trend,_this.columns.standings.teamLogo,_this.columns.standings.teamShort,_this.columns.standings.games,_this.columns.standings.points,_this.columns.standings.difference]}}}}(this)(),widget:{columns:[this.columns.standings.position,this.columns.standings.trend,this.columns.standings.teamLogo,this.columns.standings.teamShort,this.columns.standings.games,this.columns.standings.points,this.columns.standings.difference]}},gameplan:{default:function(_this){return function(){if(!Sport1Tools.isMobileSite()){return{groupByDate:true,columns:[_this.columns.gameplan.teams,_this.columns.gameplan.homeTeamLogo,_this.columns.gameplan.homeTeam,_this.columns.gameplan.vs,_this.columns.gameplan.awayTeamLogo,_this.columns.gameplan.awayTeam,_this.columns.gameplan.result,_this.columns.gameplan.resultHalftime,_this.columns.gameplan.betIcon,_this.columns.gameplan.fmIcon,_this.columns.gameplan.links]}}}}(this)(),widget:{columns:[this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeamShort,this.columns.gameplan.vs,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeamShort,this.columns.gameplan.result,!Sport1Tools.isMobileSite()?this.columns.gameplan.betIcon:void 0]}}}},handball:function(_this){return function(){if(!Sport1Tools.isMobileSite()){return{generic:{gameplan:{default:{groupByDate:true,columns:[_this.columns.gameplan.teams,_this.columns.gameplan.homeTeamLogo,_this.columns.gameplan.homeTeam,_this.columns.gameplan.vs,_this.columns.gameplan.awayTeamLogo,_this.columns.gameplan.awayTeam,_this.columns.gameplan.result,_this.columns.gameplan.resultHalftime,_this.columns.gameplan.links]}}}}}}}(this)(),eishockey:function(_this){return function(){if(!Sport1Tools.isMobileSite()){return{generic:{standings:{default:{columns:[_this.columns.standings.position,_this.columns.standings.trend,_this.columns.standings.teamLogo,_this.columns.standings.team,_this.columns.standings.games,_this.columns.standings.points,_this.columns.standings.difference,_this.columns.standings.goalratio,_this.columns.standings.win,_this.columns.standings.otw,_this.columns.standings.psw,_this.columns.standings.otl,_this.columns.standings.psl,_this.columns.standings.lost]}},gameplan:{default:{groupByDate:true,columns:[_this.columns.gameplan.teams,_this.columns.gameplan.homeTeamLogo,_this.columns.gameplan.homeTeam,_this.columns.gameplan.vs,_this.columns.gameplan.awayTeamLogo,_this.columns.gameplan.awayTeam,_this.columns.gameplan.result,_this.columns.gameplan.resultFirstThird,_this.columns.gameplan.resultSecondThird,_this.columns.gameplan.resultThirdThird,_this.columns.gameplan.resultOvertime,_this.columns.gameplan.links]},playoffs:{groupByDate:true,columns:[_this.columns.gameplan.teams,_this.columns.gameplan.homeTeamLogo,_this.columns.gameplan.homeTeam,_this.columns.gameplan.vs,_this.columns.gameplan.awayTeamLogo,_this.columns.gameplan.awayTeam,_this.columns.gameplan.result,_this.columns.gameplan.resultFirstThird,_this.columns.gameplan.resultSecondThird,_this.columns.gameplan.resultThirdThird,_this.columns.gameplan.resultOvertime,_this.columns.gameplan.links]}}},division:{standings:{default:{columns:[_this.columns.standings.position,_this.columns.standings.teamLogo,_this.columns.standings.team,_this.columns.standings.games,_this.columns.standings.points,_this.columns.standings.difference,_this.columns.standings.goalratio,_this.columns.standings.win,_this.columns.standings.otw,_this.columns.standings.psw,_this.columns.standings.otl,_this.columns.standings.psl,_this.columns.standings.lost]}}}}}}}(this)(),basketball:{generic:{standings:function(_this){return function(){if(!Sport1Tools.isMobileSite()){return{default:{columns:[_this.columns.standings.position,_this.columns.standings.trend,_this.columns.standings.teamLogo,_this.columns.standings.team,_this.columns.standings.games,_this.columns.standings.points,_this.columns.standings.difference,_this.columns.standings.goalratio,_this.columns.standings.win,_this.columns.standings.lost]}}}}}(this)(),gameplan:{default:{groupByDate:true,columns:!Sport1Tools.isMobileSite()?[this.columns.gameplan.teams,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeam,this.columns.gameplan.vs,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeam,this.columns.gameplan.result,this.columns.gameplan.resultFirstQuarter,this.columns.gameplan.resultSecondQuarter,this.columns.gameplan.resultThirdQuarter,this.columns.gameplan.resultFourthQuarter,this.columns.gameplan.resultOvertime,this.columns.gameplan.links]:[this.columns.gameplan.homeTeamMicro,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.result,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeamMicro]},playoffs:{groupByDate:true,columns:!Sport1Tools.isMobileSite()?[this.columns.gameplan.teams,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.homeTeam,this.columns.gameplan.vs,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeam,this.columns.gameplan.result,this.columns.gameplan.resultFirstQuarter,this.columns.gameplan.resultSecondQuarter,this.columns.gameplan.resultThirdQuarter,this.columns.gameplan.resultFourthQuarter,this.columns.gameplan.resultOvertime,this.columns.gameplan.links]:[this.columns.gameplan.homeTeamMicro,this.columns.gameplan.homeTeamLogo,this.columns.gameplan.result,this.columns.gameplan.awayTeamLogo,this.columns.gameplan.awayTeamMicro]}}},division:{standings:{default:{columns:!Sport1Tools.isMobileSite()?[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.team,this.columns.standings.games,this.columns.standings.winPercentage,this.columns.standings.difference,this.columns.standings.goalratio,this.columns.standings.win,this.columns.standings.lost]:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.winPercentage,this.columns.standings.win,this.columns.standings.lost]},widget:{columns:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.win,this.columns.standings.lost,this.columns.standings.winPercentage]}}}},american_football:{generic:{standings:{default:{columns:!Sport1Tools.isMobileSite()?[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.team,this.columns.standings.games,this.columns.standings.winPercentage,this.columns.standings.difference,this.columns.standings.goalratio,this.columns.standings.win,this.columns.standings.lost]:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.winPercentage,this.columns.standings.win,this.columns.standings.lost]},widget:{columns:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.win,this.columns.standings.lost,this.columns.standings.winPercentage]}},gameplan:function(_this){return function(){if(!Sport1Tools.isMobileSite()){return{default:{groupByDate:true,columns:[_this.columns.gameplan.teams,_this.columns.gameplan.homeTeamLogo,_this.columns.gameplan.homeTeam,_this.columns.gameplan.vs,_this.columns.gameplan.awayTeamLogo,_this.columns.gameplan.awayTeam,_this.columns.gameplan.result,_this.columns.gameplan.resultFirstQuarter,_this.columns.gameplan.resultSecondQuarter,_this.columns.gameplan.resultThirdQuarter,_this.columns.gameplan.resultFourthQuarter,_this.columns.gameplan.resultOvertime]}}}}}(this)()}},baseball:{generic:{standings:{default:{columns:!Sport1Tools.isMobileSite()?[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.team,this.columns.standings.games,this.columns.standings.win,this.columns.standings.lost,this.columns.standings.gamesBehind,this.columns.standings.winPercentage]:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.win,this.columns.standings.lost,this.columns.standings.winPercentage]},widget:{columns:[this.columns.standings.position,this.columns.standings.teamLogo,this.columns.standings.teamMicro,this.columns.standings.win,this.columns.standings.lost,this.columns.standings.winPercentage]}}}}};hasTickerData=function(liveStatus){return liveStatus===SportData.DETAILS_CONTENT.FULL||liveStatus===SportData.DETAILS_CONTENT.DATA};this.svc={getDefinition:function(_this){return function(args){var definition,ref,ref1,ref10,ref11,ref2,ref3,ref4,ref5,ref6,ref7,ref8,ref9;if(typeof definition==="undefined"||definition===null){definition=(ref=_this.definitions[args.competition.sport])!=null?(ref1=ref[args.competition.type])!=null?(ref2=ref1[args.content])!=null?ref2[args.layout]:void 0:void 0:void 0}if(definition==null){definition=(ref3=_this.definitions[args.competition.sport])!=null?(ref4=ref3.generic)!=null?(ref5=ref4[args.content])!=null?ref5[args.layout]:void 0:void 0:void 0}if(definition==null){definition=(ref6=_this.definitions.generic)!=null?(ref7=ref6[args.competition.type])!=null?(ref8=ref7[args.content])!=null?ref8[args.layout]:void 0:void 0:void 0}if(definition==null){definition=(ref9=_this.definitions.generic)!=null?(ref10=ref9.generic)!=null?(ref11=ref10[args.content])!=null?ref11[args.layout]:void 0:void 0:void 0}return definition}}(this)};return this.svc};Service.$inject=["$filter","sportDataService"];return angular.module("sport1.services").factory("tableDefinitionService",Service)})();appServices.factory("tickerAdService",[function(){"use strict";var firstLoad=true,lastPostId,map={"game-start":"start",goal:"goal",pso:"penalty",red:"red","substitute-out":"substitution",yellow:"yellow","yellow-red":"yellow"};function getEvent(post){if(!post.event){return}return map[post.event.action]||map[post.event.kind]}function update(posts,considered){posts=posts.slice(posts.length-considered).reverse().filter(getEvent);var post=posts[0];if(post){window.triggerTickerAds({first_load:firstLoad,condition:getEvent(post),post_banner_container_id:"s1-som-post-"+post.id,is_new_message:lastPostId!==post.id});lastPostId=post.id}else{window.triggerTickerAds({first_load:firstLoad})}firstLoad=false}return{update:function(posts,considered){jQuery(function(){update(posts,considered)})}}}]);appServices.factory("tickerService",["$filter","graphicService","sportDataService","SportTranslationService",function($filter,graphicService,SportData,SportTranslation){"use strict";var svc={home:{},away:{},tickerData:{}};svc.setHomeTeam=function(team){svc.home=team};svc.setAwayTeam=function(team){svc.away=team};svc.setTickerData=function(data){svc.tickerData=data};svc.updatePosts=function(posts,updates){var filtered=posts.concat([]);var keepGoing=true;angular.forEach(updates,function(updatedPost){keepGoing=true;angular.forEach(filtered,function(oldPost,index){if(!keepGoing){return}if(oldPost.postId===updatedPost.postId){if(!updatedPost.display){filtered.splice(index,1)}else{angular.extend(filtered[index],updatedPost)}keepGoing=false}})});return filtered};svc.getEventIcon=function(event,index,competition){var eventIcon="";switch(event.action){case"match":{switch(event.kind){case"game-start":case"game-end":case"first-half-end":case"second-half-start":case"second-half-end":case"first-extra-start":case"first-extra-end":case"second-extra-start":case"second-extra-end":case"first-third-end":case"second-third-start":case"second-third-end":case"third-third-start":case"third-third-end":case"overtime-start":case"overtime-end":case"first-set-end":case"second-set-start":case"second-set-end":case"third-set-start":case"third-set-end":case"fourth-set-start":case"fourth-set-end":case"fifth-set-start":case"fifth-set-end":case"golden-set-start":case"penalty-start":eventIcon="whistle";break}break}case"card":{switch(event.kind){case"yellow":eventIcon="card-yellow";break;case"yellow-red":eventIcon="card-yellowred";break;case"red":eventIcon="card-red";break;case"sent-off":eventIcon="card-red";break}break}case"goal":{switch(Number(competition.sport.id)){case SportData.SPORT_ID.SOCCER:eventIcon="goal";break;case SportData.SPORT_ID.HANDBALL:eventIcon="goal-handball";break;case SportData.SPORT_ID.ICEHOCKEY:eventIcon="goal-icehockey";break;case SportData.SPORT_ID.HOCKEY:eventIcon="goal-hockey";break;default:eventIcon=""}break}case"playing":{switch(event.kind){case"substitute-in":eventIcon="substitute";break;case"substitute-out":eventIcon="substitute";break}break}case"special":{switch(event.kind){case"missed-penalty":eventIcon="";break;case"sent to-tribune":eventIcon="";break}break}case"pso":switch(event.kind){case"goal":switch(Number(competition.sport.id)){case SportData.SPORT_ID.SOCCER:eventIcon="goal";break;case SportData.SPORT_ID.HANDBALL:eventIcon="goal-handball";break;case SportData.SPORT_ID.ICEHOCKEY:eventIcon="goal-icehockey";break;case SportData.SPORT_ID.HOCKEY:eventIcon="goal-hockey";break}break;case"miss":eventIcon="";break}break;default:eventIcon=""}if(eventIcon.length){return graphicService.getEventIcon(eventIcon)}return false};svc.getEventHeaderMain=function(event,index,competition){var content="";switch(event.action){case"goal":switch(Number(competition.sport.id)){case SportData.SPORT_ID.SOCCER:content="TOR!";break}break}return content};svc.getEventHeaderSub=function(event,index,competition){var sportSlug=SportData.getSportSlug(competition.sport.name);return SportTranslation.translate(sportSlug,"event__"+event.action+"__"+event.kind)};svc.getEventHeaderSubAdd=function(event,index){var content="";switch(event.action){case"card":if(event.person){content="für "+event.person.name}break;case"goal":case"pso":content="Tor für ";switch(event.kind){case"own-goal":var home,away;if(typeof svc.home.name==="undefined"){home=svc.tickerData[index+1].home;away=svc.tickerData[index+1].away}else{home=svc.home;away=svc.away}content+=event.team.id===home.id?away.name:home.name;break;case"miss":content="";break;default:content+=event.team.name}break;case"playing":switch(event.kind){case"substitute-out":case"substitute-in":content="bei "+event.team.name;break}break}return content};svc.getPlayerImages=function(event,index){var players={main:undefined,second:undefined};if(event.person){players.main=graphicService.getPersonImgUrl(event.person.id,"s");
}if(event.action==="playing"&&event.kind==="substitute-out"){if(svc.tickerData[index+1]&&svc.tickerData[index+1].event&&svc.tickerData[index+1].event.person){players.second=graphicService.getPersonImgUrl(svc.tickerData[index+1].event.person.id,"s")}}return players};svc.getEventContent=function(event){var content="";switch(event.action){case"card":content=event.team.name;break;case"goal":case"pso":content=event.content;if(event.person){content+=" durch "+event.person.name+" ("+event.team.name+")"}if(event.kind==="own-goal"){content+=" (ET)"}if(event.additional_person){content+=event.additional_person?" nach Vorlage von "+event.additional_person.name:""}break;case"playing":switch(event.kind){case"substitute-out":content=event.person.name+" wird ausgewechselt";break;case"substitute-in":content=event.person.name+" wird eingewechselt";break}break;case"special":switch(event.kind){case"missed-penalty":if(event.person){content="von "+event.person.name}break}break}return content};svc.getReplacedContent=function(ticker){return ticker};return svc}]);appServices.factory("urlResolverService",[function(){"use strict";return{getUrlToVideoPage:function(videoId){return"videos/"+videoId}}}]);appServices.factory("videoObservableService",["$rootScope",function($rootScope){"use strict";var VIDEO_START="s1_lifecycle_start";var VIDEO_AD_PLAY="s1_ad_play";var VIDEO_PLAY="s1_content_play";var VIDEO_PAUSE="s1_content_pause";var VIDEO_COMPLETE="s1_lifecycle_complete";var eventList=[VIDEO_START,VIDEO_PLAY,VIDEO_AD_PLAY,VIDEO_PAUSE,VIDEO_COMPLETE];var _updateHandlers=[];var _observable=null;function notifyObservers(event){if(eventList.indexOf(event.type)!==-1){_updateHandlers.forEach(function(handler){handler(event.type)})}}function startEventListening(){eventList.forEach(function(eventType){_observable.addEventListener(eventType,notifyObservers)})}function stopEventListening(){eventList.forEach(function(eventType){_observable.removeEventListener(eventType,notifyObservers)})}function setObservable(observable){if(observable){_observable=observable;startEventListening()}}function registerUpdateHandler(handler){if(typeof handler==="function"&&_updateHandlers.indexOf(handler)===-1){_updateHandlers.push(handler)}}$rootScope.$on("$destroy",function(){stopEventListening()});return{setObservable:setObservable,registerUpdateHandler:registerUpdateHandler,VIDEO_START:VIDEO_START,VIDEO_PLAY:VIDEO_PLAY,VIDEO_PAUSE:VIDEO_PAUSE,VIDEO_COMPLETE:VIDEO_COMPLETE}}]);appServices.value("videoServiceURLs",{video:"/video/:id",playlist:"/playlist/:id",playlist_max_count:"/playlist/:id/subset/:count/of/:max/:mode",playlist_max:"/playlist/:id/size/:max",playlist_offset:"/playlist/:id/offset/:offset/count/:max"});appServices.provider("videoService",function videoServiceProvider(){"use strict";var host="";this.$get=["$resource","videoServiceURLs","$q",function($resource,videoServiceURLs,$q){function getURL(urlKey){return host+videoServiceURLs[urlKey]}return{setBaseUrl:function(baseUrl){host=baseUrl},getOutbrainRecommendation:function(requestData){var deferred=$q.defer();if(window.hasOwnProperty("OBR")){window.OBR.extern.callRecs(requestData,function(data){data.videos=data.doc.map(function(item){return{url:item.url,isOutbrain:true,headline:item.author,title:item.content,image:item.thumbnail}});deferred.resolve(data)})}else{deferred.reject("OBR is not defined")}return deferred.promise},getVideo:function(videoId){return $resource(getURL("video"),{id:videoId},{get:{method:"GET",cache:true}}).get().$promise},getPlaylist:function(playlistId){return $resource(getURL("playlist"),{id:playlistId},{get:{method:"GET",cache:true}}).get().$promise},getPaginatedPlaylist:function(playlistId,page,count){if(!angular.isDefined(playlistId)){throw new Error("The playlistId parameter is mandatory to get a playlist")}if(!angular.isDefined(count)){count=10}if(!page){page=0}return $resource(getURL("playlist_offset"),{id:playlistId,offset:page*count,max:count},{get:{method:"GET",cache:false}}).get().$promise}}}]});appServices.service("fmplayerEPGService",["$q","epgDataService",function($q,epgDataService){"use strict";var epg=null;var baseUrl=location.hostname==="api.sport1.de"?"/api/news/api":"/api";epgDataService.setBaseUrl(baseUrl);var removeHighlights=function(){if(epg){epg=epg.filter(function(element){return element.typ!=="SH"})}};var removeDoubles=function(){var currentElement=null;var lastElement=null;if(epg&&epg.length>1){var i=0;var n=epg.length;for(;i<n;i++){currentElement=epg[i];if(lastElement&&currentElement.titel===lastElement.titel){epg.splice(i,1);removeDoubles();break}else{lastElement=currentElement}}}};var setGTMLabels=function(){if(epg&&epg instanceof Array){var current=null;var n=epg.length;for(var i=0;i<n;i++){current=epg[i];current.gtmLabel=current.startzeit+" - "+current.titel}}};var setEndTimes=function(){if(epg&&epg instanceof Array){var n=epg.length;var epgElement,nextEpgElement=null;for(var i=0;i<n;i++){epgElement=epg[i];epgElement.startzeit=Sport1Tools.getDateTime(epgElement.startzeit,"T");if(i+1<n){nextEpgElement=epg[i+1];epgElement.endzeit=Sport1Tools.getDateTime(nextEpgElement.startzeit,"T")}else{epgElement.endzeit=new Date(epgElement.startzeit);epgElement.endzeit.setHours(0);epgElement.endzeit.setMinutes(0);epgElement.endzeit.setDate(epgElement.endzeit.getDate()+1)}}}};this.getEpg=function(date){var deferred=$q.defer();var promise=epgDataService.getFM(date);promise.then(function(data){epg=data.content;removeHighlights();removeDoubles();setGTMLabels();setEndTimes();deferred.resolve(epg)},function(){deferred.reject("Could not load EPG")});return deferred.promise}}]);appServices.service("fmplayerLiveMatchesService",["$q","sportDataService","relevantFMMatchesFilter",function($q,sportDataService,relevantFMMatchesFilter){"use strict";var fmMatchesData=[],updateDateString;this.getFmMatches=function(date){var deferred=$q.defer(),soccerMatchesPromise,dtmMatchesPromise;updateDateString=Sport1Tools.dateToDateString(date);soccerMatchesPromise=sportDataService.getMatchesByDateWithSport(updateDateString,"1");dtmMatchesPromise=sportDataService.getMatchesByDateWithSport(updateDateString,"42");$q.all({soccer:soccerMatchesPromise,dtm:dtmMatchesPromise}).then(function(data){fmMatchesData=[];fmMatchesData=fmMatchesData.concat(relevantFMMatchesFilter(data.soccer));fmMatchesData=fmMatchesData.concat(relevantFMMatchesFilter(data.dtm));deferred.resolve(fmMatchesData)},function(){console.error("unable to retrieve FmMatches")});return deferred.promise};var updateFMMatchData=function(fmMatchData,rawMatchData){var deferred=$q.defer();sportDataService.getMatchStatus(rawMatchData).then(function(){if(fmMatchData.isPromiMatch){rawMatchData=angular.copy(rawMatchData);rawMatchData.home.microname=fmMatchData.match.home.microname;rawMatchData.away.microname=fmMatchData.match.away.microname}fmMatchData.match=rawMatchData;deferred.resolve()});return deferred.promise};this.updateLiveFmMatchesByCompetitionAndSport=function(date,coId,sportId,liveMatches){var deferred=$q.defer();var dateString=Sport1Tools.dateToDateString(date);var promise=sportDataService.getMatchesByDateForCompetition(dateString,coId);var updatedFMMatchData=null;var requestCounter=1;promise.then(function(data){requestCounter--;fmMatchesData=relevantFMMatchesFilter(data);angular.forEach(liveMatches,function(liveMatch){updatedFMMatchData=fmMatchesData.filter(function(fmMatchData){return fmMatchData.match.id===liveMatch.match.id});if(updatedFMMatchData.length){updatedFMMatchData=updatedFMMatchData[0];if(updatedFMMatchData.match){requestCounter++;updateFMMatchData(liveMatch,updatedFMMatchData.match).then(function(){requestCounter--;if(requestCounter===0){deferred.resolve()}})}}});if(requestCounter===0){deferred.resolve()}});return deferred.promise}}]);appServices.factory("fmscheduleElementFactory",["fmMatchDataFactory","siTitleToCoIdService","graphicService",function(fmMatchDataFactory,siTitleToCoIdService,graphicService){"use strict";var SINGLE_STREAM="sport1.fm-single-url.mp3",PROMI_STREAM="fm-single-special-url.mp3",AUDI_STREAM="sport1.fm-single-url-audi.mp3",BMW_STREAM="sport1.fm-single-url-bmw.mp3",MERCEDES_STREAM="sport1.fm-single-url-mercedes.mp3";var FM_LIVE_STREAM_URL="http://stream.sport1.fm/api/livestream-redirect/SPORT1FM_24_7.mp3";var streamSortPriority={};streamSortPriority[PROMI_STREAM]=5;streamSortPriority[SINGLE_STREAM]=4;streamSortPriority[AUDI_STREAM]=3;streamSortPriority[BMW_STREAM]=2;streamSortPriority[MERCEDES_STREAM]=1;function ScheduleElement(){this.id=undefined;this.type=undefined;this.title=undefined;this.start=undefined;this.end=undefined;this.coId=undefined;this.sportId=undefined;this.roundId=undefined;this.venueId=undefined;this.streamUrl="streamUrl";this.scheduleStatus=undefined;this.hasTeaser=false;this.image=undefined;this.label=undefined;this.gtmLabel=undefined}ScheduleElement.prototype.IS_LIVE="isLive";ScheduleElement.prototype.IS_IN_FUTURE="isInFuture";ScheduleElement.prototype.IS_IN_PAST="isInPast";ScheduleElement.prototype.updateScheduleStatus=function(now){var result;if(now<this.start){result=this.IS_IN_FUTURE}else if(now>=this.end){result=this.IS_IN_PAST}else if(now>=this.start&&now<this.end){result=this.IS_LIVE}this.scheduleStatus=result};ScheduleElement.prototype.getScheduleStatus=function(){return this.scheduleStatus};ScheduleElement.prototype.getStartTimeString=function(){var hourString=this.start.getHours().toString();var minuteString=this.start.getMinutes().toString();hourString=hourString.length>1?hourString:"0"+hourString;minuteString=minuteString.length>1?minuteString:"0"+minuteString;return hourString+":"+minuteString+" Uhr"};function MatchScheduleElement(rawData){ScheduleElement.call(this,rawData);this.match=rawData.match;this.id=this.match.id+rawData.streamUrl;this.type="match";this.start=this.match._isoDate;this.streamStart=rawData.streamStart;this.coId=rawData.coId;this.sportId=rawData.sportId;this.roundId=rawData.roundId;this.venueId=rawData.venueId;this.coName=rawData.name;this.matchday=rawData.matchday;this.streamUrl=rawData.streamUrl;this.sortPrio=streamSortPriority[rawData.streamIdentifier];this.isSingleMatch=rawData.isSingleMatch;this.isPromiMatch=rawData.isPromentatorMatch;this.label=rawData.label;this.gtmLabel=rawData.gtmLabel;if(this.isPromiMatch){this.start=new Date(this.start.valueOf()-30*60*1e3)}}MatchScheduleElement.prototype=Object.create(ScheduleElement.prototype,{updateScheduleStatus:{value:function(now){var result;if(this.match.finished==="yes"){result=this.IS_IN_PAST}else if(this.match._isLive===true||this.streamStart<=now){result=this.IS_LIVE;if(result!==this.scheduleStatus){}}else{result=this.IS_IN_FUTURE}this.scheduleStatus=result},enumerable:true,configurable:true,writable:true}});function EPGScheduleElement(rawData){ScheduleElement.call(this,rawData);this.id="EPG_"+rawData.id;this.type="epg";this.epgType=rawData.typ;this.title=rawData.titel;this.subtitle=rawData.reporter;this.start=rawData.startzeit;this.end=rawData.endzeit;this.image=rawData.image;this.streamUrl=FM_LIVE_STREAM_URL;this.gtmLabel=rawData.gtmLabel;if(this.epgType==="SI"){this.coId=siTitleToCoIdService.getCompetitionIdFromSiTitle(this.title)}}EPGScheduleElement.prototype=Object.create(ScheduleElement.prototype,{});function HeadlineScheduleElement(rawData){ScheduleElement.call(this,rawData);var self=this;var setHeadlineTitle=function(){if(self.baseElement instanceof ScheduleElement){if(self.baseElement.type==="epg"){if(self.baseElement.epgType==="SW"){self.title="Spielwiederholung"}else{self.title=self.baseElement.title}}else if(self.baseElement.type==="match"){self.title=self.baseElement.coName;self.matchday=self.baseElement.matchday}}};this.type=rawData.type;this.baseElement=rawData.baseElement;this.id="h_"+this.baseElement.id;this.logo="";if(rawData.baseElement.coId){this.logo=graphicService.getCompetitionIconUrl(rawData.baseElement.coId,50,rawData.baseElement.sportId,"male")}setHeadlineTitle()}HeadlineScheduleElement.prototype=Object.create(ScheduleElement.prototype,{});var createScheduleElement=function(rawData){if(fmMatchDataFactory.isFMMatchData(rawData)){return new MatchScheduleElement(rawData)}else if(rawData.type==="headline"){return new HeadlineScheduleElement(rawData)}else{return new EPGScheduleElement(rawData)}};return{createScheduleElement:createScheduleElement}}]);appServices.service("scheduleService",["$q","sportDataService","fmplayerEPGService","fmplayerLiveMatchesService","fmscheduleElementFactory",function($q,sportDataService,fmplayerEPGService,fmplayerLiveMatchesService,fmscheduleElementFactory){"use strict";var rawEPG,rawFMMatchData=null;var scheduleElements=[];var date;var competitionMap={};var createScheduleElements=function(){var deferred=$q.defer();var scheduleElement=null;angular.forEach(rawEPG,function(value){scheduleElement=fmscheduleElementFactory.createScheduleElement(value);scheduleElements.push(scheduleElement)});competitionMap={};if(rawFMMatchData&&rawFMMatchData.length){var matchCounter=0;angular.forEach(rawFMMatchData,function(value){matchCounter++;if(value&&value.coId&&!competitionMap.hasOwnProperty(value.coId)){competitionMap[value.coId]=angular.copy(value)}sportDataService.getMatchStatus(value.match).then(function(){scheduleElement=fmscheduleElementFactory.createScheduleElement(value);scheduleElements.push(scheduleElement);if(--matchCounter===0){deferred.resolve()}})})}else{deferred.resolve()}return deferred.promise};var updateScheduleElementsStatus=function(date){var now=date||(new Date).getTime();angular.forEach(scheduleElements,function(value){value.updateScheduleStatus(now)})};var sortSchedule=function(){function compareScheduleElements(a,b){var result=0;if(a.start<b.start){result=-1}else if(a.start>b.start){result=1}else if(a.type==="epg"&&b.type==="match"){result=-1}else if(a.type==="match"&&b.type==="epg"){result=1}else if(a.type==="match"&&b.type==="match"&&a.match.hasOwnProperty("home")&&b.match.hasOwnProperty("home")&&a.match.home.microname<b.match.home.microname){result=-1}else if(a.type==="match"&&b.type==="match"&&a.match.hasOwnProperty("home")&&b.match.hasOwnProperty("home")&&a.match.home.microname>b.match.home.microname){result=1}else if(a.type==="match"&&b.type==="match"&&a.sortPrio&&b.sortPrio){if(a.sortPrio>b.sortPrio){result=-1}else if(a.sortPrio<b.sortPrio){result=1}}return result}if(scheduleElements.length){scheduleElements.sort(compareScheduleElements)}};var addScheduleHeadlines=function(){function getMatchScheduleElementsByCoId(coId){var filterResult=scheduleElements.filter(function(element){return element.type==="match"&&element.coId===coId});return filterResult[0]}var elements=scheduleElements;var n=elements.length;var current,lastScheduleElement,headlineData,baseElement,headlineElement,matchElementWithCoId=null;for(var i=0;i<n;i++){current=elements[i];if(!lastScheduleElement||(current.type!==lastScheduleElement.type||current.epgType==="SI"&&lastScheduleElement.epgType==="SI"&&current.coId&&current.coId!==lastScheduleElement.coId||current.epgType!==lastScheduleElement.epgType)&&!(current.type==="match"&&lastScheduleElement.epgType==="SI")||current.type==="match"&&lastScheduleElement.type==="epg"&&current.coId!==lastScheduleElement.coId){baseElement=current;if(current.coId){matchElementWithCoId=getMatchScheduleElementsByCoId(current.coId);if(matchElementWithCoId){baseElement=matchElementWithCoId}}headlineData={type:"headline",baseElement:baseElement};headlineElement=fmscheduleElementFactory.createScheduleElement(headlineData);elements.splice(i,0,headlineElement);lastScheduleElement=current;i++;n++}}};var update=function(){function getLiveCompetitions(){var result=[],liveCompetitions=[],coId,sportId,n;var coidFilterResult=scheduleElements.filter(function(element){return element.type==="match"&&element.scheduleStatus===element.IS_LIVE&&element.coId!==undefined});n=coidFilterResult.length;for(var i=0;i<n;i++){coId=coidFilterResult[i].coId;sportId=coidFilterResult[i].sportId;if(liveCompetitions.indexOf(coId)===-1){result.push({coId:coId,sportId:sportId});liveCompetitions.push(coId)}}return result}function getLiveMatchesByCompetition(coId){var result=[];scheduleElements.filter(function(element){var check=element.type==="match"&&element.scheduleStatus===element.IS_LIVE&&element.coId===coId;if(check){result.push(element)}return check});return result}function updateLiveCompetitions(date,liveCompetitions){var deferred=$q.defer();var liveMatches=null;var requestCounter=0;if(liveCompetitions.length){angular.forEach(liveCompetitions,function(coData){var coId=coData.coId,sportId=coData.sportId;requestCounter++;liveMatches=getLiveMatchesByCompetition(coId);fmplayerLiveMatchesService.updateLiveFmMatchesByCompetitionAndSport(date,coId,sportId,liveMatches).then(function(){requestCounter--;if(requestCounter===0){deferred.resolve()}})})}else{deferred.resolve()}return deferred.promise}var deferred=$q.defer();var liveCompetitions=getLiveCompetitions();sportDataService.getSystemDate().then(function(systemdate){updateLiveCompetitions(systemdate,liveCompetitions).then(function(){updateScheduleElementsStatus(systemdate);deferred.resolve()})});return deferred.promise};this.getSchedule=function(){var deferred=$q.defer();scheduleElements=[];sportDataService.getSystemDate().then(function(systemDate){var promises={};date=systemDate;promises.epg=fmplayerEPGService.getEpg(date);promises.liveMatches=fmplayerLiveMatchesService.getFmMatches(date);$q.all(promises).then(function(data){rawEPG=data.epg;rawFMMatchData=data.liveMatches;createScheduleElements().then(function(){sortSchedule();addScheduleHeadlines();updateScheduleElementsStatus(date);deferred.resolve(scheduleElements)})},function(){deferred.reject("error on creating scheduleList")})},function(){deferred.reject("error on creating scheduleList")});return deferred.promise};this.update=function(){var deferred=$q.defer();update().then(function(){deferred.resolve(scheduleElements)});return deferred.promise};this.getActiveEpgElement=function(){var activeEpgElementFilterResult=scheduleElements.filter(function(element){return element.type==="epg"&&element.scheduleStatus==="isLive"});return activeEpgElementFilterResult.length>0?activeEpgElementFilterResult[0]:null};this.getLiveSportIds=function(){var result=[];scheduleElements.forEach(function(element){if(element.type==="match"&&element.scheduleStatus==="isLive"&&element.sportId&&result.indexOf(element.sportId)===-1){result.push(element.sportId)}});return result};this.getLiveMatches=function(){var result=[];scheduleElements.forEach(function(element){if(element.type==="match"&&element.scheduleStatus==="isLive"){result.push(element)}});return result};this.getFirstLiveMatchBySportId=function(sportId){var result=null,element=null,i=0,n;if(sportId){n=scheduleElements.length;for(;i<n;i++){element=scheduleElements[i];if(element.type==="match"&&element.scheduleStatus==="isLive"&&element.sportId===sportId){result=element;break}}}return result};this.getCompetionById=function(coId){var result=null;if(coId&&competitionMap.hasOwnProperty(coId)){result=competitionMap[coId]}return result};this.getScheduleElementById=function(id){var filterResult=scheduleElements.filter(function(element){return element.id===id});return filterResult.length?filterResult[0]:null}}]);appServices.factory("baseEventStrategy",[function(){"use strict";var BaseEventStrategy=function(rawData){this._rawData=rawData};BaseEventStrategy.prototype.getSportId=function(){return this._rawData.sportId};BaseEventStrategy.prototype.getVenueId=function(){var venueId="";if(this._rawData.hasOwnProperty("match")&&this._rawData.match.hasOwnProperty("venue")&&this._rawData.match.venue.hasOwnProperty("id")){venueId=this._rawData.match.venue.id}return venueId};BaseEventStrategy.prototype.getMatch=function(){return this._rawData.match};BaseEventStrategy.prototype.getStreamUrl=function(){return this._rawData.streamUrl};BaseEventStrategy.prototype.getIsSingleMatch=function(){return this._rawData.isSingleMatch};BaseEventStrategy.prototype.getIsPromentatorMatch=function(){return this._rawData.isPromentatorMatch};var getClass=function(){return BaseEventStrategy};return{getClass:getClass}}]);appServices.factory("fmMatchDataFactory",["matchEventStrategy",function(matchEventStrategy){"use strict";function FMMatchData(rawData){var strategy;if(rawData){strategy=matchEventStrategy.getInstance(rawData);this.name=strategy.getName();this.coId=strategy.getCoId();this.sportId=strategy.getSportId();this.roundId=strategy.getRoundId();this.venueId=strategy.getVenueId();this.matchday=strategy.getMatchDayTitle();this.match=strategy.getMatch();this.streamStart=strategy.getStreamStart();this.streamUrl=strategy.getStreamUrl();this.streamIdentifier=rawData.streamIdentifier;this.isSingleMatch=strategy.getIsSingleMatch();this.isPromentatorMatch=strategy.getIsPromentatorMatch();this.label=strategy.getLabel();this.gtmLabel=strategy.getGtmLabel()}}var createFMMatchData=function(rawData){return new FMMatchData(rawData)};var isFMMatchData=function(data){return data instanceof FMMatchData};return{createFMMatchData:createFMMatchData,isFMMatchData:isFMMatchData}}]);appServices.factory("matchEventStrategy",["graphicService","baseEventStrategy",function(graphicService,baseEventStrategy){"use strict";var SINGLE_STREAM="sport1.fm-single-url.mp3",AUDI_STREAM="sport1.fm-single-url-audi.mp3",BMW_STREAM="sport1.fm-single-url-bmw.mp3",MERCEDES_STREAM="sport1.fm-single-url-mercedes.mp3";var setTeamLogos=function(match){if(match){var size="20x20";if(window.hasOwnProperty("devicePixelRatio")){var pixelSize=(parseInt(size.split("x")[0])*window.devicePixelRatio).toString();size=pixelSize+"x"+pixelSize}if(match.hasOwnProperty("home")){graphicService.setTeamLogo(match.home,size)}if(match.hasOwnProperty("away")){graphicService.setTeamLogo(match.away,size)}}};var BaseEventStrategy=baseEventStrategy.getClass();var MatchEventStrategy=function(rawData){BaseEventStrategy.call(this,rawData);setTeamLogos(this._rawData.match)};MatchEventStrategy.prototype=Object.create(BaseEventStrategy.prototype);MatchEventStrategy.prototype.getName=function(){var name="";if(this._rawData&&this._rawData.hasOwnProperty("name")){name=this._rawData.name}return name};MatchEventStrategy.prototype.getCoId=function(){var coId="";if(this._rawData&&this._rawData.hasOwnProperty("id")){coId=this._rawData.id}return coId};MatchEventStrategy.prototype.getRoundId=function(){var roundId="";if(this._rawData&&this._rawData.hasOwnProperty("season")&&this._rawData.season instanceof Array&&this._rawData.season.length&&this._rawData.season[0].hasOwnProperty("round")&&this._rawData.season[0].round instanceof Array&&this._rawData.season[0].round.length&&this._rawData.season[0].round[0].hasOwnProperty("id")){roundId=this._rawData.season[0].round[0].id}return roundId};MatchEventStrategy.prototype.getMatchDayTitle=function(){var matchDayTitle="";var matchDay=this._rawData.match.matchday;var roundName=this._rawData.season[0].round[0].name;if(matchDay&&matchDay!=="0"&&!roundName.match(/^\d+\./)){matchDayTitle=matchDay+". "+roundName}else if(!roundName.match("Gruppe")){matchDayTitle=roundName}return matchDayTitle};MatchEventStrategy.prototype.getStreamStart=function(){var streamStart=Sport1Tools.getDate(this._rawData.match.match_date,this._rawData.match.match_time);if(this._rawData.hasOwnProperty("sportId")){if(this._rawData.sportId==="1"){streamStart=new Date(streamStart-=5*60*1e3)}else if(this._rawData.sportId==="42"){if(this._rawData.streamIdentifier===SINGLE_STREAM){streamStart=new Date(streamStart-=30*60*1e3)}else{streamStart=new Date(streamStart-=5*60*1e3)}}}return streamStart};MatchEventStrategy.prototype.getLabel=function(){var label="";if(this._rawData.match.hasOwnProperty("home")&&this._rawData.match.hasOwnProperty("away")){label=this._rawData.match.home.shortname+" gegen "+this._rawData.match.away.shortname}else if(this._rawData.streamIdentifier){var streamIdentifier=this._rawData.streamIdentifier;switch(streamIdentifier){case SINGLE_STREAM:label="Das Rennen live";break;case AUDI_STREAM:label="Audi-Teamradio";break;case BMW_STREAM:label="BMW-Teamradio";break;case MERCEDES_STREAM:label="Mercedes-Teamradio";break}}return label};MatchEventStrategy.prototype.getGtmLabel=function(){var gtmLabel="";if(this._rawData.match.hasOwnProperty("home")&&this._rawData.match.hasOwnProperty("away")){gtmLabel=this._rawData.match.home.name+" : "+this._rawData.match.away.name+" "+this._rawData.match.match_date}else{gtmLabel=this._rawData.name+" "+this.getLabel()+" "+this._rawData.match.match_date}return gtmLabel};var getInstance=function(rawData){return new MatchEventStrategy(rawData)};return{getInstance:getInstance}}]);appServices.factory("jwFactory",["$q","semaphoreFactory",function($q,semaphoreFactory){"use strict";var initPlayerSemaphore;var loadPlayer=function(onLoad,onError){var playerScript=document.createElement("script"),head=document.head||document.getElementsByTagName("head")[0],loadScriptsSemaphore=semaphoreFactory.createSemaphore(1,onLoad);function setupScriptElement(element,onLoad,onError){element.type="text/javascript";element.onerror=onError;element.onload=onLoad}function onPlayerLoaded(){loadScriptsSemaphore.release()}function appendScript(){head.appendChild(playerScript);playerScript.src="http://assets.sport1.de/bundles/sport1portal/libs/jwplayer6.11/jwplayer.js"}setupScriptElement(playerScript,onPlayerLoaded,onError);appendScript()};var getVideoSources=function(video){var result=[];if(video&&video.hasOwnProperty("url")){if(video.url.hasOwnProperty("low_quality")){result.push({file:video.url.low_quality,label:"Low Quality"})}if(video.url.hasOwnProperty("mid_quality")){result.push({file:video.url.mid_quality,label:"Middle Quality"})}if(!window.s1IsMobileBrowser||!result.length){result.push({file:video.url.high_quality,label:"High Quality"})}}return result};var generatePlaylist=function(videos,width,height){var playList=[],idx;if(!Array.isArray(videos)){videos=[videos]}for(idx in videos){var video=videos[idx];var sources=getVideoSources(video);playList.push({title:video.title,description:video.description,image:video.image+"/width/"+width+"/height/"+height,sources:sources})}return playList};var createFacade=function(player,sport1PlayerInstance){var lifecycleStarted=false;var lastType;var lastTag;var rollIndexMap={preroll:0,midroll:0,postroll:0};var rollType="preroll";var adIsPlaying=false;var sport1Interface=sport1PlayerInstance.sport1Interface;var dispatcher=sport1Interface.eventDispatcher;var isPaused=false;function getEventObject(type){var e=jQuery.Event(type);e.target=sport1Interface;return e}function track(type,info){if(type!==lastType||"s1_content_seek"===type||"s1_content_timechange"===type){dispatcher.trigger(getEventObject(type),info)}lastType=type}function lifecycleComplete(){setTimeout(function(){if(adIsPlaying||player.getDuration()-player.getPosition()>10){return}track("s1_lifecycle_complete")},2e3)}function checkLifecycleStarted(){if(!lifecycleStarted){track("s1_lifecycle_start");lifecycleStarted=true}}player.onAdPlay(function(info){var videoPos=player.getPosition();var videoDuration=player.getDuration();isPaused=false;adIsPlaying=true;if(videoPos>10){rollType="midroll"}if(videoDuration!==-1&&videoDuration-videoPos<10){rollType="postroll"}checkLifecycleStarted();track("s1_ad_play",{rollIndex:rollIndexMap[rollType],rollType:rollType});lastTag=info.tag});player.onAdPause(function(){track("s1_ad_pause")});player.onAdComplete(function(){track("s1_ad_complete",{rollIndex:rollIndexMap[rollType]++,rollType:rollType});adIsPlaying=false;lifecycleComplete()});player.onComplete(lifecycleComplete);player.onPlay(function(){checkLifecycleStarted();isPaused=false;setTimeout(function(){if(adIsPlaying){return}if("s1_content_seek"===lastType){return}track("s1_content_play")},2e3)});player.onPause(function(){track("s1_content_pause")});player.onSeek(function(info){if("s1_ad_complete"===lastType){return}track("s1_content_seek",{start:Math.floor(info.position),end:Math.floor(info.offset)})});(function timechange(){if("PLAYING"===player.getState()){var currentTime=Math.floor(player.getPosition());if(currentTime){track("s1_content_timechange",{duration:Math.floor(player.getDuration()),currentTime:currentTime})}}setTimeout(timechange,1e3)})();player.onFullscreen(function(info){track("s1_player_fullscreen",{isFullscreen:info.fullscreen})});sport1Interface.getDuration=function(){return Math.floor(player.getDuration())};sport1Interface.getPosition=function(){return Math.max(0,Math.min(sport1Interface.getDuration(),Math.floor(player.getPosition())||0))};sport1Interface.pause=function(){if(!isPaused){isPaused=true;player.pause(true);player.pauseAd(true)}};sport1Interface.requestFullscreen=function(){player.setFullscreen(true)}};var initPlayer=function(rawData){var deferred=$q.defer();var player={};var sport1Interface={};var width=rawData.width;var height=rawData.height;jwplayer.key="vQ588HitWJxPu/Um4QWiZ8ZErot4bLHE/A5VIg==";sport1Interface.getPosition=sport1Interface.getDuration=function(){return-1};sport1Interface.setup=function(videos,videoAutostart){var concretePlayer=null;var config={displaytitle:false,id:rawData.randomId,skin:jwplayer.version.split(".")[1]>=10?"five":undefined,width:width,height:height,playlist:generatePlaylist(videos,width,height),primary:"flash",autostart:videoAutostart};var mainVideo=Array.isArray(videos)?videos[0]:videos;var duration=mainVideo.durationSeconds;if(window.myAd&&mainVideo.headline!=="Specials"){var adbreaks={preroll1:"pre",sponsor1:"pre",postroll1:"post"};if(window.SOI_LPY&&duration>=900){adbreaks.midroll1=600;if(duration>=1500){adbreaks.midroll2=1200}if(duration>=2100){adbreaks.midroll3=1800}if(duration>=2700){adbreaks.midroll4=2400}if(duration>=3300){adbreaks.midroll5=3e3}}window.myAd.addAdvertisingToJWConfig(config,adbreaks)}concretePlayer=jwplayer(rawData.container).setup(config);window._cbv=window._cbv||[];window._cbv.push(concretePlayer);createFacade(concretePlayer,player)};sport1Interface.pause=angular.noop;sport1Interface.requestFullscreen=angular.noop;sport1Interface.eventDispatcher=jQuery({});sport1Interface.playerId=Sport1Tools.createUUID();player.sport1Interface=sport1Interface;deferred.resolve(player);return deferred.promise};var createJW=function(rawData){var deferred=$q.defer();initPlayerSemaphore=semaphoreFactory.createSemaphore(1,function(){initPlayer(rawData).then(function(player){deferred.resolve(player)})});loadPlayer(function(){initPlayerSemaphore.release()});return deferred.promise};return{createInstance:createJW}}]);appServices.factory("kolibriFactory",["$q","semaphoreFactory",function($q,semaphoreFactory){"use strict";var initPlayerSemaphore;var loadPlayer=function(onLoad,onError){if(window.kolibri){onLoad();return}var playerScript=document.createElement("script"),strategyScript=document.createElement("script"),head=document.head||document.getElementsByTagName("head")[0],loadScriptsSemaphore=semaphoreFactory.createSemaphore(2,onLoad);function setupScriptElement(element,onLoad,onError){element.type="text/javascript";element.onerror=onError;element.onload=onLoad}function onPlayerLoaded(){window.kolibri.type="kolibri";loadScriptsSemaphore.release()}function onStrategyLoaded(){window._cbv_strategies=window._cbv_strategies||[];window._cbv_strategies.push(window.KolibriStrategy);loadScriptsSemaphore.release()}function appendScripts(){head.appendChild(playerScript);head.appendChild(strategyScript);playerScript.src="http://component.p7s1.com/kolibri/2.12.8/sport1/prod/kolibri.js";strategyScript.src="http://assets.sport1.de/bundles/sport1portal/libs/kolibri/cbv_kolibri_strategy.js"}setupScriptElement(playerScript,onPlayerLoaded,onError);setupScriptElement(strategyScript,onStrategyLoaded,onError);appendScripts()};var getSourceDataFromVideo=function(video){var source=null;if(video&&video.hasOwnProperty("url")){source={mimetype:"video/mp4",id:video.id};if(video.url.hasOwnProperty("high_quality")){source.url=video.url.high_quality;source.id+="_high_quality"}else if(video.url.hasOwnProperty("mid_quality")){
source.url=video.url.mid_quality;source.id+="_mid_quality"}else if(video.url.hasOwnProperty("low_quality")){source.url=video.url.low_quality;source.id+="_low_quality"}else{source=null}}return source};var generateRawContentResourcesFromVideos=function(videos,width,height){var rawContentResources=[];if(videos){if(!Array.isArray(videos)){videos=[videos]}for(var idx in videos){var video=videos[idx];var source=getSourceDataFromVideo(video);var sources=[source];rawContentResources.push({id:video.id,title:video.title,duration:video.durationSeconds,description:video.description,poster:video.image+"/width/"+width+"/height/"+height,sources:sources})}}return rawContentResources};var createFacade=function(nature,sport1PlayerInstance){var dispatcher=sport1PlayerInstance.sport1Interface.eventDispatcher;var sport1Interface=sport1PlayerInstance.sport1Interface;function getInfo(key){var info=nature.getMediaPlayerInfo&&nature.getMediaPlayerInfo();return info&&info.content&&info.content[key]}function adInfo(info){if(undefined===info.rollType||undefined===info.adIndex||undefined===info.rollIndex){return}var valid={null:"preroll",mid:"midroll",post:"postroll",pre:"preroll"};var ad=nature.getAdResourceAt(info.rollType,info.adIndex,info.rollIndex)||{};ad.type=valid[String(String(ad.position).match(/pre|mid|post/))];ad.rollIndex=info.rollIndex;ad.rollType=info.rollType;return ad}function getEventObject(type){var e=jQuery.Event(type);e.target=sport1Interface;return e}dispatcher.sport1Id=10;if(nature){var onAdEvent=function(payload,event){var type=event.type.split(".")[1];var data=adInfo(payload);switch(type){case"play":dispatcher.trigger(getEventObject("s1_ad_play"),data);break;case"pause":dispatcher.trigger(getEventObject("s1_ad_pause"),data);break;case"complete":dispatcher.trigger(getEventObject("s1_ad_complete"),data);break}};var onSeekStart=function(payload){var start=payload.currentTime;nature.once("content.seekcomplete",function(payload){dispatcher.trigger(getEventObject("s1_content_seek"),{start:start,end:payload.currentTime})})};var onContentEvent=function(payload,event){var type=event.type.split(".")[1];switch(type){case"play":dispatcher.trigger(getEventObject("s1_content_play"));break;case"timechange":dispatcher.trigger(getEventObject("s1_content_timechange"),{duration:payload.duration,currentTime:payload.currentTime});break;case"pause":dispatcher.trigger(getEventObject("s1_content_pause"));break;case"seekstart":onSeekStart(payload);break}};var onLifecycleEvent=function(ignore,event){var type=event.type.split(".")[1];switch(type){case"start":dispatcher.trigger(getEventObject("s1_lifecycle_start"));break;case"complete":dispatcher.trigger(getEventObject("s1_lifecycle_complete"));break}};var onFullscreenEvent=function(payload){dispatcher.trigger(getEventObject("s1_player_fullscreen"),{isFullscreen:payload.isFullscreen})};nature.on(/^(?!.*timechange).*linearad\b/,onAdEvent);nature.on(/content\b/,onContentEvent);nature.on(/lifecycle\b/,onLifecycleEvent);nature.on(/fullscreen\b/,Sport1Tools.debounce(onFullscreenEvent,25));sport1Interface.getDuration=function(){return Math.floor(getInfo("duration"))||0};sport1Interface.getPosition=function(){return Math.max(0,Math.min(sport1Interface.getDuration(),Math.floor(getInfo("currentTime"))||0))};sport1Interface.pause=function(){nature.pause()};sport1Interface.requestFullscreen=function(){nature.requestFullscreen()}}};var initPlayer=function(rawData){var deferred=$q.defer();if(window.kolibri){initPlayerSemaphore=null;var sport1Interface={};var sport1PlayerInstance={sport1Interface:sport1Interface};var goldenCage=rawData.container;var width=rawData.width;var height=rawData.height;var playerConfig={"@ui":{components:{"control-bar":{overlapping:true}}}};goldenCage.style.width=width.toString()+"px";goldenCage.style.height=height.toString()+"px";window.kolibri.isReady=function(){return window.kolibri.hasOwnProperty("nature")};window._cbv=window._cbv||[];window._cbv.push(window.kolibri);sport1Interface.eventDispatcher=jQuery({});sport1Interface.playerId=Sport1Tools.createUUID();sport1Interface.getDuration=function(){return-1};sport1Interface.getPosition=function(){return-1};sport1Interface.setup=function(videos,videoAutostart){var deferred=$q.defer();window.kolibri.evolve(goldenCage,playerConfig,function(nature){window.kolibri.nature=nature;createFacade(nature,sport1PlayerInstance);var rawContentResources=generateRawContentResourcesFromVideos(videos,width,height);rawContentResources.forEach(function(element){nature.addContent(element)});nature.skip(0);if(videoAutostart){nature.play()}if(window.kolibri.evolveCallback){window.kolibri.evolveCallback(nature)}deferred.resolve()})};sport1Interface.pause=angular.noop;sport1Interface.requestFullscreen=angular.noop;deferred.resolve(sport1PlayerInstance)}else{deferred.reject("window.kolibri is undefined")}return deferred.promise};var createKolibri=function(rawData){var deferred=$q.defer();initPlayerSemaphore=semaphoreFactory.createSemaphore(1,function(){initPlayer(rawData).then(function(player){deferred.resolve(player)})});loadPlayer(function(){initPlayerSemaphore.release()});return deferred.promise};return{createInstance:createKolibri}}]);appServices.factory("kolibriV2Factory",["$q","semaphoreFactory",function($q,semaphoreFactory){"use strict";var initPlayerSemaphore;var loadPlayer=function(onLoad,onError){if(window.KolibriStrategy){onLoad();return}var glomexLoaderScript=document.createElement("script"),playerScript=document.createElement("script"),strategyScript=document.createElement("script"),head=document.head||document.getElementsByTagName("head")[0],loadScriptsSemaphore=semaphoreFactory.createSemaphore(2,onLoad);function setupScriptElement(element,src,onLoad,onError){element.type="text/javascript";element.onerror=onError;element.onload=onLoad;element.src=src}function onPlayerLoaded(){loadScriptsSemaphore.release()}function onStrategyLoaded(){window._cbv_strategies=window._cbv_strategies||[];window._cbv_strategies.push(window.KolibriStrategy);loadScriptsSemaphore.release()}function appendScripts(){head.appendChild(glomexLoaderScript);head.appendChild(strategyScript)}setupScriptElement(glomexLoaderScript,"http://component.p7s1.com/glomex-loader/3.2.0/glomex-loader.js",loadScriptsSemaphore.release.bind(loadScriptsSemaphore),onError);setupScriptElement(playerScript,"http://component.p7s1.com/kolibri/2.12.8/sport1/prod/kolibri.js",onPlayerLoaded,onError);setupScriptElement(strategyScript,"/bundles/sport1portal/libs/kolibri/cbv_kolibriV2_strategy.js",onStrategyLoaded,onError);appendScripts()};var getSourceDataFromVideo=function(video){var source=null;if(video&&video.hasOwnProperty("url")){source={mimetype:"video/mp4",id:video.id};if(video.url.hasOwnProperty("high_quality")){source.url=video.url.high_quality;source.id+="_high_quality"}else if(video.url.hasOwnProperty("mid_quality")){source.url=video.url.mid_quality;source.id+="_mid_quality"}else if(video.url.hasOwnProperty("low_quality")){source.url=video.url.low_quality;source.id+="_low_quality"}else{source=null}}return source};var generateRawContentResourcesFromVideos=function(videos,width,height){var rawContentResources=[];var somMarketing=Sport1Tools.getSOMMarketingObject();if(somMarketing.SOI_WERBUNG===false){somMarketing=null}if(videos){if(!Array.isArray(videos)){videos=[videos]}for(var idx in videos){var video=videos[idx];var source=getSourceDataFromVideo(video);var sources=[source];rawContentResources.push({id:video.id,title:video.title,duration:video.durationSeconds,description:video.description,poster:video.image+"/width/"+width+"/height/"+height,sources:sources,somMarketing:somMarketing})}}return rawContentResources};var createFacade=function(nature,sport1PlayerInstance){var dispatcher=sport1PlayerInstance.sport1Interface.eventDispatcher;var sport1Interface=sport1PlayerInstance.sport1Interface;var duration=0;var position=0;function getEventObject(type){var e=jQuery.Event(type);e.target=sport1Interface;return e}function adInfo(payload){var valid={null:"preroll",mid:"midroll",post:"postroll",pre:"preroll"};var data=angular.copy(payload.ad);data.title=payload.ad.id;data.duration=payload.runtime.duration;data.rollType=data.rollName;data.type=valid[String(String(data.rollName).match(/pre|mid|post/))];return data}dispatcher.sport1Id=10;if(nature){nature.on("trackingevent",function(trackingEventName,payload){var event,runtime,data;switch(trackingEventName){case"Lifecycle Create":dispatcher.trigger(getEventObject("s1_lifecycle_start"));break;case"Lifecycle End":dispatcher.trigger(getEventObject("s1_lifecycle_complete"));break;case"Ad Complete":if(payload&&payload.hasOwnProperty("ad")){data=adInfo(payload);dispatcher.trigger(getEventObject("s1_ad_complete"),data)}break;case"Pause":event=payload.hasOwnProperty("ad")?"s1_ad_pause":"s1_content_pause";dispatcher.trigger(getEventObject(event));break;case"Play":if(payload.hasOwnProperty("ad")){data=adInfo(payload);dispatcher.trigger(getEventObject("s1_ad_play"),data)}else{dispatcher.trigger(getEventObject("s1_content_play"))}break;case"Position Change":runtime=payload.runtime;if(runtime){duration=parseInt(runtime.duration);position=parseInt(runtime.position);if(!payload.hasOwnProperty("ad")){data={duration:duration,currentTime:position};dispatcher.trigger(getEventObject("s1_content_timechange"),data)}}if(!nature._isReady){nature._isReady=true}break;case"Position Seek":if(!payload.hasOwnProperty("ad")){runtime=payload.runtime;if(runtime){position=parseInt(runtime.position);data={start:parseInt(runtime.fromPosition),end:parseInt(position)};dispatcher.trigger(getEventObject("s1_content_seek"),data)}}break;case"Fullscreen Change":runtime=payload.runtime;if(runtime){data={isFullscreen:runtime.isInFullscreen};dispatcher.trigger(getEventObject("s1_player_fullscreen"),data)}break}});sport1Interface.getDuration=function(){return duration};sport1Interface.getPosition=function(){return Math.max(0,Math.min(duration,position))};sport1Interface.pause=function(){nature.pause()};sport1Interface.requestFullscreen=function(){nature.requestFullscreen()}}};var initPlayer=function(rawData){var deferred=$q.defer();if(window.glomex){initPlayerSemaphore=null;var sport1Interface={};var sport1PlayerInstance={sport1Interface:sport1Interface};var goldenCage=rawData.container;var width=rawData.width;var height=rawData.height;goldenCage.style.width=width.toString()+"px";goldenCage.style.height=height.toString()+"px";sport1Interface.eventDispatcher=jQuery({});sport1Interface.playerId=Sport1Tools.createUUID();sport1Interface.getDuration=function(){return-1};sport1Interface.getPosition=function(){return-1};sport1Interface.setup=function(videos,videoAutostart){var deferred=$q.defer();window.glomex.init(goldenCage,"is1hap4j").onGlomexPlayer(function(player){createFacade(player,sport1PlayerInstance);var rawContentResources=generateRawContentResourcesFromVideos(videos,width,height);rawContentResources.forEach(function(element){player.addContent(element)});player.type="kolibriV2";player._isReady=false;player.isReady=function(){return player._isReady};window._cbv=window._cbv||[];window._cbv.push(player);if(videoAutostart){player.play()}deferred.resolve()})};sport1Interface.pause=angular.noop;sport1Interface.requestFullscreen=angular.noop;deferred.resolve(sport1PlayerInstance)}else{deferred.reject("window.glomex is undefined")}return deferred.promise};var createKolibri=function(rawData){var deferred=$q.defer();initPlayerSemaphore=semaphoreFactory.createSemaphore(1,function(){initPlayer(rawData).then(function(player){deferred.resolve(player)})});loadPlayer(function(){initPlayerSemaphore.release()});return deferred.promise};return{createInstance:createKolibri}}]);appServices.factory("videoPlayerFactory",["$q","kolibriFactory","kolibriV2Factory","jwFactory",function($q,kolibriFactory,kolibriV2Factory,jwFactory){"use strict";var playerType;function Sport1VideoPlayer(player){this._player=player}Sport1VideoPlayer.prototype.setup=function(videos,videoAutostart){this._player.sport1Interface.setup(videos,videoAutostart)};Sport1VideoPlayer.prototype.addEventListener=function(type,handler){this._player.sport1Interface.eventDispatcher.on(type,handler)};Sport1VideoPlayer.prototype.removeEventListener=function(type,handler){this._player.sport1Interface.eventDispatcher.off(type,handler)};Sport1VideoPlayer.prototype.getDuration=function(){return this._player.sport1Interface.getDuration()};Sport1VideoPlayer.prototype.getPosition=function(){return this._player.sport1Interface.getPosition()};Sport1VideoPlayer.prototype.getId=function(){return this._player.sport1Interface.playerId};Sport1VideoPlayer.prototype.pause=function(){this._player.sport1Interface.pause()};Sport1VideoPlayer.prototype.requestFullscreen=function(){this._player.sport1Interface.requestFullscreen()};var createVideoPlayer=function(type,config){var deferred=$q.defer();playerType=type;switch(type){case"kolibri":kolibriFactory.createInstance(config).then(function(instance){deferred.resolve(new Sport1VideoPlayer(instance))});break;case"kolibriV2":kolibriV2Factory.createInstance(config).then(function(instance){deferred.resolve(new Sport1VideoPlayer(instance))});break;case"jw":jwFactory.createInstance(config).then(function(instance){deferred.resolve(new Sport1VideoPlayer(instance))});break}return deferred.promise};return{createVideoPlayer:createVideoPlayer}}]);appServices.factory("agfVideoTracking",["videoService","ivwTrackingCodeService",function(videoService,ivwTrackingCodeService){"use strict";var inyourface={handleAdComplete:angular.noop,handleAdPlay:angular.noop,handleFullscreenEvent:angular.noop,handleLifecycleComplete:angular.noop,handleSeek:angular.noop,handleVolumeChange:angular.noop,setPlayer:angular.noop,setSpecs:angular.noop,trackContentPause:angular.noop,trackContentPlay:angular.noop};if(!window.NOLCMB){window.NOLCMB={getInstance:function(){return{ggInitialize:angular.noop,ggPM:function(event,a,b){console.log("agf track",event,a,b)}}}}}var sdk;var spec;var player;var length;var started=false;var ended=false;var ready=false;var tried=false;var lastTypeEvent;var metadata={nol_c10:"p10,Sport1",nol_c6:"p6,"+_nolggGlobalParams.vcid,type:"content",nol_c12:"p12,Content",livestream:"no",nol_c18:"p18,N",nol_c16:"p16,"+ivwTrackingCodeService.createIvwCode(),nol_c2:"p2,1"};function set(key,value){metadata[key]=value}function setC(key,value){set("nol_c"+key,"p"+key+","+value)}function setLength(l){length=Math.min(86400,Math.round(l))||60;set("length",length);setC(8,length)}function setId(i){var id=String(i).substring(0,200);set("assetid",id);set("uurl",id);setC(7,id)}function setTitle(t){var title=String(t).substring(0,255);set("censuscategory",title);set("title",title);setC(9,title)}function track(type,event,a,b){if(!ready){tried=true;return}var typeEvent=type+"_"+event;if("seek"!==event&&typeEvent===lastTypeEvent){return}lastTypeEvent=typeEvent;sdk.ggPM(event,a,b)}function setApiData(response){var epg=response.epg||{};if(window.dataLayer&&epg.material_id){window.dataLayer.push({event:"ga_event",eventCategory:"agf",eventAction:"view",eventLabel:spec.videoId+"_"+epg.material_id})}if(epg.material_id){setC(2,"0");setC(15,epg.material_id)}if(epg.title){set("program",epg.title)}var title=epg.title||spec.title;if(epg.episode){title+=", Folge "+epg.episode}if(epg.from){setC(14,epg.from.replace(/T.*/,""));title+=", "+epg.from}setLength(response.durationSeconds);setTitle(title)}function play(){if(!ready||"content_seek"===lastTypeEvent){return}if(started){track("content","play",metadata);track("content","setPlayheadPosition",player.getPosition())}else{track("content","loadMetaData",metadata)}started=true;ended=false}function end(){if(!ended){track("content","end",player.getPosition()||length)}ended=true}function pause(){track("content","pause",player.getPosition())}function seek(info){track("content","seek",Math.floor(info.start),Math.floor(Math.max(0,info.end)))}function unload(){if(!started){return}end();track("content","stop",player.getPosition()||length);track("content","unload",player.getPosition()||length);started=false}function adComplete(info){if(!info.id){return}track("ad","stop",Math.round(info.duration))}function adPlay(info){if(!info.id){return}if(!started){play()}if("postroll"===info.type){end()}else{track("content","pause",0)}track("ad","loadMetadata",{assetid:info.id,censuscategory:info.title,length:Math.round(info.duration),title:info.title,type:info.type,uurl:info.id});track("ad","setPlayheadPosition",0)}function setSpecs(s){spec=s;player=spec.player;setId(spec.videoId);set("program",spec.title);setTitle(spec.title);videoService.getVideo(spec.videoId).then(setApiData).finally(function(){ready=true;if(tried){play()}})}sdk=NOLCMB.getInstance(_nolggGlobalParams.apid);sdk.ggInitialize(_nolggGlobalParams);inyourface.trackContentPlay=play;inyourface.trackContentPause=pause;inyourface.handleSeek=seek;inyourface.handleAdPlay=adPlay;inyourface.handleAdComplete=adComplete;inyourface.handleLifecycleComplete=unload;window.addEventListener("unload",unload);inyourface.setSpecs=setSpecs;return inyourface}]);appServices.factory("agfOldVideoTracking",["videoService","ivwTrackingCodeService",function(videoService,ivwTrackingCodeService){"use strict";var inyourface={handleAdComplete:angular.noop,handleAdPlay:angular.noop,handleFullscreenEvent:angular.noop,handleLifecycleComplete:angular.noop,handleSeek:angular.noop,handleVolumeChange:angular.noop,setPlayer:angular.noop,setSpecs:angular.noop,trackContentPause:angular.noop,trackContentPlay:angular.noop};if(!window.gg){window.gg=function(){this.ggPM=function(a,b,c,d){console.log("agf tracking old",a,b,c,d)};this.ggInitialize=angular.noop}}var adLock=false;var Agf=window.gg;var aggregator="Sport1";var beacon=new Agf;var canUseSWF=false;var clientid=_nolggGlobalParams.clientid;var codes;var epg;var isPlaying=false;var periodic=15e3;var player;var sawAd=0;var trackedLoad=false;var trackedUnload=false;var uid=0;var vcid=_nolggGlobalParams.vcid;var videoIdItems;var videoId;var isMute;var duration=0;var spec;codes={loadPlayer:1,loadVideo:3,unloadVideo:4,playVideo:5,pauseVideo:6,stopVideo:7,seek:8,mute:9,fullscreen:10,volume:11,playing:49,pageUrl:51};function configure(length){var webOnly=epg.material_id?0:1;var videoInfoXml=["<title>"+epg.title+"</title>","<censuscategory>"+epg.title+"</censuscategory>","<nol_c9>p9,"+epg.title+"</nol_c9>","<length>"+length+"</length>","<nol_c8>p8,"+length+"</nol_c8>","<livestream>"+"no"+"</livestream>","<nol_c18>p18,"+"N"+"</nol_c18>","<uurl>"+videoId+"</uurl>","<nol_c6>p6,"+vcid+"</nol_c6>","<nol_c7>p7,"+videoId+"</nol_c7>","<nol_c10>p10,"+aggregator+"</nol_c10>","<vidtype>"+"content"+"</vidtype>","<nol_c12>p12,Content</nol_c12>","<nol_c2>p2,"+webOnly+"</nol_c2>"];if(epg.from){videoInfoXml.push("<nol_c14>p14,"+epg.from.replace(/T.*/,"")+"</nol_c14>")}if(epg.material_id){videoInfoXml.push("<nol_c15>p15,"+epg.material_id+"</nol_c15>")}videoInfoXml.push("<nol_c16>p16,"+ivwTrackingCodeService.createIvwCode(spec.trackingCode)+"</nol_c16>");return videoInfoXml.join("")}function track(){var args=Array.prototype.slice.call(arguments);beacon.ggPM.apply(beacon,args)}function trackIfContent(){if(!trackedLoad||adLock||Date.now()-sawAd<1e3){return}track.apply(null,Array.prototype.slice.call(arguments))}function trackUnload(){isPlaying=false;if(trackedUnload||!trackedLoad){return}var position=player.getPosition();track(codes.stopVideo,position);track(codes.unloadVideo,position,"content");trackedUnload=true}function getDuration(){if(duration&&isFinite(duration)){return duration}duration=player.getDuration();return duration}function getVideoSuccessHandler(response){if(response.epg){if(window.dataLayer){window.dataLayer.push({event:"ga_event",eventCategory:"agf",eventAction:"view",eventLabel:spec.videoId+"_"+response.epg.material_id})}epg=response.epg;epg.title=epg.title||spec.title;if(epg.episode){epg.title+=", Folge "+epg.episode}epg.title+=", "+epg.from}else{epg={title:spec.title}}epg.title=epg.title.substring(0,255);var d=Math.floor(Number(response.durationSeconds));if(d&&(!getDuration()||getDuration()<1)){duration=d}beacon.ggInitialize(_nolggGlobalParams,uid,canUseSWF);track(codes.pageUrl,location.href);track(codes.loadPlayer,location.href)}var setSpecs=function(agfSpecs){spec=agfSpecs;videoIdItems=[clientid,vcid,spec.videoId];videoId=videoIdItems.join("_").substring(0,200);videoService.getVideo(spec.videoId).then(getVideoSuccessHandler);window.addEventListener("unload",trackUnload);(function playing(){var position=player.getPosition();if(isPlaying&&position>0){trackIfContent(codes.playing,position)}setTimeout(playing,periodic)})()};var handleAdPlay=function(){adLock=true};var handleAdComplete=function(){adLock=false;sawAd=Date.now()};var trackContentPlay=function(){var tries=30;return function p(){if(getDuration()<1||!epg){if(tries>0){setTimeout(p,100);tries-=1}return}if(!trackedLoad){track(codes.loadVideo,videoId,"content",configure(getDuration()),1);trackedLoad=true;trackedUnload=false}if(!isPlaying){track(codes.playVideo,player.getPosition());isPlaying=true}}}();var trackContentPause=function(){trackIfContent(codes.pauseVideo,player.getPosition());isPlaying=false};var handleSeek=function(info){trackIfContent(codes.seek,Math.floor(info.start),Math.floor(Math.max(0,info.end)))};var handleFullscreenEvent=function(info){trackIfContent(codes.fullscreen,String(!!info.isFullscreen))};var handleVolumeChange=function(payload){if(!isMute&&payload.muted){isMute=true;trackIfContent(codes.mute,true)}else if(isMute&&!payload.muted){isMute=false;trackIfContent(codes.mute,false)}};var handleLifecycleComplete=function(){trackUnload()};inyourface.setPlayer=function(p){player=p};inyourface.setSpecs=setSpecs;inyourface.handleAdPlay=handleAdPlay;inyourface.handleAdComplete=handleAdComplete;inyourface.trackContentPlay=trackContentPlay;inyourface.trackContentPause=trackContentPause;inyourface.handleSeek=handleSeek;inyourface.handleFullscreenEvent=handleFullscreenEvent;inyourface.handleVolumeChange=handleVolumeChange;inyourface.handleLifecycleComplete=handleLifecycleComplete;return inyourface}]);appServices.factory("gaVideoTracking",["videoService",function(videoService){"use strict";var spec={},gtmTrackedActions,rolltypeToLabel={preroll:"PreRoll",midroll:"MidRoll",postroll:"PostRoll"};function wasGTMDataAlreadyTracked(data){var result=false,storedData=null,attribute;if(data.hasOwnProperty("eventAction")&&gtmTrackedActions.hasOwnProperty(data.eventAction)){storedData=gtmTrackedActions[data.eventAction];for(attribute in data){if(data[attribute]===storedData[attribute]){result=true}else{result=false;break}}}return result}function gtmTrack(action,eventCategory,videoContentGroup,multiTrack){multiTrack=typeof multiTrack==="boolean"?multiTrack:false;var label=eventCategory==="VideoDauer"?spec.videoTags:spec.label;var data={event:"ga_event",eventCategory:eventCategory,eventLabel:label,eventAction:action,videoContentGroup:videoContentGroup};if(gtmTrackedActions&&window.dataLayer&&(multiTrack||!wasGTMDataAlreadyTracked(data))){window.dataLayer.push(data);gtmTrackedActions[action]=data}}function isCountingRollType(rollType){return rollType==="preroll"}function createActionFromPayload(payload){var action,label,rollType;if(payload.hasOwnProperty("rollType")){rollType=payload.rollType;if(rolltypeToLabel.hasOwnProperty(rollType)){label=rolltypeToLabel[rollType];action=label;if(isCountingRollType(rollType)){if(payload.hasOwnProperty("rollIndex")){action+=String(payload.rollIndex+1)}}return action}else{console.error("Cannot find "+rollType+" in rolltypeToLabel map")}}}var setSpec=function(gaSpecs){spec=gaSpecs;videoService.getVideo(spec.videoId).then(function(response){spec.videoTags=response.tags})};var trackAdPlay=function(payload){var action=createActionFromPayload(payload);if(action){action+="_started";gtmTrack(action,"Video")}};var trackAdComplete=function(payload){var action=createActionFromPayload(payload);if(action){action+="_finished";gtmTrack(action,"Video")}};var handleContentTimechange=function(payload){var viewPercentage=Math.round(100/payload.duration*payload.currentTime),action;if(viewPercentage%25===0&&viewPercentage>0){action=viewPercentage+"%";gtmTrack(action,"VideoDauer")}};var trackContentPlay=function(){var action;if(spec.autoplay){action="autoplay"}else if(spec.changeMovie){action="changeMovie"}else{action="play"}gtmTrack(action,"Video",spec.categories)};var handleFullscreenEvent=function(payload){var action=payload.isFullscreen?"screen.open":"screen.close";gtmTrack(action,"Video",undefined,true)};var handleLifecycleStart=function(){gtmTrackedActions={}};var trackInitialPlay=function(){var tracked=false;return function(){if(tracked||!window.dataLayer){return}tracked=true;window.dataLayer.push({event:"ga_event",eventCategory:"Video",eventLabel:spec.label,eventAction:"initialisierung"})}}();return{setSpec:setSpec,trackAdPlay:trackAdPlay,trackAdComplete:trackAdComplete,handleContentTimechange:handleContentTimechange,trackContentPlay:trackContentPlay,handleFullscreenEvent:handleFullscreenEvent,handleLifecycleStart:handleLifecycleStart,trackInitialPlay:trackInitialPlay}}]);appServices.factory("ivwTrackingCodeService",[function(){"use strict";function createIvwCode(code){var prefix="sport1_fm"===window.s1portal?"Ax_":"Vx_";code=code||window.iam_data&&window.iam_data.cp||"Tx_sport";return code.replace("Tx_",prefix)}return{createIvwCode:createIvwCode}}]);appServices.factory("ivwVideoTracking",["ivwTrackingCodeService",function(ivwTrackingCodeService){"use strict";var specs,code,lastEvent;var setSpecs=function(ivwSpecs){specs=ivwSpecs;code=ivwTrackingCodeService.createIvwCode(specs.trackingCode)};var count=function(event){if(lastEvent!==event){if(!specs.changeMovie){window.ivwPI(code)}specs.changeMovie=false}lastEvent=event};var handleLifecycleStart=function(){lastEvent=undefined};return{setSpecs:setSpecs,count:count,handleLifecycleStart:handleLifecycleStart}}]);appServices.factory("videoTrackingService",["$injector","gaVideoTracking","ivwVideoTracking",function($injector,gaVideoTracking,ivwVideoTracking){"use strict";var agfVideoTracking;if(_nolggGlobalParams.apid){agfVideoTracking=$injector.get("agfVideoTracking")}else{agfVideoTracking=$injector.get("agfOldVideoTracking")}function init(player,spec){if(player){gaVideoTracking.setSpec(spec);ivwVideoTracking.setSpecs(spec);agfVideoTracking.setPlayer(player);agfVideoTracking.setSpecs(spec);var onLifecycleStart=function(){gaVideoTracking.trackInitialPlay();gaVideoTracking.handleLifecycleStart();ivwVideoTracking.handleLifecycleStart()};var onAdPlay=function(event,data){gaVideoTracking.trackInitialPlay();gaVideoTracking.trackAdPlay(data);ivwVideoTracking.count("play");agfVideoTracking.handleAdPlay(data)};var onAdPause=function(){ivwVideoTracking.count("pause")};var onAdComplete=function(event,data){gaVideoTracking.trackAdComplete(data);agfVideoTracking.handleAdComplete(data)};var onContentSeek=function(event,data){agfVideoTracking.handleSeek(data)};var onContentPlay=function(){gaVideoTracking.trackInitialPlay();gaVideoTracking.trackContentPlay();ivwVideoTracking.count("play");agfVideoTracking.trackContentPlay()};var onContentPause=function(){ivwVideoTracking.count("pause");agfVideoTracking.trackContentPause()};var onContentTimechange=function(event,data){gaVideoTracking.handleContentTimechange(data)};var onPlayerFullscreen=function(event,data){gaVideoTracking.handleFullscreenEvent(data);agfVideoTracking.handleFullscreenEvent(data)};var onLifecycleComplete=function(){agfVideoTracking.handleLifecycleComplete()};player.addEventListener("s1_lifecycle_start",onLifecycleStart);player.addEventListener("s1_ad_play",onAdPlay);player.addEventListener("s1_ad_pause",onAdPause);player.addEventListener("s1_ad_complete",onAdComplete);player.addEventListener("s1_content_seek",onContentSeek);player.addEventListener("s1_content_play",onContentPlay);player.addEventListener("s1_content_pause",onContentPause);player.addEventListener("s1_content_timechange",onContentTimechange);player.addEventListener("s1_player_fullscreen",onPlayerFullscreen);player.addEventListener("s1_lifecycle_complete",onLifecycleComplete)}}return{init:init}}]);appControllers.controller("MotorsLiveTickerAppCtrl",["$scope","$location","$route","$filter","$locale","sportDataService","liveTickerTimerService","tickerService",function($scope,$location,$route,$filter,$locale,sportDataService,timerService,tickerService){"use strict";$scope.baseScriptUrl=$location.absUrl().substr(0,$location.absUrl().length-($location.path().length+1));var queryPos=$scope.baseScriptUrl.indexOf("?");if(queryPos!==-1){$scope.baseScriptUrl=$scope.baseScriptUrl.substr(0,queryPos)}$scope.sport1FmTickerUrl="http://www.sport1.fm/";$scope.$filter=$filter;$scope.$locale=$locale;$scope.$locale.id="de-de";$scope.$location=$location;$scope.$route=$route;$scope.templateUrl=null;$scope.tabId=-1;$scope.tabs=[{title:"Rennverlauf",id:0,path:"rennverlauf",templateUrl:"desktop/angularjs/apps/motors-live-ticker/templates/ticker.html"},{title:"Platzierungen",id:1,path:"platzierungen",templateUrl:"desktop/angularjs/apps/motors-live-ticker/templates/positions.html"},{title:"Startaufstellung",id:2,path:"startaufstellung",templateUrl:"desktop/angularjs/apps/motors-live-ticker/templates/lineup.html"}];$scope.currentTab=$scope.tabs[0];$scope.timeSinceUpdate=0;$scope.activeRaceId=0;$scope.lastTickerUpdateTimestamp=null;$scope.leagueId=-1;$scope.seasons=[{},{}];$scope.seasonRace={};$scope.season={};$scope.races=[];$scope.race={};$scope.ticker=[];$scope.lineup=null;$scope.positions=null;var self=this;var _todaysDate;var _initialRaceId=1;var _timerCallback=null;var _tabChanged=false;var raceId=0,season=null,race=null;sportDataService.getMotorsportsSeasons().then(function(result){var idx=0,rc=null,idxRc=0,rcId=null,params=null;params=$scope.$route.current.params;raceId=angular.isDefined(params.raceId)?params.raceId:_initialRaceId;for(idx in result.seasons){rc=result.seasons[idx].races;for(idxRc in rc){rcId=rc[idxRc].raceId;if(raceId*1===rcId){season=result.seasons[idx];race=rc[idxRc]}}}$scope.seasons=result.seasons;$scope.season=season===null?$scope.seasons[0]:season;$scope.seasonRace=race===null?$scope.season.races[0]:race;$scope.race=race===null?$scope.season.races[0]:race;var unwatchCurrentTab=$scope.$watch("currentTab",function(newValue,oldValue){if(newValue&&newValue!==oldValue){if(oldValue&&newValue.id===oldValue.id){return}_tabChanged=true;self._updateLocationPath($scope.race)}});$scope.$watch("season",function(newValue){$scope.season=newValue;$scope.races=$scope.season.races;$scope.seasonRace=newValue.races[0]});$scope.$watch("seasonRace",function(newValue,oldValue){if(newValue&&newValue!==oldValue){self._updateLocationPath(newValue)}});$scope.$on("destroy",function(){unwatchCurrentTab();timerService.stopTimer();timerService.unregisterCallback(_timerCallback)})});$scope.$on("$locationChangeSuccess",function(){var params=$scope.$route.current.params;var raceId=angular.isDefined(params.raceId)?params.raceId:_initialRaceId;$scope.tabId=angular.isDefined(params.tabId)?params.tabId:$scope.tabs[0].path;var tab;if($scope.race){var intRaceId=parseInt(raceId,10);if(!isNaN(intRaceId)&&!isNaN($scope.race.raceId)){raceId=intRaceId}if($scope.race.raceId!==raceId){$scope.positions=null;self._prepareRaceChange(raceId)}else{if($scope.canRefresh()&&_tabChanged){self._prepareRaceChange(raceId)}_tabChanged=false}}else if($scope.activeRaceId!==raceId){if(_initialRaceId!==raceId){$scope.positions=null;self._prepareRaceChange(raceId)}else{$scope.positions=null;self._prepareRaceChange(_initialRaceId)}}if($scope.tabId){if($scope.currentTab&&$scope.tabId!==$scope.currentTab.path){tab=$scope.$filter("keyValueFilter")($scope.tabs,{path:$scope.tabId})[0];$scope.currentTab=tab?tab:$scope.tabs[0]}}else{if(!$scope.currentTab){$scope.currentTab=$scope.tabs[0]}}if($scope.seasons){if($scope.season&&$scope.seasons!==$scope.currentTab.path){tab=$scope.$filter("keyValueFilter")($scope.tabs,{
path:$scope.tabId})[0];$scope.currentTab=tab?tab:$scope.tabs[0]}}else{if(!$scope.currentTab){$scope.currentTab=$scope.tabs[0]}}if($scope.currentTab&&$scope.templateUrl!==$scope.currentTab.templateUrl){$scope.templateUrl=$scope.currentTab.templateUrl}});$scope.refresh=function($event){if($scope.canRefresh()){timerService.stopTimer();timerService.resetTime();$scope.timeSinceUpdate=0;if(angular.isDefined($scope.race)){switch($scope.tabId){case"rennverlauf":self._getMotorsportsPositionsForRace($scope.race.raceId,$scope.lastTickerUpdateTimestamp);self._getMotorsportsTickerForRace($scope.race.raceId);break;case"startaufstellung":self._getMotorsportsLineupForRace($scope.race.raceId,$scope.lastTickerUpdateTimestamp);break;case"platzierungen":self._getMotorsportsPositionsForRace($scope.race.raceId,$scope.lastTickerUpdateTimestamp);break}}}if(window.myAd&&window.myAd.updateAds){window.myAd.updateAds()}if($event){$event.preventDefault()}};$scope.canRefresh=function(){return timerService.canRefresh($scope.timeSinceUpdate)};$scope.hideStartTime=function(race){if(angular.isDefined(race.detail)){var msUpdate=Date.parse(race.detail.updatedAt);var msStart=Date.parse(race.detail.startTime);if(!isNaN(msUpdate)&&!isNaN(msStart)){return msUpdate>=msStart}}return true};$scope.getCompetitorStopgaps=function(cols){if($scope.race&&$scope.race.competitors!==undefined){return new Array(cols-$scope.race.competitors.length%cols)}return 0};this._getMotorsportsTickerForRace=function(raceId,lastUpdate){sportDataService.getMotorsportsTickerForRace(raceId,lastUpdate).then(function(race){if("object"===typeof race){$scope.ticker=tickerService.updatePosts($scope.ticker,race.postUpdates);$scope.ticker=$scope.ticker.concat(race.posts);race.raceId=raceId;$scope.race=race;timerService.startTimer();$scope.lastTickerUpdateTimestamp=race.lastMod}})};this._getMotorsportsLineupForRace=function(raceId,lastUpdate){sportDataService.getMotorsportsLineupForRace(raceId,lastUpdate).then(function(race){if("object"===typeof race){race.raceId=raceId;$scope.raceName=race.currentRaceIName;$scope.positionDrivers=race.positionDrivers;timerService.startTimer();$scope.lastTickerUpdateTimestamp=race.lastMod}})};this._getMotorsportsPositionsForRace=function(raceId,lastUpdate){sportDataService.getMotorsportsPositionsForRace(raceId,lastUpdate).then(function(race){if("object"===typeof race){$scope.positionDrivers=race.positionDrivers;$scope.raceName=race.currentRaceIName;timerService.startTimer();$scope.lastTickerUpdateTimestamp=race.lastMod}})};this._prepareRaceChange=function(raceId){if(angular.isDefined(raceId)){timerService.stopTimer();timerService.resetTime();$scope.ticker=[];$scope.timeSinceUpdate=0;$scope.lastTickerUpdateTimestamp=null;$scope.activeRaceId=raceId;switch($scope.tabId){case"rennverlauf":self._getMotorsportsPositionsForRace(raceId,$scope.lastTickerUpdateTimestamp);self._getMotorsportsTickerForRace(raceId);break;case"startaufstellung":self._getMotorsportsLineupForRace(raceId,$scope.lastTickerUpdateTimestamp);break;case"platzierungen":self._getMotorsportsPositionsForRace(raceId,$scope.lastTickerUpdateTimestamp);break}}};this._getTopCompetitors=function(raceId){if(angular.isDefined(raceId)&&angular.isDefined(raceId)){}};this._updateLocationPath=function(race){if(race&&$scope.currentTab){if(race.raceId){$scope.$location.path("/"+race.raceId+"/"+$scope.currentTab.path)}}};$scope.initVars=function(raceId,leagueId,today){$scope.leagueId=leagueId;_initialRaceId=raceId;_todaysDate=today;_timerCallback=function(){$scope.$apply(function(){$scope.timeSinceUpdate=timerService.timeSinceStart()})};timerService.registerCallback(_timerCallback)}}]);appDirectives.directive("epgPopupButton",["$document",function($document){"use strict";return{controller:"EPGAppCtrl",link:function(scope,element){var $popupButton=$(element);var $trigger=$("#s1-epg-popup-trigger");var $menu=$(".s1-popup-button-menu",$popupButton);var menuOpenClass="s1-open";var _keyUpHandler;var _toggleMenuClickHandler;var _toggleMenu;_keyUpHandler=function(evt){var keyCode=evt.keyCode;switch(keyCode){case 27:var e=jQuery.Event("click touchend");_toggleMenuClickHandler(e);break}};_toggleMenu=function(){$popupButton.toggleClass(menuOpenClass);setTimeout(function(){if($popupButton.hasClass(menuOpenClass)){scope.getCurrentEPG();$trigger.off("click touchend",_toggleMenuClickHandler);$document.on("click touchend",_toggleMenuClickHandler);$document.on("keyup",_keyUpHandler)}else{$trigger.on("click touchend",_toggleMenuClickHandler);$document.off("click touchend",_toggleMenuClickHandler);$document.off("keyup",_keyUpHandler)}},250)};_toggleMenuClickHandler=function(evt){if(!$.contains($menu.get(0),evt.target)){_toggleMenu();evt.preventDefault()}};$trigger.on("click",_toggleMenuClickHandler);scope.$on("$destroy",function(){$trigger.off("click touchend",_toggleMenuClickHandler)})}}}]);appDirectives.directive("equalHeight",[function(){"use strict";return{restrict:"A",scope:{model:"&equalHeightModel"},link:function(scope,element,attrs){if(angular.isDefined(attrs.equalHeight)&&angular.isDefined(attrs.equalHeightModel)&&angular.isDefined(attrs.equalHeightTarget)){var $parent=element.parent();var $source=$("."+attrs.equalHeight,$parent);var unwatchEqualHeight=scope.$watch(function(){return scope.model()},function(){var $table=$("."+attrs.equalHeightTable,element);var $target=$("."+attrs.equalHeightTarget,element);var height=0;if(angular.isDefined(attrs.equalHeightSubtract)){var classes=attrs.equalHeightSubtract.split(",");var length=classes.length;var i;for(i=0;i<length;++i){height-=$("."+classes[i],element).outerHeight()}}height-=parseInt($table.css("margin-top"),10);height-=parseInt($table.css("margin-bottom"),10);height+=$source.height();$target.css({height:height})});scope.$on("$destroy",function(){unwatchEqualHeight()})}else{console.log('equalHeightDirective needs attributes equal-height="element\'s class name" and equal-height-model="model to observe"')}}}}]);appDirectives.directive("navBar",[function(){"use strict";return{restrict:"A",link:function(scope,element){var getElTotalWidth=function($el){var originalEl=$el.get(0);var computedStyle=window.getComputedStyle(originalEl);var width=Math.ceil(parseFloat(originalEl.getBoundingClientRect().width));return Math.ceil(parseFloat(computedStyle.marginLeft))+width+Math.ceil(parseFloat(computedStyle.marginRight))};var $navBar=element;var $navBarItems=$("> li:not(.s1-popup-button,.s1-popup-button-small)",$navBar);var $popupButton=$(".s1-popup-button,.s1-popup-button-small",$navBar);var $popupButtonMenu=$(".s1-popup-button-menu,.s1-popup-button-menu-small",$popupButton);var $popupButtonMenuItems=$("> li",$popupButtonMenu);var availableWidth=$navBar.width()-getElTotalWidth($popupButton);var availableWidthExceeded=false;var usedWidth=0;var popupButtonMenuItemCount=$popupButtonMenuItems.length;var popupButtonMenuEmpty=popupButtonMenuItemCount<1;var popupButtonActive=$popupButton.hasClass("active");var navItemsToMove=[];var calculateNavigation=function(){$navBarItems.each(function(){var $this=$(this);if(!availableWidthExceeded){usedWidth+=getElTotalWidth($this);if(usedWidth>availableWidth){availableWidthExceeded=true}}if(availableWidthExceeded){if(0===$navBar.data("level")){$this.remove()}else{navItemsToMove.push($this)}popupButtonMenuItemCount++;if(!popupButtonActive&&$this.hasClass("active")){$popupButton.addClass("active");popupButtonActive=true}}});if(popupButtonMenuEmpty){$popupButtonMenu.append(navItemsToMove)}else{$popupButtonMenuItems.first().before(navItemsToMove)}if(0===popupButtonMenuItemCount){$popupButton.remove()}else if(1===popupButtonMenuItemCount){$popupButtonMenu.addClass("s1-single-column-width")}$navBar.css({overflow:"visible"})};scope.$watch(function(){var calculatedWidth=0;$navBarItems.each(function(){calculatedWidth+=getElTotalWidth($(this))});return calculatedWidth},function(){availableWidthExceeded=false;usedWidth=0;calculateNavigation()})}}}]);appDirectives.directive("progressBar",[function(){"use strict";return{restrict:"E",replace:false,scope:{progressBarValue:"="},template:'<div class="s1-track"><div class="s1-bar"></div></div>',link:function(scope,element){var $track=$(".s1-track",element);var unwatchValue=scope.$watch("progressBarValue",function(newValue){if(!isNaN(newValue)){var totalWidth=element.width();$track.css({width:Math.round(newValue*totalWidth)})}});scope.$on("$destroy",function(){unwatchValue()})}}}]);appDirectives.directive("progressBarMobileStyle",[function(){"use strict";return{restrict:"E",replace:true,scope:{progressBarValue:"&"},template:"<div>"+'<div class="s1-track-right"></div>'+'<div class="s1-track-left">'+'<div class="s1-bar"></div>'+"</div>"+"</div>",link:function(scope,element){var $track=$(".s1-track-right",element);var $track2=$(".s1-track-left",element);var unwatchValue=scope.$watch(function(){return scope.progressBarValue()},function(newValue){if(!isNaN(newValue)){var totalWidth=element.width();var width=Math.round(newValue*totalWidth);$track.css({width:totalWidth-width});$track2.css({width:width})}});var unwatchSizeUpdate=scope.$watch(function(){return element[0].offsetWidth},function(totalWidth){var progressBarValue=scope.progressBarValue();if(!isNaN(progressBarValue)){var width=Math.round(progressBarValue*totalWidth);$track.css({width:totalWidth-width});$track2.css({width:width})}});scope.$on("$destroy",function(){unwatchValue();unwatchSizeUpdate()})}}}]);appDirectives.directive("goStart",function(){"use strict";return{restrict:"E",template:'<div class="redirect-loader">'+"<div id=\"goToLandingPage\" class=\"indicator\" ng-class=\"{'ampel0': ampel == 0, 'ampel1': ampel == 1, 'ampel2': ampel == 2, 'ampel3': ampel == 3}\">"+"</div>"+'<div class="text">'+'<a id="articleToStartLink" href="#">zur<br>Startseite</a>'+'<div class="arrow-grey-down"></div>'+"</div>"+"</div>"+'<div id="forceGoToStart">'+'<div id="superTeaserPreview">'+'<a href="" class="s1-teaser-slider-prev" title="Zurück">Zurück</a>'+'<figure class="s1-icon-none">'+'<img src="" id="superTeaserPreviewImg" width="1040" height="423" onerror="this.onerror=null;this.src=\'http://assets.sport1.de/imagix/filter2/jpeg/_set=super_teaser/bundles/sport1portal/images/fallback/generic.jpg\';">'+'<figcaption class="s1-figcaption-on-top">'+'<div class="s1-title">{{previewTeaserTitle}}</div>{{previewTeaserHeadline}}'+"</figcaption>"+"</figure>"+'<a href="" class="s1-teaser-slider-next" title="Weiter">Weiter</a>'+"</div>"+"</div>",link:function(scope){function bindScroll(){var pos=$(window).scrollTop()+$(window).height();var docHeight=$(document).height();if(pos>=docHeight-560){angular.element(".s1-anchor-to-top").fadeOut()}else{angular.element(".s1-anchor-to-top").fadeIn()}if(pos<=docHeight-401){scope.ampel=0}else if(pos>docHeight-400&&pos<docHeight-250){scope.ampel=1;if(!angular.element("#forceGoToStart :first-child").hasClass("clonedHeader")){angular.element(".s1-main-header").clone().addClass("clonedHeader").prependTo("#forceGoToStart");var clonedHeader=angular.element(".clonedHeader");clonedHeader.attr("id","clonedHeader");clonedHeader.find(".s1-navigation-level0").find(".active").removeClass("active");$.getJSON("http://"+window.location.host+"/home.json",function(data){var firstArticle=data.elements[0].elements[0];var teaserTitle=firstArticle.teaser_title;var teaserHeadline=firstArticle.teaser_headline;var mainImageUrl=firstArticle.main_image.path;scope.previewTeaserTitle=teaserTitle;scope.previewTeaserHeadline=teaserHeadline;mainImageUrl=mainImageUrl.replace("dyn_size","super_teaser");angular.element("#superTeaserPreviewImg").attr("src",mainImageUrl)});angular.element("#superTeaserPreview").show()}}else if(pos>=docHeight-249&&pos<docHeight-100){scope.ampel=2;scope.enableHomeRedirect=true}else if(pos>=docHeight-99&&pos<docHeight-1){scope.ampel=3}else if(pos>docHeight-1){if(scope.enableHomeRedirect===true){scope.enableHomeRedirect=false;window.location="http://"+window.location.host}else{window.scrollTo(0,0)}}scope.$apply()}$(window).scroll(bindScroll)}}});appDirectives.directive("scrollView",[function(){"use strict";return{restrict:"E",transclude:true,template:'<div class="s1-scroll-content">'+'<div class="s1-scroll-area" ng-transclude></div>'+"</div>"+'<div class="s1-scroll-track">'+'<div class="s1-scroll-bar"></div>'+"</div>",link:function(scope,element){var scrollView=element.sport1ScrollView({});scope.$on("$destroy",function(){scrollView.destroy()})}}}]);appDirectives.directive("searchBar",["$templateRequest","$compile",function($templateRequest,$compile){"use strict";return{restrict:"A",link:function(scope,element){var template="desktop/angularjs/directives/templates/search-bar.html";function clickHandler(){element.off("click",clickHandler);$templateRequest(template).then(function(html){var parent=element.parent();parent.empty();parent.html(html);$compile(parent.contents())(scope);parent.find(".searchInputBox").focus()})}element.on("click",clickHandler)}}}]);appDirectives.directive("superLead",[function(){"use strict";return{restrict:"A",controller:"SuperLeadAppCtrl",link:function(scope,element){var _itemSelector=".s1-super-lead-teaser-list-item";scope.teasers=$(_itemSelector,element);var _interval=-1;var _animationInterval=6e3;function _displayNext(){if(!scope.userInteraction){scope.$apply(function(){scope.selectedIndex=scope.selectedIndex<scope.teasers.length-1?scope.selectedIndex+1:0})}}function _startAutoAnimation(){if(-1===_interval&&0<_animationInterval){_interval=setInterval(_displayNext,_animationInterval)}}function _stopAutoAnimation(){if(-1!==_interval){clearInterval(_interval);_interval=-1}}function _mouseleaveHandler(){_startAutoAnimation()}function _mouseenterHandler(){_stopAutoAnimation()}function _pauseEvent(){_animationInterval=0;_stopAutoAnimation()}var unwatchSelectedIndex=scope.$watch("selectedIndex",function(){if(_animationInterval===0){_animationInterval=6e3;_startAutoAnimation();element.trigger("restartTabAnimation")}});if(scope.teasers&&0<scope.teasers.length){_startAutoAnimation();element.on("mouseenter",_mouseenterHandler);element.on("mouseleave",_mouseleaveHandler);element.on("pause",_pauseEvent)}scope.$on("$destroy",function(){unwatchSelectedIndex();if(scope.teasers&&0<scope.teasers.length){element.off("mouseenter",_mouseenterHandler);element.off("mouseleave",_mouseleaveHandler);element.off("pause",_pauseEvent)}})}}}]);appDirectives.directive("tabBar",[function(){"use strict";return{restrict:"E",replace:true,scope:{tabs:"=",selected:"=",cssClass:"@tabBarClass"},template:'<ul class="s1-tabbar [[cssClass]]" role="tablist">'+'<li ng-repeat="tab in tabs" role="presentation" ng-class="{ \'active\': selected === tab, \'disabled\': !tab.enabled }">'+'<h2><a ng-class="{\'active\': selected === tab, \'disabled\': !tab.enabled }" href="#" ng-click="selectTab($event, tab)" role="tab">[[tab.title]]</a></h2>'+"</li>"+"</ul>",link:function(scope){scope.selectTab=function($event,item){scope.selected=item;if(item&&location.search.match(/match-id=(\d+)/)!==null){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"ga_event",eventCategory:"Ticker",eventLabel:location.pathname+"/"+location.search.match(/match-id=(\d+)/)[1]+"/"+item.path,eventAction:"selectTab"})}$event.preventDefault()}}}}]);(function(){"use strict";var lastTime=0;var vendors=["webkit","moz"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(id){clearTimeout(id)}})();appDirectives.directive("videoBandNavigator",["$document",function($document){"use strict";return{restrict:"A",replace:false,transclude:true,scope:true,template:'              <div ng-mouseup="startScrollLeft()" class="band-navigator left" ng-hide="stickyLeft"></div>              <div ng-mouseup="startScrollRight()" class="band-navigator right" ng-hide="stickyRight"></div>              <div class="band-navigator-contents" ng-transclude ng-scroll="updateScrollHandles"></div>',link:function(scope,element){element.css("position","relative");var scrollingContainer=element.children()[2];var scrollWidth=jQuery(scrollingContainer).width();var scrollStep=scrollWidth+7,keepgoing=false,rafId=-1;scope.stickyLeft=true;scope.stickyRight=false;var rightBorderReached,leftBorderReached;var updateScrollHandles=function(){$(scrollingContainer).find("img:in-viewport:not([src])").lazyload({container:$(scrollingContainer),skip_invisible:true});leftBorderReached=scope.leftBorderReached();rightBorderReached=scope.rightBorderReached();if(rightBorderReached&&!scope.stickyRight){scope.stickyRight=true}else if(!rightBorderReached&&scope.stickyRight){scope.stickyRight=false}if(leftBorderReached&&!scope.stickyLeft){scope.stickyLeft=true}else if(!leftBorderReached&&scope.stickyLeft){scope.stickyLeft=false}};$document.on("mouseup",function(){keepgoing=false});var scroll=function(direction){$(scrollingContainer).animate({scrollLeft:"+="+direction},scrollWidth);updateScrollHandles()};var animatedScroll=function(direction){if(keepgoing){rafId=window.requestAnimationFrame(animatedScroll.bind(this,direction));scroll(direction)}else{window.cancelAnimationFrame(rafId)}};angular.element(scrollingContainer).on("scroll",function(){scope.$apply(function(){updateScrollHandles()})});scope.startScrollLeft=function(){keepgoing=true;animatedScroll(-1*scrollStep)};scope.startScrollRight=function(){keepgoing=true;animatedScroll(scrollStep)};scope.stopScroll=function(){keepgoing=false};scope.leftBorderReached=function(){return scrollingContainer.scrollLeft===0};scope.rightBorderReached=function(){return scrollingContainer.scrollLeft+scrollingContainer.offsetWidth>=scrollingContainer.scrollWidth}}}}]);appDirectives.directive("schedule",function(){"use strict";return{require:["^^scheduleElement "],restrict:"E",templateUrl:"desktop/angularjs/directives/fmplayer/templates/schedule.html",controller:["$scope","$interval","scheduleService","scheduleLiveModeService","fmPopUpPlayerAdService",function($scope,$interval,scheduleService,scheduleLiveModeService,fmPopUpPlayerAdService){$scope.scheduleElements=[];$scope.liveFMMatches=[];$scope.activeEPGElement=null;$scope.isLiveModeActive=false;$scope.liveSoccerCompetition=null;$scope.isDTMLive=false;$scope.sportFilter="soccer";$scope.activeSportData={sportId:null,coId:null};var UPDATE_INTERVAL=6e4;var updateIntervalPromise=null;var SOCCER="1";var DTM="42";$scope.$watchCollection("activeSportData",function handleActiveSportDataChange(newValue,oldValue){if(newValue!==oldValue){fmPopUpPlayerAdService.reloadAd($scope.activeSportData.coId,$scope.activeSportData.sportId,true)}});var checkForLiveMode=function(){$scope.activeEPGElement=scheduleService.getActiveEpgElement();$scope.isLiveModeActive=scheduleLiveModeService.meetsScheduleLiveSoccerViewRequirements();$scope.liveSoccerCompetition=scheduleLiveModeService.getLiveCompetitionBySportId(SOCCER);$scope.isDTMLive=scheduleLiveModeService.isDTMLive();$scope.liveFMMatches=scheduleService.getLiveMatches();if($scope.sportFilter==="soccer"){$scope.activeSportData.sportId=SOCCER;$scope.activeSportData.coId=$scope.liveSoccerCompetition?$scope.liveSoccerCompetition.coId:null}else if($scope.sportFilter==="dtm"){$scope.activeSportData.sportId=DTM;$scope.activeSportData.coId=null}if($scope.isLiveModeActive&&!$scope.selectedMatch.id||$scope.selectedMatch.type==="epg"&&$scope.selectedMatch.scheduleStatus==="isInPast"||!$scope.isLiveModeActive&&$scope.sportFilter==="soccer"&&$scope.selectedMatch!==$scope.activeEpgElement){$scope.apCtrl.selectLiveGame($scope.activeEPGElement,false)}if($scope.sportFilter==="dtm"&&!$scope.isDTMLive){$scope.selectSportView("soccer")}if($scope.selectedMatch){$scope.apCtrl.selectLiveGame($scope.selectedMatch,false)}};var updateSchedule=function(){function isNewDay(){var lastScheduleElement=null;if($scope.scheduleElements&&$scope.scheduleElements.length){lastScheduleElement=$scope.scheduleElements[$scope.scheduleElements.length-1]}return lastScheduleElement&&lastScheduleElement.scheduleStatus==="isInPast"}scheduleService.update().then(function(){if(isNewDay()){scheduleService.getSchedule().then(function(scheduleElements){$scope.scheduleElements=scheduleElements;checkForLiveMode()})}else{checkForLiveMode()}})};scheduleService.getSchedule().then(function(scheduleElements){var queryMap=Sport1Tools.getQueryParamsMap();$scope.scheduleElements=scheduleElements;checkForLiveMode();if($scope.isDTMLive&&queryMap.hasOwnProperty("sport")&&queryMap.sport==="dtm"){$scope.selectSportView("dtm")}updateIntervalPromise=$interval(updateSchedule,UPDATE_INTERVAL)});$scope.getPlayableElement=function(){return $scope.selectedMatch&&$scope.selectedMatch.scheduleStatus==="isLive"&&$scope.selectedMatch.streamUrl?$scope.selectedMatch:$scope.activeEPGElement};$scope.onElementSelected=function(element){$scope.apCtrl.selectLiveGame(element,true)};$scope.selectSportView=function(sport){if(sport&&sport!==$scope.sportFilter){$scope.sportFilter=sport;if(sport==="soccer"){$scope.activeSportData.sportId=SOCCER;$scope.activeSportData.coId=$scope.liveSoccerCompetition?$scope.liveSoccerCompetition.coId:null;$scope.apCtrl.selectLiveGame($scope.activeEPGElement,true)}else if(sport==="dtm"&&$scope.isDTMLive){$scope.activeSportData.sportId=DTM;$scope.activeSportData.coId=null;$scope.apCtrl.selectLiveGame(scheduleService.getFirstLiveMatchBySportId(DTM),true)}}}}]}});appDirectives.directive("popover",["$templateCache","$document","$compile","$position","$timeout",function($templateCache,$document,$compile,$position,$timeout){"use strict";var templateUrl="desktop/angularjs/directives/popover/popover.html";var forcePopover=false;var positionPopover=function(popover,top,left){popover.css({top:top+"px",left:left+"px"})};var hidePopover=function(popover){popover.off("mouseleave mouseenter");popover.placeholder.replaceWith(popover);popover.placeholder=null;popover.removeClass("visible");popover.shown=false};var showPopover=function(popover,element,relativePositioning){popover.addClass("visible");var parentElement=element;var parentWidth=parentElement[0].offsetWidth;var parentOffset=$position.offset(parentElement);var popoverWidth=popover[0].offsetWidth;var popoverPosition=parentOffset.left+parentWidth+popoverWidth;if(popoverPosition<parentElement.parent()[0].offsetWidth){popover.addClass("popover-right");popover.removeClass("popover-left");positionPopover(popover,parentOffset.top+relativePositioning.relativeTop,parentOffset.left+parentWidth+relativePositioning.relativeLeft)}else{popover.addClass("popover-left");popover.removeClass("popover-right");positionPopover(popover,parentOffset.top+relativePositioning.relativeTop,parentOffset.left-popoverWidth-relativePositioning.relativeRight)}popover.one("mouseenter",function(){forcePopover=true;popover.one("mouseleave",function(){forcePopover=false;hidePopover(popover)})})};return{restrict:"EA",replace:true,transclude:true,templateUrl:templateUrl,link:function(scope,element,attrs){var body=$document.find("body");var relativePositioning={relativeLeft:0,relativeTop:0,relativeRight:0,relativeBottom:0};for(var relativePosition in relativePositioning){if(attrs[relativePosition]){relativePositioning[relativePosition]=parseInt(attrs[relativePosition],10)}}element.shown=false;var placeholder=null;var parentElement=element.parent();parentElement.on("mouseover",function(){if(!element.shown){scope.$apply(function(){element.shown=true});placeholder=angular.element('<div class="s1-popover-placeholder"></div>');element.after(placeholder);element.placeholder=placeholder;body.append(element);showPopover(element,parentElement,relativePositioning);parentElement.on("mouseleave",function(){$timeout(function(){if(!forcePopover){hidePopover(element)}});parentElement.off("mouseleave")})}});scope.$watch(function(){return element.shown},function(newVal,oldVal){if(newVal!==oldVal){scope.hovered=newVal}})}}}]);appFilters.filter("timerLabel",[function(){"use strict";return function(dateInMilliseconds){var second=1*1e3;var minute=1*60*1e3;var hour=1*60*60*1e3;var day=24*60*60*1e3;var label="";var value;if(!isNaN(dateInMilliseconds)){if(dateInMilliseconds<minute){value=Math.floor(dateInMilliseconds/second);label="vor "+value+" Sek"}else if(dateInMilliseconds<hour){var seconds;value=Math.floor(dateInMilliseconds/minute);seconds=Math.floor((dateInMilliseconds-value*minute)/second);label="vor "+value+" Min "+seconds+" Sek"}else if(dateInMilliseconds<day){var minutes;value=Math.floor(dateInMilliseconds/hour);minutes=Math.floor((dateInMilliseconds-value*hour)/minute);label="vor "+value+" Std "+minutes+" Min"}else{var hours;value=Math.floor(dateInMilliseconds/day);hours=Math.floor((dateInMilliseconds-value*day)/hour);label="vor "+value+" Tagen "+hours+" Std"}}return label}}]);appFilters.filter("scheduleFilter",["scheduleLiveModeService",function(scheduleLiveModeService){"use strict";function getEpgOnly(scheduleElements){var result=scheduleElements.filter(function(scheduleElement){return scheduleElement.type==="epg"&&scheduleElement.scheduleStatus!=="isInPast"});return result}function filterSchedule(scheduleElements,sport){var result=scheduleElements;if(scheduleElements&&scheduleElements instanceof Array){if(sport&&sport==="dtm"){result=scheduleLiveModeService.getDTMLiveViewElements(scheduleElements)}else if(scheduleLiveModeService.meetsScheduleLiveSoccerViewRequirements()){result=scheduleLiveModeService.getSoccerLiveViewElements(scheduleElements)}else{result=getEpgOnly(scheduleElements)}}return result}return function(scheduleElements,sport){return filterSchedule(scheduleElements,sport)}}]);appServices.service("scheduleLiveModeService",["scheduleService",function(scheduleService){"use strict";var epgTitlesWhichTriggerLiveView=["2. Bundesliga LIVE","Zweitligakonferenz LIVE","Bundesliga LIVE","Bundesligakonferenz LIVE","DFB Pokal LIVE","DFB-Pokal LIVE","DFB-Pokal-Konferenz LIVE","Europa League LIVE","Europa-League-Konferenz LIVE","Champions League LIVE","Champions-League-Konferenz LIVE","Nationalmannschaft LIVE","Die Nachspielzeit","Ehrenrunde","Supercup LIVE","UEFA EURO 2016 LIVE"];var liveSportIds=null,activeEpgElement=null,SOCCER="1",DTM="42";this.meetsScheduleLiveSoccerViewRequirements=function(){liveSportIds=scheduleService.getLiveSportIds();activeEpgElement=scheduleService.getActiveEpgElement();return activeEpgElement&&epgTitlesWhichTriggerLiveView.indexOf(activeEpgElement.title)!==-1||liveSportIds.length&&liveSportIds.indexOf(SOCCER)!==-1};this.getSoccerLiveViewElements=function(scheduleElements){var lastApprovedElement=null;var result=scheduleElements.filter(function(scheduleElement){var result=scheduleElement.type==="epg"&&scheduleElement.scheduleStatus!=="isInPast"&&epgTitlesWhichTriggerLiveView.indexOf(scheduleElement.title)!==-1||scheduleElement.type==="match"&&scheduleElement.sportId===SOCCER||scheduleElement.type==="headline"&&scheduleElement.baseElement&&scheduleElement.baseElement.sportId===SOCCER&&!(scheduleElement.type==="headline"&&lastApprovedElement&&lastApprovedElement.type==="headline"&&scheduleElement.coId===lastApprovedElement.coId);if(result){lastApprovedElement=scheduleElement}return result});return result};this.getDTMLiveViewElements=function(scheduleElements){var result=scheduleElements.filter(function(scheduleElement){return scheduleElement.type==="match"&&scheduleElement.sportId===DTM||scheduleElement.type==="headline"&&scheduleElement.baseElement&&scheduleElement.baseElement.sportId===DTM});return result};this.getLiveCompetitionBySportId=function(sportId){var result=null;var activeEpgCoId=activeEpgElement?activeEpgElement.coId:undefined;if(activeEpgCoId&&sportId===SOCCER){result=scheduleService.getCompetionById(activeEpgCoId);if(result){result.title=result.name;if(result.matchday&&result.matchday.length){result.title+=" - "+result.matchday}}}return result};this.isDTMLive=function(){return liveSportIds&&liveSportIds.indexOf(DTM)!==-1}}]);angular.module("sport1.templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/angularjs/apps/audio-player/templates/highlights.html",'<s1-spinner s1-visible="apCtrl.app.highlights.loading"></s1-spinner><fm-highlights ng-if="!apCtrl.app.highlights.loading" ng-init="fmHighlightsCtrl.initVars(apCtrl.fmHighlightsData)"></fm-highlights>');$templateCache.put("common/angularjs/apps/audio-player/templates/lineup.html",'<s1-spinner s1-visible="apCtrl.app.lineup.loading"></s1-spinner><scroll-view class="s1-scroll-view"><div ng-hide="apCtrl.app.lineup.loading" class="s1-audio-player-setup" ng-cloak><div class="s1-audio-player-field"><div class="s1-audio-player-team-setup"><div class="s1-audio-player-team-setup-header"><div class="s1-team-logo"> <img ng-src="[[apCtrl.teams.home.logo]]" ng-attr-alt="Vereinslogo von [[apCtrl.teams.home.name]]"/></div><div class="s1-team-name" ng-bind="apCtrl.teams.home.name"></div><div class="s1-strategy" ng-bind="apCtrl.teams.home.strategy"></div></div><div class="s1-audio-player-field-players"><div class="s1-audio-player-canvas-players"><soccer-player ng-repeat="player in apCtrl.teams.home.lineup | orderBy:\'_sortId\'" player="player" anchor-target="_blank" class="s1-audio-player-field-player"></soccer-player></div></div></div><div class="s1-audio-player-team-setup s1-bottom"><div class="s1-audio-player-team-setup-header"><div class="s1-strategy" ng-bind="apCtrl.teams.away.strategy"></div><div class="s1-team-name" ng-bind="apCtrl.teams.away.name"></div><div class="s1-team-logo"> <img ng-src="[[apCtrl.teams.away.logo]]" ng-attr-alt="Vereinslogo von [[apCtrl.teams.away.name]]"/></div></div><div class="s1-audio-player-field-players s1-bottom"><div class="s1-audio-player-canvas-players"><soccer-player ng-repeat="player in apCtrl.teams.away.lineup | orderBy:\'_sortId\':true" player="player" anchor-target="_blank" class="s1-audio-player-field-player">></soccer-player></div></div></div></div><div class="s1-home-team"><header class="s1-dashboard-headline"><div class="s1-dashboard-icon"> <img ng-src="[[apCtrl.teams.home.logo]]" ng-attr-alt="Vereinslogo von [[apCtrl.teams.home.name]]"></div><div class="s1-dashboard-channel" ng-bind="apCtrl.teams.home.name"></div></header><soccer-team-list players="apCtrl.teams.home" competition="apCtrl.competition" target="_blank"></soccer-team-list></div><div class="s1-guest-team"><header class="s1-dashboard-headline"><div class="s1-dashboard-icon"> <img ng-src="[[apCtrl.teams.away.logo]]" ng-attr-alt="Vereinslogo von [[apCtrl.teams.away.name]]"></div><div class="s1-dashboard-channel" ng-bind="apCtrl.teams.away.name"></div></header><soccer-team-list players="apCtrl.teams.away" competition="apCtrl.competition" target="_blank"></soccer-team-list></div></div></scroll-view>');$templateCache.put("common/angularjs/apps/audio-player/templates/onair.html","<onair-fm-stream ng-if=\"!isLiveModeActive && sportFilter !== 'dtm'\"></onair-fm-stream><onair-live ng-if=\"(isLiveModeActive || sportFilter === 'dtm') && selectedMatch.type === 'match'\" loading=\"app.onair.loading\"></onair-live><onair-live-si ng-if=\"isLiveModeActive && selectedMatch.type === 'epg'\"></onair-live-si>");$templateCache.put("common/angularjs/apps/audio-player/templates/standings.html",'<div ng-module="genericWidgetApp" ng-controller="MiniStandingsAppCtrl" ng-init="initVars({    competitionId: selectedMatch.coId,    today: selectedMatch.match_date,    roundId: selectedMatch.roundId,    matchdayNo: selectedMatch.match.matchday,    groupmatchdayNo: selectedMatch.match.group_matchday,    toPortal: \'http://www.sport1.de\',    linkTarget: \'_blank\'  })" ng-if="selectedMatch.match.match_date || selectedMatch.isSiElement" ng-cloak class="1-module s1-aside-live-conference  s1-standings" ng-cloak><s1-spinner s1-visible="loading"></s1-spinner><scroll-view class="s1-scroll-view"><div ng-hide="loading" class="s1-api-view-content"></div></scroll-view></div>');
$templateCache.put("common/angularjs/apps/audio-player/templates/statistics-audio.html",'<s1-spinner s1-visible="loading"></s1-spinner><div ng-hide="loading" class="s1-audio-player-statistics" ng-class="{\'s1-live\': true}"><div class="s1-table s1-audio-player-statistics-table"><div class="s1-table-body s1-even"><div ng-repeat="statistic in statistics" class="s1-table-row"><span class="s1-value-left" ng-class="{ \'s1-highlighted\': statistic.is_home_winner }" ng-bind="statistic.home"></span><b ng-bind="statistic.name | statisticKeyToLabel : statistic.name"></b><span class="s1-value-right" ng-class="{ \'s1-highlighted\': statistic.is_away_winner }" ng-bind="statistic.away"></span><progress-bar-mobile-style class="s1-progress-bar" ng-class="{                      \'s1-highlighted-left\': statistic.is_home_winner,                      \'s1-highlighted-right\': statistic.is_away_winner                    }" progress-bar-value="1 - statistic.away_ratio"></progress-bar-mobile-style></div></div></div></div>');$templateCache.put("common/angularjs/apps/audio-player/templates/statistics.html",'<scroll-view class="s1-scroll-view"><header class="s1-audio-player-statistics-header" ng-class="{\'s1-live\': selectedMatch.scheduleStatus === \'isLive\'}"><div class="s1-game-time"><span ng-if="false && +selectedMatch.match.current_minute" ng-bind="selectedMatch.match.current_minute  + \'. Min\'"></span> <span class="s1-game-over" ng-if="selectedMatch.match.finished === \'yes\'">Spiel beendet •</span> <span class="s1-game-runs" ng-if="selectedMatch.scheduleStatus === \'isLive\'">Spiel läuft •</span><span class="s1-game-runs" ng-if="selectedMatch.scheduleStatus === \'isInFuture\' && selectedMatch.match_time !== \'unknown\'" ng-bind="\'Spiel beginnt um \' + selectedMatch.match.match_time"></span></div><div class="s1-game-score"><div ng-bind="selectedMatch.match._result.home +  \' :  \' + selectedMatch.match._result.away"></div><div class="s1-game-score-incident" ng-if="selectedMatch.match._result.incident" ng-bind="selectedMatch.match._result.incident.short"></div></div> <a ng-href="[[apCtrl.teams.home._link]]" ng-attr-title="[[apCtrl.teams.home._linkTitle]]" class="s1-home-team-logo"><img ng-src="[[apCtrl.teams.home.logo]]" ng-attr-alt="Vereinslogo von [[apCtrl.teams.home.name]]"/></a> <a ng-href="[[apCtrl.teams.away._link]]" ng-attr-title="[[apCtrl.teams.away._linkTitle]]" class="s1-guest-team-logo"><img ng-src="[[apCtrl.teams.away.logo]]" ng-attr-alt="Vereinslogo von [[apCtrl.teams.away.name]]"/></a><div class="s1-home-team" ng-bind="apCtrl.teams.home.name"></div><div class="s1-guest-team" ng-bind="apCtrl.teams.away.name"></div></header><match-statistics competitionid="[[competition.id]]" sportid="[[competition.sport.id]]" match="selectedMatch.match" template-url="common/angularjs/apps/audio-player/templates/statistics-audio.html"></match-statistics></scroll-view>');$templateCache.put("common/angularjs/apps/audio-player/templates/telegram.html",'<div class="s1-audio-player-telegram"><scroll-view class="s1-scroll-view s1-audioplayer-scrollview"><div class="s1-flash-container"></div><liveticker competition="competition" match="selectedMatch.match" loading="apCtrl.app.stats.loading" telegram="true"></liveticker></scroll-view></div>');$templateCache.put("common/angularjs/apps/generic-widget/templates/live-conference-ticker/gameplan.html",'<div class="s1-content" role="content"><div ng-module="genericWidgetApp" ng-controller="MiniMatchdayAppCtrl" ng-init="initVars({          competitionId: $parent.competition.id,          today: $parent.today,          roundId: $parent.competition.current_round_id,          matchdayNo: $parent.competition.current_matchday,          groupmatchdayNo: $parent.groupMatchdayId      })" ng-if="$parent.competition.id && $parent.groupMatchdayId" widget-layout="conference" class="s1-module s1-aside-live-conference s1-gameplan" ng-cloak><s1-spinner s1-visible="loading"></s1-spinner><div ng-hide="loading" class="s1-api-view-content"></div></div></div>');$templateCache.put("common/angularjs/apps/generic-widget/templates/live-conference-ticker/standings.html",'<div class="s1-content" role="content"><div ng-module="genericWidgetApp" ng-controller="MiniStandingsAppCtrl" ng-init="initVars({            competitionId: $parent.competition.id,            today: $parent.today,            roundId: $parent.competition.current_round_id,            matchdayNo: $parent.competition.current_matchday,            groupmatchdayNo: $parent.groupMatchdayId      })" ng-if="$parent.competition.id" class="1-module s1-aside-live-conference  s1-standings" ng-cloak><s1-spinner s1-visible="loading"></s1-spinner><div ng-hide="loading" class="s1-api-view-content"></div></div></div>');$templateCache.put("common/angularjs/apps/generic-widget/templates/live-conference-ticker/ticker.html",'<div class="s1-content" role="content"><s1-spinner s1-visible="app.loading"></s1-spinner><div class="s1-flash-container"></div><div ng-if="!app.loading" class="s1-live-ticker-messages" ng-class="{\'s1-live\': matchday._isLive}" infinite-scroll="loadMoreEvents()" infinite-scroll-distance="2" infinite-scroll-disabled="busy"><div class="s1-live-ticker-message" ng-repeat="post in ticker"><div id="s1-som-post-[[post.id]]" class="s1-som-post"></div><div class="s1-game-time">[[post.minute | tickerMinuteFilter]]<div ng-if="post.minuteAddedTime" class="s1-added-game-time">[[post.tickertime | tickerAddedTimeFilter]]</div></div><div class="s1-live-ticker-message-content"><div class="s1-live-ticker-match" ng-class="{\'s1-live\': post.isLive}" ng-if="post.home"> <span class="s1-home-team">[[post.home.name]]</span> <a class="s1-home-team-logo" ng-href="[[post.home._link]]" ng-attr-title="[[post.home._linkTitle]]"><img ng-src="[[post.home.logo]]" alt="Vereinslogo von [[post.home.name]]"/></a> <span class="s1-game-score">[[post._currentScore.home]] : [[post._currentScore.away]]</span> <a class="s1-guest-team-logo" ng-href="[[post.away._link]]" ng-attr-title="[[post.away._linkTitle]]"><img ng-src="[[post.away.logo]]" alt="Vereinslogo von [[post.away.name]]"/></a> <span class="s1-guest-team">[[post.away.name]]</span></div><div class="s1-live-ticker-event-details"><div class="s1-live-ticker-message-icon"> <img ng-if="post._display.eventIcon" ng-src="[[post._display.eventIcon]]" alt="[[post.event.kind]]"/></div><div class="s1-live-ticker-message-text"><div ng-if="post._display.playerImages.second" class="s1-live-ticker-message-player-container" ng-class="{ \'s1-substitute-in\': post._display.playerImages.second }"><div class="s1-live-ticker-message-player-wrapper"><div class="s1-live-ticker-message-player"> <img ng-src="[[post._display.playerImages.second]]"/></div></div></div><div ng-if="post._display.playerImages.main" class="s1-live-ticker-message-player-container" ng-class="{ \'s1-substitute-out\': post._display.playerImages.second }"><div class="s1-live-ticker-message-player-wrapper"><div class="s1-live-ticker-message-player"> <img ng-src="[[post._display.playerImages.main]]"/></div></div></div><div class="s1-live-ticker-message-heading-1">[[post._display.eventHeaderMain]]</div><div class="s1-live-ticker-message-heading-2"><b>[[post._display.eventHeaderSub]]</b> [[post._display.eventHeaderSubAdd]]</div><div class="s1-live-ticker-message-heading-3">[[post._display.eventContent]]</div><div class="s1-live-ticker-message-post-content" ng-if="post.content" ng-bind-html="post.content"></div></div></div></div></div></div><div class="s1-live-ticker-more" ng-if="considerBusyFlag && ticker.length"> <a href="#" class="s1-more" ng-click="setBusy( false )">Mehr anzeigen >></a></div></div><aside class="s1-aside"><div class="s1-aside-live-ticker-related" ng-if="presenting.link && presenting.imageUrl"> <a ng-href="[[ presenting.link ]]" target="_blank" ng-click="gtmTrack(\'click\', presenting.trackingCode);"><img ng-src="[[ presenting.imageUrl ]]" alt=""/></a></div><div ng-module="genericWidgetApp" ng-controller="MiniMatchdayAppCtrl" ng-if="$root.PLATFORM == \'desktop\' && $parent.competition.id && $parent.groupMatchdayId" ng-init="initVars({              competitionId: $parent.competition.id,              today: $parent.today,              roundId: $parent.competition.current_round_id,              matchdayNo: $parent.competition.current_matchday,              groupmatchdayNo: $parent.groupMatchdayId            })" ng-cloak widget-layout="conference" class="s1-module s1-aside-live-conference s1-gameplan"><div class="s1-api-view-content"></div></div><div ng-module="genericWidgetApp" ng-controller="MiniStandingsAppCtrl" ng-if="$root.PLATFORM == \'desktop\' && $parent.competition.id && $parent.displayStandings" ng-init="initVars({              competitionId: $parent.competition.id,              today: $parent.today,              roundId: $parent.competition.current_round_id,              matchdayNo: $parent.competition.current_matchday,              groupmatchdayNo: $parent.groupMatchdayId            })" ng-cloak class="1-module s1-aside-live-conference s1-standings"><div class="s1-api-view-content"></div></div></aside>');$templateCache.put("common/angularjs/apps/live-ticker/templates/gameplan.html",'<div class="s1-content" role="content"><div ng-module="genericWidgetApp" ng-controller="MiniMatchdayAppCtrl" ng-init="initVars({        competitionId: $parent.vm.competition.id,        today: $parent.vm.matchData.match_date,        roundId: $parent.vm.matchData.round_id,        matchdayNo: $parent.vm.matchData.matchday,        groupmatchdayNo: $parent.vm.matchData.group_matchday      })" ng-if="vm.matchData.match_date" widget-layout="conference" class="s1-module s1-aside-live-conference s1-gameplan" ng-cloak><div class="s1-api-view-content"></div></div></div>');$templateCache.put("common/angularjs/apps/live-ticker/templates/standings.html",'<div class="s1-content" role="content"><div ng-module="genericWidgetApp" ng-controller="MiniStandingsAppCtrl" ng-init="initVars({        competitionId: $parent.vm.competition.id,        today: $parent.vm.matchData.match_date,        roundId: $parent.vm.matchData.round_id,        matchdayNo: $parent.vm.matchData.matchday,        groupmatchdayNo: $parent.vm.matchData.group_matchday      })" ng-if="vm.matchData.match_date" class="1-module s1-aside-live-conference  s1-standings" ng-cloak><div class="s1-api-view-content"></div></div></div>');$templateCache.put("common/angularjs/apps/live-ticker/templates/statistics.html",'<match-statistics competitionid="[[vm.competition.id]]" sportid="[[vm.competition.sport.id]]" match="vm.matchData" template-url="common/angularjs/directives/statisticsDirective/statistics-desktop.html"></match-statistics>');$templateCache.put("common/angularjs/apps/live-ticker/templates/ticker.html",'<div class="s1-content" role="content"><s1-spinner s1-visible="app.ticker.loading"></s1-spinner><div class="s1-live-ticker-scorers" ng-if="$root.PLATFORM == \'mobile\' && (vm.teams.home.scorers.length || teams.away.scorers.length)"><ul class="s1-team s1-home-team" ng-class="{ \'s1-bordered\': vm.teams.home.scorers.length>= vm.teams.away.scorers.length }"><li ng-repeat="scorer in vm.teams.home.scorers | orderBy:[\'minute\',\'id\']:false" ng-bind-html="scorer.display"></li></ul><ul class="s1-team s1-away-team" ng-class="{ \'s1-bordered\': vm.teams.away.scorers.length> vm.teams.home.scorers.length }"><li ng-repeat="scorer in vm.teams.away.scorers | orderBy:[\'minute\',\'id\']:false" ng-bind-html="scorer.display"></li></ul></div><div class="s1-live-ticker-scorers" ng-if="$root.PLATFORM == \'mobile\' && (vm.teams.home.scorersPso.length || teams.away.scorersPso.length)"><div class="s1-scorers-penalty" ng-class="{ \'s1-penaltyAfterNoGoals\': vm.teams.away.scorers.length == 0 }">[[ vm.matchData._result.incident.name ]]</div><ul class="s1-team s1-home-team" ng-class="{ \'s1-bordered\': vm.teams.home.scorersPso.length>= vm.teams.away.scorersPso.length }"><li ng-repeat="scorer in vm.teams.home.scorersPso | orderBy:[\'minute\',\'id\']:false" ng-bind-html="scorer.display"></li></ul><ul class="s1-team s1-away-team" ng-class="{ \'s1-bordered\': vm.teams.away.scorersPso.length> vm.teams.home.scorersPso.length }"><li ng-repeat="scorer in vm.teams.away.scorersPso | orderBy:[\'minute\',\'id\']:false" ng-bind-html="scorer.display"></li></ul></div><liveticker competition="vm.competition" match="vm.matchData" loading="vm.app.ticker.loading" telegram="vm.telegram"></liveticker></div><aside class="s1-aside"><div class="s1-aside-live-ticker-related" ng-if="vm.displayAsideLinks"> <a class="s1-half" ng-href="[[vm.conferenceTickerUrl]]" title="Alle Begegnungen im Konferenz-Ticker" ng-if="vm.presenting.link && vm.presenting.imageUrl"><img src="/bundles/sport1portal/images/banner-conference-ticker-160x100.png" alt=""/></a> <a class="s1-half" ng-href="[[vm.presenting.link]]" target="_blank" ng-if="vm.presenting.link && vm.presenting.imageUrl" ng-click="vm.gtmTrack(\'click\', vm.presenting.trackingCode);"><img ng-src="[[vm.presenting.imageUrl]]" alt=""/></a> <a ng-href="[[vm.conferenceTickerUrl]]" title="Alle Begegnungen im Konferenz-Ticker" ng-if="(!vm.presenting.link || !vm.presenting.imageUrl) && vm.displayConfTickerLink"><img src="/bundles/sport1portal/images/banner-conference-ticker-320x100.png" alt=""/></a></div><div ng-if="vm.embedCode" ng-bind-html="vm.embedCode"></div><div ng-module="genericWidgetApp" ng-controller="MiniMatchdayAppCtrl" ng-if="$root.PLATFORM == \'desktop\' && vm.matchData.match_date" ng-init="initVars({ competitionId: $parent.vm.competition.id, today: $parent.vm.matchData.match_date, roundId: $parent.vm.matchData.round_id, matchdayNo: $parent.vm.matchData.matchday, groupmatchdayNo: $parent.vm.matchData.group_matchday })" ng-cloak widget-layout="conference" class="s1-module s1-aside-live-conference s1-gameplan"><div class="s1-api-view-content"></div></div><div ng-module="genericWidgetApp" ng-controller="MiniStandingsAppCtrl" ng-if="$root.PLATFORM == \'desktop\' && vm.matchData.match_date && vm.displayStandings" ng-init="initVars({            competitionId: $parent.vm.competition.id,            today: $parent.vm.matchData.match_date,            roundId: $parent.vm.matchData.round_id,            matchdayNo: $parent.vm.matchData.matchday,            groupmatchdayNo: $parent.vm.matchData.group_matchday            })" ng-cloak class="1-module s1-aside-live-conference s1-standings"><div class="s1-api-view-content"></div></div></aside>');$templateCache.put("common/angularjs/apps/motors-live-ticker/templates/lineup.html",'<header class="s1-live-ticker-header s1-motors-ticker s1-motors-ticker-lineup" ng-class="{\'s1-live\': race.isLive}"><div class="s1-header-top"><div class="s1-race-name">[[raceName]]</div><div class="s1-race-over" ng-if="!race.isLive && !race.isFuture">Rennen beendet •</div><div class="s1-race-runs" ng-if="race.isLive">Rennen läuft •</div></div><div class="s1-live-ticker-standings"><div ng-repeat="driver in positionDrivers" class="s1-driver"><div class="position-information"><span ng-bind="driver.position" class="position"></span></div> <img ng-src="[[driver.carIcon]]" class="car"><div class="driver-information"> <img class="driver-nation" ng-src="[[driver.person.nation.nationIcon]]"> <span class="driver-name">[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</span> <span class="team-name">[[driver.person.teamName]]</span></div></div></div></header><div class="s1-table s1-standings-table s1-motors-formel1-lineup"><div class="s1-table-header"><div class="position">Pl.</div><div class="driver">Fahrer</div></div><div class="s1-table-body"><a ng-repeat="driver in positionDrivers" class="s1-table-row-rank"><div class="position" ng-bind="driver.position"></div><div class="driver"> <img ng-src="[[driver.person.nation.nationIcon]]"> <span>[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</span></div><div class="team" ng-bind="driver.person.teamName"></div></a></div></div>');$templateCache.put("common/angularjs/apps/motors-live-ticker/templates/positions.html",'<header class="s1-live-ticker-header s1-motors-ticker s1-motors-ticker-positions" ng-class="{\'s1-live\': race.isLive}"><div class="s1-header-top"><div class="s1-race-name">[[raceName]]</div><div class="s1-race-over" ng-if="!race.isLive && !race.isFuture">Rennen beendet •</div><div class="s1-race-runs" ng-if="race.isLive">Rennen läuft •</div></div><div class="s1-live-ticker-standings"><div ng-repeat="driver in positionDrivers| limitTo:8" class="s1-driver"><div class="position-information"><span ng-bind="driver.position" class="position"></span><div class="lap-time" ng-bind="driver.lapTime"></div></div> <img ng-src="[[driver.carIcon]]" class="car"><div class="driver-information"> <img class="driver-nation" ng-src="[[driver.person.nation.nationIcon]]"> <span class="driver-name">[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</span> <span class="team-name">[[driver.person.teamName]]</span></div></div></div></header><div class="s1-table s1-standings-table s1-motors-formel1-rankings s1-motors-live-ticker-points"><div class="s1-table-header"><div class="position">Rang</div><div class="driver">Fahrer</div><div class="team">Rennstall</div><div class="stopps">Boxenstopps</div><div class="rounds">Rnd.</div><div class="time">Zeit</div><div class="points">Pkt.</div></div><div class="s1-table-body"><a ng-repeat="driver in positionDrivers" class="s1-table-row-rank"><div class="position" ng-bind="driver.position"></div><div class="driver"> <img ng-src="[[driver.person.nation.nationIcon]]"> <span>[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</span></div><div class="team" ng-bind="driver.person.teamName"></div><div class="stopps" ng-bind="driver.stopps"></div><div class="rounds" ng-bind="driver.rounds"></div><div class="time" ng-bind-template="[[driver.lapTime| date:\'H:m:s,sss\']] "></div><div class="points" ng-bind="driver.points"></div></a></div></div><div class="s1-motors-qualify-header">Qualifying</div><div class="s1-motors-qualify-date">Samstag, 14. Februar 2014</div><div class="s1-table s1-standings-table s1-motors-formel1-rankings qualification s1-motors-live-ticker-points s1-live-ticker-current-standings"><div class="s1-table-header"><div class="position">Startplatz</div><div class="driver">Fahrer</div><div class="team">Rennstall</div><div class="rounds">Rnd.</div><div class="time">Zeit</div></div><div class="s1-table-body"><a ng-repeat="driver in positionDrivers" class="s1-table-row-rank"><div class="position" ng-bind="driver.position"></div><div class="driver"> <img ng-src="[[driver.person.nation.nationIcon]]"> [[driver.person.personNameFirst]] [[driver.person.personNameLast]]</div><div class="team" ng-bind="driver.person.teamName"></div><div class="rounds" ng-bind="driver.rounds"></div><div class="time" ng-bind-template="[[driver.lapTime| date:\'H:m:s,sss\']] "></div></a></div></div>');$templateCache.put("common/angularjs/apps/motors-live-ticker/templates/ticker.html",'<header class="s1-live-ticker-header s1-motors-ticker" ng-class="{\'s1-live\': race.isLive}"><div class="s1-header-top"><div class="s1-race-name">[[race.circuit.circuitName]]</div> <time class="s1-race-time" datetime="[[race.startTime]]">[[race.startTime | date: \'EEE, dd. MMMM yyyy\']]</time><div class="s1-race-over" ng-if="!race.isLive && !race.isFuture">Rennen beendet •</div><div class="s1-race-runs" ng-if="race.isLive">Rennen läuft •</div></div><div class="s1-live-ticker-standings"><div ng-repeat="driver in positionDrivers| limitTo:8" class="s1-driver"><div class="position-information"><span ng-bind="driver.position" class="position"></span><div class="lap-time" ng-bind="driver.lapTime"></div></div> <img ng-src="[[driver.carIcon]]" class="car"><div class="driver-information"> <img class="driver-nation" ng-src="[[driver.person.nation.nationIcon]]"> <span class="driver-name">[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</span> <span class="team-name">[[driver.person.teamName]]</span></div></div></div><div class="s1-header-bottom"> <span class="s1-race-round-current">[[race.currentRound]].</span> <span class="s1-race-round-total">Runde von [[race.totalRounds]]</span><div class="s1-race-local"> <span class="s1-race-time"><span class="s1-label">Ortszeit -</span> [[race.localTime | date: \'HH:mm\']]</span> <span class="s1-race-weather"><span class="s1-label">Wetter -</span> [[race.localWeatherConditions.weatherTempCelsius]]°C / [[race.localWeatherConditions.weatherDescr]]</span> <span class="s1-race-conditions"><span class="s1-label">Strecke -</span> [[race.circuit.circuitConditions]]</span></div></div></header><div class="s1-content" role="content"><div class="s1-live-ticker-messages s1-motors-live-ticker" ng-class="{\'s1-live\': race.isLive}"><div class="s1-live-ticker-message" ng-repeat="event in ticker| orderBy : \'sortId\' : true" ng-if="event.display"><div id="s1-som-post-[[event.postId]]" class="s1-som-post"></div><div class="s1-race-round s1-race-round1"><div>[[event.round]].</div></div><div class="s1-live-ticker-message-content1"><div class="s1-live-ticker-event-details2"><div class="s1-live-ticker-message-icon1"> <img ng-if="event.eventIcon" ng-src="[[event.eventIcon]]" alt="[[event.eventType]]"/></div><div class="s1-live-ticker-message-text"><div class="s1-live-ticker-message-heading-1">[[event.heading1]]</div><div class="s1-live-ticker-message-heading-2"><b>[[event.heading2]]</b> [[event.heading2B]]</div><div class="s1-live-ticker-message-heading-3">[[event.textAuto]]</div> [[event.textRed]]</div></div></div></div></div><div class="s1-live-ticker-headline">Qualifying Verlauf</div> <time class="s1-live-ticker-qualifying-date" datetime="[[race.startTime]]">[[race.startTime | date: \'EEEE, dd. MMMM yyyy\']]</time><div class="s1-live-ticker-messages s1-motors-live-ticker" ng-class="{\'s1-live\': race.isLive}"><div class="s1-live-ticker-message" ng-repeat="event in ticker| orderBy : \'sortId\' : true" ng-if="event.display"><div id="s1-som-post-[[event.postId]]" class="s1-som-post"></div><div class="s1-race-round s1-race-round2"><div>[[event.updatedAt | date: \'EEE,dd:MM\']]</div><div>[[event.updatedAt | date: \'hh:mm\']]</div></div><div class="s1-live-ticker-message-content1"><div class="s1-live-ticker-event-details2"><div class="s1-live-ticker-message-icon1"> <img ng-if="event.eventIcon" ng-src="[[event.eventIcon]]" alt="[[event.eventType]]"/></div><div class="s1-live-ticker-message-text"><div class="s1-live-ticker-message-heading-1">[[event.heading1]]</div><div class="s1-live-ticker-message-heading-2"><b>[[event.heading2]]</b> [[event.heading2B]]</div><div class="s1-live-ticker-message-heading-3">[[event.textAuto]]</div> [[event.textRed]]</div></div></div></div></div></div><aside class="s1-aside"><div class="s1-live-ticker-points-header">WM Fahrerwertung</div><div class="s1-table s1-motors-live-ticker-points"><div class="s1-table-header"><div class="position">Pl.</div><div class="driver">Fahrer</div><div class="points">WM-Punkte</div></div><div class="s1-table-body"><a ng-href="#" ng-repeat="driver in positionDrivers" class="s1-table-row-rank"><div class="position" ng-bind="driver.position"></div><div class="driver"> <img ng-src="[[driver.person.nation.nationIcon]]"><div class="driver-name">[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</div></div><div class="driver-points" ng-bind-template="[[driver.points]]"></div><div ng-class="{\'s1-trend-up\':true,\'s1-trend-down\':false,\'s1-trend-none\':false}" class="driver-trend"></div></a></div></div><div class="s1-live-ticker-points-header s1-live-ticker-header-current-state">Aktueller Rennstand</div><div class="s1-table s1-motors-live-ticker-points s1-live-ticker-current-standings"><div class="s1-table-header"><div class="position">Pl.</div><div class="driver">Fahrer</div><div class="time">Zeit</div><div class="box">Box</div></div><div class="s1-table-body"><a ng-href="#" ng-repeat="driver in positionDrivers" class="s1-table-row-rank"><div class="position" ng-bind="driver.position"></div><div class="driver shorter"> <img ng-src="[[driver.person.nation.nationIcon]]"><div class="driver-name">[[driver.person.personNameFirst]] [[driver.person.personNameLast]]</div></div><div class="driver-time" ng-bind-template="[[driver.lapTime | date: \'\']]"></div><div class="driver-box" ng-bind-template="[[2]]"></div></a></div></div></aside>');$templateCache.put("common/angularjs/apps/standings/templates/standingsHA.html",'<div class="s1-table-headline">Heim-Tabelle</div><generic-table table-data="standings.data.home" table-options="standings.options" table-loading="standings.loading"></generic-table><div class="s1-table-headline">Auswärts-Tabelle</div><generic-table table-data="standings.data.away" table-options="standings.options" table-loading="standings.loading"></generic-table>');$templateCache.put("common/angularjs/apps/standings/templates/standingsHR.html",'<div class="s1-table-headline">Hinrunden-Tabelle</div><generic-table table-data="standings.data.firstHalf" table-options="standings.options" table-loading="standings.loading"></generic-table><div class="s1-table-headline">Rückrunden-Tabelle</div><generic-table table-data="standings.data.secondHalf" table-options="standings.options" table-loading="standings.loading"></generic-table>');$templateCache.put("common/angularjs/apps/standings/templates/standings.html",'<generic-table table-data="standings.data.standard" table-options="standings.options" table-loading="standings.loading"></generic-table><div><s1-glossary data="standings.data.standard" options="standings.options"></s1-glossary><div class="s1-standings-additional-links"> <a ng-href="/spielplan/[[competition.id]]" title="[[linkText]] &raquo;" class="s1-link-passive s1-link-underlined">[[linkText]] &raquo;</a></div></div>');$templateCache.put("common/angularjs/directives/articleRecommenderDirectives/recommenderContent.html",'<div><s1-spinner s1-visible="!recommendedArticles"></s1-spinner><ul class="s1-module-content"><li ng-repeat="articleWithSimilarity in recommendedArticles | limitTo: count"><a href="{{ articleWithSimilarity.path }}" class="s1-popular s1-teaser"><div class="s1-recommended-articles-figure-wrapper"><figure class="s1-recommended-article-figure s1-channel-figure s1-icon-{{ articleWithSimilarity.teaser.icon }}"> <img ng-if="articleWithSimilarity.teaser.imageUrlRight" ng-src="{{ articleWithSimilarity.teaser.imageUrlRight }}" alt=""> <img ng-if="articleWithSimilarity.teaser.imageUrlRight==undefined" src="http://assets.sport1.de/imagix/filter2/jpeg/_set=most_read/var/sport1/storage/images/medien/bilder/kommunikation/node_145433/2141819-1-ger-DE/Sport1-generisch.jpg"><figcaption class="s1-figcaption-on-top"> {{ articleWithSimilarity.teaser.headline }}</figcaption></figure></div></a></li></ul></div>');$templateCache.put("common/angularjs/directives/audioPlayerDirectives/fm-highlights.html",'<div class="s1-fm-highlights"><div id="fmHighlightsPlayer"></div><figure class="s1-figure-fm-highlights"> <img ng-src="http://assets.sport1.de/imagix/filter2/jpeg/_set=dyn_size,width=388,height=354,focus=50x0/[[selectedMatch.venue._imageUrl]]"/><figcaption class="s1-figcaption-fm-highlights"><div class="s1-fm-highlights-play-button"> <img ng-if="!fmHighlightsCtrl.playing" src="/bundles/sport1portal/images/icon-video-black.svg"/> <img ng-if="fmHighlightsCtrl.playing" src="/bundles/sport1portal/images/pause_button.svg"/></div><div class="s1-fm-higlights-description">[[fmHighlightsCtrl.highlightData.title]]</div></figcaption></figure></div>');$templateCache.put("common/angularjs/directives/audioPlayerDirectives/onair-24-7.html",'<s1-spinner s1-visible="loading"></s1-spinner><img ng-hide="loading" id="onairImg247" ng-src="[[imgUrl]]"/>');$templateCache.put("common/angularjs/directives/audioPlayerDirectives/onair-live.html",'<s1-spinner s1-visible="loading"></s1-spinner><div ng-show="(isLiveModeActive || sportFilter === \'dtm\' )&& selectedMatch.type !== \'epg\' && !loading" class="s1-onair-live" style="position: relative;"><div ng-show="selectedMatch.sportId === \'1\'"><div class="s1-onair-home-logo"> <img ng-src="[[apCtrl.teams.home.logo]]"></div><div class="s1-onair-away-logo"> <img ng-src="[[apCtrl.teams.away.logo]]"></div><div class="s1-onair-result"> <span>[[selectedMatch.match._result.display]]</span></div><div class="s1-onair-match"> <span>[[selectedMatch.match.home.shortname]] - [[selectedMatch.match.away.shortname]]</span></div><div class="s1-onair-minute" ng-if="(selectedMatch.match.home && selectedMatch.match.current_minute> 0)"> <span>[[selectedMatch.match.current_minute]]. Min</span></div></div><div ng-class="{\'s1-venue-image-cover\': selectedMatch.sportId === \'1\'}"></div><div ng-class="{\'s1-outer-venue-container\': selectedMatch.sportId === \'1\'}"><div ng-class="{\'s1-inner-venue-container\': selectedMatch.sportId === \'1\'}"> <img ng-class="{\'s1-venue-image\': selectedMatch.sportId === \'1\'}" id="venue-image" ng-src="[[venueUrl]]"></div></div></div>');$templateCache.put("common/angularjs/directives/audioPlayerDirectives/onair-live-si.html",'<s1-spinner s1-visible="loading"></s1-spinner><div ng-hide="loading"> <img style="position: absolute"id="onairLiveSiImg" ng-src="[[imageUrl]]"/><div class="s1-onair-cover"></div><div ng-hide="true" class="s1-onair-competition-logo"> <img ng-src="[[$parent.competitionLogo]]"></div><div class="s1-onair-conference-title"> <span>[[title]]</span></div></div>');$templateCache.put("common/angularjs/directives/audioPlayerDirectives/video-preroll-container.html",'<div class="s1-fm-audio-player"><div class="s1-fm-audio-player-container"><div id="fmPrerollPlayer"></div></div></div><div class="s1-video-preroll-cover"></div>');$templateCache.put("common/angularjs/directives/audioPlayerDirectives/volume-button.html",'<span class="s1-audio-player-volume-button"><div ng-show="volumeCtrl.showSlider" class="s1-audio-player-slider-box"><slider class="s1-slider" floor="0" ceiling="100" step="1" precision="1" ng-model="volume"></slider></div></span>');$templateCache.put("common/angularjs/directives/genericTableDirective/body.gameplan.generic.default.html",'<div class="s1-table-body"><div class="s1-table-row-block" bindonce ng-repeat="group in tableData.content" ng-init="initRowCount();"> <time ng-if="$root.PLATFORM == \'mobile\'" datetime="[[group._startTime]]">[[group._startTime | date: \'EEEE dd.MM. HH:mm\']]</time><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && tableDefinition.groupByDate" class="s1-table-header--grouped"></generic-table-header><div class="s1-table-row" bindonce ng-repeat="tableRow in group.matches" ng-class="{            \'s1-live\': tableRow.isLive,            \'s1-table-even\': ($index + 1) % 2 === 0,            \'s1-table-odd\': ($index + 1) % 2 !== 0,            \'s1-table-total-odd\': tableRow._totalIndex % 2 !== 0,            \'s1-table-total-even\': tableRow._totalIndex % 2 === 0          }" ng-init="incRowCount(tableRow);" idx="[[$index]]"><a ng-href="[[tableRow._link]]" ng-attr-title="[[tableRow._linkTitle]]"><generic-table-cells></generic-table-cells></a></div></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/body.gameplan.generic.livetoday.html",'<div class="s1-table-body"><div class="s1-table-row-block" bindonce ng-repeat="group in tableData.content" ng-init="initRowCount();"> <time ng-if="$root.PLATFORM == \'mobile\'" datetime="[[group._startTime]]"><span>[[group.time]]</span> <span ng-if="group._matchday">, [[group._matchday]]</span></time><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && tableDefinition.groupByDate" class="s1-table-header--grouped"></generic-table-header><div class="s1-table-row" bindonce ng-repeat="tableRow in group.matches" ng-class="{            \'s1-live\': tableRow.isLive,            \'s1-table-even\': ($index + 1) % 2 === 0,            \'s1-table-odd\': ($index + 1) % 2 !== 0,            \'s1-table-total-odd\': tableRow._totalIndex % 2 !== 0,            \'s1-table-total-even\': tableRow._totalIndex % 2 === 0,            \'s1-has-details\': tableRow._link          }" ng-init="incRowCount(tableRow);" idx="[[$index]]"><a ng-href="[[tableRow._link]]" ng-attr-title="[[tableRow._linkTitle]]"><generic-table-cells></generic-table-cells></a></div></div></div>');
$templateCache.put("common/angularjs/directives/genericTableDirective/body.gameplan.generic.playoffs.html",'<div class="s1-table-body"><div class="s1-table-row-block" bindonce ng-repeat="group in tableData.content" ng-init="initRowCount();"> <time ng-if="$root.PLATFORM == \'mobile\'" datetime="[[group._startTime]]">[[group._startTime | date: \'EEEE dd.MM. HH:mm\']]</time><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && tableDefinition.groupByDate" class="s1-table-header--grouped"></generic-table-header><div class="s1-table-row" bindonce ng-repeat="tableRow in group.matches" ng-class="{            \'s1-live\': tableRow.isLive,            \'s1-table-even\': ($index + 1) % 2 === 0,            \'s1-table-odd\': ($index + 1) % 2 !== 0,            \'s1-table-total-even\': tableRow._totalIndex % 2 === 0,            \'s1-table-total-odd\': tableRow._totalIndex % 2 !== 0          }" ng-init="incRowCount(tableRow);"><a ng-href="[[toPortal]][[tableRow._link]]" title="Zum Liveticker von [[tableRow.home.name]] gegen [[tableRow.away.name]]"><generic-table-cells></generic-table-cells></a></div></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/body.standings.generic.default.html",'<div class="s1-table-body"><div class="s1-table-row" bindonce ng-repeat="tableRow in tableData.content" ng-class="{\'s1-live\': tableRow.isLive}"><a ng-href="[[toPortal]][[tableRow.team._link]]" ng-attr-title="[[tableRow.team._linkTitle]]"><generic-table-cells></generic-table-cells></a></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/body.standings.generic.widget.html",'<div class="s1-table-body"><div class="s1-table-row" ng-repeat="tableRow in tableData.content" ng-class="{ \'s1-live\': tableRow.isLive }"><a ng-href="[[tableRow.team._link]]" ng-attr-title="[[tableRow.team._linkTitle]]" ng-attr-target="[[options.target]]"><generic-table-cells></generic-table-cells></a></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/header.generic.html",'<div class="s1-table-header"><generic-table-header-cells></generic-table-header-cells></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.division.conferencewidget.html",'<div class="s1-table-body" ng-class="tableClass"><ul role="list"><li class="s1-aside-live-conference-item" bindonce ng-repeat="match in tableData.content" ng-class="{\'s1-live\': match.isLive}" role="listitem" ng-if="match._link" ng-switch="match._hasStarted"><a ng-href="[[match._link]]" ng-attr-title="[[match._linkTitle]]"><div class="s1-home-team-logo"><img ng-src="[[match.home.logo]]" alt="Vereinslogo von [[match.home.name]]"/></div><div class="s1-guest-team-logo"><img ng-src="[[match.away.logo]]" alt="Vereinslogo von [[match.away.name]]"/></div><div class="s1-game-score" ng-switch-when="true">[[match._result.display]]</div><div class="s1-game-start" ng-switch-when="false" ng-if="match.match_date !== \'unknown\' && match.match_time !== \'unknown\'">[[match._isoDate | dateLabel]]<br/>[[match._isoDate | date: \'HH:mm\']]</div><div class="s1-game-start" ng-switch-when="false" ng-if="match.match_date === \'unknown\'|| match.match_time === \'unknown\'">Noch nicht<br/>angesetzt</div></a></li></ul></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.division.default.html",'<div class="s1-table" ng-class="tableClass"><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && !tableDefinition.groupByDate"></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.division.playoffs.html",'<div class="s1-table" ng-class="tableClass" bindonce ng-repeat="tableData in tableData.groups"><div class="s1-table-headline s1-playoff-headline" ng-if="tableData.matches.length> 1"><div class="s1-playoff-headline-teams"><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-home-logo"> <img ng-src="[[tableData.home.logo]]"/></div><div class="s1-playoff-headline-teams-home-name">[[tableData.home.name]]</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-vs">:</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-away-logo"> <img ng-src="[[tableData.away.logo]]"/></div><div class="s1-playoff-headline-teams-away-name">[[tableData.away.name]]</div></div><div class="s1-playoff-headline-score"><div class="s1-playoff-headline-score-home">[[tableData.score.home]]</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-score-vs">:</div><div class="s1-playoff-headline-score-away">[[tableData.score.away]]</div></div></div><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.division.widget.html",'<div class="s1-table-body" ng-class="tableClass"><div class="s1-table-row s1-match" bindonce ng-repeat="tableRow in tableData.content" ng-class="{\'s1-live\': tableRow.isLive}" ng-if="tableRow.home.show_team!==\'no\'"><a ng-href="[[tableRow._link]]" ng-attr-title="[[tableRow._linkTitle]]"><generic-table-cells></generic-table-cells></a></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.league.conferencewidget.html",'<div class="s1-table-body" ng-class="tableClass"><ul role="list"><li class="s1-aside-live-conference-item" bindonce ng-repeat="match in tableData.content" ng-class="{\'s1-live\': match.isLive}" role="listitem" ng-if="match._link" ng-switch="match._hasStarted"><a ng-href="[[match._link]]" ng-attr-title="[[match._linkTitle]]"><div class="s1-home-team-logo"><img ng-src="[[match.home.logo]]" alt="Vereinslogo von [[match.home.name]]"/></div><div class="s1-guest-team-logo"><img ng-src="[[match.away.logo]]" alt="Vereinslogo von [[match.away.name]]"/></div><div class="s1-game-score" ng-switch-when="true">[[match._result.display]]</div><div class="s1-game-start" ng-switch-when="false" ng-if="match.match_date !== \'unknown\' && match.match_time !== \'unknown\'">[[match._isoDate | dateLabel]]<br/>[[match._isoDate | date: \'HH:mm\']]</div><div class="s1-game-start" ng-switch-when="false" ng-if="match.match_date === \'unknown\'|| match.match_time === \'unknown\'">Noch nicht<br/>angesetzt</div></a></li></ul></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.league.default.html",'<div ng-show="!loading" class="s1-table" ng-class="tableClass"><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && !tableDefinition.groupByDate"></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.league.livetoday.html",'<div class="s1-table" ng-class="tableClass"><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && !tableDefinition.groupByDate"></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.league.playoffs.html",'<div class="s1-table" ng-class="tableClass" bindonce ng-repeat="tableData in tableData.groups"><div class="s1-table-headline s1-playoff-headline" ng-if="tableData.matches.length> 1"><div class="s1-playoff-headline-teams"><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-home-logo"> <img ng-src="[[tableData.home.logo]]"/></div><div class="s1-playoff-headline-teams-home-name">[[tableData.home.name]]</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-vs">:</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-away-logo"> <img ng-src="[[tableData.away.logo]]"/></div><div class="s1-playoff-headline-teams-away-name">[[tableData.away.name]]</div></div><div class="s1-playoff-headline-score"><div class="s1-playoff-headline-score-home">[[tableData.score.home]]</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-score-vs">:</div><div class="s1-playoff-headline-score-away">[[tableData.score.away]]</div></div></div><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.league.widget.html",'<div class="s1-table-body" ng-class="tableClass"><div class="s1-table-row s1-match" bindonce ng-repeat="tableRow in tableData.content track by $index" ng-class="{\'s1-live\': tableRow.isLive}"><a ng-href="[[toPortal]][[tableRow._link]]" ng-attr-title="[[tableRow._linkTitle]]"><generic-table-cells></generic-table-cells></a></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.tournament.conferencewidget.html",'<div class="s1-table-body" ng-class="tableClass"><ul role="list"><li class="s1-aside-live-conference-item" bindonce ng-repeat="match in tableData.content" ng-class="{\'s1-live\': match.isLive}" role="listitem" ng-if="match._link" ng-switch="match._hasStarted"><a ng-href="[[match._link]]" ng-attr-title="[[match._linkTitle]]"><div class="s1-home-team-logo"><img ng-src="[[match.home.logo]]" alt="Vereinslogo von [[match.home.name]]"/></div><div class="s1-guest-team-logo"><img ng-src="[[match.away.logo]]" alt="Vereinslogo von [[match.away.name]]"/></div><div class="s1-game-score" ng-switch-when="true">[[match._result.display]]</div><div class="s1-game-start" ng-switch-when="false" ng-if="match.match_date !== \'unknown\' && match.match_time !== \'unknown\'">[[match._isoDate | dateLabel]]<br/>[[match._isoDate | date: \'HH:mm\']]</div><div class="s1-game-start" ng-switch-when="false" ng-if="match.match_date === \'unknown\'|| match.match_time === \'unknown\'">Noch nicht<br/>angesetzt</div></a></li></ul></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.tournament.default.html",'<div ng-show="!loading" class="s1-table" ng-class="tableClass"><generic-table-header ng-if="$root.PLATFORM == \'desktop\' && !tableDefinition.groupByDate"></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.tournament.playoffs.html",'<div class="s1-table" ng-class="tableClass" ng-repeat="tableData in tableData.groups"><div class="s1-table-headline s1-playoff-headline" ng-if="tableData.matches.length> 1"><div class="s1-playoff-headline-teams"><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-home-logo"> <img ng-src="[[tableData.home.logo]]"/></div><div class="s1-playoff-headline-teams-home-name">[[tableData.home.name]]</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-vs">:</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-teams-away-logo"> <img ng-src="[[tableData.away.logo]]"/></div><div class="s1-playoff-headline-teams-away-name">[[tableData.away.name]]</div></div><div class="s1-playoff-headline-score"><div class="s1-playoff-headline-score-home">[[tableData.score.home]]</div><div ng-if="$root.PLATFORM == \'desktop\'" class="s1-playoff-headline-score-vs">:</div><div class="s1-playoff-headline-score-away">[[tableData.score.away]]</div></div></div><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.gameplan.tournament.widget.html",'<div class="s1-table-body" ng-class="tableClass"><div class="s1-table-row s1-match" bindonce ng-repeat="tableRow in tableData.content" ng-class="{\'s1-live\': tableRow.isLive}" ng-if="tableRow.home.show_team!==\'no\'"><a ng-href="[[tableRow._link]]" ng-attr-title="[[tableRow._linkTitle]]"><generic-table-cells></generic-table-cells></a></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.standings.division.default.html",'<div><div class="s1-table" ng-class="tableClass" bindonce ng-repeat="tableData in tableData.groups"><div class="s1-table-headline">[[tableData.name]]</div><generic-table-header></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.standings.league.default.html",'<div class="s1-table" ng-class="tableClass" ng-if="tableData.content"><generic-table-header></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/genericTableDirective/table.standings.tournament.default.html",'<div class="s1-table" ng-class="tableClass" ng-if="tableData.content"><generic-table-header></generic-table-header><generic-table-body custom-style="generic"></generic-table-body></div>');$templateCache.put("common/angularjs/directives/liveticker/liveticker.directive.html",'<s1-spinner s1-visible="loading"></s1-spinner><div ng-if="!loading" class="s1-live-ticker-messages" ng-class="{\'s1-live\': match.isLive}"><div class="s1-live-ticker-message" ng-repeat="ticker in tickerData"><div id="s1-som-post-[[ticker.id]]" class="s1-som-post"></div><div class="s1-game-time"><div ng-bind="ticker.minute | tickerMinuteFilter"></div><div ng-if="ticker.minuteAddedTime" class="s1-added-game-time" ng-bind="ticker.minuteAddedTime | tickerAddedTimeFilter"></div></div><div class="s1-live-ticker-message-content"><div class="s1-live-ticker-message-icon"> <img ng-if="ticker._display.eventIcon" ng-src="[[ticker._display.eventIcon]]" alt="[[ticker.event.kind]]"/></div><div class="s1-live-ticker-message-text"><div class="s1-live-ticker-message-heading-1"><span ng-bind="ticker._display.eventHeaderMain"></span></div><div class="s1-live-ticker-message-heading-2"><strong ng-bind="ticker._display.eventHeaderSub + \' \'"></strong><span ng-bind="ticker._display.eventHeaderSubAdd"></span></div><div class="s1-live-ticker-message-heading-3"><span ng-bind="ticker._display.eventContent"></span></div><div class="s1-live-ticker-message-post-content"><span ng-bind-html="ticker.content"></span></div></div></div></div></div><div ng-if="!loading" class="s1-live-ticker-more"> <a href="javascript:void();" class="s1-more" ng-click="displayMoreEvents()" ng-if="moreTickerDataExists">Mehr anzeigen &raquo;</a></div>');$templateCache.put("common/angularjs/directives/newsRecommenderDirectives/readArticlesContent.html",'<div class="s1-read-articles-wrapper"><div class="s1-read-article" ng-repeat="article in lastReadArticles"><a ng-href="{{ article[0] }}"><figure class="s1-last-read-article-figure"> <img ng-if="article[2]" ng-src="{{ article[2] }}" alt="Sport1"> <img ng-if="!article[2]" src="http://assets.sport1.de/imagix/filter2/jpeg/_set=newspage_teaser_image/var/sport1/storage/images/medien/bilder/kommunikation/node_145433/2141819-1-ger-DE/Sport1-generisch.jpg" alt="Sport1"><figcaption ng-if="article[1]" class="s1-last-read-article-figcaption"> {{ article[1] }}</figcaption></figure></a></div></div>');$templateCache.put("common/angularjs/directives/newsRecommenderDirectives/recommenderContent.html",'<div><s1-spinner s1-visible="!recommendedArticles"></s1-spinner><div class="s1-recommended-articles-wrapper"><div class="s1-recommended-article" ng-repeat="articleWithSimilarity in recommendedArticles | limitTo: 9" ng-mouseover="articleWithSimilarity.hovered = true" ng-mouseleave="articleWithSimilarity.hovered = false"><div class="s1-recommender-icon-wrapper" ng-show="articleWithSimilarity.hovered"><a href="{{ articleWithSimilarity.path }}" class="s1-recommender-view"><div class="s1-recommender-view-icon"></div><div class="s1-recommender-icon-text-left">Ansehen</div></a><div class="s1-recommender-remove" ng-click="removeArticleFromRecommender();"><div class="s1-recommender-remove-icon"></div><div class="s1-recommender-icon-text-right">Entfernen</div></div></div><a href="{{ articleWithSimilarity.path }}" class="s1-teaser s1-channel-teaser s1-third"><div class="s1-recommender-tinder" ng-show="articleWithSimilarity.hovered"></div><div class="s1-recommended-articles-figure-wrapper"><figure class="s1-recommended-article-figure s1-channel-figure s1-icon-{{ articleWithSimilarity.teaser.icon }}"> <img ng-if="articleWithSimilarity.teaser.image" ng-src="http://assets.sport1.de/imagix/filter2/jpeg/_set=teaser_grid_one_third,focus=49x20/imagix/{{ articleWithSimilarity.teaser.image }}" alt=""> <img ng-if="articleWithSimilarity.teaser.image==undefined" src="http://assets.sport1.de/imagix/filter2/jpeg/_set=teaser_grid_one_third/var/sport1/storage/images/medien/bilder/kommunikation/node_145433/2141819-1-ger-DE/Sport1-generisch.jpg"><figcaption class="s1-figcaption"> {{ articleWithSimilarity.teaser.headline }}</figcaption></figure><div class="s1-teaser-text"> <span ng-if="articleWithSimilarity.teaser.text" class="s1-article-label">{{ articleWithSimilarity.teaser.text }}</span> <span ng-if="!articleWithSimilarity.teaser.text" class="s1-article-label">{{ sliceBodyTextForPreview( (articleWithSimilarity.body | htmlToPlaintext)) }}</span> <span class="s1-more">mehr »</span></div></div></a></div></div> <button id="s1-recommender-load-more" ng-show="recommendedArticles.length < 1" ng-click="recommendedArticles = null; loadContentBased();"> Neue Empfehlungen laden</button></div>');$templateCache.put("common/angularjs/directives/newsRecommenderDirectives/recommenderContentMobile.html",'<div><s1-spinner s1-visible="!recommendedArticles"></s1-spinner><div class="s1-recommended-articles-wrapper"><div class="s1-recommended-article" ng-repeat="articleWithSimilarity in recommendedArticles | limitTo: 2" ng-mouseover="articleWithSimilarity.hovered = true" ng-mouseleave="articleWithSimilarity.hovered = false"><div class="s1-recommender-icon-wrapper"><a href="{{ articleWithSimilarity.path }}" class="s1-recommender-view"><div class="s1-recommender-view-icon"></div><div class="s1-recommender-icon-text-left">Ansehen</div></a><div class="s1-recommender-remove" ng-click="removeArticleFromRecommender();"><div class="s1-recommender-remove-icon"></div><div class="s1-recommender-icon-text-right">Entfernen</div></div></div><a href="{{ articleWithSimilarity.path }}" class="s1-teaser s1-channel-teaser s1-third"><div class="s1-recommender-tinder"></div><div class="s1-recommended-articles-figure-wrapper"><figure class="s1-recommended-article-figure s1-channel-figure s1-icon-{{ articleWithSimilarity.teaser.icon }}"> <img ng-if="articleWithSimilarity.teaser.image" ng-src="http://assets.sport1.de/imagix/filter2/jpeg/_set=teaser_grid_one_third,focus=49x20/imagix/{{ articleWithSimilarity.teaser.image }}" alt=""> <img ng-if="articleWithSimilarity.teaser.image==undefined" src="http://assets.sport1.de/imagix/filter2/jpeg/_set=teaser_grid_one_third/var/sport1/storage/images/medien/bilder/kommunikation/node_145433/2141819-1-ger-DE/Sport1-generisch.jpg"><figcaption class="s1-figcaption-on-top"> {{ articleWithSimilarity.teaser.headline }}</figcaption></figure><div class="s1-teaser-text"> <span ng-if="articleWithSimilarity.teaser.text" class="s1-article-label">{{ articleWithSimilarity.teaser.text }}</span> <span ng-if="!articleWithSimilarity.teaser.text" class="s1-article-label">{{ sliceBodyTextForPreview( (articleWithSimilarity.body | htmlToPlaintext)) }}</span> <span class="s1-more">mehr »</span></div></div></a></div></div> <button id="s1-recommender-load-more" ng-show="recommendedArticles.length < 1" ng-click="recommendedArticles = null; loadContentBased();"> Neue Empfehlungen laden</button></div>');$templateCache.put("common/angularjs/directives/newsRecommenderDirectives/teaminfos.html",'<div class="s1-recommender-fav-team-infos" ng-if="settingsStored"><div class="s1-recommender-favourites-bar" ng-hide="!teamName"><div class="s1-recommender-favourites-headline" ng-hide="!teamName"> Aktuelle Infos - {{ teamName }}</div><div class="s1-recommender-favourites-headline" ng-hide="teamName"> Aktuelle Infos - {{ sportName }}</div></div><div id="s1-team-last-matches-app" class="s1-module s1-team-next-matches" ng-hide="!teamName"><div class="s1-module-header">Aktuelle Ergebnisse</div><s1-spinner s1-visible="!nextMatches"></s1-spinner><div class="s1-module-content" ng-if="lastMatches"><a class="s1-team-next-match" ng-repeat="topMatch in lastMatches.matches | limitTo: 1" ng-href="/fussball/team/{{ topMatch.opponentTeam.id }}" title="Zur Vereinsseite von {{ topMatch.opponentTeam.name }}"><div class="s1-shade"><div class="s1-date">{{ topMatch.match_date }}</div><div class="s1-team-logo0"> <img ng-src="{{ topMatch.opponentTeamLogo }}" alt="Vereinslogo von {{ topMatch.home.name }}"/></div><div class="s1-teams"> {{ topMatch.match_result.team }} : {{ topMatch.match_result.opponent }}</div><div class="s1-league">gegen {{ topMatch.opponentTeam.name }}</div></div></a><div class="s1-table s1-layout-widget s1-team-next-matches-table"><div class="s1-table-header"> <span class="s1-table-header-date">Datum</span> <span class="s1-table-header-team">Gegner</span> <span class="s1-table-header-league">Ergebnis</span></div><div class="s1-table-body"><div class="s1-table-row{{ ($index == 0 ? \' s1-table-row-highlight\' : \'\' ) }}" ng-repeat="match in lastMatches.matches | limitTo: 4"> <a ng-href="/fussball/team/{{ match.opponentTeam.id }}" title="Zur Vereinsseite von {{ match.opponentTeam.name }}"><span class="s1-table-row-date">{{ match.match_date }}</span> <span class="s1-table-row-team-logo"><img ng-src="{{ match.opponentTeamLogo }}" alt="Zur Vereinsseite von {{ match.opponentTeam.name }}"/></span> <span class="s1-table-row-team"><b>{{ match.opponentTeam.shortname }}</b></span> <span class="s1-table-row-result-last-matches">{{ match.match_result.team }} : {{ match.match_result.opponent }}</span></a></div></div></div></div></div><div id="s1-team-top-scorer-app" class="s1-module s1-team-top-scorer" ng-hide="!teamName"><div class="s1-module-header">Top Torjäger</div><s1-spinner s1-visible="!topScorers"></s1-spinner><div class="s1-module-content" ng-if="topScorers"><figure> <a class="s1-figure-image" ng-repeat="topScorer in topScorers | limitTo: 1" ng-href="/fussball/person/{{ topScorer.id }}" title="Zur Profileseite von {{ topScorer.name }}"><img ng-src="{{  topScorer.logo}}" alt="Spielerfoto von {{ topScorer.name }}"/></a><figcaption><div class="s1-table s1-layout-widget s1-team-top-scorer-table"><div class="s1-table-header"> <span class="s1-table-header-position">Pl.</span> <span class="s1-table-header-player">Name</span> <span class="s1-table-header-games">Sp</span> <span class="s1-table-header-goals">Tore</span></div><div class="s1-table-body"><div class="s1-table-row{{ ($index == 0 ? \' s1-table-row-highlight\' : \'\' ) }}" ng-repeat="scorer in topScorers | limitTo: 4"> <a ng-href="/fussball/person/{{ scorer.id }}" title="Zum Profil von {{ scorer.name }}"><span class="s1-table-row-position">{{ $index + 1 }}</span> <span class="s1-table-row-nation-logo"><img ng-src="{{ scorer.logoNation }}" alt="Nationalflagge"/></span> <span class="s1-table-row-player">{{ scorer.name }}</span> <span class="s1-table-row-games">{{ scorer.person_stats.playing }}</span> <span class="s1-table-row-goals">{{ scorer.person_stats.score }}</span></a></div></div></div></figcaption></figure></div></div><div id="s1-team-next-matches-app" class="s1-module s1-team-next-matches" ng-hide="!teamName"><div class="s1-module-header">Nächste Termine</div><s1-spinner s1-visible="!nextMatches"></s1-spinner><div class="s1-module-content" ng-if="nextMatches"><a class="s1-team-next-match" ng-repeat="topMatch in nextMatches | limitTo: 1" ng-href="/fussball/team/{{ teamId }}/termine" title="Zum Spielplan"><div class="s1-shade"><div class="s1-date">{{ topMatch.match_date }}</div><div class="s1-team-logo0"> <img ng-src="{{ topMatch.home.logo }}" alt="Vereinslogo von {{ topMatch.home.name }}" onerror="this.onerror=null;this.src=\'/bundles/sport1portal/images/team-logo-fallback.svg\';"/></div><div class="s1-team-logo-divider"></div><div class="s1-team-logo1"> <img ng-src="{{ topMatch.away.logo }}" alt="Vereinslogo von {{ topMatch.away.name }}" onerror="this.onerror=null;this.src=\'/bundles/sport1portal/images/team-logo-fallback.svg\';"/></div><div class="s1-teams"> {{ topMatch.home.shortname }} - {{ topMatch.away.shortname }}</div><div class="s1-league">{{ topMatch.league.name }}</div></div></a><div class="s1-table s1-layout-widget s1-team-next-matches-table"><div class="s1-table-header"> <span class="s1-table-header-date">Datum</span> <span class="s1-table-header-team">Gegner</span> <span class="s1-table-header-league">Wettbewerb</span></div><div class="s1-table-body"><div class="s1-table-row{{ ($index == 0 ? \' s1-table-row-highlight\' : \'\' ) }}" ng-repeat="match in nextMatches | limitTo: 4"> <a ng-href="/fussball/team/{{ match.atHome ? match.away.id : match.home.id }}" title="Zur Vereinsseite von {{ match.atHome ? match.away.name : match.home.name }}"><span class="s1-table-row-date">{{ match.match_date }}</span> <span class="s1-table-row-team-logo"><img ng-src="{{ match.atHome ? match.away.logo : match.home.logo }}" alt="Zur Vereinsseite von {{ match.atHome ? match.away.name : match.home.name }}"/></span> <span class="s1-table-row-team"><b>{{ match.atHome ? match.away.shortname : match.home.shortname }}</b> <span>{{ match.atHome ? \'(H)\' : \'(A)\' }}</span></span><span class="s1-table-row-league"></span> <span class="s1-table-row-league-logo"><img ng-src="{{ match.league.logo }}" alt="{{ match.league.name }}"/></span></a></div></div></div></div></div></div>');$templateCache.put("common/angularjs/directives/popup-button/popup-button.html",'<div class="s1-popup-button-label"><span ng-transclude></span><ul class="s1-popup-button" role="menu" aria-haspopup="true" aria-labelledby="[[titleId]]"><li ng-show="menuItemsLoading" role="presentation"><a><s1-spinner s1-visible="menuItemsLoading"></s1-spinner></a></li><li ng-show="!menuItemsLoading" role="presentation"><a id="[[titleId]]" class="s1-popup-button-title">[[ labelForMenuItem(selected) ]]</a><scroll-view class="s1-scroll-view"><ul class="s1-popup-button-menu" role="menu"><li ng-repeat="menuItem in menuItems" ng-class="{\'active\': isActiveMenuItem(menuItem) }" role="presentation"><a href="#" ng-click="selectMenuItem($event, menuItem)" role="menuitem">[[ labelForMenuItem(menuItem) ]]</a></li></ul></scroll-view></li></ul></div>');$templateCache.put("common/angularjs/directives/s1ArticleRatingDirective/content.html","");$templateCache.put("common/angularjs/directives/s1GlossaryDirective/glossary.gameplan.html","<div> Glossary Gameplan</div>");$templateCache.put("common/angularjs/directives/s1GlossaryDirective/glossary.standings.html",'<div class="s1-glossary"><div ng-if="data.glossary"><div class="s1-glossary-color-definition" ng-repeat="marker in data.glossary | orderBy:\'colour_id\'" ng-class="\'s1-glossary-color-definition-\' + marker.colour_id">[[marker.comment]]</div></div></div>');$templateCache.put("common/angularjs/directives/soccerPlayerDirective/soccer-player.html",'<div ng-style="player.offset"><figure> <a class="s1-figure-image" ng-href="[[player._link]]" ng-attr-title="[[player._linkTitle]]"><img ng-src="[[player.img]]" alt="Spielerfoto von [[player.surname]]"/></a><figcaption><div class="s1-name" ng-class="{\'s1-captain\': player.isCaptain}">[[player.surname]] <span class="s1-shirt-number">([[player.shirtnumber]])</span></div></figcaption></figure></div>');$templateCache.put("common/angularjs/directives/soccerTeamListDirective/playerList.html",'<ul class="s1-live-ticker-player-list s1-table-stripes s1-odd" role="list"><li class="s1-player" role="listitem" ng-repeat="player in list | orderBy:\'_sortId\'"> <a ng-href="[[player._link]]" ng-attr-title="[[player._linkTitle]]"><span class="s1-shirt-number">[[player.shirtnumber]]</span> <span class="s1-name" ng-class="{\'s1-captain\': player.isCaptain}">[[player.surname]]</span><ol class="s1-events" role="list"><soccer-event ng-repeat="event in player.events" event="event"></soccer-event></ol></a></li></ul>');$templateCache.put("common/angularjs/directives/soccerTeamListDirective/soccerTeamList.html",'<div><div ng-if="players.lineup.length"><player-list list="players.lineup"></player-list></div><div ng-if="players.bench.length"><div class="s1-title">Ersatzbank</div><player-list list="players.bench"></player-list></div><div ng-if="players.coach.length"><div class="s1-title">Trainer</div><player-list list="players.coach"></player-list></div></div>');$templateCache.put("common/angularjs/directives/videoOverlayDirective/videoOverlay.html",'<script src="/bundles/sport1portal/libs/jwplayer/jwplayer.js"></script><div id="s1-video-player-overlay" class="s1-overlay" video-overlay-backdrop><div class="s1-video-player"><header class="s1-video-player-header"><div class="s1-title"><span>Videos</span></div><a id="s1-video-player-close" class="s1-close" title="Video Player schliessen" ng-click="close()"></a></header><div class="s1-video-player-subheader"><div class="s1-video-title">[[video.headline]]</div><div class="s1-video-headline">[[video.title]]</div><div class="s1-video-date">[[video.date+\'000\' | date: dd.MM.yyyy]]</div></div><div class="s1-video-player-content"><figure class="s1-video-player-figure" role="content"><div video-overlay-player video-id="[[videoId]]" class="s1-video-player-container"></div><figcaption>[[video.description]]</figcaption></figure><footer class="s1-video-player-footer"><div class="s1-social-bar"><social-recommendations url="[[videoDetailPageUrl]]"></social-recommendations></div></footer></div><aside class="s1-video-player-related" video-overlay-playlist video-id="videoId" video-related-playlist-id="videoRelatedPlaylistId"></aside></div></div>');$templateCache.put("common/angularjs/directives/videoOverlayDirective/videoOverlayPlaylist.html",'<div class="s1-related-video-headline s1-module-header">Weitere Videos</div><scroll-view class="s1-scroll-view s1-video-playlist" loading-spinner><a class="s1-teaser s1-channel-teaser-striped" title="Lorem ipsum headlinum" ng-repeat="video in playlist.videos" ng-click="loadVideo(video.id)"><figure><figcaption><div class="s1-title">[[video.headline]]</div> [[video.title]]<div class="s1-date">[[video.date+\'000\' | date: dd.MM.yyyy]]</div></figcaption><div class="s1-teaser-image [[ video.isRadio ? \'s1-icon-audio\' : \'s1-icon-video\' ]]"> <img ng-src="[[video.image + \'/width/120/height/75\']]" alt=""/><div class="s1-duration">[[video.duration]]</div></div></figure></a></scroll-view>');$templateCache.put("common/angularjs/directives/videoRecommendationDirective/recommendation.html",'<div class="s1-teaser-video-recommendation-container"><div class="ob_what ob-hover"> <a onclick="OBR.extern.callWhatIs(\'http://www.outbrain.com/what-is/default/de\',\'\',-1,-1,true ,null);return false">empfohlen von<span class="ob_logo" title="Outbrain"></span></a></div><div id="s1-video-teaser-container"><div ng-repeat="video in videos" class="s1-teaser-video-recommendation"><a ng-href="[[video.url]]" title="[[video.headline]]"><figure><figcaption> [[video.title]]</figcaption><div class="s1-teaser-image s1-icon-video"> <img width="220" height="123" ng-src=\'[[video.image.url]]\'></div></figure></a></div></div></div>');$templateCache.put("desktop/angularjs/apps/live-ticker/templates/lineup.html",'<s1-spinner s1-visible="app.lineup.loading"></s1-spinner><div ng-hide="vm.app.lineup.loading" class="s1-live-ticker-setup" ng-cloak><div class="s1-home-team"><soccer-team-list players="vm.teams.home" competition="vm.competition"></soccer-team-list></div><div class="s1-live-ticker-field"><div class="s1-live-ticker-team-setup"><div class="s1-live-ticker-team-setup-header"><div class="s1-team-logo"><img ng-src="[[vm.teams.home.logo]]" alt="Vereinslogo von [[vm.teams.home.name]]"/></div><div class="s1-team-name" ng-bind="vm.teams.home.name"></div><div class="s1-strategy" ng-bind="vm.teams.home.strategy"></div></div><div class="s1-field-players"><div class="s1-canvas-players"><soccer-player ng-repeat="player in vm.teams.home.lineup | orderBy:\'_sortId\'" class="s1-field-player"></soccer-player></div></div></div><div class="s1-live-ticker-team-setup s1-bottom"><div class="s1-live-ticker-team-setup-header"><div class="s1-strategy" ng-bind="vm.teams.away.strategy"></div><div class="s1-team-name" ng-bind="vm.teams.away.name"></div><div class="s1-team-logo"><img ng-src="[[vm.teams.away.logo]]" alt="Vereinslogo von [[vm.teams.away.name]]"/></div></div><div class="s1-field-players s1-bottom"><div class="s1-canvas-players"><soccer-player ng-repeat="player in vm.teams.away.lineup | orderBy:\'_sortId\':true" class="s1-field-player"></soccer-player></div></div></div><div class="s1-live-ticker-setup-referee"><div class="s1-live-ticker-referee-headline">Schiedsrichter</div><div class="s1-live-ticker-referee" ng-bind="vm.matchData.referee.fullname"><span ng-if="vm.matchData.referee.person_detail.birth_place">,<span ng-bind="vm.matchData.referee.person_detail.birth_place"></span></div></div></div><div class="s1-guest-team"><soccer-team-list players="vm.teams.away" competition="vm.competition"></soccer-team-list></div></div>');
$templateCache.put("desktop/angularjs/apps/live-ticker/templates/statistics-desktop.html",'<s1-spinner s1-visible="loading"></s1-spinner><div ng-hide="loading" class="s1-live-ticker-statistics" ng-class="{\'s1-live\': isLive}"><div class="s1-table s1-live-ticker-statistics-table"><div class="s1-table-body s1-even"><div ng-repeat="statistic in statistics" class="s1-table-row"><progress-bar class="s1-progress-bar s1-left" ng-class="{\'s1-highlighted\': statistic.is_home_winner}" progress-bar-value="statistic.home_ratio"></progress-bar><span class="s1-value-left" ng-class="{\'s1-highlighted\': statistic.is_home_winner}" ng-bind="statistic.home"></span> <b>[[statistic.name | statisticKeyToLabel : statistic.name]]</b><span class="s1-value-right" ng-class="{\'s1-highlighted\': statistic.is_away_winner}" ng-bind="statistic.away"></span><progress-bar class="s1-progress-bar" ng-class="{\'s1-highlighted\': statistic.is_away_winner}" progress-bar-value="statistic.away_ratio"></progress-bar></div></div></div></div>');$templateCache.put("desktop/angularjs/apps/live-ticker/templates/statistics.html",'<match-statistics competitionid="[[vm.competition.id]]" sportid="[[vm.competition.sport.id]]" match="vm.matchData" template-url="desktop/angularjs/apps/live-ticker/templates/statistics-desktop.html"></match-statistics>');$templateCache.put("desktop/angularjs/directives/fmplayer/templates/epg-schedule-element.html",'<div ng-if="!isLiveModeActive" ng-class="{\'s1-epg-live\': element.scheduleStatus === \'isLive\'}"><div class="s1-playlist-button" ng-if="element.scheduleStatus === \'isLive\'" ng-click="element = jwCtrl.activeLiveStreamElement  || getPlayableElement(); jwCtrl.playStream(element)"> <img ng-hide="jwCtrl.playing" src="/bundles/sport1portal/images/playicon_playlist_weiss.png"> <img ng-show="jwCtrl.playing" src="/bundles/sport1portal/images/pausebutton_playlist.png"></div><div ng-if="element.scheduleStatus === \'isInPast\'" class="s1-finished-icon"> <img ng-hide="selectedMatchId == element.id" src="/bundles/sport1portal/images/beendet_blau.png"> <img ng-show="selectedMatchId == element.id" src="/bundles/sport1portal/images/beendet.png"></div><div class="s1-epg-schedule"><div class="s1-epg-shows"><div class="s1-epg-time" ng-class="{\'live\': element.scheduleStatus === \'isLive\'}"> [[element.scheduleStatus === \'isLive\' ? \'seit\' : \'ab\']] [[element.start | date :\'HH:mm\']]<span class="s1-epg-delimiter">|</span></div><div class="s1-epg-info" ng-class="{\'live\': element.scheduleStatus === \'isLive\'}"><div class="s1-epg-title">[[element.title]]</div><div class="s1-epg-desc">[[element.subtitle]]</div></div></div></div></div><div ng-if="isLiveModeActive" class="s1-schedule-epg-container" ng-class="{\'s1-selected\': element.id == selectedMatchId}" ng-click="onElementSelected(element)"><div ng-if="element.scheduleStatus !== \'isInPast\'" class="s1-playlist-button" ng-class="{\'disabled\': element.scheduleStatus === \'isInFuture\'}" ng-click="element.scheduleStatus !== \'isLive\' || jwCtrl.playStream(element, element.streamUrl)"><div style="float: left;" ng-if="element.streamUrl"> <img ng-hide="jwCtrl.activeLiveStreamElement == element || selectedMatchId == element.id" src="/bundles/sport1portal/images/playicon_playlist.png"> <img ng-show="jwCtrl.activeLiveStreamElement != element && selectedMatchId == element.id" src="/bundles/sport1portal/images/playicon_playlist_weiss.png"> <img ng-show="jwCtrl.activeLiveStreamElement == element && selectedMatchId == element.id" src="/bundles/sport1portal/images/pausebutton_playlist.png"> <img ng-show="jwCtrl.activeLiveStreamElement == element && selectedMatchId != element.id" src="/bundles/sport1portal/images/pausebutton_playlist_blau.png"></div></div><div ng-if="element.scheduleStatus === \'isInPast\'" class="s1-playlist-button"> <img ng-hide="selectedMatchId == element.id" src="/bundles/sport1portal/images/beendet_blau.png"> <img ng-show="selectedMatchId == element.id" src="/bundles/sport1portal/images/beendet.png"></div><div class="s1-schedule-match-info"> <span class="s1-conference-title">[[element.title]]</span><div ng-if="element.scheduleStatus !==\'isInPast\'" class="s1-start-time" style="float: left;">[[element.start | date : \'HH:mm\']]</div></div></div>');$templateCache.put("desktop/angularjs/directives/fmplayer/templates/headline-schedule-element.html",'<div class="s1-headline"> <img class="s1-competition-logo" ng-src="[[element.logo]]"/> <span class="s1-headline-title">[[element.baseElement && element.baseElement.sportId === \'42\' ? element.baseElement.coName + \' \' + element.matchday : element.title]]</span></div>');$templateCache.put("desktop/angularjs/directives/fmplayer/templates/match-schedule-element.html",'<div class="s1-schedule-match-container" ng-class="{\'s1-selected\': element.id == selectedMatchId}" ng-click="onElementSelected(element)"><div ng-if="element.scheduleStatus !== \'isInPast\'" class="s1-playlist-button" ng-class="{\'disabled\': element.scheduleStatus === \'isInFuture\'}" ng-click="element.scheduleStatus !== \'isLive\' || jwCtrl.playStream(element, element.streamUrl)"><div style="float: left;" ng-if="element.streamUrl"> <img ng-hide="jwCtrl.activeLiveStreamElement == element || selectedMatchId == element.id" src="/bundles/sport1portal/images/playicon_playlist.png"> <img ng-show="jwCtrl.activeLiveStreamElement != element && selectedMatchId == element.id" src="/bundles/sport1portal/images/playicon_playlist_weiss.png"> <img ng-show="jwCtrl.activeLiveStreamElement == element && selectedMatchId == element.id" src="/bundles/sport1portal/images/pausebutton_playlist.png"> <img ng-show="jwCtrl.activeLiveStreamElement == element && selectedMatchId != element.id" src="/bundles/sport1portal/images/pausebutton_playlist_blau.png"></div></div><div ng-if="element.scheduleStatus === \'isInPast\'" class="s1-playlist-button"> <img ng-hide="selectedMatchId == element.id" src="/bundles/sport1portal/images/beendet_blau.png"> <img ng-show="selectedMatchId == element.id" src="/bundles/sport1portal/images/beendet.png"></div><schedule-element-match-info element="element"></schedule-element-match-info><div class="s1-audioplayer-tipico"><span class="s1-tipico" tipico-bet tipico-match="element.match" tipico-competition-id="[[element.coId]]" tooltip-placement="left"></span></div></div>');$templateCache.put("desktop/angularjs/directives/fmplayer/templates/schedule-element-dtm-info.html",'<div class="s1-schedule-match-dtm-info">[[element.label]]</div>');$templateCache.put("desktop/angularjs/directives/fmplayer/templates/schedule-element-soccer-info.html",'<div class="s1-schedule-match-info"><div ng-if="element.match.home"> <span class="s1-team-title-home">[[element.match.home.shortname]]</span> <span class="s1-team-separator">:</span> <span class="s1-team-title-away">[[element.match.away.shortname]]</span></div><div ng-if="element.scheduleStatus !==\'isInFuture\'" class="s1-result">[[element.match._result.display]]</div><div ng-if="element.scheduleStatus ===\'isInFuture\'" class="s1-start-time">[[element.match.match_time]]</div></div>');$templateCache.put("desktop/angularjs/directives/fmplayer/templates/schedule.html",'<div class="s1-playlist"><scroll-view class="s1-scroll-view"><ul id="scheduleList" class="s1-fmplayer-schedule-list" role="list"><li ng-repeat="element in scheduleElements | scheduleFilter: sportFilter" role="presentation"><schedule-element type="[[element.type]]"></schedule-element></li></ul></scroll-view></div>');$templateCache.put("desktop/angularjs/directives/popover/popover.html",'<div class="s1-popover-wrapper"><div class="s1-popover"><div class="s1-popover-arrow"></div><div class="s1-popover-content" ng-transclude></div></div></div>');$templateCache.put("desktop/angularjs/directives/templates/search-bar.html",'<div ng-module="searchApp" class="s1-search" ng-cloak="" style="text-align: right"><div ng-controller="SearchController" ng-init="initVars({searchPage:\'/suche\'})" style="display: inline-block;position:relative"> <input class="searchInputBox" ng-model="searchInputBox" placeholder="Suche" type="search" ng-keyup="searchSuggestion($event)" ng-focus="suggestFocus($event)" ng-blur="cleanResultsList($event)" autocomplete="off" value="[[searchInputBox]]"><div class="lupe" ng-click="callInputSearchWord()"></div><div class="clearButton" ng-show="hasSearchBoxFocus" ng-mousedown="clearInputBox()"> <img src="bundles/sport1portal/images/icon-close.png" width="11" height="13"></div><ul class="showSuggest" ng-show="isOpenSuggestionBox=suggestResults.length>0"><li class="border_line" ng-repeat="suggestResult in suggestResults"><div class="marker ng-class:{\'active\': suggestResult.highLight};" ng-bind-html="suggestResult.display" ng-mouseover="setHighlightIndex($index);resetHighlight();suggestResult.highLight=true;" ng-click="callHighlightSearchWord()"></div></li></ul></div></div>')}]);
//# sourceMappingURL=desktop.min.js.mapG      WKWK<W;   F    :http://assets.sport1.de/bundles/sport1portal/js/desktop.min.js?v=v248 necko:classified 1 strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
Via: 1.1 ISA01TMG
Expires: Tue, 04 Oct 2016 19:38:36 GMT
Date: Tue, 04 Oct 2016 06:19:27 GMT
Content-Type: application/javascript
Etag: "57ea63bb-8f61d"
Accept-Ranges: bytes
Last-Modified: Tue, 27 Sep 2016 12:19:07 GMT
X-Cache-Hits: 0
Access-Control-Allow-Origin: *
X-Served-By: lnxv-8153
X-By-Backend: vdirsport1
Cache-Control: max-age=47949
 original-response-headers Via: 1.1 ISA01TMG
Connection: Keep-Alive
Proxy-Connection: Keep-Alive
Transfer-Encoding: chunked
Expires: Tue, 04 Oct 2016 19:38:36 GMT
Date: Tue, 04 Oct 2016 06:19:27 GMT
Content-Type: application/javascript
Etag: "57ea63bb-8f61d"
Accept-Ranges: bytes
Last-Modified: Tue, 27 Sep 2016 12:19:07 GMT
X-Cache-Hits: 0
Access-Control-Allow-Origin: *
X-Served-By: lnxv-8153
X-By-Backend: vdirsport1
Cache-Control: max-age=47949
 uncompressed-len 0  