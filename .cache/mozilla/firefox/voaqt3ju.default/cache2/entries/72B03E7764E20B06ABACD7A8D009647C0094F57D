define([],function(){"use strict";var a={teaser:'a[rel="bookmark"]',dataHref:"data-ajax-href",dataVideoJSON:"data-video-json",dataVideoJSONLong:"data-video-json-long",dataRecomHref:"data-recoms-href",expandingClass:"element--full",skinningClass:"gallery-box--skinning",videoContainer:".mediaplayer",hideElem:".tsr11 .tsr-img",tsrImg:".tsr11 >a",buliBtn:".btn-group-in-video > a",kicker:".kicker",headline:".headline",source:".credit",videoDuration:".index",autoplayButton:".link-autoplay",autoplayKey:"vc.autoplay",autoplayText:function(a){return"Autoplay "+(a?"aus":"an")},outbrainJS:"http://widgets.outbrain.com/outbrain.js",oubrainAppId:"APP_1",obContainer:'<aside class="gallery-box-recommendations"><header class="group-header"><h2>Empfehlungen</h2><ul class="topic"><li class="block-videoworld"><a href="">Zu Bild Video</a></li></ul></header><div class="overflow-container"><div class="overflow-wrapper"><ul class="overflow-gallery"></ul></div><button rel="prev" class="hidden">zur√ºck</button><button rel="next">vorw√§rts</button></div></aside>',obTemplate:'<li class="overflow-gallery_item"><div class="hentry tsr13" data-video-json="##VIDEOJSON##"><a href="##OBHREF##" rel="bookmark"><span class="tsr-img icon-video"><img src="http://bilder.bild.de/fotos/ondemand-23661532/Bild/1.bild.gif" data-src="##TESAERIMG##" width="320"height="180" alt="" class="photo"></span><h3 class="entry-title"><span class="kicker ">##KICKER##</span><span class="headline">##HEADLINE##</span></h3></a></div></li>',fallBackTimer:2e3,events:de.bild.events,minTemplate:"##MM##:##SS## Min.",initClass:"js-initialized",dataVideoId:"data-video-id",dataVideoIdLong:"data-video-id-long",activeElem:".btn-play.active"},b=function(b){return b?(this.options=b,this.el=b.el,this.$el=$(this.el),this.settings=a,this.Events=de.bild.events,this.$parent=this.$el.parent(),this.videoContainer=this.$el.find(this.settings.videoContainer),this.kicker=this.$el.find(this.settings.kicker),this.headline=this.$el.find(this.settings.headline),this.source=this.$el.find(this.settings.source),this.videoDuration=this.$el.find(this.settings.videoDuration),this.autoplayButton=this.$el.find(this.settings.autoplayButton),this.autoplayDisabled=!1,this.videoSlider=null,this.recomJSON=null,this.buliBtns=this.$el.find(this.settings.buliBtn),this.isBuliVid=this.buliBtns.length>0,this.videoSliderDef=$.Deferred(),this.$el.hasClass(this.settings.initClass)?console.warn("videocenter: multiple module initialisation.",this.$el,this.$el.attr("id")):this.init(),this):(console.warn("videocenter: no options defined. Module can not be initialized"),this)};return b.prototype={init:function(){var a=this;this.initAutoplayDisableButton(),this.bindUIEvents(),this.initMediaPlayer().then(function(){a.options.autoplay&&!a.autoplayDisabled&&a.autoplayButton.length>0&&a.triggerAutoplay()}),this.$el.addClass(this.settings.initClass)},bindUIEvents:function(){var a=this,b=!1;a.$el.on("click",a.settings.tsrImg+","+a.settings.buliBtn,function(c){if(!b){b=!0;var d=$(this);d.css("pointer-events","none");var e=a.getVideoJSON(d);a.initialVideoId=a.parseVideoId(a.$el),a.handleVideoClick(e)}c.preventDefault()}),a.$el.on("startVideo",function(b,c){a.sortRecomJSON(c),a.startVideo(c.json)}),a.$el.on("videoSliderLoaded",function(b,c){a.videoSlider=c,a.videoSliderDef.resolve()}),a.videoContainer.on("mediaplayer/created",function(){a.handleVideoPlay()}),a.$el.on("mediaplayer/play",function(){a.pauseAllVids(a.videoContainer)})},getVideoJSON:function(a){var b=this.$el.attr(this.settings.dataVideoJSON);if(this.isBuliVid)if(a.hasClass("btn-play")){var c=a.index();b=0===c?this.$el.attr(this.settings.dataVideoJSON):this.$el.attr(this.settings.dataVideoJSONLong),this.longVidChoice=1===c}else if(this.buliBtns.is(":hidden"))b=this.$el.attr(this.settings.dataVideoJSONLong),this.longVidChoice=!0;else{var d=this.$el.find(this.settings.activeElem).index();b=1===d?this.$el.attr(this.settings.dataVideoJSONLong):this.$el.attr(this.settings.dataVideoJSON),this.longVidChoice=1===d}return b},initAutoplayDisableButton:function(){var b,c=this;if(this.options.autoplay&&!(this.autoplayButton.length<=0)){try{b=JSON.parse(window.localStorage.getItem(a.autoplayKey)||"{}"),this.autoplayInteractionState=b.value,b&&b.time>(new Date).getTime()-6048e5&&(this.autoplayDisabled=b.value)}catch(a){this.autoplayInteractionState=!1}this.autoplayButton.text(a.autoplayText(this.autoplayDisabled)),this.autoplayButton.on("click",function(){c.autoplayDisabled=!c.autoplayDisabled,c.autoplayButton.text(a.autoplayText(c.autoplayDisabled));try{b={value:c.autoplayDisabled,time:(new Date).getTime()},window.localStorage.setItem(a.autoplayKey,JSON.stringify(b))}catch(a){}return c.trackAutoPlaySwitch(),!1})}},triggerAutoplay:function(){this.$el.find(this.settings.tsrImg).trigger("click")},trackAutoPlaySwitch:function(){var a;void 0!==this.autoplayInteractionState?a=this.autoplayDisabled?"redeaktiviert":"reaktiviert":(a="deaktiviert",this.autoplayInteractionState=!0),this.settings.events.publish("de.bild.mobile.clickTracking",[!1,{webtrekk:{linkId:"video_autoplay",customClickParameter:{22:"click/video_autoplay/"+a}}}])},handleVideoClick:function(a){var b=this;b.options.teaserblock||de.bild.cmsKonfig.additional.isRebrush||b.$parent.addClass(b.settings.expandingClass),b.isBuliVid&&b.$el.find(b.settings.buliBtn).parent().hide(),b.initMediaPlayer().then(function(){b.startVideo(a,b.options.autoplay)})},handleVideoPlay:function(){var a=this,b=a.videoContainer.data("mediaplayer");b&&$.when(b,a.videoSliderDef).then(function(b){b.data&&(a.setHeadline({kicker:b.data.headline,headline:b.data.title,videoDuration:a.generateStringFromSeconds(b.data.durationSec),source:"Quelle: "+b.data.copyright}),a.triggerSliderScroll(b))})},generateStringFromSeconds:function(a){if(!a)return"";var b=Math.floor(a/60),c=a-60*b;return c<10&&(c="0"+c),this.settings.minTemplate.replace("##MM##",b).replace("##SS##",c)},loadRecoms:function(){var a=this,b=$.Deferred();return a.options.outbrain?a.loadOutbrainRecoms().then(function(a){b.resolve(a)},function(){a.loadBildRecoms().then(function(a){b.resolve(a)},function(){b.reject()})}):a.loadBildRecoms().then(function(a){b.resolve(a)},function(){b.reject()}),b},loadBildRecoms:function(){var a=this,b=$.Deferred(),c=a.$el.attr(a.settings.dataRecomHref);return c?($.ajax({url:c}).done(function(c){c=a.optimizeHTML(c),a.recomJSON=a.generateRecomJSON(c),a.addRecoms(c),b.resolve(a.recomJSON)}).fail(function(){b.reject()}),b):(console.warn("Videocenter: recoms could not be loaded. No recom url defined"),b.reject())},loadOutbrainRecoms:function(){var a,b=this,c=this.settings.outbrainJS,d=$.Deferred(),e=$.Deferred();return $("script[src='"+c+"']").length?e.resolve():de.bild.events.publish("appendScriptToHead",[c,function(){e.resolve()}]),e.then(function(){var c={permalink:"http://www.bild.de"+window.location.pathname,widgetId:b.settings.oubrainAppId};clearTimeout(a),OBR&&OBR.extern&&"function"==typeof OBR.extern.callRecs?OBR.extern.callRecs(c,function(a){b.recomJSON=b.generateRecomJSONOB(a),b.renderOutbrainSlider(b.recomJSON),d.resolve(b.recomJSON)}):d.reject()}),a=setTimeout(function(){d.reject()},b.settings.fallBackTimer),d},initMediaPlayer:function(){var a=$.Deferred();return de.bild.mediaplayer?a.resolve():(this.settings.events.publish("initModule",["mediaPlayer",{el:this.$el.attr("id"),cb:function(){a.resolve()}}]),a)},sortRecomJSON:function(a){for(var b,c=0;c<this.recomJSON.length;c++)if(this.recomJSON[c].json===a.json){b=c;break}void 0!==b&&(this.recomJSON=this.recomJSON.concat(this.recomJSON.splice(0,b+1)))},setHeadline:function(a){a&&a.headline&&a.kicker&&(this.kicker.html(a.kicker),this.headline.html(a.headline),this.videoDuration.html(a.videoDuration),this.source.html(a.source))},triggerSliderScroll:function(a){var b=this;a&&a.data&&b.videoSlider.trigger("handleActiveVideo",[a.data.id])},startVideo:function(a,b){var c=this;c.$el.find(c.settings.hideElem).hide(),c.videoContainer.removeClass("hidden"),de.bild.mediaplayer.core.create(c.videoContainer,a,{prepareProvider:!0,initializedBy:{origin:"expanding",teaserAutoplay:b},relatedVideos:c.recomJSON||c.loadRecoms()}).then(function(){this.play()})},addRecoms:function(a){if(!this.options.autoplay){var b=$(a),c="videoSlider_"+Math.round(1e5*Math.random());b.attr("id",c),this.$el.find(".tsr11").after(b),this.$el.addClass(this.settings.skinningClass),this.settings.events.publish("newContent",[this.$el]),this.settings.events.publish("initModule",["videocenterSlider",{el:"#"+c,videoElem:this.$el,videoContainer:this.videoContainer,outbrain:this.options.outbrain,recomJSON:this.recomJSON,longVidChoice:this.longVidChoice||!1}])}},renderOutbrainSlider:function(a){if(!a||0===a.total_count)return void console.error("no outbrain content resolved");for(var b=$(this.settings.obContainer),c=b.find("ul"),d=this.settings.obTemplate,e=0;e<a.length;e++)if(a[e]&&a[e].text&&a[e].title&&a[e].url&&a[e].img){var f=$(d.replace(/##HREF##/g,a[e].url).replace(/##TESAERIMG##/g,a[e].img).replace(/##KICKER##/g,a[e].title).replace(/##HEADLINE##/g,a[e].text).replace(/##VIDEOJSON##/g,a[e].json).replace(/##OBHREF##/g,a[e].url));c.append(f)}this.addRecoms(b)},optimizeHTML:function(a){var b=this;a="<div>"+a+"</div>";var c,d,e,f=$(a),g=f.find(".hentry");return g.each(function(a,g){c=$(g),c.attr("data-orig-video-json",c.attr("data-video-json")),d=b.setPosterWidth(c.attr("data-video-json"),b.$el,320),c.attr("data-video-json",d),e=b.parseVideoId(c);var h=b.longVidChoice?b.settings.dataVideoIdLong:b.settings.dataVideoId;e&&f.find("["+h+'="'+e+'"]').length>1&&c.parent().remove()}),f.html()},generateRecomJSON:function(a){var b,c,d,e,f,g=this,h=$(a).find(".hentry"),i=[];return h.each(function(a,h){b=$(h),c=b.find(".photo"),d=c.attr("data-src")||c.attr("src");var j=g.settings.dataVideoJSON;g.isBuliVid&&g.longVidChoice!==!1&&(j=g.settings.dataVideoJSONLong),e=b.attr("data-orig-video-json"),f=g.parseVideoId(b),f&&i.push({img:d,index:a,json:b.attr(j)||b.attr(g.settings.dataVideoJSON),jsonOrig:b.attr("data-orig-video-json"),text:b.find(".headline").text(),title:b.find(".kicker").text(),url:b.find("a").attr("href"),id:f})}),i[0]&&this.initialVideoId===i[0].id&&i.push(i.shift()),i},setPosterWidth:function(a,b,c){c=c||b.find("img").width();var d="low",e=a.split(".");return c&&e.length&&(e[0]=e[0]+",width="+c+",q="+d,a=e.join(".")),a},generateRecomJSONOB:function(a){for(var b,c=[],d=0;d<a.doc.length;d++)b=a.doc[d],c.push({img:b.thumbnail.url,index:d,json:b.orig_url.replace(".bildMobile.html",",view=json.bildMobile.html").replace(".bild.html",",view=json.bildMobile.html").replace("http://www.bild.de","http://m.bild.de"),text:b.content,title:b.desc,url:b.orig_url});return c},pauseAllVids:function(a){var b=$(this.settings.videoContainer).not(a);b.each(function(){var a=$(this).data("mediaplayer");a&&a.then(function(a){a.isPlaying()&&a.pause()})})},parseVideoId:function(a){var b,c=this.longVidChoice?this.settings.dataVideoIdLong:this.settings.dataVideoId;if(a&&a.attr(c))b=parseInt(a.attr(c));else{var d=this.getVideoJSON(a);try{b=parseInt(d.match(/(\d+){8}/)[0])}catch(a){return}}if(!isNaN(b))return b}},b});n>Sœs8      X+)X+*=GhXe-Æ   q    :http://code.bildstatic.de/2.21.1-cats-release--16.21/min/targets/bild/xl/js/simple/de.bild.mobile.videocenter.js necko:classified 1 strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
Via: 1.1 ISA01TMG
Expires: Sun, 18 Dec 2016 13:55:11 GMT
Date: Mon, 31 Oct 2016 11:29:45 GMT
Content-Type: application/javascript
Server: Apache
Last-Modified: Thu, 20 Oct 2016 09:09:52 GMT
X-UA-Compatible: IE=Edge
Cache-Control: public, max-age=5112454
X-Refresh: h=10|g=103975.000|c=(null)|rd=Thu, 20 Oct 2016 09:47:36 GMT|dd=Thu, 20 Oct 2016 09:52:22 GMT
Vary: Origin
 original-response-headers Via: 1.1 ISA01TMG
Connection: Keep-Alive
Proxy-Connection: Keep-Alive
Transfer-Encoding: chunked
Expires: Sun, 18 Dec 2016 13:55:11 GMT
Date: Mon, 31 Oct 2016 11:29:45 GMT
Content-Type: application/javascript
Server: Apache
Last-Modified: Thu, 20 Oct 2016 09:09:52 GMT
X-UA-Compatible: IE=Edge
Cache-Control: public, max-age=5112454
X-Refresh: h=10|g=103975.000|c=(null)|rd=Thu, 20 Oct 2016 09:47:36 GMT|dd=Thu, 20 Oct 2016 09:52:22 GMT
Vary: Origin
 uncompressed-len 0   +á