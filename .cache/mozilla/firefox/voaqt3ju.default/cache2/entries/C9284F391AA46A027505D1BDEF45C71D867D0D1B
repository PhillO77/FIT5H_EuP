//!     uuid.js
//!     Copyright (c) 2010-2012 Robert Kieffer
//!     MIT License - http://opensource.org/licenses/mit-license.php
(function(){function e(e,t,n){var r=t&&n||0,o=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>o&&(t[r+o++]=c[e])});16>o;)t[r+o++]=0;return t}function t(e,t){var n=t||0,r=s;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function n(e,n,o){var i=n&&o||0;"string"==typeof e&&(n="binary"==e?new a(16):null,e=null),e=e||{};var s=e.random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,n)for(var c=0;16>c;c++)n[i+c]=s[c];return n||t(s)}var r,o=this,i=new Array(16);r=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i};for(var a=Array,s=[],c={},u=0;256>u;u++)s[u]=(u+256).toString(16).substr(1),c[s[u]]=u;var d=n;d.v4=n,d.parse=e,d.unparse=t,d.BufferClass=a;var l=o.uuid;d.noConflict=function(){return o.uuid=l,d},o.uuid=d}).call(this),function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(2),i=n(3),a=n(6),s=n(11),c=n(14),u=r(c),d=n(19),l=r(d),p=n(12),f=r(p),h=n(22),g=r(h);window.Kx=window.Kx||{},window.Kx.log=function(){return f["default"]}(),window.Kx.Request=function(){return g["default"]}(),window.Kx.Markup=function(){return{getViewPixel:a.getViewPixel,appendUTMParameter:a.appendUTMParameter}}(),window.Kx.Helper=window.Kx.Helper||{},window.Kx.Helper.Util=function(){var e={};return e.mergeObjects=n(20)["default"],e.isRealObject=n(21)["default"],e.compactArray=n(5)["default"],e.wordCount=n(23)["default"],e.uniqueID=function(){return uuid.v4()},e.hasOnlyWhitespaces=n(4)["default"],e.findStringInText=n(17)["default"],e.domReady=n(24)["default"],e.replacePlaceholder=n(7)["default"],e}(),window.Kx.Helper.DOM=function(){return{nodesBySelector:o.nodesBySelector,firstChild:o.firstChild,nextSibling:o.nextSibling,nodeType:o.nodeType,isTextNode:o.isTextNode,nodeName:o.nodeName,textContent:o.textContent,parentNode:o.parentNode,nodeValue:o.nodeValue,setNodeValue:o.setNodeValue,addAttributeToNode:o.addAttributeToNode,hasKxAttribute:o.hasKxAttribute}}(),window.Kx.Helper.NodeFilter=function(){return{containsValidText:i.containsValidText,isMarked:i.isMarked,isContentNode:i.isContentNode,hasEnoughWords:i.hasEnoughWords}}(),window.Kx.Helper.ContentParser=function(){return{findPossibleKeywords:l["default"]}}(),window.Kx.Helper.Strategy=function(){return{getCampaignById:s.getCampaignById}}(),window.Kx.Strategy=window.Kx.Strategy||{},window.Kx.Strategy.Xtraffic=window.Kx.Strategy.Xtraffic||{},window.Kx.Strategy.Xtraffic=function(){return u["default"]}()},function(e,t){"use strict";function n(e){var t=document.querySelectorAll(e),n=[].slice.call(t);return n}function r(e){return e.firstChild}function o(e){return e.nextSibling}function i(e){return e.nodeType}function a(e){return 3===i(e)}function s(e){return e.nodeName.toLowerCase()}function c(e){return e.textContent}function u(e){return e.parentNode}function d(e){return e.nodeValue}function l(e,t){e.nodeValue=t}function p(e,t){var n=document.createAttribute(t.name);return n.value=t.value,e.setAttributeNode(n),e}function f(e){return 8===i(e)?!1:e.hasAttribute("data-kx")}Object.defineProperty(t,"__esModule",{value:!0}),t.nodesBySelector=n,t.firstChild=r,t.nextSibling=o,t.nodeType=i,t.isTextNode=a,t.nodeName=s,t.textContent=c,t.parentNode=u,t.nodeValue=d,t.setNodeValue=l,t.addAttributeToNode=p,t.hasKxAttribute=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=c.nodeValue(e);return!(null===t||d["default"](t))}function i(e){return c.hasKxAttribute(e)}function a(e,t){var n=c.nodeName(e);return t.indexOf(n)>-1}function s(e,t){var n=c.textContent(e),r=p["default"](n.split(/\s/));return r.length>=t}Object.defineProperty(t,"__esModule",{value:!0}),t.containsValidText=o,t.isMarked=i,t.isContentNode=a,t.hasEnoughWords=s;var c=n(2),u=n(4),d=r(u),l=n(5),p=r(l)},function(e,t){"use strict";function n(e){var t=e||" ";return 0===t.replace(/\s/g,"").length}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t="x"+window.Kx.Helper.Util.uniqueID(),n=document.createElement("span");n.className="kx-rlink-container "+t;var r=document.createElement("a"),o=void 0;e.campaign.keywords.forEach(function(t){t.name===e.keyword&&(o=t)}),Kx.log("keywordObject: Xtraffic: ",o),r.href=o.targetURL;var a="";o.tags&&o.tags.length>0&&(a=o.tags.join(","));var c=u["default"](o.clickTrackingURL,{pid:e.publisherId,cid:e.campaign.id,format:"rlink",keyword:e.keyword,sessionid:e.sessionId,ref:e.referrer,target:i(o.targetURL,e.campaign.utm,e.keyword),tags:a});if(r.setAttribute("onclick",'this.href="'+c+'"'),o.tooltip&&(r.title=o.tooltip),r.target="_self",r.rel="nofollow",r.className="kx-ad-link",r.appendChild(document.createTextNode(e.keyword)),n.appendChild(r),o.iconURL&&o.iconURL.length>0){var d={cssNamespace:t};o.tooltip&&(d.tooltip=o.tooltip),d.iconHeight=e.kxObject.config.iconSize,d.iconURL=o.iconURL;var l=s(d);r.appendChild(l)}return n}function i(e,t,n){if(t){var r=[];Object.keys(t).forEach(function(e){t.hasOwnProperty(e)&&r.push("term"===e?"utm_"+e+"="+u["default"](t[e],{keyword:n}):"utm_"+e+"="+encodeURIComponent(t[e]))});var o=document.createElement("a");return o.href=e,r.unshift(o.search),o.search=r.join("&"),o.href}return e}function a(e){var t=document.createElement("img");return t.src=e.replace(/(\[timestamp\]|\{timestamp\})/,(new Date).getTime()),t.height=1,t.width=1,t.style.opacity=.01,t.style.position="absolute",t.style.left="-10000px",t}function s(e){function t(e){return setTimeout(function(){e.className="kx-ad-logo"},1e3)}var n=!1,r=void 0,o=void 0,i=document.createElement("img");i.className="kx-ad-logo kx-init",i.style.opacity=.01,i.alt=e.tooltip,i.onload=function(a){if(!n){n=!0;var s=a.target;t(s);var c=s.width/s.height,u=e.iconHeight*c,d=27>u?"-2px":"-4px";Kx._css.addRules([{selector:"."+e.cssNamespace+".kx-rlink-container .kx-logo-container",declarations:{height:"10px",width:u+2+"px"}},{selector:"."+e.cssNamespace+".kx-rlink-container .kx-ad-logo",declarations:{height:e.iconHeight+"px",bottom:d,left:"2px",width:"auto"}},{selector:"."+e.cssNamespace+".kx-rlink-container .kx-ad-logo.kx-init",declarations:{height:2.35*e.iconHeight+"px"}},{selector:"."+e.cssNamespace+".kx-rlink-container .kx-ad-link:hover .kx-ad-logo",declarations:{height:2.35*e.iconHeight+"px"}}]),r||(o=!0),!r&&o?(o=!1,r=i.complete||4===i.readyState,setTimeout(function(){var e=f["default"]("load");n=!1,s.dispatchEvent(e)},500)):s.style.opacity=1}},i.src=l["default"](e.iconURL)?e.iconURL:"//kkastatic.s3.amazonaws.com/"+e.iconURL,r=i.complete||4===i.readyState;var a=document.createElement("span");if(a.className="kx-logo-container",a.appendChild(i),i.complete||4===i.readyState){var s=f["default"]("load");i.dispatchEvent(s)}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkFragment=o,t.appendUTMParameter=i,t.getViewPixel=a,t.getImageElement=s;var c=n(7),u=r(c),d=n(9),l=r(d),p=n(10),f=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=a["default"](n),o=new RegExp("(%"+r+"%|%25"+r+"%25)","g");e=e.replace(o,encodeURIComponent(t[n]))}return e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(8),a=r(i)},function(e,t){"use strict";function n(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e){var t=e.toLowerCase();return 0===t.indexOf("http")||0===t.indexOf("//")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e){var t=void 0;try{t=new Event(e)}catch(n){t=document.createEvent("Event"),t.initEvent(e,!0,!0)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=void 0;return t.campaigns.forEach(function(t){t.id===e&&(n=t)}),n}function i(e,t){var n=e.keywordResult[0],r=n.keyword.slice(0,-1),o=n.index,i=l.nodeValue(e.node),a=u.getLinkFragment({keyword:r,campaign:e.campaign,publisherId:e.publisherId,sessionId:e.sessionId,referrer:e.referrer,kxObject:t.kxObject}),s=[];if(0===n.index){s.push(a);var c=i.substring(o+r.length,i.length);s.push(document.createTextNode(c))}else{var p=i.substring(0,o);if(s.push(document.createTextNode(p)),s.push(a),i.length!==o+r.length){var f=i.substring(o+r.length,i.length);s.push(document.createTextNode(f))}}e.node.nodeValue="";var h=e.node.nextSibling;s.forEach(h?function(e){h.parentNode.insertBefore(e,h)}:function(t){e.node.parentNode.appendChild(t)}),t.maxKeywordsInspector.addKey("keyword");var g=void 0;e.campaign.keywords.forEach(function(e){e.name===r&&(g=e)});var x={event_type:"placement.rlink",campaign_id:e.campaign.id+"",ad_format:"rlink",keywords:[r]};if(g.tags&&g.tags.length>0&&(x.tags=g.tags),Kx._tracker.track(x),d.viewPixelUriIsSet(e.campaign)){var y=u.getViewPixel(e.campaign.impressionTrackingURL);document.body.appendChild(y)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getCampaignById=o,t.setKeywordLink=i;var a=n(5),s=(r(a),n(8)),c=(r(s),n(12)),u=(r(c),n(6)),d=n(13),l=n(2)},function(e,t){"use strict";function n(){var e=document.cookie.split(";"),t=e.indexOf("KX-Debug=Deiyah3b");if(t>=0){var n;(n=console).log.apply(n,arguments)}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e){return void 0!==e.impressionTrackingURL&&null!==e.impressionTrackingURL&&""!==e.impressionTrackingURL}Object.defineProperty(t,"__esModule",{value:!0}),t.viewPixelUriIsSet=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(15),s=r(a),c=n(16),u=r(c),d=n(12),l=r(d),p=n(17),f=r(p),h=n(18),g=n(2),x=n(11),y=(n(6),function(){function e(t,n){o(this,e),s["default"](t),s["default"](n),this.kxObject=t,this.parser=n,this.maxKeywordsInspector=new u["default"](3),l["default"]("XTRAFFIK"),this.run()}return i(e,[{key:"run",value:function(){var e=this;l["default"]("RUN"),this.parser.parserResult.paragraphs.forEach(function(t){return 0===t.possibleKW.length?void l["default"](t.possibleKW):void t.possibleKW.forEach(function(n){var r=x.getCampaignById(n.campaignId,e.kxObject);if(h.isXtrafficCampaign(r)){var o=g.nodesBySelector(t.selector)[0];e.parser.traverseDomTree(o,function(t){function i(e,t){return e=e||[],t.forEach(function(t){e.push(t)}),e}if(g.isTextNode(t)){for(var a=[],s=["-","â€“","~"],c=[" ",".",",",";",":","!","?",'"'],u=function(e){var r=g.nodeValue(t);a=a.concat(f["default"](n.name+c[e],r)).filter(function(e){var t=r[e.index-1];return s.every(function(e){return t!==e})})},d=0;d<c.length;d++)u(d);if(l["default"]("before result empty",a),0!==a.length&&(l["default"]("before parent check"),g.parentNode(t)===o)){if(e.maxKeywordsInspector.hitLimit("keyword"))return void l["default"]("maxKeywordsInspector");var p=e.kxObject.config.styles||{},h=i(p.rlink||[],[{selector:".kx-rlink-container",declarations:{position:"relative",display:"inline","font-size":"inherit !important"}},{selector:".kx-rlink-container .kx-ad-link, .kx-rlink-container .kx-logo-container",declarations:{position:"relative",display:"inline-block"}},{selector:".kx-rlink-container .kx-ad-logo",declarations:{position:"absolute",transition:"all .5s","max-width":"none !important","max-height":"none","min-width":"0","min-height":"0",margin:"0",padding:"0",border:"0"}}]);Kx._css.addRules(h),x.setKeywordLink({node:t,keywordResult:a,campaign:r,publisherId:e.kxObject.id,sessionId:Kx._sessionId,referrer:document.location.href},e)}}})}})})}}]),e}());t["default"]=y},function(e,t){"use strict";function n(e){if(void 0===e||null===e)throw new Error("Passed argument is undefined")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.limit=t,this.store={}}return r(e,[{key:"addKey",value:function(e){this.store[e]=this.store[e]?this.store[e]+1:1}},{key:"hitLimit",value:function(e){return this.store[e]>=this.limit}}]),e}();t["default"]=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=new RegExp(a["default"](e),"g"),r=[],o=void 0;do o=n.exec(t),o&&r.push({keyword:o[0],index:o.index});while(o);return r}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(8),a=r(i)},function(e,t){"use strict";function n(e){return"xtraffic"===e.type.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.isXtrafficCampaign=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=[];return t.forEach(function(t){t.keywords.forEach(function(r){var o=s["default"](r.name,i.textContent(e));o.forEach(function(){var e=u["default"](r,{campaignId:t.id});n.push(e)})})}),n}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(2),a=n(17),s=r(a),c=n(20),u=r(c)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(!s["default"](e))throw new TypeError("[object Object] expected")}function i(e){var t=Array.prototype.slice.call(arguments);for(t=t.reverse(),e=t.pop(),o(e);t.length>0;){var n=t[t.length-1];o(n);for(var r in n)e[r]=s["default"](n[r])&&s["default"](e[r])?i(e[r],n[r]):n[r];t.pop()}return e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i;var a=n(21),s=r(a)},function(e,t){"use strict";function n(e){return"[object Object]"===Object.prototype.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){return n(this,e),this.config=t,this}return r(e,[{key:"send",value:function(e){function t(){for(var e=!1,t=0;t<r.length;t++){try{e=r[t]()}catch(n){continue}break}return e}var n=this,r=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],o=t();o.open(this.config.verb,this.config.url,1),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-type","application/json"),o.onreadystatechange=function(){o.readyState>3&&(o.status>=200&&o.status<400?n.config.successCb(o.responseText):n.config.errorCb(o.responseText))},o.send(e)}}]),e}();t["default"]=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=e||"";return a["default"](t.split(" ")).length}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(5),a=r(i)},function(e,t){"use strict";/*!
	 * contentloaded.js
	 *
	 * Author: Diego Perini (diego.perini at gmail.com)
	 * Summary: cross-browser wrapper for DOMContentLoaded
	 * Updated: 20101020
	 * License: MIT
	 * Version: 1.2
	 *
	 * URL:
	 * http://javascript.nwbox.com/ContentLoaded/
	 * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE
	 *
	 */
function n(e,t){var n=!1,r=!0,o=e.document,i=o.documentElement,a=o.addEventListener,s=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",u=a?"":"on",d=function f(r){("readystatechange"!=r.type||"complete"==o.readyState)&&(("load"==r.type?e:o)[c](u+r.type,f,!1),!n&&(n=!0)&&t.call(e,r.type||r))},l=function h(){try{i.doScroll("left")}catch(e){return void setTimeout(h,50)}d("poll")};if("complete"==o.readyState)t.call(e,"lazy");else{if(!a&&i.doScroll){try{r=!e.frameElement}catch(p){}r&&l()}o[s](u+"DOMContentLoaded",d,!1),o[s](u+"readystatechange",d,!1),e[s](u+"load",d,!1)}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n}]);var Kx=Kx||{};Kx.Strategy=function(e){return e}(Kx.Strategy||{});var Kx=Kx||{};Kx.Strategy.DefaultRLink=function(e){function t(e){return void 0===e.impressionTrackingURL?!1:""!=e.impressionTrackingURL}var n=Kx.Helper.DOM,r=Kx.Helper.Util,o=Kx.Markup,i=Kx.Helper.Strategy;e=function(e,t){if(void 0===e)throw new TypeError("kxObject expected");if(void 0===t)throw new TypeError("parser expected");this.type="rLink",this.kxObject=e,this.parser=t;var n=e.config.displayRules.rlink;n&&(this.maxKeywordsInspector=new Kx.RuleInspector(n.max),this.maxEqualKeywordsInspector=new Kx.RuleInspector(2),this.maxEqualLogosInspector=new Kx.RuleInspector(n.maxLogos),this.maxLogosPerKeywordsInspector=new Kx.RuleInspector(n.maxLogosPerKw)),Kx.log("RLINK"),this.run()};var a;return e.prototype.run=function(){function e(e,t){return e=e||[],t.forEach(function(t){e.push(t)}),e}Kx.log("run"),Kx.log("rlp",this.parser),this.parser.parserResult.paragraphs.forEach(function(e){return 0===e.possibleKW.length?void Kx.log(e.possibleKW):void e.possibleKW.forEach(function(t){var o=i.getCampaignById(t.campaignId,this.kxObject);if(Kx.log(o),!(o&&o.formats[0].toLowerCase()!==this.type.toLowerCase()||"xtraffic"===o.type.toLowerCase())){var s=n.nodesBySelector(e.selector)[0];this.parser.traverseDomTree(s,function(e){function i(e,t){var n=e.host+e.pathname,r=t.host+t.pathname;return n==r}if(n.isTextNode(e)){for(var c=[],u=["-","â€“","~"],d=[" ",".",",",";",":","!","?",'"'],l=0;l<d.length;l++){var p=n.nodeValue(e);c=c.concat(r.findStringInText(t.name+d[l],p).filter(function(e){var t=p[e.index-1];return u.every(function(e){return t!==e})}))}if(Kx.log("before result empty",c),0!==c.length&&(Kx.log("before parent check"),n.parentNode(e)===s)){var f=document.createElement("a");if(f.href=o.targetURL,i(document.location,f))return void Kx.log("TargetURL is the same as the current URL.");if(this.maxKeywordsInspector&&this.maxKeywordsInspector.hitLimit("keyword"))return void Kx.log("maxKeywordsInspector");if(this.maxEqualKeywordsInspector&&this.maxEqualKeywordsInspector.hitLimit(t.name))return void Kx.log("maxEqualKeywordsInspector");var h=(this.getKeywordFromCampaignByName(o,t.name),o.iconURL);if(this.maxEqualLogosInspector&&this.maxEqualLogosInspector.hitLimit(h))return void Kx.log("maxEqualLogosInspector");if(this.maxLogosPerKeywordsInspector&&this.maxLogosPerKeywordsInspector.hitLimit(h+"_"+t.name))return void Kx.log("maxLogosPerKeywordsInspector");var g=this.kxObject.config.iconSize,x=this.setKeywordLink(e,c,h,o,g);x&&(a=x)}}},this)}},this)},this);var t=Kx._css,o=(this.kxObject.config.iconSize,this.kxObject.config.styles||{}),s=e(o.rlink||[],[{selector:".kx-rlink-container",declarations:{position:"relative",display:"inline","font-size":"inherit !important"}},{selector:".kx-rlink-container .kx-ad-link, .kx-rlink-container .kx-logo-container",declarations:{position:"relative",display:"inline-block"}},{selector:".kx-rlink-container .kx-ad-logo",declarations:{position:"absolute",transition:"all .5s","max-width":"none !important","max-height":"none","min-width":"0","min-height":"0",margin:"0",padding:"0",border:"0"}}]);t.addRules(s)},e.prototype.getKeywordFromCampaignByName=function(e,t){var n;return e.keywords.forEach(function(e){e.name===t&&(n=e)}),n},e.prototype.setKeywordLink=function(e,r,i,s,c){var r=r[0],u=r.keyword.slice(0,-1),d=r.index,l=n.nodeValue(e),p=this.getRLinkHtml({keyword:u,campaignIcon:i,campaign:s,iconHeight:c}),f=[];if(0===r.index){f.push(p);var h=l.substring(d+u.length,l.length);f.push(document.createTextNode(h))}else{var g=l.substring(0,d);if(f.push(document.createTextNode(g)),f.push(p),l.length!==d+u.length){var x=l.substring(d+u.length,l.length);f.push(document.createTextNode(x))}}e.nodeValue="";var y=e.nextSibling,m=document.createElement("span");m.style.opacity=0,m.style.height=0,m.style.width=0,m.style.display="inline-block",this.kxObject.config.displayRules.rlink;var v=0;this.kxObject.config.displayRules.rlink&&(v=this.kxObject.config.displayRules.rlink.minVerticalSpacing);var k=!0;if(y){if(a){y.parentNode.insertBefore(m,y);var w=m.getBoundingClientRect();y.parentNode.removeChild(m),a.getBoundingClientRect().top+v>w.top&&(k=!1)}}else if(a){e.parentNode.appendChild(m);var w=m.getBoundingClientRect();e.parentNode.removeChild(m),a.getBoundingClientRect().top+v>w.top&&(k=!1)}if(k||f.forEach(function(e,t){e===p&&(f[t]=document.createTextNode(e.textContent))}),f.forEach(y?function(e){y.parentNode.insertBefore(e,y)}:function(t){e.parentNode.appendChild(t)}),k){if(this.maxKeywordsInspector&&this.maxKeywordsInspector.addKey("keyword"),this.maxEqualKeywordsInspector&&this.maxEqualKeywordsInspector.addKey(u),this.maxEqualLogosInspector&&this.maxEqualLogosInspector.addKey(i),this.maxLogosPerKeywordsInspector&&this.maxLogosPerKeywordsInspector.addKey(i+"_"+u),Kx._tracker.track({event_type:"placement.rlink",campaign_id:s.id+"",ad_format:"rlink",keywords:[u]}),t(s)){var K=o.getViewPixel(s.impressionTrackingURL);document.body.appendChild(K)}return p}},e.prototype.getRLinkHtml=function(e){function t(e){return setTimeout(function(){e.className="kx-ad-logo"},1e3)}var n="x"+r.uniqueID(),i=document.createElement("span");i.className="kx-rlink-container kka-active "+n;var a=document.createElement("a"),s=e.campaign.targetURL;e.campaign.clickTrackingURL&&""!=e.campaign.clickTrackingURL&&(s=r.replacePlaceholder(e.campaign.clickTrackingURL,{pid:this.kxObject.id,cid:e.campaign.id,format:"rlink",keyword:e.keyword,sessionid:Kx._sessionId,ref:document.location.href,target:r.replacePlaceholder(o.appendUTMParameter(e.campaign.targetURL,e.campaign.utm,e.keyword),{pid:this.kxObject.id,keyword:e.keyword,ref:document.location.href})})),a.href=s,a.title=e.campaign.tooltip||"",a.target="_blank",a.rel="nofollow",a.className="kx-ad-link",a.appendChild(document.createTextNode(e.keyword)),i.appendChild(a),Kx.log("kx:",e.keyword);var c,u,d=!1,l=document.createElement("img");l.className="kx-ad-logo kx-init",l.style.opacity=.01,l.alt=e.campaign.tooltip,l.onload=function(r){if(!d){d=!0;var o=r.target;t(o);var i=o.width/o.height,a=e.iconHeight*i;Kx.log(e.iconHeight,i);var s;s=27>a?"-2px":"-4px",Kx._css.addRules([{selector:"."+n+".kx-rlink-container .kx-logo-container",declarations:{height:"10px",width:a+2+"px"}},{selector:"."+n+".kx-rlink-container .kx-ad-logo",declarations:{height:e.iconHeight+"px",bottom:s,left:"2px",width:"auto"}},{selector:"."+n+".kx-rlink-container .kx-ad-logo.kx-init",declarations:{height:2.35*e.iconHeight+"px"}},{selector:"."+n+".kx-rlink-container .kx-ad-link:hover .kx-ad-logo",declarations:{height:2.35*e.iconHeight+"px"}}]),c||(u=!0),!c&&u?(u=!1,c=l.complete||4===l.readyState,setTimeout(function(){var e;try{e=new Event("load")}catch(t){e=document.createEvent("Event"),e.initEvent("load",!0,!0)}d=!1,o.dispatchEvent(e)},500)):o.style.opacity=1}},l.src=e.campaignIcon,c=l.complete||4===l.readyState;var p=document.createElement("span");if(p.className="kx-logo-container",p.appendChild(l),a.appendChild(p),l.complete||4===l.readyState){var f;try{f=new Event("load")}catch(h){f=document.createEvent("Event"),f.initEvent("load",!0,!0)}l.dispatchEvent(f)}return i},e}(Kx.Strategy.DefaultRLink),function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){e.exports=n(25)},25:function(e,t,n){"use strict";window.Kx=window.Kx||{},window.Kx.Strategy=window.Kx.Strategy||{},window.Kx.Strategy.DefaultIWidget=window.Kx.Strategy.DefaultIWidget||{},window.Kx.Strategy.DefaultIWidget=function(e){var t=Kx.Helper.DOM,r=Kx.Helper.Util,o=n(26)["default"],i=Kx.Markup,a=Kx.Helper.Strategy,s=new o;return e=function(e,t){if(void 0===e)throw new TypeError("kxObject expected");if(void 0===t)throw new TypeError("parser expected");this.kxObject=e,this.parser=t,this.type="iWidget",this.run()},e.prototype.run=function(){var e=[],n=t.nodesBySelector(this.kxObject.config.contentSelector),r=[];if(n.forEach(function(e){r.push(t.textContent(e))}),this.parser.parserResult.paragraphs.forEach(function(n){var r=t.nodesBySelector(n.selector)[0];e.push(r)}),Kx.log("default_iwidget:possibleNodes",e),!(0>=e)){this.parser.parserResult.paragraphs.forEach(function(e){0!==e.possibleKW.length&&e.possibleKW.forEach(function(e){var t=a.getCampaignById(e.campaignId,this.kxObject);t&&t.formats[0].toLowerCase()!==this.type.toLowerCase()},this)},this);var o=this.getCampaignByFormat("iWidget");Kx.log("CAMPAIGN",o);var i=this.kxObject.config.displayRules.iwidget||{};i.skipParagraphs||(i.skipParagraphs=1);var s;s=i.skipParagraphs<0?e.length+i.skipParagraphs:i.skipParagraphs-1,void 0!==e[s]&&this.setIWidget(e[s],o)}},e.prototype.getCampaignByFormat=function(e){var t;return this.kxObject.campaigns.forEach(function(n){n.formats[0]===e.toLowerCase()&&(t=n)}),t},e.prototype.setIWidget=function(e,t){function n(e){return void 0===e.impressionTrackingURL?!1:""!=e.impressionTrackingURL}function o(e,t){return e=e||[],t.forEach(function(t){e.push(t)}),e}var a=this.kxObject.config.displayRules.iwidget||{},c=document.createElement("iframe");c.id="iWidget",c.className="kx-iwidget-iframe";for(var u=0,d=[],l=0;l<t.keywords.length;l++)u<(a.max||2)&&(d.push(t.keywords[l].name),u+=1);c.style.display="none",c.width="100%";var p=r.replacePlaceholder(t.targetURL,{pid:this.kxObject.id,cid:t.id,sessionId:Kx._sessionId,keyword:d.join(","),ref:document.location.href,jwt:t.jwt});if(s.sub("size.set",function(n){0===n.height?(Kx.log("iWidget empty"),e.parentNode.removeChild(c)):(c.height=n.height,c.style.display="block",Kx._tracker.track({event_type:"placement.iwidget",campaign_id:t.id+"",ad_format:"iwidget",keywords:d}))},document.location.protocol+"//a.ktxtr.com"),s.sub("items.set",function(n){0===n.items?(Kx.log("iWidget empty"),e.parentNode.removeChild(c)):(c.height=48*n.items,c.style.display="block",Kx._tracker.track({event_type:"placement.iwidget",campaign_id:t.id+"",ad_format:"iwidget",keywords:d}))},document.location.protocol+"//a.ktxtr.com"),c.height=48*u,e.nextSibling?e.parentNode.insertBefore(c,e.nextSibling):e.parentNode.appendChild(c),c.src=p,n(t)){var f=i.getViewPixel(t.impressionTrackingURL);document.body.appendChild(f)}var h=Kx._css,g=this.kxObject.config.styles||{},x=o(g.iwidget||[],[{selector:".kx-iwidget-iframe",declarations:{border:"0","margin-bottom":"19px"}}]);h.addRules(x)},e}(window.Kx.Strategy.DefaultIWidget)},26:function(e,t,n){"use strict";function r(){}function o(e){var t=void 0;try{t=JSON.stringify(e)}catch(n){t=null}return t}Object.defineProperty(t,"__esModule",{value:!0});var i=n(27);r.prototype.pub=function(e,t,n,r){var i=void 0;i="undefined"==typeof r?e:e+"|"+o(r),t.postMessage(i,n)},r.prototype.sub=function(e,t,n){i.bindEvent(window,"message",function(r){var o=void 0;if(r.origin===n){var i=r.data.split("|"),a=i[0];e===a&&(2===i.length&&(o=JSON.parse(i[1])),t(o))}})},t["default"]=r},27:function(e,t){"use strict";function n(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):window.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function r(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):window.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}Object.defineProperty(t,"__esModule",{value:!0}),t.bindEvent=n,t.unbindEvent=r}});var Kx=Kx||{};Kx.AppConfig={},Kx.AppConfig.trackingUrl="//t.ktxtr.com/track.json",Kx.AppConfig.scriptUrl="//a.ktxtr.com/api/publishers/";var Kx=Kx||{};Kx.Tracker=function(e){var t=Kx.Helper.Util,e=function(e){this.baseData=e||{},this.payload=[],this.payloadDump=[];var t=this,n=function(){t.payloadDump=[]},r=function(){t.payloadDump.forEach(function(e){this.payload.push(e)},t)};this.request=new Kx.Request({url:Kx.AppConfig.trackingUrl,verb:"POST",successCb:n,errorCb:r})};return e.prototype.getBaseData=function(){var e={client_timestamp:this.getCurrentTimestamp()};return t.mergeObjects(e,this.baseData)},e.prototype.getCurrentTimestamp=function(){return(new Date).getTime()},e.prototype.mergeWithBaseData=function(e){return t.mergeObjects(this.getBaseData(),e)},e.prototype.track=function(e){var t=this.mergeWithBaseData(e);this.payload.push(this.convertEvent(t)),this.watch()},e.prototype.convertEvent=function(e){var t=["publisher_id","campaign_id","session_id"];for(var n in e)-1!==t.indexOf(n)&&(e[n]=String(e[n]));return e},e.prototype.watch=function(){this.send()},e.prototype.send=function(){this.payloadDump=this.payload,this.payload=[];var e={events:this.payloadDump};this.request.send(JSON.stringify(e))},e}(Kx.Tracker);var Kx=Kx||{};Kx.UserToken=function(e){var t=Kx.Helper.Util,e=function(e){if(void 0===e)throw new TypeError("config expected");e.config.sendUserToken===!0&&(this.setCookie=!0)};return e.prototype.getOrSetToken=function(){return this.userToken=document.cookie.replace(/(?:(?:^|.*;\s*)ktxtrToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),""!==this.userToken?this.userToken:this.setCookie?this.setToken():null},e.prototype.setToken=function(){this.userToken=t.uniqueID(),Kx.log(this.userToken);var e=new Date;return e.setTime(+e+31536e6),document.cookie="ktxtrUID="+this.userToken+"; expires="+e.toGMTString()+"; path=/",this.userToken},e}(Kx.UserToken);var Kx=Kx||{};Kx.ContentParser=function(e){var t=Kx.Helper.DOM,n=Kx.Helper.Util,r=Kx.Helper.NodeFilter,o=Kx.Helper.ContentParser,e=function(e){if(void 0===e)throw new TypeError("config expected");if(void 0===e.config.contentSelector)throw new TypeError("contentSelector expected");var t={paragraphWordThreshold:8,parentAwayFromTextThreshold:3,contentNodes:["p","section","article"]};this.config=n.mergeObjects(t,e||{}),Kx.log(this.config),void 0!==e.config.contentNodes&&(this.config.contentNodes=e.config.contentNodes),Kx.log(this.config),this.parserResult={selector:e.config.contentSelector,paragraphs:[]}};return e.prototype.getParserResult=function(){return this.parserResult},e.prototype.parse=function(){Kx.log(this.config.config.contentSelector);var e=t.nodesBySelector(this.config.config.contentSelector);if(this.config.config.excludeSelector&&this.config.config.excludeSelector.length>0){var n=t.nodesBySelector(this.config.config.excludeSelector);e=e.filter(function(e){return-1===n.indexOf(e)})}return e.forEach(function(e){var t=e;return void 0===t?void Kx.log("NULL"):void this.traverseDomTree(t,this.processNodeIfValid,this)},this),Kx.log("cppr: ",this.parserResult),this.parserResult},e.prototype.traverseDomTree=function(e,n,r){for(r=r||this,n.call(r,e),e=t.firstChild(e);e;)this.traverseDomTree(e,n,r),e=t.nextSibling(e)},e.prototype.processNodeIfValid=function(e){this.isNodeValid(e)&&this.processNode(e)},e.prototype.isNodeValid=function(e){if(!r.containsValidText(e))return!1;var t=this.getValidParentNode(e);return"undefined"!=typeof t&&r.hasEnoughWords(t,this.config.paragraphWordThreshold)&&!r.isMarked(t)},e.prototype.getValidParentNode=function(e){for(var n=0;n<this.config.parentAwayFromTextThreshold;)if(n++,e=t.parentNode(e),r.isContentNode(e,this.config.contentNodes))return e},e.prototype.processNode=function(e){var r=this.getValidParentNode(e),i=n.uniqueID();this.markNodeWithValue(r,i);var a=o.findPossibleKeywords(r,this.config.campaigns);this.parserResult.paragraphs.push({id:i,selector:"[data-kx='"+i+"']",type:t.nodeName(r),wordCount:n.wordCount(t.textContent(r)),possibleKW:a})},e.prototype.markNodeWithValue=function(e,n){t.addAttributeToNode(e,{name:"data-kx",value:n})},e}(Kx.ContentParser);var Kx=Kx||{};Kx.ContentManager=function(e){var e=(Kx.Helper.Util,function(e,t){if(void 0===e)throw new TypeError("kxObject expected");if(void 0===t)throw new TypeError("parser expected");this.kxObject=e,this.parser=t,this.usedStrategies=[],this.strategies=this.getStrategies(e)});return e.prototype.getStrategies=function(e){var t=[];if(!e.campaigns)return t;var n=[];return e.campaigns.forEach(function(e){if(n.indexOf(e.formats[0]+e.type)<0){Kx.log(e);var r={format:e.formats[0],type:e.type,strategy:this.getPublisherStrategy(e.formats[0].toLowerCase(),e.type.toLowerCase()),ruleset:this.getPublisherRuleset(e.formats[0].toLowerCase())};t.push(r),n.push(e.formats[0]+e.type)}},this),t},e.prototype.getPublisherStrategy=function(e,t){return Kx.log("getPublisherStrategy",e,t),"rlink"===e&&"xtraffic"===t?"Xtraffic":"rlink"===e&&"xtraffic"!==t?"DefaultRLink":"iwidget"===e?"DefaultIWidget":void 0},e.prototype.getPublisherRuleset=function(e){return Kx.log("getPublisherRuleset",e),this.kxObject.config.displayRules[e]},e.prototype.decideWhichStrategies=function(){this.strategies.forEach(function(e){if(this.strategyTypeNotUsed(e.format,e.type)&&this.isStrategyDefined(e.strategy)){{this.run(e.strategy)}this.usedStrategies.push(e.format+e.type)}},this)},e.prototype.isStrategyDefined=function(e){return void 0!==Kx.Strategy[e]},e.prototype.run=function(e){var t=new Kx.Strategy[e](this.kxObject,this.parser);return t},e.prototype.strategyTypeNotUsed=function(e,t){return this.usedStrategies.indexOf(e+t)<0},e}(Kx.ContentManager);var Kx=Kx||{};Kx.CSS=function(e){return e=function(){this.styleSheet=void 0,this.hasStyleSheet()||this.createStyleSheet()},e.prototype.hasStyleSheet=function(){return void 0!==this.styleSheet},e.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.type="text/css",e.rel="stylesheet",e.id="kx-style-sheet",document.head.appendChild(e),this.styleSheet=e.sheet,this.styleSheet},e.prototype.addRules=function(e){e.forEach(function(e){this.addRule(e)},this)},e.prototype.addRule=function(e){var t=e.selector+" { ",n=e.declarations;for(var r in e.declarations)n.hasOwnProperty(r)&&(t+=r+": "+n[r]+";");t+="}",this.styleSheet.insertRule(t,this.nextIndex)},e.prototype.nextIndex=function(){return this.styleSheet.cssRules.length},e}(Kx.CSS);var Kx=Kx||{};Kx.RuleInspector=function(e){return e=function(e){this.limit=e,this.store={}},e.prototype.addKey=function(e){this.store[e]=this.store[e]?this.store[e]+1:1},e.prototype.hitLimit=function(e){return this.store[e]>=this.limit},e}(Kx.RuleInspector);var Kx=Kx||{};Kx=function(e){var t=window.Kx.Helper.Util,n=window.ktxtrPublisherId||window.kka_publisher_id;return e._css=void 0,e._tracker=void 0,e.run=function(){this._css=new Kx.CSS,this._sessionId=t.uniqueID(),this._tracker=new Kx.Tracker({session_id:this._sessionId,publisher_id:n+"",url:window.location.href}),this._tracker.track({event_type:"pi"});var e=new Kx.Request({url:Kx.AppConfig.scriptUrl+n,verb:"GET",successCb:function(e){if("undefined"==typeof e||null===e||0===e.length)return void Kx.log("Response was some kind of empty");e=JSON.parse(e);var t=function(){try{var t=new Kx.UserToken(e);Kx._userToken=t.getOrSetToken(),null!==Kx._userToken&&(Kx._tracker=new Kx.Tracker({user_token:Kx._userToken,session_id:Kx._sessionId,publisher_id:n+"",url:window.location.href}),Kx._tracker.track({event_type:"userpi"}))}catch(r){Kx.log("CATCHED",r)}},r=function(){t();try{if(e.campaigns){var n=new Kx.ContentParser(e);n.parse();var r=new Kx.ContentManager(e,n);r.decideWhichStrategies()}else Kx.log("NO CAMPAIGNS",e)}catch(o){Kx.log("CATCHED",o)}};e.waitForContent?Kx.Helper.Util.domReady(window,r):r()}.bind(this),errorCb:function(){}});e.send()},e}(Kx),function(){function e(e){return null!=window.navigator.userAgent.match(e)}return Kx.log("DEV-VERSION-03.03.2016-1"),e("MSIE 8")?void 0:e("MSIE 9")?void 0:void Kx.run()}();”âÔÊÂ      Wû{ÚWû{¾<ü™»Wû|^       :http://s.ktxtr.com/kx.js strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
Content-Type: application/javascript
Etag: W/"57ed78fc-8fb6"
Server: nginx/1.10.1
Last-Modified: Thu, 29 Sep 2016 20:26:36 GMT
Cache-Control: public, max-age=300
Via: 1.1 ISA01TMG
Age: 122
Date: Mon, 10 Oct 2016 11:27:47 GMT
 original-response-headers Via: 1.1 google, 1.1 ISA01TMG
Connection: Keep-Alive
Proxy-Connection: Keep-Alive
Transfer-Encoding: chunked
Age: 6
Date: Tue, 04 Oct 2016 06:19:49 GMT
Content-Type: application/javascript
Etag: W/"57ed78fc-8fb6"
Server: nginx/1.10.1
Last-Modified: Thu, 29 Sep 2016 20:26:36 GMT
Cache-Control: public, max-age=300
 uncompressed-len 0 necko:classified 1   ¶